ke.import("ext.clipboard"),pl.extend(ke.particles.three_dots.model,{getClassIntAttr:function(e,t){for(var o=e.split(" "),s=0,n=o.length;s<n;++s){var i=o[s].split("-");if(i[0]===t)return+i[1]}return-1},getOriginalWord:function(e){if("content"===ke.section||"pdf_tooltip"===ke.section){var t=ke.particles.three_dots.model.getClassIntAttr($(e.target).attr("class"),"t");return ke.particles.listen.model._getTransValue("tooltip","orig",$("."+ke.getPrefix()+"tooltip-"+t))}return"window"===ke.section?$(".translation-input").val():"phrasebook"===ke.section?ke.app.handlers.getPlaybackContents("orig",$(".expanded")):"history"===ke.section?ke.particles.hist_list.model.getListenValue("orig",$(".expanded")):""},getTranslatedWord:function(e){if("content"===ke.section||"pdf_tooltip"===ke.section){var t=ke.particles.three_dots.model.getClassIntAttr($(e.target).attr("class"),"t");return ke.particles.listen.model._getTransValue("tooltip","trans",$("."+ke.getPrefix()+"tooltip-"+t))}return"window"===ke.section?ke.particles.listen.model._getTransValue("window"):"phrasebook"===ke.section?ke.app.handlers.getPlaybackContents("trans"):"history"===ke.section?ke.particles.hist_list.model.getListenValue("trans"):""},createWordlist:function(e,t){chrome.runtime.sendMessage({action:ke.processCall("app","opt","newTab"),url:ke.ext.tpl.compile(chrome.extension.getURL("/pages/public/phrasebook.html#wl_create?from=<%=from%>&to=<%=to%>&text=<%=text%>&word=<%=word%>"),{from:ke.particles.three_dots.view.current_from_lang,to:ke.particles.three_dots.view.current_to_lang,word:ke.particles.three_dots.model.getOriginalWord(t)})}),chrome.runtime.sendMessage({action:ke.processCall("app","commands","sendAnalyticsEvent"),cat:"three-dot",event:ke.section,subevent:"create-wordlist"})},addToWordlist:function(e,t){var o=ke.particles.three_dots.model.getClassIntAttr($(t.target).attr("class"),"wl"),s=ke.particles.three_dots.view.current_from_lang,n=ke.particles.three_dots.view.current_to_lang,i=ke.particles.three_dots.model.getOriginalWord(t),a=$(t.target).html();chrome.runtime.sendMessage({action:ke.processCall("app","phrasebook","addPhrase"),wl_id:o,phrase:i,from:s,to:n},(function(){})),ke.ui.notifications.show(ke.ext.tpl.compile(ke.getLocale("DotsButton_Added"),{wl:a})),chrome.runtime.sendMessage({action:ke.processCall("app","commands","sendAnalyticsEvent"),cat:"three-dot",event:ke.section,subevent:"add-wordlist"})},copyOriginal:function(e,t){ke.ext.clipboard.copyToClipboard(ke.particles.three_dots.model.getOriginalWord(t)),ke.ui.notifications.show(ke.getLocale("DotsButton_OrigCopied")),chrome.runtime.sendMessage({action:ke.processCall("app","commands","sendAnalyticsEvent"),cat:"three-dot",event:ke.section,subevent:"copy-orig"})},copyTranslation:function(e,t){ke.ext.clipboard.copyToClipboard(ke.particles.three_dots.model.getTranslatedWord(t)),ke.ui.notifications.show(ke.getLocale("DotsButton_Copied")),chrome.runtime.sendMessage({action:ke.processCall("app","commands","sendAnalyticsEvent"),cat:"three-dot",event:ke.section,subevent:"copy-trans"})},copyMain:function(e){var t=$(this);t.hasClass("copied")||(t.addClass("copied"),setTimeout((function(){t.removeClass("copied")}),2500),t.hasClass("copy-translation")?ke.particles.three_dots.model.copyTranslation.call(this,null,e):t.hasClass("copy-original")&&ke.particles.three_dots.model.copyOriginal.call(this,null,e))},copySynonym:function(){var e="content"===ke.section||"pdf_tooltip"===ke.section?ke.getPrefix():"",t=$(this),o=e+"copied";if(!t.hasClass(o)){var s=$(this).parent().find("."+e+"main-of-item");t.addClass(o),setTimeout((function(){t.removeClass(o)}),2500),ke.ext.clipboard.copyToClipboard(s.html()),"content"!==ke.section&&"pdf_tooltip"!==ke.section&&ke.ui.notifications.show(ke.getLocale("Common_Copied")),chrome.runtime.sendMessage({action:ke.processCall("app","commands","sendAnalyticsEvent"),cat:ke.section,event:"copy-synonym"})}}});