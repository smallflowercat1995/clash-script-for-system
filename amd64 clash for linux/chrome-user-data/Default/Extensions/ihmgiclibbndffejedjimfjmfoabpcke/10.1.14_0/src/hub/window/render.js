!function(e){const n=864e5;pl.extend(ke.app.render,{get ONE_DAY(){return n},organize:{ctrlHistoryLinkVisibility:function(){ke.ext.util.storageUtil.requestBackgroundOption("isTrueOption",["history"],(function(e){$(".collapsable-history").css("display",e?"inline-block":"none")}))},fadeInElements:function(){$(".complex-wrap").fadeIn(175,ke.getAnimType("slide_up"),(function(){$(this).addClass("unfaded-cw"),pl(".translation-input").caretToEnd()}))},toggleUnpinLink:function(){(document.location.hash.indexOf("unpinned")>-1||ke.IS_SAMSUNG)&&$(".unpin").fadeOut(300,ke.getAnimType("fade_out"))},tryShowingProUpgradeLayout:function(){!ke.app.flags.pro&&Date.now()-ke.ext.util.storageUtil.getIntValue("pro_upgrade_last_shown")>=2592e6&&(ke.ui.pro_alert.show(ke.getLocale("Window_ProBannerAds"),"toolbar-window-routine-promo"),ke.ext.util.storageUtil.setIntValue("pro_upgrade_last_shown",Date.now()))},tryShowingSponsorshipBar:function(){let e=ke.ext.util.storageUtil.getDecodedVal("sponsorships");if(!e.active||ke.ext.util.storageUtil.isTrueOption("sponsorships_dismissed")||ke.app.flags.pro)ke.app.handlers.hideSponsorshipsBar();else if(Math.random()<.5)$(".sponsorship-bar .message").html(ke.getLocale("Window_ProBannerAds").replace(".","").replace("ã€‚","")),$(".sponsorship-bar").on("click",ke.app.handlers.onProBannerAdsClicked),"undefined"!=typeof ga&&ga("send","event","window","pro-banner-ads","shown");else{const n=2592e5;let t=ke.ext.util.storageUtil.getVal("sponsorships_current_id"),a=e.ads.filter((e=>("global"===e.region||e.region===ke.ext.util.storageUtil.getVal("user_country"))&&(void 0===e.platform||"mac"===e.platform&&ke.isMac||"windows"===e.platform&&ke.isWindows)));if(t)if(Date.now()-ke.ext.util.storageUtil.getIntValue("sponsorships_last_ad_rotation")>=n){let e=!1;for(let n=0;n<a.length;++n)if(t===a[n].id){n+1<a.length?ke.app.temp.current_ad=a[n+1]:ke.app.temp.current_ad=a[n+1-a.length],e=!0;break}e||(ke.app.temp.current_ad=a[Math.floor(Math.random()*a.length)]),ke.ext.util.storageUtil.setVal("sponsorships_current_id",ke.app.temp.current_ad.id),ke.ext.util.storageUtil.setVal("sponsorships_last_ad_rotation",Date.now())}else{let e=!1;for(let n=0;n<a.length;++n)if(t===a[n].id){ke.app.temp.current_ad=a[n],e=!0;break}e||(ke.app.temp.current_ad=a[Math.floor(Math.random()*a.length)])}else ke.app.temp.current_ad=a[Math.floor(Math.random()*a.length)],ke.ext.util.storageUtil.setVal("sponsorships_current_id",ke.app.temp.current_ad.id),ke.ext.util.storageUtil.setVal("sponsorships_last_ad_rotation",Date.now());if(ke.app.temp.current_ad&&ke.app.temp.current_ad.id){let e=ke.app.temp.current_ad.localizations[navigator.language.split("-").shift()]||ke.app.temp.current_ad.localizations.en||ke.app.temp.current_ad.localizations.ru;$(".sponsorship-bar .message").html(e),$(".sponsorship-bar").on("click",ke.app.handlers.openSponsorship),$(".sponsorship-bar .close").on("click",ke.app.handlers.dismissSponsorship),"undefined"!=typeof ga&&ga("send","event","affiliate-ads",ke.app.temp.current_ad.id,"shown")}else ke.app.handlers.hideSponsorshipsBar(),"undefined"!=typeof ga&&ga("send","event","affiliate-ads","not-shown","unknown-reason")}},adjustSwapWidth:function(){let e=$(".lang-selectors"),n=$(".from-lang"),t=$(".lang-swap"),a=0;for(;e.height()>n.height()&&t.width()>=35&&++a<=30;)t.width(t.width()-1)}},events:{showArticleUpgrade:function(){ke.app.flags.pro||$(".article").click(ke.app.handlers.showArticleUpgrade)},showIpaUpgrade:function(){ke.app.flags.pro||$(".ipa").click(ke.app.handlers.showIpaUpgrade)},swap:function(){$(".lang-swap").bind("click",ke.app.handlers.onSwapLang)},toggleTextareaFocus:function(){$(document).off("focus").on("focus",".translation-input",ke.particles.tr_input.model.onTextareaFocus),$(document).off("blur").on("blur",".translation-input",ke.particles.tr_input.model.onTextareaBlur)},listenRaw:function(){$(".listen-raw-butt0n").bind("click",ke.particles.listen.model.playRaw)},listenTranslation:function(){$(".listen-translation").bind("click",ke.particles.listen.model.playTranslation)},listenSynonym:function(){$(".listen-v-item").bind("click",ke.particles.listen.model.playSynonym),$(".small-copy-button").bind("click",ke.particles.three_dots.model.copySynonym)},useSynonym:function(){$(".synonym").bind("click",ke.app.handlers.useSynonym)},listen:function(){this.listenRaw()},clearInput:function(){$(".clear-input").bind("click",ke.app.handlers.clearInput)},enableRawListen:function(){},onHistoryLinkClick:function(){$(".history-button").bind("click",ke.app.handlers.onHistoryLinkClick)},onSettingsLinkClick:function(){$(".settings-button").bind("click",ke.app.handlers.onSettingsLinkClick)},onUnpinLinkClick:function(){$(".unpin").bind("click",ke.app.handlers.onUnpinLinkClick)},translateOnClick:function(){$(".translate-button").bind("click",ke.particles.translate.model.translateSimple)},onResize:function(){$(window).resize(ke.app.handlers.onResize)},translateOnKeyCombinations:function(){ke.ext.util.storageUtil.requestBackgroundOption("getVal",["win_trans_type"],(function(e){ke.app.$input.bind("keydown",(function(n){ke.particles.translate.model.checkTranslationShortcut(n,e)}))})),ke.app.$input.bind("keyup",(function(e){ke.particles.translate.model.toggleControls()}))},translateOnKeyup:function(){$(".translation-input").bind("keyup",ke.particles.translate.model.translateOnKeyup)},saveValueOnKeyup:function(){ke.app.$input.bind("keyup",ke.particles.tr_input.model.saveValueOnKeyup)},countTextLength:function(){ke.app.$input.bind("keyup",ke.app.handlers.countTextLength)},shortcuts:function(){$(document.body).bind("keyup",ke.app.handlers.onShortcutsUp),$(".translation-input").bind("keyup",ke.app.handlers.onShortcutsUp)},dontAutocorrect:function(){$(".autocorrection-layout .ac-word").on("click",ke.app.handlers.dontAutocorrect)}}})}();