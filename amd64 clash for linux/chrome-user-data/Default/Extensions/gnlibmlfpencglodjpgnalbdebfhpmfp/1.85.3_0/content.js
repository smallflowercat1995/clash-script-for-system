var a=(r,t)=>()=>(r&&(t=r(r=0)),t);var Rt,xo=a(()=>{"use strict";Rt=r=>{let t=new URL(r).hostname;if(t==="www.youtube.com"||t==="m.youtube.com")return"youtube";if(t==="www.netflix.com")return"netflix";if(t==="www.disneyplus.com")return"disneyplus";if(t==="www.primevideo.com"||t.startsWith("www.amazon."))return"primevideo";if(t==="www.paramountplus.com")return"paramountplus";if(t==="www.amcplus.com")return"amcplus";if(t==="www.peacocktv.com")return"peacocktv";if(t==="www.starz.com")return"starz";if(t==="www.hulu.com")return"hulu";if(t==="play.hbomax.com")return"hbomax";if(t==="watch.frndlytv.com")return"frndlytv";if(t==="www.hmnow.com")return"hmnow";if(t==="www.viki.com")return"viki";if(t==="www.funimation.com")return"funimation";if(t==="www.coupangplay.com")return"coupangplay";if(t==="www.hotstar.com")return"hotstar";if(t==="www.coursera.org")return"coursera";if(t==="www.udemy.com")return"udemy";if(t==="www.ted.com")return"ted";if(t==="www.ardmediathek.de")return"ard";if(t==="www.zdf.de")return"zdf";if(t==="www.bbc.co.uk")return"bbciplayer";if(t==="www.britbox.co.uk")return"britbox";if(t==="www.britbox.com")return"britboxcom";if(t==="www.itv.com")return"itv";if(t==="www.channel4.com")return"channel4";if(t==="www.channel5.com")return"channel5";if(t==="iview.abc.net.au")return"abciview";if(t==="7plus.com.au")return"7plus";if(t==="www.9now.com.au")return"9now";if(t==="10play.com.au")return"10play";if(t==="play.stan.com.au")return"stan";if(t==="www.raiplay.it")return"raiplay";if(t==="www.arte.tv")return"arte";if(t==="vimeo.com")return"vimeo";if(t==="viu.tv")return"viutv";if(t==="www.iq.com")return"iqiyiint";if(t==="wetv.vip"||t==="www.iflix.com")return"wetv";if(t==="www.bilibili.com")return"bilibili";if(t==="www.magellantv.com")return"magellantv";if(t==="www.starplus.com")return"starplus";if(t==="www.rtve.es")return"rtveplay";if(t==="player.dualsub.xyz")return"player";throw`invalid url: ${r}`}});function ct(r,t,e){let n=t.type;if(n==="string"||n==="number"||n==="boolean")return ls(t,e);if(n==="null")return null;if(n==="array"){if(t=t,t.items===void 0)return[];Nt(t,e)||(e=[]);let o=t.items,s=[];for(let i of e)s.push(ct(r,o,i));return s}if(n==="object"){if(t=t,t.properties===void 0)return{};Nt(t,e)||(e={});let o=t.properties,s=t.required??[],i={};for(let[c,l]of Object.entries(o)){let u=e[c];if(r==="expand"){let p=ct(r,l,u);i[c]=p;continue}if(r==="shrink"){let p=ct(r,l,u);Wd(l,p)||(i[c]=p);continue}if(r==="inject"){let p=u!==void 0,I=s.includes(c);if(p||I){let k=ct(r,l,u);i[c]=k}continue}throw`invalid mode: ${r}`}return i}throw`invalid schema type: ${n}`}function So(r,t){t=t??new WeakMap;let e=typeof r;if(e==="string"||e==="number"||e==="boolean"||e==="function"||r===null)return r;if(e!=="object")throw`invalid type: ${e}`;if(t.has(r))throw"circular reference";if(Array.isArray(r)){t.set(r,!0);let o=r.map(s=>So(s,t));return t.delete(r),o}t.set(r,!0);let n={};for(let[o,s]of Object.entries(r))n[o]=So(s,t);return t.delete(r),n}function wo(r){let t=typeof r;if(t==="string"||t==="number"||t==="boolean")return{type:t,default:r};if(r===null)return{type:"null"};if(Array.isArray(r))return{type:typeof r[0],default:r[0],enum:r};if(t!=="object")throw`invalid value type: ${t}`;let e=r,n=e.type;if(!(n==="string"||n==="number"||n==="boolean"||n==="null")){if(n==="array"){let o=wo(e.items);o!==void 0&&(e.items=o);return}if(n==="object"){let o=e.properties??{};for(let[s,i]of Object.entries(o)){let c=wo(i);c!==void 0&&(o[s]=c)}e.required===!0&&(e.required=Object.keys(o)),e.required===!1&&(e.required=[]);return}throw`invalid schema type: ${n}`}}var Nt,ls,Wd,us,ps,ms=a(()=>{Nt=(r,t)=>{let e=r.type;if(e==="string"||e==="number"||e==="boolean")return typeof t===e;if(e==="null")return t===null;if(e==="array")return Array.isArray(t);if(e==="object")return!(typeof t!="object"||t===null||Array.isArray(t));throw`invalid schema type: ${e}`},ls=(r,t)=>{let e=r.type;if(e==="string"||e==="number"||e==="boolean"){r=r,t!==void 0&&r.enum!==void 0&&(r.enum.includes(t)||(t=void 0));let n=!1;if(t!==void 0&&(n=Nt(r,t)),n||(t=r.default,t!==void 0&&(n=Nt(r,t))),e==="string")return n?t:"";if(e==="number")return n?t:0;if(e==="boolean")return n?t:!1}if(e==="null")return null;if(e==="array")return[];if(e==="object")return{};throw`invalid schema type: ${e}`},Wd=(r,t)=>{let e=r.type;if(e==="string"||e==="number"||e==="boolean")return ls(r)===t;if(e==="null")return!0;if(e==="array")return t.length===0;if(e==="object")return Object.keys(t).length===0;throw`invalid schema type: ${e}`};us=(r,t)=>ct("inject",r,t);ps=r=>{let t=So(r);return wo(t),t}});var Ad,$d,fs,ds=a(()=>{Ad={type:"object",properties:{bottomMargin:100,baseStyle:["stroke","background","classic","none"],mouseAction:["none","text"]},required:!0},$d={type:"object",properties:{subtitleCount:[2,3,4,5,6,7,8],showOnlyLanguages:""},required:!0},fs={type:"object",properties:{rendering:Ad,dropdown:$d},required:!0}});var zd,Fd,qd,gs,hs=a(()=>{zd={type:"object",properties:{languageList:["popular","available"],translationEngine:["google","microsoft"],translationMode:["auto","enhance","normal"]},required:!0},Fd={type:"object",properties:{pinyinScheme:["putonghua","guangzhouhua","jyutping"]},required:!0},qd={type:"object",properties:{furiganaCharacter:["kanji","kana"]},required:!0},gs={type:"object",properties:{translation:zd,chinese:Fd,japanese:qd},required:!0}});var _,z,et,Ud,Hd,Vd,_d,Gd,st,lt,L,Jd,Bd,Xd,Kd,Yd,Zd,Qd,tg,ys,bs=a(()=>{_={type:"array",items:""},z={fontSize:100,fontColor:"#ffffff",fontOpacity:100,fontEdgeEffect:["none","shadow","raised","depressed","outline","stroke"],fontEdgeColor:"#ffffff",fontEdgeSize:0,fontBold:!0,fontItalic:!0,backgroundColor:"#ffffff",backgroundOpacity:100,backgroundEdgeEffect:["none","shadow"],backgroundEdgeColor:"#ffffff",borderSize:0,borderColor:"#ffffff"},et={display1:["true","false"],display2:["true","false","preserve"],flexAlign:["center","left","right","evenly"]},Ud={flexAlign:et.flexAlign,...z},Hd={...z},Vd={display:et.display2,...z},_d={display:et.display2,flexAlign:et.flexAlign,...z},Gd={display:et.display2,backgroundColor:z.backgroundColor,backgroundEdgeEffect:z.backgroundEdgeEffect,backgroundEdgeColor:z.backgroundEdgeColor,borderSize:z.borderSize,borderColor:z.borderColor},st={display:et.display1,match:"",...z},lt={display:et.display1,match:_,...z},L=r=>({type:"object",properties:r,required:!1}),Jd={type:"object",properties:{none:null,dialogue:L(Ud),contents:L(Hd),readings:L(Vd),grammars:L(_d),dividers:L(Gd),pinyin:L(st),hiragana:L(st),katakana:L(st),romaji:L(st),loanword:L(st),pos:L(lt),form:L(lt),tag:L(lt),base:L(st),sense:L(lt),jlpt:L(lt)},required:!1},Bd={type:"object",properties:{text:"",hiragana:"",katakana:"",romaji:"",loanword:"",pos:_,form:_,tag:_,base:"",sense:_,jlpt:_},required:!1},Xd={type:"object",properties:{name:"",component:Jd},required:!0},Kd={type:"object",properties:{name:"",genres:_,tokens:Bd},required:!0},Yd={type:"object",properties:{name:"",genres:_,rulers:_,toolkit:"none"},required:!0},Zd={type:"array",items:Xd},Qd={type:"array",items:Kd},tg={type:"array",items:Yd},ys={type:"object",properties:{genres:Zd,rulers:Qd,themes:tg},required:!0}});var eg,xs,Ss=a(()=>{eg={type:"object",properties:{name:"",type:["none","style","script","standard","simple"],code:"",urls:{type:"array",items:""}},required:!0},xs={type:"object",properties:{items:{type:"array",items:eg}},required:!0}});var ng,ws,vs=a(()=>{ng={type:"object",properties:{name:"",lang:"",code:"",urls:{type:"array",items:""}},required:!0},ws={type:"object",properties:{items:{type:"array",items:ng}},required:!0}});var rg,Ms,Is=a(()=>{rg={type:"object",properties:{apiUrl:["https://api.dualsub.xyz/"],apiKey:""},required:!0},Ms={type:"object",properties:{server:rg},required:!0}});var og,sg,vo,ks=a(()=>{ms();ds();hs();bs();Ss();vs();Is();og={type:"object",properties:{general:fs,language:gs,style:ys,plugin:xs,file:ws,network:Ms},required:!0},sg=ps(og),vo=r=>us(sg,r)});var ig,ag,cg,lg,ut,Mo=a(()=>{ig={get:r=>new Promise((t,e)=>{chrome.storage.local.get(r,n=>{let o=chrome.runtime.lastError;o?e(o):t(n)})}),set:r=>new Promise((t,e)=>{chrome.storage.local.set(r,()=>{let n=chrome.runtime.lastError;n?e(n):t()})})},ag={sendMessage:r=>new Promise((t,e)=>{chrome.runtime.sendMessage(r,n=>{let o=chrome.runtime.lastError;o?e(o):t(n)})})},cg={query:r=>new Promise(t=>{chrome.tabs.query(r,e=>{t(e)})}),sendMessage:(r,t)=>new Promise((e,n)=>{chrome.tabs.sendMessage(r,t,o=>{let s=chrome.runtime.lastError;s?n(s):e(o)})})},lg={storage:ig,runtime:ag,tabs:cg},ut=lg});var ug,js,Ts=a(()=>{"use strict";ks();Mo();ug={loadSetting:async()=>{let{setting:r}=await ut.storage.get(["setting"]);return vo(r)},saveSetting:async r=>{let t=vo(r);await ut.storage.set({setting:t})}},js=ug});var Cs,Rs=a(()=>{"use strict";Cs=(r,t,e,n)=>{let o=r[t.name];if(!o){let s=`invalid name: ${t.name}`;n({ok:!1,data:s});return}o(e,t.args).then(s=>n({ok:!0,data:s}),s=>n({ok:!1,data:String(s)}))}});var pg,mg,fg,dg,Ns,Ps=a(()=>{pg=["af","am","ar","az","be","bg","bn","bs","ca","ceb","co","cs","cy","da","de","el","en","eo","es","et","eu","fa","fi","fr","fy","ga","gd","gl","gu","ha","haw","hi","hmn","hr","ht","hu","hy","id","ig","is","it","iw","ja","jw","ka","kk","km","kn","ko","ku","ky","la","lb","lo","lt","lv","mg","mi","mk","ml","mn","mr","ms","mt","my","ne","nl","no","ny","or","pa","pl","ps","pt","ro","ru","rw","sd","si","sk","sl","sm","sn","so","sq","sr","st","su","sv","sw","ta","te","tg","th","tk","tl","tr","tt","ug","uk","ur","uz","vi","xh","yi","yo","zu"],mg=["zh-hans","zh-hant"],fg=[],dg=pg.concat(mg).concat(fg),Ns=dg});var gg,hg,yg,bg,Os,Ds=a(()=>{gg=["af","am","ar","az","bg","bs","ca","cs","cy","da","de","el","en","es","et","fa","fi","fr","ga","gu","hi","hr","ht","hu","hy","id","is","it","ja","kk","km","kn","ko","lo","lt","lv","mg","mi","ml","mr","ms","mt","ne","nl","pa","pl","ps","ro","ru","sk","sl","sm","sq","sv","sw","ta","te","th","tr","uk","ur","vi"],hg=["tl","iw","no"],yg=["bn","ku","my","or","pt","zh-hans","zh-hant"],bg=gg.concat(hg).concat(yg),Os=bg});var xg,Sg,wg,vg,Es,Ls=a(()=>{xg=["bg","cs","da","de","el","en","es","et","fi","fr","ga","hr","hu","is","it","ja","lt","lv","mt","nl","no","pl","pt","ro","ru","sk","sl","sv"],Sg=["zh-hans","zh-hant"],wg=[],vg=xg.concat(Sg).concat(wg),Es=vg});var Mg,Ws,As=a(()=>{Mg=["ar","cs","de","el","en","es","fr","hu","ja","ko","pl","pt","ru","th","tr","vi","zh-hans","zh-hant"],Ws=Mg});var Pt,Io=a(()=>{Ps();Ds();Ls();As();Pt=r=>{let t=[];r.engine==="google"&&(t=Ns),r.engine==="microsoft"&&(t=Os),r.engine==="deepl"&&(t=Es);let e=[];r.filter==="available"&&(e=Array.from(t)),r.filter==="popular"&&(e=Ws.filter(n=>t.includes(n)));for(let n of r.attach)n=n.toLowerCase().replace("_","-").trim(),n=n.split("-")[0],!e.includes(n)&&t.includes(n)&&e.push(n);return e.sort(),e}});var Ig,kg,$s,jg,F,zs=a(()=>{Ig=r=>{if(r=r.trim(),r==="")return null;r=r.replace(/\[/g,'["').replace(/\]/g,'"]').replace(/,/g,'","').replace(/\]\[/g,"],[");let t;try{t=JSON.parse(`[${r}]`)}catch{return null}let e=[];for(let o=0;o<3;o++){let s=t[o]??[];s=s.map(i=>i.trim()).filter(i=>i!==""),s.length===0&&s.push("SKIP"),e.push(s)}let n=[];for(let o of t[3]??[]){let s=parseInt(o);if(isNaN(s)||String(s)!==o)return null;n.push(s)}return n.length===0&&n.push(0),{files:e[0],translates:e[1],legends:e[2],limits:n}},kg=r=>{if(r=r.trim(),r==="")return[];let t=[];for(let e of r.split(`
`)){let n=Ig(e);n&&t.push(n)}return t},$s=()=>({file:"",translate:"",legend:""}),jg=()=>({files:["SKIP"],translates:["SKIP"],legends:["SKIP"],limits:[0]}),F=class{constructor(t){this.hasValue=(t,e)=>e===""?!0:t.find(n=>n.value===e)!==void 0;this.rules=t}static fromText(t){let e=kg(t);return new F(e)}static fromCount(t){let e=Array(t).fill(jg());return new F(e)}get(t,e,n){let o=[],s=0;for(let i=0;i<n;i++){let c=e[i]??$s(),l=null;for(;s<this.rules.length;){let u=this.rules[s];if(s+=1,l=this.matchSchema(t,u,c,i),l)break}l?o.push(l):o.push($s())}return o}matchSchema(t,e,n,o){if(!e.limits.includes(0)&&!e.limits.includes(o+1))return null;let s=this.hasValues(t.files,e.files,n.file,!0);if(s===null)return null;let i=this.hasValues(t.translates,e.translates,n.translate,!0);if(i===null)return null;let c=this.hasValues(t.legends,e.legends,n.legend,!1);return c===null?null:{file:s,translate:i,legend:c}}hasValues(t,e,n,o){let s=[n];if(o){let l=["zh-hans","zh-cn"],u=["zh-hant","zh-tw","zh-hk","zh-mo"];l.includes(n)&&(s.push(...l),s.push(...u)),u.includes(n)&&(s.push(...u),s.push(...l));let p=n.split(/\b/)[0];s.push(p)}s=Array.from(new Set(s));let i=[];for(let l of e){if(l==="SKIP"){i.push(...s),i.push("");continue}if(l==="LAST"){i.push(...s);continue}if(l==="CLOSE"){i.push("");continue}i.push(l)}i=Array.from(new Set(i));let c=[];for(let l of i){if(l===""){c.push(l);continue}if(o){let u=new RegExp(`^${l}\\b`);for(let p of t)u.test(p.value)&&c.push(p.value)}else c.push(l)}c=Array.from(new Set(c));for(let l of c)if(this.hasValue(t,l))return l;return null}}});var Fs,qs,nt,ko=a(()=>{"use strict";zs();Fs=r=>{for(let t of r)if(t.file!=="")return!1;return!0},qs=(r,t)=>{let e=`${location.origin}/`;for(let n of r.plugin.items)if(n.urls.includes(e)&&n.type===t)return n.code;return""},nt=class{setting;mode;count;text;macroLast;macroUser;constructor(t,e){this.setting=t,this.mode=e,this.count=t.general.dropdown.subtitleCount,this.text=qs(t,this.mode),this.macroLast=F.fromCount(this.count),this.macroUser=F.fromText(this.text)}updateSetting(t){this.setting=t,this.count=t.general.dropdown.subtitleCount,this.text=qs(t,this.mode),this.macroLast=F.fromCount(this.count),this.macroUser=F.fromText(this.text)}get(t,e){let n=this.macroLast.get(t,e,this.count),o=this.macroUser.get(t,e,this.count);return Fs(n)&&!Fs(o)?o:n}}});var Ot,Us,Dt=a(()=>{"use strict";Ot=r=>new Promise(t=>setTimeout(t,r)),Us=r=>(r=r.toLowerCase().replace("_","-").trim(),r==="zh-tw"||r==="zh-hk"||r==="zh-mo"||r==="zh-hant"?"zh-hant":r.match(/^zh\b/)?"zh-hans":"en")});var Tg,Cg,Rg,G,pt=a(()=>{"use strict";Dt();xo();Tg=new URL(location.href).searchParams.get("hl"),Cg=Us(Tg??navigator.language),Rg=Rt(location.href),G={i18nCode:Cg,website:Rg}});var Et,Lt,V,Wt=a(()=>{Et=(r,t)=>[Math.floor(r/t),r%t],Lt=r=>{let t=l=>String(l).padStart(2,"0"),e=l=>String(l).padStart(3,"0"),[n,o,s,i,c]=[0,0,0,0,0];return[c,i]=Et(r,1e3),[o,s]=Et(c,60),[n,o]=Et(o,60),`${t(n)}:${t(o)}:${t(s)}.${e(i)}`},V=r=>{let[t,e]=r.split("."),n=t.split(":").reverse(),o=0;for(let[s,i]of n.entries())o+=parseInt(i)*60**s;return o*1e3+parseInt(e)}});var R,rt=a(()=>{Wt();R=class{constructor(t,e,n){this.start=t,this.duration=e,this.content=n}clone(){return new R(this.start,this.duration,this.content)}get end(){return this.start+this.duration}get startString(){return Lt(this.start)}get endString(){return Lt(this.end)}between(t,e){return e=e??t,this.start<=t&&this.end>=e}}});var T,it=a(()=>{T=class{constructor(t){this.dialogues=t}clone(){let t=this.dialogues.map(e=>e.clone());return new T(t)}find(t,e){for(let n of this.dialogues)if(n.between(t,e))return n;return null}get contents(){return this.dialogues.map(t=>t.content)}get intervals(){let t=[];for(let e=0;e<this.dialogues.length-1;e++){let n=this.dialogues[e],o=this.dialogues[e+1];t.push(o.start-n.end)}return t.push(0),t}}});var Ng,Pg,Og,At,Dg,Hs,Eg,q,J,jo,To,W,Vs=a(()=>{Wt();rt();it();Ng='xml version="1.0" encoding=',Pg={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&lrm;":"\u202A","&rlm;":"\u202B"},Og=r=>r.replace(/&.+?;/g,t=>{let e=Pg[t];return e===void 0?t:e}),At=r=>Og(r).replace(/<br\/>/g,`
`).replace(/<br .+?>/g,`
`).replace(/<.+?>/g,""),Dg=r=>r.replace(/{.+?}/g,"").replace(/\\[nN]/g,`
`).replace(/\\[hH]/g," "),Hs=r=>r.endsWith("t")?parseInt(r.slice(0,-5)):(r.includes(".")||(r=`${r}.000`),V(r)),Eg=(r,t,e)=>{let n=r.split(t);return n.length>e&&n.push(n.splice(e-1).join("")),n},q=r=>{if(!r.startsWith("WEBVTT"))throw"invalid text";let t=r.split(`
`).map(s=>s.trim()),e=/([0-9:.]+) --> ([0-9:.]+)/,n=[],o=null;for(let s of t)if(o===null){let i=s.match(e);i&&(o={matches:i,payloads:[]})}else if(s!=="")o.payloads.push(s);else{let i=V(o.matches[1]),l=V(o.matches[2])-i,u=At(o.payloads.join(`
`));n.push(new R(i,l,u)),o=null}return new T(n)},J=r=>{let t=r.split(`
`).map(s=>s.trim()),e=/([0-9:,]+) --> ([0-9:,]+)/,n=[],o=null;for(let s of t)if(o===null){let i=s.match(e);i&&(o={matches:i,payloads:[]})}else if(s!=="")o.payloads.push(s);else{let i=V(o.matches[1].replace(",",".")),l=V(o.matches[2].replace(",","."))-i,u=At(o.payloads.join(`
`));n.push(new R(i,l,u)),o=null}return new T(n)},jo=r=>{if(!r.startsWith("[Script Info]")||!r.includes("ScriptType: v4.00"))throw"invalid text";let t=r.split(`
`).map(p=>p.trim()),e=t.findIndex(p=>/^Format:.*Text$/.test(p)),n=t[e].split(",").map(p=>p.trim()),o=t.slice(e+1),s=n.length,i=n.findIndex(p=>p==="Start"),c=n.findIndex(p=>p==="End"),l=n.findIndex(p=>p==="Text"),u=[];for(let p of o){if(p==="")continue;let I=Eg(p,",",s),k=V(I[i]),j=V(I[c])-k,D=Dg(I[l]),A=new R(k,j,D);u.push(A)}return new T(u)},To=r=>{let t=/\[([0-9:.]+)\](.*)/,e=i=>{let c=i.match(t);if(!c)return[];let l=V(c[1]),u=c[2].trim();if(!u.match(t))return[{start:l,content:u}];let p=e(u);return u=p[0].content,[{start:l,content:u},...p]},n=r.split(`
`).map(i=>i.trim()),o=[];for(let i of n)o.push(...e(i));if(o.sort((i,c)=>i.start-c.start),o.length>0){let i=o[o.length-1];if(i.content!==""){let c=i.content.length*500;o.push({start:i.start+c,content:""})}}let s=[];for(let i=0;i<o.length-1;i++){let c=o[i],l=c.start,u=o[i+1].start-l-1,p=c.content;p!==""&&s.push(new R(l,u,p))}return new T(s)},W=r=>{if(!r.includes(Ng))throw"invalid text";let o=new globalThis.DOMParser().parseFromString(r,"application/xml").querySelector("body, tt\\:body").querySelectorAll("[begin][end]"),s=[];for(let i of o){let c=Hs(i.getAttribute("begin")),u=Hs(i.getAttribute("end"))-c,p=At(i.innerHTML);s.push(new R(c,u,p))}return new T(s)}});var _s=a(()=>{});var Lg,Gs,Js=a(()=>{rt();Lg=r=>{let t=new Map;for(let n of r)t.set(n.start,!0),t.set(n.end,!0);let e=Array.from(t.keys());return e.sort((n,o)=>n-o),e},Gs=r=>{let t=Lg(r),e=[];for(let o=0;o<t.length-1;o++){let s=t[o],i=t[o+1],c=[];for(let l of r)l.between(s,i)&&c.push(l.content);c.length>0&&e.push({start:s,end:i,contents:c})}let n=[];for(let o of e){let s=o.start,i=o.end-o.start,c=o.contents.join(`
`);n.push(new R(s,i,c))}return n}});var Co,Bs=a(()=>{Co=r=>{let t=[];for(let e of r){if(t.length===0){t.push(e);continue}let n=t[t.length-1];if(n.end!==e.start||n.content!==e.content){t.push(e);continue}n.duration+=e.duration}return t}});var Wg,$t,Ro=a(()=>{Wg=(r,t,e)=>{let n=t.duration/(t.duration+e.duration),o=Math.floor(n*r.duration),s=r.duration-o,i,c;return o>s?[i,c]=[o,s]:[i,c]=[s,o],t.duration>e.duration?[c,i]:[i,c]},$t=(r,t)=>{let e=[],n=0;for(;n<r.length;){let o=r[n];if(n===0||n===r.length-1){e.push(o),n+=1;continue}let s=e[e.length-1],i=r[n+1];if(s.end!==o.start||o.end!==i.start){e.push(o),n+=1;continue}if(!t(o,s,i)){e.push(o),n+=1;continue}let[c,l]=Wg(o,s,i);s.duration+=c,i.duration+=l,i.start-=l,e.push(i),n+=2}return e}});var Ag,Xs,Ks=a(()=>{Ro();Ag=(r,t,e)=>r.content===`${t.content}
${e.content}`,Xs=r=>$t(r,Ag)});var $g,Ys,Zs=a(()=>{rt();$g=r=>{let t=new Map;for(let n of r)for(let o of n.dialogues)t.set(o.start,!0),t.set(o.end,!0);let e=Array.from(t.keys());return e.sort((n,o)=>n-o),e},Ys=r=>{let t=$g(r),e=[];for(let o=0;o<t.length-1;o++){let s=t[o],i=t[o+1],c=[],l=!1;for(let u of r){let p=u.find(s,i);p?(l=!0,c.push(p.content)):c.push("")}l&&e.push({start:s,end:i,contents:c})}let n=[];for(let o of e){let s=o.start,i=o.end-o.start,c=o.contents.join(`
`);n.push(new R(s,i,c))}return n}});var Qs,zg,ti,ei=a(()=>{Qs=(r,t)=>r===""?!1:!!(r.startsWith(`
`)&&t.endsWith(r)||r.endsWith(`
`)&&t.startsWith(r)),zg=r=>{let t=!1;for(let e=1;e<r.length;e++){let n=r[e],o=r[e-1];n.start!==o.end||n.content===o.content||!Qs(n.content,o.content)||(n.content=o.content,t=!0)}for(let e=0;e<r.length-1;e++){let n=r[e],o=r[e+1];n.end!==o.start||n.content===o.content||!Qs(n.content,o.content)||(n.content=o.content,t=!0)}return t},ti=r=>{let t=Array.from(r),e=!0,n=0;for(;e&&n<5;)e=zg(t),n+=1;return t}});var Fg,qg,Ug,ni,ri=a(()=>{Ro();Fg=(r,t,e,n)=>!(r>t||r>e||r>n),qg=(r,t,e)=>{let n=r.split(`
`);if(n.length<=1)return!1;let o=n.pop(),s=n.join(`
`);return s===""||o===""?!1:!!(t.startsWith(s)&&e.endsWith(o)||t.endsWith(o)&&e.startsWith(s))},Ug=r=>(t,e,n)=>!(!Fg(t.duration,e.duration,n.duration,r)||!qg(t.content,e.content,n.content)),ni=(r,t=6e4)=>$t(r,Ug(t))});var mt,ft,oi=a(()=>{it();Js();Bs();Ks();Zs();ei();ri();mt=r=>{let t=r.clone().dialogues;return t=Gs(t),t=Co(t),t=Xs(t),new T(t)},ft=r=>{if(r.length===0)return new T([]);let t=r[0];for(let e=1;e<r.length;e++){let n=Ys([t,r[e]]);n=ti(n),n=Co(n),n=ni(n),t=new T(n)}return t}});var dt,No,si=a(()=>{rt();it();dt=r=>{let t=JSON.parse(r).events,e=[];for(let n of t){let o=n.tStartMs,s=n.dDurationMs,c=(n.segs??[]).map(l=>l.utf8).join("").trim();c!==""&&e.push(new R(o,s,c))}return new T(e)},No=r=>{let t=[];for(let n of r.dialogues){let o=n.start,s=n.duration,i=[{utf8:n.content}];t.push({tStartMs:o,dDurationMs:s,segs:i})}let e={wireMagic:"pb3",events:t,pens:[{}],wpWinPositions:[{}],wsWinStyles:[{}]};return JSON.stringify(e,null,4)}});var Po,ii=a(()=>{rt();it();Po=r=>{let t=JSON.parse(r).body,e=[];for(let n of t){let o=Math.round(n.from*1e3),s=Math.round(n.to*1e3)-o,i=n.content;i!==""&&n.location===2&&e.push(new R(o,s,i))}return new T(e)}});var O=a(()=>{Wt();rt();it();Vs();_s();oi();si();ii()});var zt,ot,gt,ht=a(()=>{zt=r=>{let t=[];for(let e of r.events){let n=e.tStartMs??0,o=e.dDurationMs??0,s=e.segs??[];if(s.length===0)continue;let i=[];for(let u of s){let p=n+(u.tOffsetMs??0),I=0,k=u.utf8??"";i.push({start:p,duration:I,content:k})}let c=0;for(let u=0;u<i.length-1;u++){let p=i[u],k=i[u+1].start-p.start;p.duration=k,c+=k}let l=i[i.length-1];l.duration=o-c,t.push(...i)}for(let e=0;e<t.length-1;e++){let n=t[e],o=t[e+1];n.start+n.duration>o.start&&(n.duration=o.start-n.start)}return t},ot=r=>{let t=r[0].start,e=0,n=[];for(let o of r)e+=o.duration,n.push(o.content);return{start:t,duration:e,content:n.join("")}},gt=r=>{let t=0;for(let e of r)t+=e.duration;return t}});var Oo,ai=a(()=>{ht();Oo=r=>{let t=JSON.parse(r),e=zt(t),n=[],o=[],s=()=>{o.length>0&&(n.push(ot(o)),o=[])},i=0,c=0;for(let l of e){let{start:u,duration:p,content:I}=l,k=u+p;(u>c||i===2)&&(s(),i=0),o.push(l),c=k,I===`
`&&(i+=1)}return s(),n}});function Ft(r,t){if(r.length<2)return[r];if(gt(r)<t.duration)return[r];let e=[];for(let n of Vg(r))e.push(...Ft(n,t));return e}var Hg,Do,Vg,_g,Gg,Jg,ci,li=a(()=>{ht();Hg=r=>{let{duration:t,content:e}=r,n=t;return e.match(/[0-9]{2}/)?n*.8:e.length>8?n*.9:n},Do=(r,t)=>{let e=r.slice(0,t+1),n=r.slice(t+1);if(e.length===0||n.length===0)throw"invalid index";return[e,n]},Vg=r=>{if(r.length<2)throw"invalid length";let t=[];for(let s=0;s<r.length-1;s++){let i=Hg(r[s]);t.push({index:s,weight:i})}t.sort((s,i)=>i.weight-s.weight);for(let s of t){let[i,c]=Do(r,s.index);if(gt(i)>=1500&&gt(c)>=1500)return[i,c]}let e=gt(r)/2,n=0;for(let s=0;s<r.length-1;s++)if(n+=r[s].duration,n>=e)return Do(r,s);let o=Math.floor((r.length-1)/2);return Do(r,o)};_g=r=>Ft(r,{duration:5e3}),Gg=r=>Ft(r,{duration:1e4}),Jg=r=>Ft(r,{duration:15e3}),ci=r=>{let t=[];for(let e of Jg(r)){let n=[];for(let o of Gg(e)){let s=[];for(let i of _g(o))s.push(i);n.push(s)}t.push(n)}return t}});var qt,ui=a(()=>{ht();qt=(r,t)=>{let e=[];for(let n=0;n<r.length;n++){let o=r[n];if(e.length===0){e.push(o);continue}let s=e[e.length-1];if(!t(s,o)){e.push(o);continue}e[e.length-1]=ot([s,o])}return e}});var Bg,Xg,Kg,Yg,Zg,Eo,pi=a(()=>{ht();li();ui();Bg=r=>qt(r,(t,e)=>t.content===`
`),Xg=r=>{let t=/^[0-9\n ]+$/;return qt(r,(e,n)=>t.test(e.content)&&t.test(n.content))},Kg=r=>{let t=new Map;for(let e=0;e<r.length;e++){let n=r.slice(e,e+4);for(;n.length>=2;){let s=ot(n).content.replace(/\n/g," ").trim(),i=t.get(s)??0;t.set(s,i+1),n.pop()}}return qt(r,(e,n)=>{let s=`${e.content}${n.content}`.replace(/\n/g," ").trim();return(t.get(s)??0)>=3})},Yg=(r,t,e)=>{let n=0;t&&(e?n=r.length+100:n=r.length);let o=ot(r);return o.duration>n&&(o.duration-=n),o},Zg=r=>{let t=[];for(let e of r)for(let[n,o]of e.entries()){let s=n===e.length-1;for(let[i,c]of o.entries()){let l=i===o.length-1;t.push(Yg(c,l,s))}}return t},Eo=r=>{let t=JSON.parse(r),e=zt(t);e=Bg(e),e=Xg(e),e=Kg(e);let n=ci(e);return Zg(n)}});var Lo=a(()=>{ai();pi()});var Qg,th,mi,eh,Ut,fi=a(()=>{Qg=r=>{let t=r.split(`
`).map(s=>s.trim()).filter(s=>s!=="");if(t.length<=1)return t.join("");let e=/\p{Unified_Ideograph}/u,n=/[，。？！：；、“”「」《》（）【】]/,o=[];for(let s=0;s<t.length-1;s++){let i=t[s],c=t[s+1],l=i[i.length-1],u=c[0];if(l.match(e)&&u.match(e)||l.match(n)||u.match(n)){o.push(i);continue}o.push(i," ")}return o.push(t[t.length-1]),o.join("")},th=r=>(r=r.replace(/(\p{Unified_Ideograph})([\w%#])/gu,"$1 $2"),r=r.replace(/([\w%#])(\p{Unified_Ideograph})/gu,"$1 $2"),r),mi=(r,t,e)=>r.replace(t,e).split(`
`),eh=r=>{if(r.trim()==="")return[r];let t=/([，。？！：；、”」》）】)\]] *)/g,e=/([“「《【([])/g,n=[];for(let o of mi(r,t,`$1
`))n.push(...mi(o,e,`
$1`));return n.filter(o=>o!=="")},Ut={oneline:Qg,pretty:th,segment:eh}});var Ao,$o,Wo,yt,di=a(()=>{fi();Ao=class{getWidth(t){return t.length}startsWithComma(t){let e=/^[，、]/;return t.match(e)!==null}startsWithPeroid(t){let e=/^[。？！：；”」》）】)\]]/;return t.match(e)!==null}startsWithSymbol(t){return this.startsWithComma(t)||this.startsWithPeroid(t)}endsWithComma(t){let e=/[，、]$/;return t.match(e)!==null}endsWithPeriod(t){let e=/[。？！：；”」》）】)\]♪]$/;return t.match(e)!==null}endsWithSymbol(t){return this.endsWithComma(t)||this.endsWithPeriod(t)}segment(t){return Ut.segment(t)}oneline(t){return Ut.oneline(t)}pretty(t){return Ut.pretty(t)}},$o=class{getWidth(t){return t.split(/\s/).length}startsWithComma(t){let e=/^[,]/;return t.match(e)!==null}startsWithPeroid(t){let e=/^[.?!:;"')\]”…]/;return t.match(e)!==null}startsWithSymbol(t){return this.startsWithComma(t)||this.startsWithPeroid(t)}endsWithComma(t){let e=/[,]$/;return t.match(e)!==null}endsWithPeriod(t){let e=/[.?!:;"')\]”…♪]$/;return t.match(e)!==null}endsWithSymbol(t){return this.endsWithComma(t)||this.endsWithPeriod(t)}segment(t){return[t]}oneline(t){return t.replace(/ ?\n/g," ")}pretty(t){return t}},Wo={chinese:new Ao,english:new $o},yt=r=>(r=r.toLowerCase().replace("_","-").trim(),r.match(/^zh\b/)||r.match(/^ja\b/)?Wo.chinese:Wo.english)});var zo=a(()=>{di()});var Fo,qo,gi,hi,yi=a(()=>{Fo=class{removeInlineSource(t){return t.replace(/(\p{Unified_Ideograph})（[A-Za-z ]+）/gu,"$1")}replaceFullWidth(t){let e=/[\uff01-\uff5e]/g;return t.replace(e,n=>n.match(/[，？！：；（）]/)?n:String.fromCharCode(n.charCodeAt(0)-65248))}replacePunctuation(t){return t=t.replace(/\.\.\.+/g,"\u2026\u2026"),t}replaceCustomText(t){return t=t.replace(/您/g,"\u4F60"),t}afterTranslate(t){return t=this.removeInlineSource(t),t=this.replaceFullWidth(t),t=this.replacePunctuation(t),t=this.replaceCustomText(t),t}},qo=class{afterTranslate(t){return t}},gi={chinese:new Fo,english:new qo},hi=r=>(r=r.toLowerCase().replace("_","-").trim(),r.match(/^zh\b/)?gi.chinese:gi.english)});var nh,Uo,Ht,Ho=a(()=>{zo();yi();nh=r=>r.split(`
`).map(t=>t.trim()).filter(t=>t!=="").join(`
`),Uo=(r,t)=>{let e=yt(t.languageCode),n=hi(t.languageCode);return r.map(o=>(t.afterTranslate&&(o=n.afterTranslate(o)),o=nh(o),o=e.oneline(o),o=e.pretty(o),o))},Ht=(r,t)=>{let e=Uo(r.contents,t);r=r.clone();for(let[n,o]of r.dialogues.entries())o.content=e[n];return r.dialogues=r.dialogues.filter(n=>n.content.trim()!==""),r}});var Vo,rh,oh,sh,bi,_o=a(()=>{"use strict";O();Lo();Ho();Vo=r=>{let t=new Map;for(let n of r.dialogues){let o=`${n.start}:${n.end}`;t.set(o,n)}let e=Array.from(t.values());return new T(e)},rh=r=>{let t=Oo(r),e=[];for(let n of t)e.push(new R(n.start,n.duration,n.content));return new T(e)},oh=async r=>{let t=await(await fetch(r)).text();if(t.includes("tOffsetMs"))return rh(t);let e=dt(t);return Vo(e)},sh=async r=>{let t=new URL(r),e=t.searchParams.get("lang")??"",n=t.searchParams.get("tlang")??"",o=n!=="",s=o?n:e,i=await oh(r);return i=mt(i),i=Ht(i,{languageCode:s,afterTranslate:o}),i},bi=async r=>{let t=await Promise.all(r.map(sh)),e=ft(t);return No(e)}});var Y,xi,P,$=a(()=>{"use strict";Y={getJSON:r=>{let t=localStorage.getItem(r);if(t===null)return;let e;try{e=JSON.parse(t)}catch{e=void 0}return e},setJSON:(r,t)=>{t=JSON.stringify(t),localStorage.setItem(r,t)}},xi=r=>{let t=new Blob([r],{type:"plain/text"});return window.URL.createObjectURL(t)},P=r=>{let t=new URL(r),e=t.pathname.split("/");e[e.length-1]="";let n=e.join("/");return`${t.origin}${n}`}});var Go,ih,ah,Si,wi,bt,vi=a(()=>{"use strict";Io();ko();pt();_o();$();Go="dualsub-simple",ih=(r,t)=>JSON.stringify(r)===JSON.stringify(t),ah=(r,t)=>{let e={};for(let n of r){let o=n[t];e[o]=n}return e},Si=(r,t)=>{let n=r.general.dropdown.showOnlyLanguages.toLowerCase().split(",").map(s=>s.trim()).filter(s=>s!=="").map(s=>new RegExp(`^${s}\\b`));if(n.length===0)return[...t];let o=t.filter(s=>n.some(i=>s.value.match(i)));return o.length===0?[...t]:o},wi=async r=>{let t="";r.length>0&&(t=await bi(r)),window.postMessage({name:"subtitle",args:t},location.origin)},bt=class{setting;autoSelect;manifests;stage;constructor(t){this.setting=t,this.autoSelect=new nt(t,"simple"),this.manifests=new Map,this.stage=null}getStageManifest(){if(!this.stage)return null;let t=this.manifests.get(this.stage.movieId);return t||null}executeCallback(t){G.website==="youtube"&&this.executeCallbackYouTube(t)}executeCallbackYouTube(t){let e=this.getStageManifest();if(!e){wi([]);return}let n=ah(e.items,"code"),o=[];for(let s of t)if(s.file!==""){let i=new URL(n[s.file].url);i.searchParams.set("tlang",s.translate),o.push(i.toString())}wi(o)}getMenuItemsFile(){let t=this.getStageManifest();if(!t)return[];let e=[];for(let n of t.items)e.push({label:n.name,value:n.code,title:n.code});return e.sort((n,o)=>n.value>o.value?1:-1),e=Si(this.setting,e),e}getMenuItemsTranslate(){let t=this.getStageManifest();if(!t)return[];let e=[];for(let o of t.translations??[])e.push({label:o.name,value:o.code,title:o.code});if(this.setting.language.translation.languageList==="popular"){let o=Pt({engine:"google",filter:"popular",attach:[navigator.language]});e=e.filter(s=>o.includes(s.value))}return e.sort((o,s)=>o.value>s.value?1:-1),e=Si(this.setting,e),e}getMenuItemsLegend(){let t=this.setting.style.themes,e=[];for(let n of t)e.push({label:n.name,value:n.name,title:n.name});return e}getSchema=()=>{let t=this.getMenuItemsFile(),e=this.getMenuItemsTranslate(),n=this.getMenuItemsLegend();return{files:t,translates:e,legends:n}};getDefaultValue(t){let e=Y.getJSON(Go)??[];return this.autoSelect.get(t,e)}load(){let t=this.getSchema(),e=this.getDefaultValue(t);return{schema:t,value:e}}save(t){ih(Y.getJSON(Go),t)||(Y.setJSON(Go,t),this.executeCallback(t))}update(){let t=this.getSchema(),e=this.getDefaultValue(t);this.executeCallback(e)}updateSetting(t){this.setting=t,this.autoSelect.updateSetting(t)}updateStage(t){this.stage=t,this.update()}appendManifest(t){this.manifests.set(t.movieId,t),this.update()}}});var Vt,Jo,ch,lh,uh,ph,y,N=a(()=>{Vt=r=>r.replaceAll("\uFF08","(").replaceAll("\uFF09",")").replaceAll(/ *\(/g," (").trim(),Jo=r=>r.toLowerCase().replaceAll("_","-").trim(),ch=new URL(location.href).searchParams.get("hl"),lh=[ch??navigator.language,"en"],uh={type:"language",languageDisplay:"standard"},ph=new Intl.DisplayNames(lh,uh),y=r=>{r=Jo(r);let t=ph.of(r)??r;return Vt(t)}});var xt,Mi=a(()=>{"use strict";N();$();xt=class{setting;constructor(t){this.setting=t}updateSetting(t){this.setting=t}getManifestItems(){let t=`${location.origin}/`,e=this.setting.file.items,n=[];for(let o=0;o<e.length;o++){let s=e[o];if(!s.urls.includes(t))continue;let i=y(s.lang),c=xi(s.code),l=`${i} [${s.name}]`,u=`${s.lang}.file${o+1}`,p=`custom://file?text=${c}`;n.push({name:l,code:u,url:p})}return n}}});var Bo,mh,fh,Ii,St,ki=a(()=>{"use strict";Io();N();ko();Mi();$();Bo="dualsub-standard",mh=(r,t)=>JSON.stringify(r)===JSON.stringify(t),fh=(r,t)=>{let e={};for(let n of r){let o=n[t];e[o]=n}return e},Ii=(r,t)=>{let n=r.general.dropdown.showOnlyLanguages.toLowerCase().split(",").map(s=>s.trim()).filter(s=>s!=="").map(s=>new RegExp(`^${s}\\b`));if(n.length===0)return[...t];let o=t.filter(s=>n.some(i=>s.value.match(i)));return o.length===0?[...t]:o},St=class{setting;callback;autoSelect;fileManager;manifests;stage;constructor(t,e){this.setting=t,this.callback=e,this.autoSelect=new nt(t,"standard"),this.fileManager=new xt(t),this.manifests=new Map,this.stage=null}getStageManifest(){if(!this.stage)return null;let t=this.manifests.get(this.stage.movieId);return t||null}executeCallback(t){let e=this.createIntents(t);this.callback(e)}createIntents(t){let e=this.getStageManifest();if(!e)return[];let n=fh(e.items,"code"),o=[];for(let s of t)if(s.file!==""){let i=n[s.file].url;o.push({url:i,...s})}return o}getMenuItemsFile(){let t=this.getStageManifest();if(!t)return[];let e=[];for(let n of t.items)e.push({label:n.name,value:n.code,title:n.code});return e.sort((n,o)=>n.value>o.value?1:-1),e=Ii(this.setting,e),e}getMenuItemsTranslate(){let t=this.setting.language.translation,e=Pt({engine:t.translationEngine,filter:t.languageList,attach:[navigator.language]}),n=[];for(let o of e)n.push({label:y(o),value:o,title:o});return n.sort((o,s)=>o.value>s.value?1:-1),n=Ii(this.setting,n),n}getMenuItemsLegend(){let t=this.setting.style.themes,e=[];for(let n of t)e.push({label:n.name,value:n.name,title:n.name});return e}getSchema=()=>{let t=this.getMenuItemsFile(),e=this.getMenuItemsTranslate(),n=this.getMenuItemsLegend();return{files:t,translates:e,legends:n}};getDefaultValue(t){let e=Y.getJSON(Bo)??[];return this.autoSelect.get(t,e)}load(){let t=this.getSchema(),e=this.getDefaultValue(t);return{schema:t,value:e}}save(t){mh(Y.getJSON(Bo),t)||(Y.setJSON(Bo,t),this.executeCallback(t))}update(){let t=this.getSchema(),e=this.getDefaultValue(t);this.executeCallback(e)}updateSetting(t){this.setting=t,this.autoSelect.updateSetting(t),this.fileManager.updateSetting(t)}updateStage(t){this.stage=t,this.update()}appendManifest(t){let e=t.movieId,n=Array.from(t.items);n.push(...this.fileManager.getManifestItems()),t={movieId:e,items:n},this.manifests.set(t.movieId,t),this.update()}}});var wt,ji=a(()=>{"use strict";vi();ki();pt();wt=class{setting;props;simple;standard;constructor(t,e){this.setting=t,this.props=e,this.simple=new bt(t),this.standard=new St(t,e.onChange)}loadSimple(){if(G.website!=="youtube")throw"unsupported website";let t=this.simple.load(),e={menus:t.schema},n={menus:t.value};return{schema:e,value:n}}saveSimple(t){let e=t.value;this.simple.save(e.menus)}loadStandard(){let t=this.standard.load(),e={menus:t.schema},n={menus:t.value};return{schema:e,value:n}}saveStandard(t){let e=t.value;this.standard.save(e.menus)}updateSetting(t){this.setting=t,this.simple.updateSetting(t),this.standard.updateSetting(t)}updateStage(t){this.simple.updateStage(t),this.standard.updateStage(t)}appendManifest(t){this.simple.appendManifest(t),this.standard.appendManifest(t)}}});var vt,Ti=a(()=>{"use strict";vt=class{setting;constructor(t){this.setting=t,this.execute()}updateSetting(t){this.setting=t}execute(){let t=`${location.origin}/`,e=this.setting.plugin.items;for(let n of e){if(!n.urls.includes(t))continue;let o=document.createElement(n.type);o.textContent=n.code,document.head.appendChild(o)}}}});var h,b=a(()=>{"use strict";Ts();Rs();ji();Ti();h=async r=>{let{Fetcher:t,Injecter:e,Renderer:n,Watcher:o}=r,s=await js.loadSetting(),i=new vt(s),c=new t(s),l=new n(s,{fetcher:c}),u=new wt(s,{onChange:j=>{l.updateIntents(j)}}),p=new o(s,{onChange:j=>{u.updateStage(j),l.updateStage(j)}}),I=new e(s,{onChange:j=>{u.appendManifest(j)}}),k={loadSimple:async(j,D)=>u.loadSimple(),saveSimple:async(j,D)=>{u.saveSimple(D)},loadStandard:async(j,D)=>u.loadStandard(),saveStandard:async(j,D)=>{u.saveStandard(D)}},C=j=>{i.updateSetting(j),c.updateSetting(j),l.updateSetting(j),u.updateSetting(j),p.updateSetting(j),I.updateSetting(j)};window.addEventListener("message",I.onMessage),chrome.storage.onChanged.addListener((j,D)=>{j.setting&&C(j.setting.newValue)}),chrome.runtime.onMessage.addListener((j,D,A)=>(Cs(k,j,D,A),!0))}});var dh,_t,Ci=a(()=>{dh=()=>{let r={};return r.promise=new Promise((t,e)=>{r.resolve=t,r.reject=e}),r},_t=class{constructor(){this.deferreds=[]}acquire(){let e=this.deferreds[this.deferreds.length-1]?.promise??Promise.resolve();return this.deferreds.push(dh()),e}release(){let t=this.deferreds.shift();return t&&t.resolve(),Promise.resolve()}async apply(t,e,n){await this.acquire();let o;try{o=await Reflect.apply(t,e,n??[])}finally{await this.release()}return o}wrap(t,e){return async(...n)=>await this.apply(t,e,n)}}});var m,x=a(()=>{"use strict";Ci();O();m=class{setting;cache;lock;constructor(t){this.setting=t,this.cache=new Map,this.lock=new _t}updateSetting(t){this.setting=t}async parse(t,e){return q(e)}async fetch(t,e){return await(await fetch(e)).text()}async createSubtitleUrls(t){return[t.url]}async createSubtitle(t){let e=await this.createSubtitleUrls(t),n=[];for(let o of e){let s=await this.fetch(t,o),i=await this.parse(t,s);n.push(...i.dialogues)}return new T(n)}async loadAtomic(t){let e=t.url,n=this.cache.get(e);return n||(n=await this.createSubtitle(t),this.cache.set(e,n)),n.clone()}async load(t){return await this.lock.apply(this.loadAtomic,this,[t])}}});var gh,Gt,Ri=a(()=>{"use strict";O();Lo();_o();x();gh=r=>{let t=Eo(r),e=[];for(let n of t)e.push(new R(n.start,n.duration,n.content));return new T(e)},Gt=class extends m{async parse(r,t){if(t.includes("tOffsetMs"))return gh(t);let e=dt(t);return Vo(e)}}});var f,S=a(()=>{"use strict";N();f=class{setting;props;constructor(t,e){this.setting=t,this.props=e,this.inject()}updateSetting(t){this.setting=t}inject(){let t=this.getScript(),e=document.createElement("script");e.textContent=`(${t})();`,document.head.appendChild(e),e.remove()}onMessage=t=>{if(t.source!==window)return;let{name:e,args:n}=t.data;e==="manifest"&&this.onManifest(n)};async onManifest(t){let e=await this.createManifest(t);if(e!==null){for(let n of e.items)n.name=Vt(n.name),n.code=Jo(n.code);for(let n of e.translations??[])n.name=Vt(n.name);this.props.onChange(e)}}getScript(){throw"not implemented"}async createManifest(t){throw"not implemented"}}});var Ni,Pi=a(()=>{"use strict";Ni=function(){let r=new class{text;constructor(){this.text=""}toggle(){let o=document.querySelector(".html5-video-player");o.getOption("captions","track")?.languageCode!==void 0&&o.setOption("captions","reload",{})}refresh(){let o="dualsub-simple";this.text===""?document.body.classList.remove(o):document.body.classList.add(o)}save(o){this.text=o,this.toggle(),this.refresh()}match(o){return o.includes("/api/timedtext")&&this.text!==""}};window.addEventListener("message",function(o){if(o.source!==window)return;let{name:s,args:i}=o.data;s==="subtitle"&&r.save(i)});let t=window.XMLHttpRequest;window.XMLHttpRequest=class extends t{get responseText(){return r.match(this.responseURL)?r.text:super.responseText}};let e=async o=>{if(o?.playerResponse?.videoDetails&&(o=o.playerResponse),!o?.videoDetails)return;let s={name:"manifest",args:o};window.postMessage(s,location.origin)},n=JSON.parse;JSON.parse=o=>{let s=n(o);return e(s),s},setTimeout(()=>{let o=window.ytInitialPlayerResponse;o&&e(o)},1e3)}.toString()});var hh,Oi,Di,Ei=a(()=>{"use strict";hh=r=>{let t={};for(let e of r){let n=t[e.code]??0;n===0?t[e.code]=1:(t[e.code]=n+1,e.code=`${e.code}.var${n}`)}},Oi=r=>r.simpleText?r.simpleText:r.runs?r.runs[0].text:"undefined",Di=async r=>{let t=r.videoDetails,e=r.captions?.playerCaptionsTracklistRenderer,n=e?.captionTracks??[],o=e?.translationLanguages??[],s=t.videoId,i=[];for(let l of n){let u=Oi(l.name),p=l.languageCode.toLowerCase();l.kind==="asr"&&(p=`${p}.asr`);let I=new URL(l.baseUrl,location.origin);I.searchParams.set("fmt","json3"),I.searchParams.set("tlang","");let k=I.toString();i.push({name:u,code:p,url:k})}hh(i);let c=[];for(let l of o){let u=Oi(l.languageName),p=l.languageCode.toLowerCase();c.push({name:u,code:p})}return{movieId:s,items:i,translations:c}}});var Jt,Li=a(()=>{"use strict";S();Pi();Ei();Jt=class extends f{getScript(){return Ni}async createManifest(r){return await Di(r)}}});var E,Xo=a(()=>{E=window.React});var Wi,Ai=a(()=>{Wi=window.ReactDOM});var yh,$i,bh,xh,Sh,wh,Ko,vh,Mh,zi,Fi,Ih,kh,B,Bt=a(()=>{yh=crypto.getRandomValues(new Uint32Array(1))[0].toString(36),$i=0,bh=r=>($i+=1,`jss-${yh}-${$i}-${r}`),xh=(r,t)=>{for(let e of["","-webkit-","-moz-"]){let n=`${e}${r}`;if(CSS.supports(n,t))return[n,t]}return[r,t]},Sh=(r,t)=>{for(let e of["","-webkit-","-moz-"]){let n=`${e}${t}`;if(CSS.supports(r,n))return[r,n]}return[r,t]},wh=(r,t)=>r==="appearance"||r==="text-stroke"||r==="user-select"?xh(r,t):t==="fit-content"?Sh(r,t):[r,t],Ko=class{constructor(t){this.style=t,this.entries=[];for(let[e,n]of Object.entries(this.style))this.entries.push(this.createEntry(e,n));this.classes={};for(let e of this.entries)e.className!==""&&(this.classes[e.styleKey]=e.className);this.text=this.entries.map(e=>e.styleText).join(`
`),this.node=document.createElement("style"),this.node.textContent=this.text}createEntry(t,e){let n,o;t==="@global"?(n="",o=""):(n=bh(t),o=`.${n}`);let s=[];this.createRuleItem(o,e,s);let i=[];for(let[l,u]of s)Object.keys(u).length>0&&i.push(this.createRuleText(l,u));let c=i.join(`
`);return{styleKey:t,styleValue:e,styleText:c,className:n}}createRuleItem(t,e,n){let o=t,s={};n.push([o,s]);for(let[i,c]of Object.entries(e))if(typeof c=="object"&&!Array.isArray(c)){let l=i.replace(/&/g,o);this.createRuleItem(l,c,n)}else s[i]=c}createRuleText(t,e){let n=[`${t} {`];for(let[o,s]of Object.entries(e))o=o.replace(/[A-Z]/g,i=>`-${i.toLowerCase()}`),Array.isArray(s)&&(s=s.join(", ")),[o,s]=wh(o,String(s)),n.push(`    ${o}: ${s};`);return n.push("}"),n.join(`
`)}attach(){return this.node.isConnected||document.head.appendChild(this.node),this}remove(){this.node.isConnected&&this.node.remove()}toString(){return this.text}},vh=r=>new Ko(r),Mh=r=>{r.remove()},zi=CSS.supports("-moz-appearance","none"),Fi=CSS.supports("-webkit-appearance","-apple-pay-button"),Ih=navigator.standalone!==void 0,kh=(r,t)=>zi||Fi?{textStroke:r,paintOrder:"stroke"}:{position:"relative",zIndex:0,"&:before":{position:"absolute",left:"0",right:"0",zIndex:-1,content:`attr(${t})`,textStroke:r}},B={createStyleSheet:vh,removeStyleSheet:Mh,createTextStroke:kh,platform:{firefox:zi,safari:Fi,ios:Ih}}});var jh,Mt,qi=a(()=>{Xo();Bt();({classes:jh}=B.createStyleSheet({root:{"& .dialogue":{display:"flex",alignItems:"baseline",flexWrap:"wrap","& .readings":{display:"flex",flexDirection:"column",fontSize:"50%",lineHeight:"1.5",textAlign:"center"},"& .reading":{display:"none"},"& .text":{whiteSpace:"pre-wrap"},"& .contents":{display:"flex",justifyContent:"center",lineHeight:"1",textAlign:"center"},"& .content":{display:"flex",flexDirection:"column-reverse"},"& .dividers":{display:"none",backgroundColor:"#fff",height:"2px",margin:"2px"},"& .grammars":{display:"flex",justifyContent:"center",gap:"0.5em",fontSize:"50%",lineHeight:"1.5"},"& .grammar":{display:"none"}}}}).attach()),Mt=class extends E.PureComponent{constructor(){super(...arguments);this.renderContent=(e,n)=>{let o=[];for(let c of Object.keys(e))if(c!=="text"){let l=`reading ${c}`,u=e[c],p=u;o.push(E.createElement("span",{className:l,key:c,"data-value":u,"data-text":p},p))}let s=e.text,i=s;return E.createElement("span",{className:"content",key:n},E.createElement("span",{className:"text","data-value":s,"data-text":i},i),E.createElement("span",{className:"readings"},o))};this.renderDivider=()=>E.createElement("div",null);this.renderGrammar=(e,n)=>{let o=`grammar ${e.type}`,s=e.text,i=e.translation??s;return E.createElement("div",{className:o,key:n,"data-value":s,"data-text":i},i)};this.renderChild=(e,n)=>{let o=["token",e.classes].join(" ").trim();return E.createElement("div",{className:o,key:n},E.createElement("div",{className:"contents"},e.contents.map(this.renderContent)),E.createElement("div",{className:"dividers"},this.renderDivider()),E.createElement("div",{className:"grammars"},e.grammars.map(this.renderGrammar)))};this.renderChildren=()=>this.props.schema.items.map(this.renderChild)}render(){let e=this.props.className;e=[jh.root,e].join(" ").trim();let n=this.props.lang;return E.createElement("div",{className:e,lang:n},E.createElement("div",{className:"dialogue"},this.renderChildren()))}}});var K,Z,Th,Ch,es,Rh,Hi,Yo,Zo,Ui,Nh,Vi,Ph,zw,Fw,qw,X,Oh,_i,Xt,Qo,ts,Gi,Ji,Bi,Dh,Kt,ns=a(()=>{K=[["\u3042","\u30A2","a"],["\u3044","\u30A4","i"],["\u3046","\u30A6","u"],["\u3048","\u30A8","e"],["\u304A","\u30AA","o"],["\u304B","\u30AB","ka"],["\u304D","\u30AD","ki"],["\u304F","\u30AF","ku"],["\u3051","\u30B1","ke"],["\u3053","\u30B3","ko"],["\u3055","\u30B5","sa"],["\u3057","\u30B7","shi"],["\u3059","\u30B9","su"],["\u305B","\u30BB","se"],["\u305D","\u30BD","so"],["\u305F","\u30BF","ta"],["\u3061","\u30C1","chi"],["\u3064","\u30C4","tsu"],["\u3066","\u30C6","te"],["\u3068","\u30C8","to"],["\u306A","\u30CA","na"],["\u306B","\u30CB","ni"],["\u306C","\u30CC","nu"],["\u306D","\u30CD","ne"],["\u306E","\u30CE","no"],["\u306F","\u30CF","ha"],["\u3072","\u30D2","hi"],["\u3075","\u30D5","fu"],["\u3078","\u30D8","he"],["\u307B","\u30DB","ho"],["\u307E","\u30DE","ma"],["\u307F","\u30DF","mi"],["\u3080","\u30E0","mu"],["\u3081","\u30E1","me"],["\u3082","\u30E2","mo"],["\u3084","\u30E4","ya"],["\u3086","\u30E6","yu"],["\u3088","\u30E8","yo"],["\u3089","\u30E9","ra"],["\u308A","\u30EA","ri"],["\u308B","\u30EB","ru"],["\u308C","\u30EC","re"],["\u308D","\u30ED","ro"],["\u308F","\u30EF","wa"],["\u3092","\u30F2","wo"],["\u3093","\u30F3","n"]],Z=[["\u304C","\u30AC","ga"],["\u304E","\u30AE","gi"],["\u3050","\u30B0","gu"],["\u3052","\u30B2","ge"],["\u3054","\u30B4","go"],["\u3056","\u30B6","za"],["\u3058","\u30B8","ji"],["\u305A","\u30BA","zu"],["\u305C","\u30BC","ze"],["\u305E","\u30BE","zo"],["\u3060","\u30C0","da"],["\u3062","\u30C2","ji"],["\u3065","\u30C5","zu"],["\u3067","\u30C7","de"],["\u3069","\u30C9","do"],["\u3070","\u30D0","ba"],["\u3073","\u30D3","bi"],["\u3076","\u30D6","bu"],["\u3079","\u30D9","be"],["\u307C","\u30DC","bo"],["\u3071","\u30D1","pa"],["\u3074","\u30D4","pi"],["\u3077","\u30D7","pu"],["\u307A","\u30DA","pe"],["\u307D","\u30DD","po"]],Th=[["\u304D\u3083","\u30AD\u30E3","kya"],["\u304D\u3085","\u30AD\u30E5","kyu"],["\u304D\u3087","\u30AD\u30E7","kyo"],["\u3057\u3083","\u30B7\u30E3","sha"],["\u3057\u3085","\u30B7\u30E5","shu"],["\u3057\u3087","\u30B7\u30E7","sho"],["\u3061\u3083","\u30C1\u30E3","cha"],["\u3061\u3085","\u30C1\u30E5","chu"],["\u3061\u3087","\u30C1\u30E7","cho"],["\u306B\u3083","\u30CB\u30E3","nya"],["\u306B\u3085","\u30CB\u30E5","nyu"],["\u306B\u3087","\u30CB\u30E7","nyo"],["\u3072\u3083","\u30D2\u30E3","hya"],["\u3072\u3085","\u30D2\u30E5","hyu"],["\u3072\u3087","\u30D2\u30E7","hyo"],["\u307F\u3083","\u30DF\u30E3","mya"],["\u307F\u3085","\u30DF\u30E5","myu"],["\u307F\u3087","\u30DF\u30E7","myo"],["\u308A\u3083","\u30EA\u30E3","rya"],["\u308A\u3085","\u30EA\u30E5","ryu"],["\u308A\u3087","\u30EA\u30E7","ryo"],["\u304E\u3083","\u30AE\u30E3","gya"],["\u304E\u3085","\u30AE\u30E5","gyu"],["\u304E\u3087","\u30AE\u30E7","gyo"],["\u3058\u3083","\u30B8\u30E3","ja"],["\u3058\u3085","\u30B8\u30E5","ju"],["\u3058\u3087","\u30B8\u30E7","jo"],["\u3073\u3083","\u30D3\u30E3","bya"],["\u3073\u3085","\u30D3\u30E5","byu"],["\u3073\u3087","\u30D3\u30E7","byo"],["\u3074\u3083","\u30D4\u30E3","pya"],["\u3074\u3085","\u30D4\u30E5","pyu"],["\u3074\u3087","\u30D4\u30E7","pyo"]],Ch=[["\u3064\u3041","\u30C4\u30A1","tsa"],["\u3075\u3041","\u30D5\u30A1","fa"],["\u3046\u3043","\u30A6\u30A3","wi"],["\u3066\u3043","\u30C6\u30A3","ti"],["\u3075\u3043","\u30D5\u30A3","fi"],["\u3067\u3043","\u30C7\u30A3","di"],["\u3068\u3045","\u30C8\u30A5","tu"],["\u3069\u3045","\u30C9\u30A5","du"],["\u3067\u3085","\u30C7\u30E5","dyu"],["\u3046\u3047","\u30A6\u30A7","we"],["\u3057\u3047","\u30B7\u30A7","she"],["\u3061\u3047","\u30C1\u30A7","che"],["\u3064\u3047","\u30C4\u30A7","tse"],["\u3075\u3047","\u30D5\u30A7","fe"],["\u3058\u3047","\u30B8\u30A7","je"],["\u3046\u3049","\u30A6\u30A9","wo"],["\u3064\u3049","\u30C4\u30A9","tso"],["\u3075\u3049","\u30D5\u30A9","fo"]],es=[["\u3041","\u30A1","a"],["\u3043","\u30A3","i"],["\u3045","\u30A5","u"],["\u3047","\u30A7","e"],["\u3049","\u30A9","o"],["\u3083","\u30E3","ya"],["\u3085","\u30E5","yu"],["\u3087","\u30E7","yo"],["\u3063","\u30C3",'"']],Rh=["\uFF71","\uFF72","\uFF73","\uFF74","\uFF75","\uFF76","\uFF77","\uFF78","\uFF79","\uFF7A","\uFF7B","\uFF7C","\uFF7D","\uFF7E","\uFF7F","\uFF80","\uFF81","\uFF82","\uFF83","\uFF84","\uFF85","\uFF86","\uFF87","\uFF88","\uFF89","\uFF8A","\uFF8B","\uFF8C","\uFF8D","\uFF8E","\uFF8F","\uFF90","\uFF91","\uFF92","\uFF93","\uFF94","\uFF95","\uFF96","\uFF97","\uFF98","\uFF99","\uFF9A","\uFF9B","\uFF9C","\uFF66","\uFF9D","\uFF67","\uFF68","\uFF69","\uFF6A","\uFF6B","\uFF6C","\uFF6D","\uFF6E","\uFF6F","\uFF76\uFF9E","\uFF77\uFF9E","\uFF78\uFF9E","\uFF79\uFF9E","\uFF7A\uFF9E","\uFF7B\uFF9E","\uFF7C\uFF9E","\uFF7D\uFF9E","\uFF7E\uFF9E","\uFF7F\uFF9E","\uFF80\uFF9E","\uFF81\uFF9E","\uFF82\uFF9E","\uFF83\uFF9E","\uFF84\uFF9E","\uFF8A\uFF9E","\uFF8B\uFF9E","\uFF8C\uFF9E","\uFF8D\uFF9E","\uFF8E\uFF9E","\uFF8A\uFF9F","\uFF8B\uFF9F","\uFF8C\uFF9F","\uFF8D\uFF9F","\uFF8E\uFF9F"],Hi=(r,t)=>{let e=K.slice(0,5),n=[...K,...es,...Z,...Th,...Ch],o={};for(let s of n){let i=s[r],c=s[t];o[i]=c;for(let l of e)s[2].endsWith(l[2])&&(o[i+"\u30FC"]=c+l[t])}return o},Yo=Hi(1,0),Zo=Hi(1,2),Ui=(()=>{let r=[...K,...es,...Z],t={"\uFF61":"\u3002","\uFF62":"\u300C","\uFF63":"\u300D","\uFF64":"\u3001","\uFF65":"\u30FB",\uFF70:"\u30FC"};for(let[e,n]of r.entries()){let o=Rh[e];t[o]=n[1]}return t})(),Nh=(()=>{let r={};for(let[t,e]of K.slice(5,30).entries()){let n=Z[t],o=e[0]+"\uFF9E",s=e[1]+"\uFF9E";r[o]=n[0],r[s]=n[1]}for(let[t,e]of K.slice(25,30).entries()){let n=Z[t+20],o=e[0]+"\uFF9F",s=e[1]+"\uFF9F";r[o]=n[0],r[s]=n[1]}return r})(),Vi=(()=>{let r=[...K,...Z],t={};for(let e of r)t[e[1]]=e[2];return delete t.\u30F3,t})(),Ph=(()=>{let r={...Vi};for(let t of es)r[t[1]]=t[2];return r})(),zw=(()=>{let r=[...K,...Z],t={};for(let[e,n,o]of r){if(o==="n")continue;let s=o[o.length-1];t[e]=s,t[n]=s}return t})(),Fw=(()=>{let r=[...K,...Z],t={};for(let[e,n,o]of r){if(o==="n")continue;if(o==="chi"){t[e]="t",t[n]="t";continue}let s=o.length===1?"":o[0];t[e]=s,t[n]=s}return t})(),qw=(()=>{let r=[...K,...Z],t={};for(let[e,n,o]of r){if(o==="n")continue;let s;o==="chi"?(s="t",s="t"):s=o.length===1?"":o[0];let i=o[o.length-1],c=s+i;t[c]=[e,n,o]}return t})(),X=r=>/^[\u3040-\u309f\u30a0-\u30ff]+$/.test(r),Oh=r=>/[\u3040-\u309f\u30a0-\u30ff]/.test(r),_i=r=>/^[\x20-\x7e、，。]+$/.test(r),Xt=r=>{let t=/[\u3040-\u309f\u30a0-\u30ff]/g,e=0;return r.replace(t,(n,o)=>{if(e>0)return e-=1,"";let s=r[o+1],i=r[o+2],c=Yo[n+s+i];return c?(e=2,c):(c=Yo[n+s],c?(e=1,c):Yo[n]||n)})},Qo=(r,t)=>{if(r.slice(-1)!=="n")return t;let n=["a","i","u","e","o","ya","yu","yo"];for(let o of n)if(t.startsWith(o))return"'"+t;return t},ts=(r,t)=>r!=='"'?t:t.startsWith("ch")?"t"+t:t.slice(0,1)+t,Gi=r=>{let t=/[\u3040-\u309f\u30a0-\u30ff]/g,e=0,n=0,o="";return r.replace(t,(s,i)=>{if(e>0)return e-=1,"";let c=n+1===i,l=r[i+1]||"",u=r[i+2]||"",p=Zo[s+l+u];return p?(c&&(p=Qo(o,p),p=ts(o,p)),e=2,n=i+2,o=p,p):(p=Zo[s+l],p?(c&&(p=Qo(o,p),p=ts(o,p)),e=1,n=i+1,o=p,p):(p=Zo[s],p?(c&&(p=Qo(o,p),p=ts(o,p)),e=0,n=i,p==='"'?(o='"',""):(o=p,p)):(e=0,n=0,o="",s)))})},Ji=r=>r.replace(/aa/g,"\u0101").replace(/uu/g,"\u016B").replace(/oo/g,"\u014D").replace(/ou/g,"\u014D").replace(/ee/g,"ei"),Bi=r=>{let t=/[\u3040-\u309f\u30a0-\u30ff\uff61-\uff9f]/g,e=0;return r.replace(t,(n,o)=>{if(e>0)return e-=1,"";let s=r[o+1];if(s==="\uFF9E"||s==="\uFF9F"){let i=n+s,c=Ui[i];if(c||(c=Nh[i],c))return e=1,c}return e=0,Ui[n]||n})},Dh=(r,t)=>{let e=[],n=[],o=()=>{n.length>0&&e.push(n.splice(0,n.length).join(""))};for(let s=0;s<r.length;s++){let i=r[s];if(!t&&i==="\u30C3"){o(),n.push(i);continue}let c=Vi[i];if(!c){n.push(i);continue}if(n.length>0){let l=n[n.length-1];if(l==="\u30C3"){n.push(i);continue}let p=(Ph[l]||"")+c;if(p.endsWith("ai")||p.endsWith("ei")||p.endsWith("ou")||p.endsWith("oo")||p.endsWith("uu")){n.push(i);continue}}o(),n.push(i)}return o(),e},Kt=(r,t,e)=>{if(X(t))return[[r],[t]];if(!Oh(t)){let C=Dh(r,e);return C.length!==t.length?[[r],[t]]:[C,t.split("")]}let n,o;if(X(t[0])){for(n=0;n<t.length&&X(t[n]);)n+=1;o=n}else if(X(t[t.length-1])){for(n=t.length-1;n>=0&&X(t[n]);)n-=1;n=n+1-t.length,o=n}else{for(n=0;n<t.length&&!X(t[n]);)n+=1;let C=Xt(t[n]),j=Xt(r);for(o=0;o<r.length&&j[o]!==C;)o+=1}let s=r.slice(0,o),i=t.slice(0,n),c=r.slice(o),l=t.slice(n),[u,p]=Kt(s,i,e),[I,k]=Kt(c,l,e);return[[...u,...I],[...p,...k]]}});var Eh,Lh,Wh,Ah,Xi,Ki=a(()=>{ns();Eh=(()=>{let r={"!":"\uFF01","?":"\uFF1F"},t=Object.keys(r).join(),e=new RegExp(`[${t}]`,"g"),n=o=>r[o]??o;return o=>o.replace(e,n)})(),Lh=(()=>{let r=/[\uff01-\uff5e]/g,t=e=>String.fromCharCode(e.charCodeAt(0)-65248);return e=>e.replace(r,t)})(),Wh=r=>r.replace(/[ \u3000]+/g," ").replace(/([，。！？])\s+/g,"$1"),Ah=r=>(r=Bi(r),r=Lh(r),r=Eh(r),r=Wh(r),r),Xi=Ah});var $h,zh,Yi,Zi=a(()=>{zo();$h=r=>{let t=[],e=[],n=0,o=0,s=r.split(" ");for(;s.length>0;)if(n<=o){let i=s.shift();t.push(i),n+=i.length}else{let i=s.pop();e.unshift(i),o+=i.length}return t.push(""),[t.join(" "),e.join(" ")]},zh=(r,t)=>{let n=yt(t).segment(r);return n.length>1?n:r.length<=48?[r]:$h(r)},Yi=(r,t)=>zh(r,t).map(n=>({classes:"",contents:[{text:n}],grammars:[]}))});var Qi,ta=a(()=>{Qi=r=>r.map(t=>({classes:"",contents:[{text:t[0],pinyin:` ${t[1]} `}],grammars:[]}))});var Yt,rs=a(()=>{Yt={"zh-hans":{BeiDongXingShi:"\u88AB\u52A8\u5F62\u5F0F",Dai:"\u4EE3",DongEr:"\u52A8\u4E8C",DongSan:"\u52A8\u4E09",DongYi:"\u52A8\u4E00",FouDing:"\u5426\u5B9A",Fu:"\u526F",FuCiHua:"\u526F\u8BCD\u5316",GanTan:"\u611F\u53F9",GuoQu:"\u8FC7\u53BB",JiBenXing:"\u57FA\u672C\u5F62",JiaDing:"\u5047\u5B9A",JiaDingXing:"\u5047\u5B9A\u5F62",JianTi:"\u7B80\u4F53",JianYi:"\u5EFA\u8BAE",JieTou:"\u63A5\u5934",JieWei:"\u63A5\u5C3E",JieXu:"\u63A5\u7EED",JingTi:"\u656C\u4F53",KeNengXingShi:"\u53EF\u80FD\u5F62\u5F0F",KenDing:"\u80AF\u5B9A",LianTi:"\u8FDE\u4F53",MaSuXing:"\u307E\u3059\u5F62",Ming:"\u540D",MingCiHua:"\u540D\u8BCD\u5316",MingLing:"\u547D\u4EE4",MingLingXing:"\u547D\u4EE4\u5F62",NaIXing:"\u306A\u3044\u5F62",Shi:"\u4E8B",ShiYiXingShi:"\u4F7F\u5F79\u5F62\u5F0F",Shu:"\u6570",TaDong:"\u4ED6\u52A8",TaXing:"\u305F\u5F62",TeXing:"\u3066\u5F62",Wai:"\u5916",Wu:"\u65E0",XianZai:"\u73B0\u5728",XingEr:"\u5F62\u4E8C",XingYi:"\u5F62\u4E00",YiZhi:"\u610F\u5FD7",YiZhiXing:"\u610F\u5FD7\u5F62",Zhu:"\u52A9",ZhuDong:"\u52A9\u52A8",Zhuan:"\u4E13",ZiDong:"\u81EA\u52A8",ZiTaDong:"\u81EA\u4ED6\u52A8"}}});var os,qh,ea,na=a(()=>{ns();rs();os=class{constructor(t,e=!0){this.doConvert=t=>t.noun?this.doNoun(t):t.verb?this.doVerb(t):t.adjective?this.doAdjective(t):t.numeral?this.doNumeral(t):t.pronoun?this.doPronoun(t):t.particle?this.doParticle(t):t.adverb?this.doAdverb(t):t.conjunction?this.doConjunction(t):t.continuation?this.doContinuation(t):t.prefixion?this.doPrefixion(t):t.suffixion?this.doSuffixion(t):t.interjection?this.doInterjection(t):t.auxiliary?this.doAuxiliary(t):this.doPlain(t);this.tokens=t,this.compact=e}getSpeakingText(t){let{text:e,speaking:n}=t;return n?e==="\u306F"&&t.particle?"\u30EF":e==="\u3078"&&t.particle?"\u30A8":e==="\u3092"&&t.particle?"\u30AA":n.text:""}createContent(t,e,n){return this.compact&&(X(t)||_i(t))?{loanword:n,text:t}:{hiragana:Xt(e),katakana:e,romaji:Ji(Gi(e)),loanword:n,text:t}}createContents(t){let{text:e,speaking:n,detail:o}=t;if(!n)return[{text:e}];let s=this.getSpeakingText(t);if(o&&o.loanword){let u=o.loanword;return[this.createContent(e,s,u)]}if(X(e))return[this.createContent(e,s)];let[i,c]=Kt(n.text,e),l=[];for(let u=0;u<c.length;u++){let p=this.createContent(c[u],i[u]);l.push(p)}return l}createGrammarsByDetail(t){let e=t.detail;if(!e)return[];let n=[],o=e.type;if(o&&o.startsWith("verb")){let s;o.endsWith("+")?s="\u81EA\u52A8":o.endsWith("-")?s="\u4ED6\u52A8":o.endsWith("*")?s="\u81EA\u4ED6\u52A8":s="",s!==""&&n.push({type:"sense",text:s})}return e.jlpt&&n.push({type:"jlpt",text:e.jlpt}),n}doNoun(t){let e=t.noun,n;e.type==="\u4E13\u6709\u540D\u8BCD"?n="\u4E13":e.type==="\u5F62\u5F0F\u540D\u8BCD"?n="\u4E8B":n="\u540D",t.detail&&t.detail.loanword&&(n="\u5916");let o=[];return o.push({type:"pos",text:n}),o.push(...this.createGrammarsByDetail(t)),{classes:"",contents:this.createContents(t),grammars:o}}doVerb(t){let e=t.verb;e.root&&(e={type:e.root.type,base:e.root.base,form:e.root.kind,tags:[...e.tags]});let n;e.type==="\u4E00\u7C7B\u52A8\u8BCD"?n="\u52A8\u4E00":e.type==="\u4E8C\u7C7B\u52A8\u8BCD"?n="\u52A8\u4E8C":e.type==="\u4E09\u7C7B\u52A8\u8BCD"?n="\u52A8\u4E09":n="\u52A8";let o=[];o.push({type:"pos",text:n}),o.push({type:"form",text:e.form});for(let s of e.tags)o.push({type:"tag",text:s});return o.push({type:"base",text:e.base}),o.push(...this.createGrammarsByDetail(t)),{classes:"",contents:this.createContents(t),grammars:o}}doAdjective(t){let e=t.adjective,n;e.type==="\u4E00\u7C7B\u5F62\u5BB9\u8BCD"?n="\u5F62\u4E00":e.type==="\u4E8C\u7C7B\u5F62\u5BB9\u8BCD"?n="\u5F62\u4E8C":n="\u5F62";let o=[];o.push({type:"pos",text:n});for(let s of e.tags)o.push({type:"tag",text:s});return o.push({type:"base",text:e.base}),o.push(...this.createGrammarsByDetail(t)),{classes:"",contents:this.createContents(t),grammars:o}}doNumeral(t){let e=[];return e.push({type:"pos",text:"\u6570"}),e.push(...this.createGrammarsByDetail(t)),{classes:"",contents:this.createContents(t),grammars:e}}doPronoun(t){let e=[];return e.push({type:"pos",text:"\u4EE3"}),e.push(...this.createGrammarsByDetail(t)),{classes:"",contents:this.createContents(t),grammars:e}}doParticle(t){let e=[];return e.push({type:"pos",text:"\u52A9"}),e.push(...this.createGrammarsByDetail(t)),{classes:"",contents:this.createContents(t),grammars:e}}doAdverb(t){let e=[];return e.push({type:"pos",text:"\u526F"}),e.push(...this.createGrammarsByDetail(t)),{classes:"",contents:this.createContents(t),grammars:e}}doConjunction(t){let e=[];return e.push({type:"pos",text:"\u8FDE\u4F53"}),e.push(...this.createGrammarsByDetail(t)),{classes:"",contents:this.createContents(t),grammars:e}}doContinuation(t){let e=[];return e.push({type:"pos",text:"\u63A5\u7EED"}),e.push(...this.createGrammarsByDetail(t)),{classes:"",contents:this.createContents(t),grammars:e}}doPrefixion(t){let e=[];return e.push({type:"pos",text:"\u63A5\u5934"}),e.push(...this.createGrammarsByDetail(t)),{classes:"",contents:this.createContents(t),grammars:e}}doSuffixion(t){let e=[];return e.push({type:"pos",text:"\u63A5\u5C3E"}),e.push(...this.createGrammarsByDetail(t)),{classes:"",contents:this.createContents(t),grammars:e}}doInterjection(t){let e=[];return e.push({type:"pos",text:"\u611F\u53F9"}),e.push(...this.createGrammarsByDetail(t)),{classes:"",contents:this.createContents(t),grammars:e}}doAuxiliary(t){let e=[];return e.push({type:"pos",text:"\u52A9\u52A8"}),e.push(...this.createGrammarsByDetail(t)),{classes:"",contents:this.createContents(t),grammars:e}}doPlain(t){let e=[];return e.push({type:"pos",text:"\u65E0"}),{classes:"",contents:this.createContents(t),grammars:e}}getOutput(){return this.tokens.map(this.doConvert)}},qh=new class{constructor(){this.items={};for(let[t,e]of Object.entries(Yt["zh-hans"]))this.items[e]=t}get(t,e){let n=this.items[t];return n?e[n]??t:t}update(t,e){let n=["pos","form","tag","sense"];for(let o of t)for(let s of o.grammars)n.includes(s.type)&&(s.translation=this.get(s.text,e))}},ea=(r,t,e)=>{let o=new os(r,t).getOutput();return qh.update(o,e),o}});var Zt,ra=a(()=>{Zi();ta();na();Zt={plain:Yi,zhtools:Qi,jatools:ea}});var ia,oa,sa,Uh,Hh,It,aa=a(()=>{O();ia=r=>{let t=0;for(let e of r)t+=e.content.length+1;return t},oa=(r,t)=>{let e=0;for(let[n,o]of r.entries())if(e+=o.content.length+1,e>=t)return n;return r.length-1},sa=(r,t)=>{let e=r.slice(0,t+1),n=r.slice(t+1);if(e.length===0)throw"invalid index";return[e,n]},Uh=(r,t,e)=>{if(ia(r)<e)return[Array.from(r),[]];let n=oa(r,t),o=oa(r,e);if(n===o)return sa(r,n);let s=[];for(let i=n;i<o;i++){let c=i,l=r[i],u=0;i<o&&(u=r[i+1].start-l.end);let p=l.end;s.push({index:c,interval:u,end:p})}return s.sort((i,c)=>i.interval!==c.interval?c.interval-i.interval:c.end-i.end),sa(r,s[0].index)},Hh=(r,t,e)=>{if(e===0)return[Array.from(r)];let n=[];for(;r.length>0;){let[o,s]=Uh(r,t,e);n.push(o),r=s}return n},It=class{constructor(t,e,n){this.minSize=t,this.maxSize=e,this.preload=n,this.subtitles=[],this.offsets=[]}parse(t){this.subtitles=[];for(let n of Hh(t.dialogues,this.minSize,this.maxSize))this.subtitles.push(new T(n));let e=0;this.offsets=[];for(let n=0;n<this.subtitles.length;n++)this.offsets.push(e),e+=ia(this.subtitles[n].dialogues)}get duration(){let t=this.subtitles;if(t.length===0)return 0;let n=t[t.length-1].dialogues;return n[n.length-1].end}getIndex(t){for(let[e,n]of this.subtitles.entries()){let o=n.dialogues,s=o[0],i=o[o.length-1];if(s.start>t)return-1;if(i.end>t)return e}return-1}getIndexes(t){let e=[],n=this.getIndex(t);n!==-1&&e.push(n);let o=this.getIndex(t+this.preload);return o!==-1&&o>n&&e.push(n+1),e}}});var kt,Vh,Qt,ca=a(()=>{"use strict";Mo();Dt();kt=async(r,t)=>{let o=0,s,i;for(;;){try{s=await ut.runtime.sendMessage({name:r,args:t})}catch(u){i=u.message}if(s!==void 0)break;if(o<1e3){o+=200,await Ot(200);continue}throw i??"invalid response message"}let{ok:c,data:l}=s;if(!c)throw l;return l},Vh={translate:async r=>await kt("translate",r),zhtools:async r=>await kt("zhtools",r),jatools:async r=>await kt("jatools",r),heat:async r=>await kt("heat",r),check:async r=>await kt("check",r)},Qt=Vh});var _h,Gh,te,la=a(()=>{_h=function(r){return r=r.toLowerCase().replace("_","-").trim(),r===""?"en":r==="zh-tw"||r==="zh-hk"||r==="zh-mo"||r==="zh-hant"?"zh-hant":r.match(/^zh\b/)?"zh-hans":r.split("-")[0]},Gh=r=>{let t={};for(let e of r)for(let[n,o]of Object.entries(e))t[n]||(t[n]={}),Object.assign(t[n],o);return t},te=class{constructor(t){this.dataset=Gh(t)}get(t){return t=_h(t),this.dataset[t]||(t="en"),this.dataset[t]}}});var pa,ua=a(()=>{pa={en:{BeiDongXingShi:"\u88AB\u52D5\u5F62\u5F0F",Dai:"\u4EE3",DongEr:"\u52D5\u4E8C",DongSan:"\u52D5\u4E09",DongYi:"\u52D5\u4E00",FouDing:"\u5426\u5B9A",Fu:"\u526F",FuCiHua:"\u526F\u8A5E\u5316",GanTan:"\u611F\u5606",GuoQu:"\u904E\u53BB",JiBenXing:"\u57FA\u672C\u5F62",JiaDing:"\u5047\u5B9A",JiaDingXing:"\u5047\u5B9A\u5F62",JianTi:"\u7C21\u9AD4",JianYi:"\u5EFA\u8B70",JieTou:"\u63A5\u982D",JieWei:"\u63A5\u5C3E",JieXu:"\u63A5\u7E8C",JingTi:"\u656C\u9AD4",KeNengXingShi:"\u53EF\u80FD\u5F62\u5F0F",KenDing:"\u80AF\u5B9A",LianTi:"\u9023\u9AD4",MaSuXing:"\u307E\u3059\u5F62",Ming:"\u540D",MingCiHua:"\u540D\u8A5E\u5316",MingLing:"\u547D\u4EE4",MingLingXing:"\u547D\u4EE4\u5F62",NaIXing:"\u306A\u3044\u5F62",Shi:"\u4E8B",ShiYiXingShi:"\u4F7F\u5F79\u5F62\u5F0F",Shu:"\u6578",TaDong:"\u4ED6\u52D5",TaXing:"\u305F\u5F62",TeXing:"\u3066\u5F62",Wai:"\u5916",Wu:"\u7121",XianZai:"\u73FE\u5728",XingEr:"\u5F62\u4E8C",XingYi:"\u5F62\u4E00",YiZhi:"\u610F\u5FD7",YiZhiXing:"\u610F\u5FD7\u5F62",Zhu:"\u52A9",ZhuDong:"\u52A9\u52D5",Zhuan:"\u5C08",ZiDong:"\u81EA\u52D5",ZiTaDong:"\u81EA\u4ED6\u52D5"}}});var fa,ma=a(()=>{fa={"zh-hant":{BeiDongXingShi:"\u88AB\u52D5\u5F62\u5F0F",Dai:"\u4EE3",DongEr:"\u52D5\u4E8C",DongSan:"\u52D5\u4E09",DongYi:"\u52D5\u4E00",FouDing:"\u5426\u5B9A",Fu:"\u526F",FuCiHua:"\u526F\u8A5E\u5316",GanTan:"\u611F\u5606",GuoQu:"\u904E\u53BB",JiBenXing:"\u57FA\u672C\u5F62",JiaDing:"\u5047\u5B9A",JiaDingXing:"\u5047\u5B9A\u5F62",JianTi:"\u7C21\u9AD4",JianYi:"\u5EFA\u8B70",JieTou:"\u63A5\u982D",JieWei:"\u63A5\u5C3E",JieXu:"\u63A5\u7E8C",JingTi:"\u656C\u9AD4",KeNengXingShi:"\u53EF\u80FD\u5F62\u5F0F",KenDing:"\u80AF\u5B9A",LianTi:"\u9023\u9AD4",MaSuXing:"\u307E\u3059\u5F62",Ming:"\u540D",MingCiHua:"\u540D\u8A5E\u5316",MingLing:"\u547D\u4EE4",MingLingXing:"\u547D\u4EE4\u5F62",NaIXing:"\u306A\u3044\u5F62",Shi:"\u4E8B",ShiYiXingShi:"\u4F7F\u5F79\u5F62\u5F0F",Shu:"\u6578",TaDong:"\u4ED6\u52D5",TaXing:"\u305F\u5F62",TeXing:"\u3066\u5F62",Wai:"\u5916",Wu:"\u7121",XianZai:"\u73FE\u5728",XingEr:"\u5F62\u4E8C",XingYi:"\u5F62\u4E00",YiZhi:"\u610F\u5FD7",YiZhiXing:"\u610F\u5FD7\u5F62",Zhu:"\u52A9",ZhuDong:"\u52A9\u52D5",Zhuan:"\u5C08",ZiDong:"\u81EA\u52D5",ZiTaDong:"\u81EA\u4ED6\u52D5"}}});var ga,da=a(()=>{ga={en:{LANG_CODE:"en",LANG_NAME:"English",LANG_LOCAL:"English"},"zh-hans":{LANG_CODE:"zh-hans",LANG_NAME:"Chinese (Simplified)",LANG_LOCAL:"\u4E2D\u6587 (\u7B80\u4F53)"},"zh-hant":{LANG_CODE:"zh-hant",LANG_NAME:"Chinese (Traditional)",LANG_LOCAL:"\u4E2D\u6587 (\u7E41\u9AD4)"}}});var ha,ya=a(()=>{la();ua();rs();ma();da();ha=new te([pa,Yt,fa,ga])});var Kh,ba,xa=a(()=>{"use strict";ya();pt();Kh=r=>({term:ha.get(r)}),ba=Kh(G.i18nCode)});var Yh,Zh,Qh,ty,Sa,wa,ey,ny,ry,oy,sy,iy,ay,cy,ly,uy,py,ss,jt,va=a(()=>{"use strict";O();Ho();Ki();ra();aa();ca();pt();xa();Yh=2900,Zh=3e3,Qh=3e4,ty={type:"plain",data:"",language:"en"},Sa={dialogues:[]},wa=r=>r.translated.data,ey=r=>{let t=r.start,e=r.end-r.start,n=wa(r);return new R(t,e,n)},ny=r=>{let t=r.dialogues.map(ey);return new T(t)},ry=(r,t)=>{let e=0;for(let[i,c]of r.dialogues.entries())if(e=i,c.end>=t)break;let n=e-2<0?0:e-2,o=e+3;return{dialogues:r.dialogues.slice(n,o)}},oy=(r,t)=>{r=r.map(c=>ry(c,t));let e=r.map(ny),o=ft(e).find(t);if(o===null)return[];let s=o.content.split(`
`),i=[];for(let[c,l]of s.entries()){let I=r[c].dialogues.find(k=>l===wa(k))?.finalized??ty;i.push(I)}return i},sy=r=>{let t=[];for(let e=0;e<r.length-1;e++){let n=r[e],o=r[e+1];t.push(o.start-n.end)}return t.push(0),t},iy=async r=>{let e=new URL(r.url).searchParams.get("text"),n=await(await fetch(e)).text(),o=[q,J,jo,W,To];for(let s of o){let i;try{i=s(n)}catch{continue}if(i.dialogues.length>0)return i}return new T([])},ay=(r,t)=>{if(r.legend==="")return"";let e=r.translate===""?r.file:r.translate,n="";for(let o of t.style.themes)if(o.name===r.legend){n=o.toolkit??"";break}return n==="zhtools"&&e.match(/^zh\b/)||n==="jatools"&&e.match(/^ja\b/)?n:""},cy=(r,t,e,n)=>{if(t==="plain")return Zt.plain(r,e);if(t==="zhtools")return Zt.zhtools(r);if(t==="jatools"){let{furiganaCharacter:o}=n.language.japanese,s=o==="kanji";return Zt.jatools(r,s,ba.term)}throw"invalid type"},ly=r=>r==="TypeError: Failed to fetch"?"https://www.dualsub.xyz/error/failed-to-fetch":r,uy=(r,t)=>r.match(/^zh\b/)?(r==="zh-cn"&&(r="zh-hans"),(r==="zh-tw"||r==="zh-hk"||r==="zh-mo")&&(r="zh-hant"),r===t):r.split("-")[0]===t,py=(r,t,e)=>r!=="auto"?r:t.match(/^zh\b/)||t.match(/^ko\b/)?"normal":"enhance",ss=class{setting;fetcher;intent;bioscope;mapping;constructor(t,e,n){this.setting=t,this.fetcher=e,this.intent=n,this.bioscope=new It(Yh,Zh,Qh),this.mapping=new Map,this.initial()}async initial(){let t=await this.doCreate();this.bioscope.parse(t),this.touch(0)}async touch(t){let e=this.bioscope.getIndexes(t);for(let n of e)this.mapping.has(n)||(this.mapping.set(n,Sa),this.cook(n))}async cook(t){await this.cookNormalized(t),await this.cookTranslated(t),await this.cookToolkited(t)}async cookNormalized(t){let o=this.intent.file.split(".")[0],i=this.bioscope.subtitles[t].dialogues,c=[];for(let u of i){let p=u.start,I=u.end,k=u.content,C={type:"plain",data:k,language:o};c.push({start:p,end:I,content:k,normalized:C,translated:C,toolkited:C,finalized:C})}let l={dialogues:c};this.mapping.set(t,l)}async cookTranslated(t){let e=this.intent;if(e.translate==="")return;let{translationEngine:n}=this.setting.language.translation,{translationMode:o}=this.setting.language.translation,{apiKey:s}=this.setting.network.server,i=e.file.split("."),c=i[0],l=i[1]??"",u=e.translate;if(uy(c,u))return;let p=c.split("-")[0],I=u,k=n,C=G.website,j=o;j==="auto"&&(j=py(j,c,C));let D="";C==="youtube"&&l==="asr"&&(D="asr");let A=this.bioscope.offsets[t],go=this.mapping.get(t).dialogues,ho=[];for(let tt of go)ho.push(tt.normalized.data);let cs=[];(C==="youtube"&&l==="asr"||C==="bilibili"&&l==="ai")&&(cs=sy(go));let Ld={contents:ho,target:I,source:p,intervals:cs,engine:k,mode:j,trait:D,offset:A,website:C,apiKey:s},yo;try{let tt=await Qt.translate(Ld);yo=Uo(tt,{languageCode:u,afterTranslate:!0})}catch(tt){let at=`{ ${ly(tt)} }`;yo=ho.map(()=>at)}for(let[tt,at]of go.entries()){let bo={type:"plain",data:yo[tt],language:u};at.translated=bo,at.toolkited=bo,at.finalized=bo}}async cookToolkited(t){let e=ay(this.intent,this.setting);if(e==="")return;let o=this.mapping.get(t).dialogues,s=[];for(let l of o)s.push(l.translated.data);let i=G.website,c;if(e==="zhtools"){let l=this.setting.language.chinese.pinyinScheme;c=await Qt.zhtools({contents:s,style:l,website:i})}else e==="jatools"?(s=s.map(Xi),c=await Qt.jatools({contents:s,website:i})):c=s;for(let[l,u]of o.entries()){let p={type:e,data:c[l],language:u.translated.language};u.toolkited=p,u.finalized=p}}async doCreate(){let t=this.intent,e=this.fetcher,n;return t.url.startsWith("custom://")?n=await iy(t):n=await e.load(t),n=mt(n),n=Ht(n,{languageCode:t.file}),n}getSubtitleIndex(t){let e=this.bioscope.subtitles;for(let[n,o]of e.entries()){let s=o.dialogues;if(s[s.length-1].end>t)return n}return e.length-1}getSubtitle(t){this.touch(t);let e=this.getSubtitleIndex(t);return this.mapping.get(e)??Sa}updateSetting(t){this.setting=t}},jt=class{setting;fetcher;workers;constructor(t,e){this.setting=t,this.fetcher=e,this.workers=[]}updateSetting(t){this.setting=t,this.workers.forEach(e=>e.updateSetting(t))}updateIntents(t){this.workers=[];for(let e of t){let n=new ss(this.setting,this.fetcher,e);this.workers.push(n)}}find(t){let e=this.workers.map(s=>s.getSubtitle(t)),n=oy(e,t),o=[];for(let s of n){let{data:i,language:c,type:l}=s,u=cy(i,l,c,this.setting);o.push({language:c,tokens:u})}return o}}});var ja,Ta,my,as,Ma,is,fy,Ia,ka,ee,ne,re,dy,oe,Ca=a(()=>{Bt();ja=r=>{let t=[];for(let e of r)t.includes(e)||t.push(e);return t},Ta=["pinyin","hiragana","katakana","romaji","loanword","text"],my=["pinyin","hiragana","katakana","romaji","loanword"],as=["pos","form","tag","base","sense","jlpt"],Ma=(r,t)=>{if(t===void 0)return r;let e=Math.round(t/100*255).toString(16).padStart(2,"0");return`${r}${e}`},is=r=>{let t=[];for(let e of r){let n=e.name;n!==""&&!t.includes(n)&&t.push(n)}return t.map(e=>({label:e,value:e}))},fy=(r,t)=>{for(let e of t)if(r.includes(e))return!0;return!1},Ia=r=>{let t=r.contents??[],e=r.grammars??[],n={};for(let o of Ta)n[o]=t.map(s=>s[o]).join("");for(let o of as)n[o]=e.filter(s=>s.type===o).map(s=>s.text);return n},ka=(r,t)=>{for(let e of Object.keys(t)){if(Ta.includes(e)){let n=new RegExp(t[e]),o=r[e];if(!n.test(o))return!1;continue}if(as.includes(e)){let n=t[e],o=r[e];if(!fy(n,o))return!1;continue}}return!0},ee=class{constructor(t){this.genreItems=t,this.mapping={},this.classNames={},this.sheetItems={};for(let[e,n]of t.entries()){let o=n.name;if(o===""||this.mapping[o])continue;let s=`genre-${e}`,i=this.createSheetItem(n,s);this.mapping[o]=n,this.classNames[o]=s,this.sheetItems[o]=i}}exists(t){return t.filter(e=>this.mapping[e])}getClassName(t){return this.classNames[t]}getClassNames(t){return t.map(e=>this.classNames[e])}getSheetItems(t){let e={};for(let n of this.genreItems){let o=n.name;t.includes(o)&&Object.assign(e,this.sheetItems[o])}return e}createSheetItem(t,e){let n=t.component;if(!n)return{};let o={};for(let s of Object.keys(n)){let i=n[s];if(i!==null){let c=this.createSheetKey(s,i,e);o[c]=this.createSheetValue(s,i)}}return o}createSheetKey(t,e,n){let o;t==="dialogue"?o="& .dialogue":o=`& .token.${n} .${t}`;let s=e.match;if(s===void 0||s===""||(typeof s=="string"&&(s=[s]),s.length===0))return o;let i=[];for(let c of s)i.push(o+`[data-value="${c}"]`);return i.join(", ")}createSheetValue(t,e){let n={},o=e.display;o==="true"?((my.includes(t)||as.includes(t))&&(n.display="revert"),t==="dividers"&&(n.display="block")):o==="false"?n.display="none":o==="preserve"&&((t==="readings"||t==="grammars")&&(n.minHeight="1.5em"),t==="dividers"&&(n.display="block",n.visibility="hidden"));let s=e.fontSize;s!==void 0&&(n.fontSize=`${s}%`);let i=e.fontColor,c=e.fontOpacity;i!==void 0&&(n.color=Ma(i,c));let l=e.fontBold;l===!0?n.fontWeight="bold":l===!1&&(n.fontWeight="normal");let u=e.fontItalic;u===!0?n.fontStyle="italic":u===!1&&(n.fontStyle="normal");let p=e.backgroundColor,I=e.backgroundOpacity;p!==void 0&&(n.backgroundColor=Ma(p,I));let k=e.borderSize;if(k!==void 0){let A=e.borderColor??"#000000";n.border=`${A} solid ${k}px`}let C=e.fontEdgeEffect;if(C==="none")n.textShadow="none";else if(C==="shadow"){let A=e.fontEdgeColor??"#222222",H=e.fontEdgeSize??2;n.textShadow=[`${A} ${H}px ${H}px ${H+1}px`,`${A} ${H}px ${H}px ${H+2}px`,`${A} ${H}px ${H}px ${H+3}px`]}let j=e.backgroundEdgeEffect;if(j==="none")n.boxShadow="none";else if(j==="shadow"){let A=e.backgroundEdgeColor??"#000000";n.boxShadow=`0 0 2px 0 ${A}`}let D=e.flexAlign;return D==="center"?n.justifyContent="center":D==="left"?n.justifyContent="flex-start":D==="right"?n.justifyContent="flex-end":D==="evenly"&&(n.justifyContent="space-evenly"),n}},ne=class{constructor(t,e){this.rulerItems=t,this.genres=e,this.mapping={},this.genreNames={},this.conditions={};for(let n of t){let o=n.name;o===""||this.mapping[o]||(this.mapping[o]=n,this.genreNames[o]=e.exists(n.genres??[]),this.conditions[o]=n.tokens??{})}}exists(t){return t.filter(e=>this.mapping[e])}getGenreNames(t){return this.genreNames[t]}getConditions(t){return this.conditions[t]}},re=class{constructor(t,e,n){this.themeItems=t,this.genres=e,this.rulers=n,this.mapping={},this.basicGenreNames={},this.wholeGenreNames={},this.rulerNames={};for(let o of t){let s=o.name;if(s===""||this.mapping[s])continue;let i=e.exists(o.genres??[]),c=n.exists(o.rulers??[]),l=[...i];for(let u of c)l.push(...n.getGenreNames(u));this.mapping[s]=o,this.basicGenreNames[s]=i,this.wholeGenreNames[s]=ja(l),this.rulerNames[s]=o.rulers??[]}}exists(t){return t.filter(e=>this.mapping[e])}getBasicGenreNames(t){return this.basicGenreNames[t]}getWholeGenreNames(t){return this.wholeGenreNames[t]}getRulerNames(t){return this.rulerNames[t]}},dy={genres:[],rulers:[],themes:[]},oe=class{constructor(t,e){e=e??dy,this.id=t,this.config=e,this.genres=new ee(e.genres),this.rulers=new ne(e.rulers,this.genres),this.themes=new re(e.themes,this.genres,this.rulers),this.appliedType="",this.appliedName="",this.sheetObject=null}get sheetString(){return this.sheetObject?this.sheetObject.toString():""}reset(){this.sheetObject&&B.removeStyleSheet(this.sheetObject),this.appliedType="",this.appliedName="",this.sheetObject=null}update(t){this.config=t,this.genres=new ee(t.genres),this.rulers=new ne(t.rulers,this.genres),this.themes=new re(t.themes,this.genres,this.rulers),this.sheetObject&&this.apply(`${this.appliedType}:${this.appliedName}`)}createSheetObject(t){let e=this.genres.getSheetItems(t),o={"@global":{[`.${this.id}`]:e}};return B.createStyleSheet(o)}apply(t){this.reset();let e=t.match(/^(.+?):(.*)$/);if(e===null)return;let n=e[1],o=e[2];if(n===""||o==="")return;let s;n==="genre"?s=this.genres.exists([o]):n==="ruler"?s=this.rulers.getGenreNames(o):n==="theme"&&(s=this.themes.getWholeGenreNames(o)),!(s===void 0||s.length===0)&&(this.appliedType=n,this.appliedName=o,this.sheetObject=this.createSheetObject(s),this.sheetObject.attach())}previewSheetString(t){return this.createSheetObject(t).toString()}connectGenreName(t,e){let n=this.genres.getClassName(t),o=[];for(let s of e)o.push({...s,classes:n});return o}connectRulerName(t,e){let n=this.rulers.getGenreNames(t),o=this.rulers.getConditions(t),s=this.genres.getClassNames(n).join(" "),i=[];for(let c of e){let l=Ia(c);ka(l,o)?i.push({...c,classes:s}):i.push({...c})}return i}connectThemeName(t,e){let n=this.themes.getBasicGenreNames(t),o=this.themes.getRulerNames(t),s=[];for(let i of e){let c=[...n],l=Ia(i);for(let p of o){let I=this.rulers.getConditions(p);ka(l,I)&&c.push(...this.rulers.getGenreNames(p))}c=ja(c);let u=this.genres.getClassNames(c).join(" ");s.push({...i,classes:u})}return s}connect(t){let e=this.appliedType,n=this.appliedName;return e==="genre"?this.connectGenreName(n,t):e==="ruler"?this.connectRulerName(n,t):e==="theme"?this.connectThemeName(n,t):[...t]}getSchemaItems(){return{genres:is(this.config.genres),rulers:is(this.config.rulers),themes:is(this.config.themes)}}}});var Tt,Ra=a(()=>{"use strict";Ca();Tt=class{setting;legends;constructor(t){this.setting=t,this.legends=[],this.updateCount(2)}updateCount(t){let e=this.setting.style,n=this.legends.length;for(let o=n;o<t;o++){let s=`dualsub-theme-${o+1}`,i=new oe(s,e);this.legends.push(i)}}updateIntents(t){this.updateCount(t.length);for(let[e,n]of t.entries())this.legends[e].apply(`theme:${n.legend}`)}updateSetting(t){this.setting=t,this.legends.forEach(e=>e.update(t.style))}get(t){return this.legends[t]}}});var Na,U,d,w=a(()=>{"use strict";Xo();Ai();Bt();qi();va();Ra();Na=100,{classes:U}=B.createStyleSheet({root:{position:"absolute",bottom:`${Na}px`,left:"0",right:"0",margin:"auto",padding:"8px 16px",zIndex:99,width:"fit-content",fontSize:"calc(100vw / 1920 * 18 + 18px)","& .subtitles":{display:"flex",flexDirection:"column",gap:"4px",padding:"8px 16px"},"& .dialogue":{color:"#fff",justifyContent:"center","& .readings":{userSelect:"none","&:hover":{userSelect:"revert"}}}},stroke:{"& .subtitles":{"& [data-text]":B.createTextStroke("4px #000000","data-text")}},background:{"& .subtitles":{background:"rgba(8, 8, 8, 0.75)"}},classic:{"& .subtitles":{gap:"6px",fontWeight:"bold",textShadow:["#222222 2px 2px 4px","#222222 2px 2px 5px","#222222 2px 2px 6px"],"& [data-text]":B.createTextStroke("6px #000000","data-text")}},passthrough:{pointerEvents:"none"},selecttext:{"& *":{cursor:"text !important",userSelect:"text !important"}}}).attach(),d=class{setting;props;overlay;overlayRoot;styler;composer;stage;constructor(t,e){this.setting=t,this.props=e,this.overlay=this.overlayCreate(),this.overlayRoot=Wi.createRoot(this.overlay),this.overlayUpdateSetting(),this.styler=new Tt(t),this.composer=new jt(t,e.fetcher),this.stage=null}overlayCreate(){let t=document.createElement("div");return t.classList.add(U.root,"dualsub-renderer"),t.setAttribute("translate","no"),t}overlaySetStyle(t){if(this.overlay.classList.remove(U.stroke),this.overlay.classList.remove(U.background),this.overlay.classList.remove(U.classic),t==="stroke"){this.overlay.classList.add(U.stroke);return}if(t==="background"){this.overlay.classList.add(U.background);return}if(t==="classic"){this.overlay.classList.add(U.classic);return}}overlaySetMouse(t){this.overlay.classList.remove(U.passthrough),this.overlay.classList.remove(U.selecttext),t==="none"&&this.overlay.classList.add(U.passthrough),t==="text"&&this.overlay.classList.add(U.selecttext)}overlaySetBottom(t){if(t===Na){this.overlay.style.bottom="";return}this.overlay.style.bottom=`${t}px`}overlayUpdateSetting(){let t=this.setting.general.rendering.bottomMargin,e=this.setting.general.rendering.baseStyle,n=this.setting.general.rendering.mouseAction;this.overlaySetBottom(t),this.overlaySetStyle(e),this.overlaySetMouse(n)}onTimeUpdate=()=>{let t=this.getPlayerTime(),e=this.composer.find(t);if(e.length===0){this.overlayRoot.render(null);return}let n=[];for(let[s,i]of e.entries()){let c=this.styler.get(s),l={items:c.connect(i.tokens)},u=`subtitle subtitle-${s+1} ${c.id}`;n.push(E.createElement(Mt,{key:s,className:u,schema:l}))}let o=E.createElement("div",{className:"subtitles"},n);this.overlayRoot.render(o)};getPlayerTime(){return this.stage.player.currentTime*1e3}startStage(t){this.stage||(t.curtain.appendChild(this.overlay),t.player.addEventListener("timeupdate",this.onTimeUpdate),this.stage=t)}stopStage(){!this.stage||(this.overlayRoot.render(null),this.overlay.remove(),this.stage.player.removeEventListener("timeupdate",this.onTimeUpdate),this.stage=null)}updateStage(t){this.stopStage(),t!==null&&this.startStage(t)}updateIntents(t){this.styler.updateIntents(t),this.composer.updateIntents(t)}updateSetting(t){this.setting=t,this.overlayUpdateSetting(),this.styler.updateSetting(t),this.composer.updateSetting(t)}}});var se,Pa=a(()=>{"use strict";w();se=class extends d{}});var g,v=a(()=>{"use strict";g=class{setting;props;stage;constructor(t,e){this.setting=t,this.props=e,this.stage=null,setInterval(this.watch,3e3)}updateSetting(t){this.setting=t}watch=()=>{let t=this.getStage(),e=this.checkChange(t,this.stage);this.stage=t,e&&this.props.onChange(t)};getStage(){let t=this.getHint();if(t===null)return null;let e=this.getMovieId();if(e===null)return null;let n=this.getCurtain();if(n===null)return null;let o=this.getPlayer();return o===null?null:{hint:t,movieId:e,curtain:n,player:o}}getHint(){return location.pathname}getMovieId(){return""}getCurtain(){return document.body}getPlayer(){return document.querySelector("video[src]")}checkChange(t,e){return t===null&&e===null?!1:t===null&&e!==null||t!==null&&e===null||(t=t,e=e,t.hint!==e.hint)||t.movieId!==e.movieId||t.curtain!==e.curtain||t.player!==e.player}}});var ie,Oa=a(()=>{"use strict";v();ie=class extends g{getHint(){if(!location.pathname.startsWith("/watch"))return null;let r=new URL(location.href).searchParams.get("v");return r!==null?`${location.pathname}?v=${r}`:location.pathname}getMovieId(){return new URL(location.href).searchParams.get("v")}getCurtain(){return document.querySelector(".html5-video-player")}getPlayer(){return document.querySelector("video")}}});var gy={};var Da=a(()=>{"use strict";b();Ri();Li();Pa();Oa();h({Fetcher:Gt,Injecter:Jt,Renderer:se,Watcher:ie})});var ae,Ea=a(()=>{"use strict";O();x();ae=class extends m{async parse(r,t){return t.startsWith("WEBVTT")?q(t):W(t)}}});var La,Wa=a(()=>{"use strict";La=function(){let r=async n=>{if(!n?.result?.timedtexttracks)return;let o={name:"manifest",args:n};window.postMessage(o,location.origin)},t=JSON.parse;JSON.parse=n=>{let o=t(n);return r(o),o};let e=JSON.stringify;JSON.stringify=n=>{if(!n?.url?.toLowerCase().includes("manifest"))return e(n);let o=Object.values(n).find(c=>c?.profiles?.includes("nflx-cmisc"));if(o===null)return e(n);o.showAllSubDubTracks=!0;let s=o.profiles,i=s.indexOf("nflx-cmisc");for(let c of["webvtt-lssdh-ios8","imsc1.1"])s.includes(c)||(i+=1,s.splice(i,0,c));return e(n)}}.toString()});var hy,yy,by,Aa,$a=a(()=>{"use strict";hy=["webvtt-lssdh-ios8","imsc1.1","dfxp-ls-sdh","simplesdh"],yy=r=>{let t=r.ttDownloadables??{},e={};for(let o of hy){let s=t[o];if(s!==void 0){e=s.downloadUrls;break}}let n=r.cdnlist??[];for(let{id:o}of n){let s=e[o];if(s!==void 0)return s}for(let o of Object.values(e))return o;return null},by=r=>{let t={},e=[];for(let n of r){if(n.isNoneTrack||n.isForcedNarrative)continue;let o=yy(n);if(o===null)continue;let s=n.language,i=n.languageDescription,c=n.rawTrackType==="closedcaptions",l=t[s]??0;e.push({url:o,language:s,label:i,isCC:c,variant:l}),t[s]=l+1}return e},Aa=async r=>{let t=by(r.result.timedtexttracks),e=String(r.result.movieId),n=[];for(let o of t){let s=o.language,i=o.label,c=o.url,{isCC:l,variant:u}=o;u>0&&(s=`${s}.var${u}`,i=`${i} (Var ${u})`),l&&(i=`${i} (CC)`),n.push({name:i,code:s,url:c})}return{movieId:e,items:n}}});var ce,za=a(()=>{"use strict";S();Wa();$a();ce=class extends f{getScript(){return La}async createManifest(r){return await Aa(r)}}});var le,Fa=a(()=>{"use strict";w();le=class extends d{}});var ue,qa=a(()=>{"use strict";v();ue=class extends g{getHint(){return location.pathname.includes("/watch/")?location.pathname:null}getMovieId(){return document.querySelector("[data-videoid]")?.getAttribute("data-videoid")??null}getCurtain(){return document.querySelector(".watch-video, .NFPlayer")}}});var xy={};var Ua=a(()=>{"use strict";b();Ea();za();Fa();qa();h({Fetcher:ae,Injecter:ce,Renderer:le,Watcher:ue})});var Sy,pe,Ha=a(()=>{"use strict";O();$();x();Sy=r=>{let t=r.dialogues;for(let e of t)e.start+=3e3},pe=class extends m{async createSubtitleUrls(r){let t=r.url,e=await this.fetch(r,t),n=P(t);return e.split(`
`).map(o=>o.trim()).filter(o=>o.endsWith(".vtt")).filter(o=>!o.includes("DUB_CARD")).map(o=>`${n}${o}`)}async createSubtitle(r){let t=await this.createSubtitleUrls(r),e=[];for(let o of t){let s=await this.fetch(r,o),i=await this.parse(r,s);e.push(...i.dialogues)}let n=new T(e);return t[0]?.includes("BUMPER")&&Sy(n),n}}});var Va,_a=a(()=>{"use strict";Va=function(){let r=async e=>{if(!e?.stream?.complete)return;let n={name:"manifest",args:e};window.postMessage(n,location.origin)},t=JSON.parse;JSON.parse=e=>{let n=t(e);return r(n),n}}.toString()});var Q,Ct=a(()=>{"use strict";Q=r=>{let t=[];for(let e of r.split(`
`)){if(!e.startsWith("#EXT-X-MEDIA:TYPE=SUBTITLES"))continue;let n={};for(let o of e.matchAll(/([A-Z-]+)=(YES|NO)/g)){let s=o[1].toLowerCase(),i=o[2]==="YES";n[s]=i}for(let o of e.matchAll(/([A-Z-]+)="(.+?)"/g)){let s=o[1].toLowerCase(),i=o[2];n[s]=i}t.push(n)}return t}});var Ga,Ja=a(()=>{"use strict";$();Ct();Ga=async r=>{let t=r.stream.complete[0].url,e=await(await fetch(t)).text(),n=Q(e),o=P(t),s="",i=[];for(let c of n){if(c.forced)continue;let l=c.name,u=c.language,p=`${o}${c.uri}`;i.push({name:l,code:u,url:p})}return{movieId:s,items:i}}});var me,Ba=a(()=>{"use strict";S();_a();Ja();me=class extends f{getScript(){return Va}async createManifest(r){return await Ga(r)}}});var fe,Xa=a(()=>{"use strict";w();fe=class extends d{}});var de,Ka=a(()=>{"use strict";v();de=class extends g{getHint(){return location.pathname.includes("/video/")?location.pathname:null}getCurtain(){return document.querySelector("#app_body_content")}}});var wy={};var Ya=a(()=>{"use strict";b();Ha();Ba();Xa();Ka();h({Fetcher:pe,Injecter:me,Renderer:fe,Watcher:de})});var vy,ge,Za=a(()=>{"use strict";O();x();vy=(r,t)=>{let e=new URL(t),o=new URLSearchParams(e.hash.slice(1)).get("start")??"0",s=parseInt(o);if(s!==0)for(let i of r.dialogues)i.start+=s},ge=class extends m{async parse(r,t){let e=W(t);return vy(e,r.url),e}}});var Qa,tc=a(()=>{"use strict";Qa=function(){let r=async n=>{let o={name:"manifest",args:n};window.postMessage(o,location.origin)},t=()=>{let n=document.querySelector(".atvwebplayersdk-overlays-container");if(n===null)return null;let o=null;for(let[c,l]of Object.entries(n))if(c.startsWith("__reactInternalInstance")){o=l;break}return o?.child?.stateNode?.context?.stores?.title?.streamFeature?.currentPlaylistItem},e=null;setInterval(()=>{let n=t();if(n!==e){let o={staticTimedTextStreams:n.staticTimedTextStreams,start:n.start-n.timelineStart};r(o),e=n}},3e3)}.toString()});var My,ec,nc=a(()=>{"use strict";My=r=>{let t={},e=[];for(let n of r.staticTimedTextStreams){if(n.type==="Mandatory")continue;let o=`${n.variants[0].url}#start=${r.start}`,s=n.language,i=n.label,c=t[s]??0;e.push({url:o,language:s,label:i,variant:c}),t[s]=c+1}return e},ec=async r=>{let t=My(r),e="",n=[];for(let o of t){let s=o.language,i=o.label,c=o.url,{variant:l}=o;l>0&&(s=`${s}.var${l}`),n.push({name:i,code:s,url:c})}return{movieId:e,items:n}}});var he,rc=a(()=>{"use strict";S();tc();nc();he=class extends f{getScript(){return Qa}async createManifest(r){return await ec(r)}}});var ye,oc=a(()=>{"use strict";w();ye=class extends d{}});var be,sc=a(()=>{"use strict";v();be=class extends g{getCurtain(){return document.querySelector(".cascadesContainer, .webPlayerSDKContainer")}getPlayer(){let r=".dv-player-fullscreen video[src]";return document.querySelector(r)}}});var Iy={};var ic=a(()=>{"use strict";b();Za();rc();oc();sc();h({Fetcher:ge,Injecter:he,Renderer:ye,Watcher:be})});var xe,ac=a(()=>{"use strict";x();xe=class extends m{}});var cc,lc=a(()=>{"use strict";cc=function(){let r=n=>{let o={name:"manifest",args:n};window.postMessage(o,location.origin)},t=()=>{let o=window.presetPlayerParams?.pid??null;return{key:o,args:{pid:o}}},e={key:null};setInterval(()=>{let n=t();n.key!==e.key&&(r(n.args),e=n)},3e3)}.toString()});var ky,uc,pc=a(()=>{"use strict";N();ky=async r=>{let t=[`https://link.theplatform.com/s/dJ5BDC/${r}`,"?format=SMIL&manifest=m3u&Tracking=true&mbr=true"].join(""),e=await(await fetch(t)).text(),n=/name="webVTTCaptionURL" value="(.+?)"/,o=e.match(n);return o?o[1]:null},uc=async r=>{let t=await ky(r.pid),e="",n=[];if(t!==null){let o="en",s=y(o),i=t;n.push({name:s,code:o,url:i})}return{movieId:e,items:n}}});var Se,mc=a(()=>{"use strict";S();lc();pc();Se=class extends f{getScript(){return cc}async createManifest(r){return await uc(r)}}});var we,fc=a(()=>{"use strict";w();we=class extends d{}});var ve,dc=a(()=>{"use strict";v();ve=class extends g{getCurtain(){return document.querySelector("cbsplayer > div")}}});var jy={};var gc=a(()=>{"use strict";b();ac();mc();fc();dc();h({Fetcher:xe,Injecter:Se,Renderer:we,Watcher:ve})});var Me,hc=a(()=>{"use strict";x();Me=class extends m{}});var yc,bc=a(()=>{"use strict";yc=function(){let r=async e=>{let n={name:"manifest",args:e};window.postMessage(n,location.origin)},t=null;setInterval(()=>{let e=window.player?.tech_?.sourceHandler_?.playlists?.master?.playlists??null;if(e!==t){let n=Object.entries(e).filter(([s,i])=>s.includes("SUBTITLES")&&s===i.uri),o=Object.fromEntries(n);r(o),t=e}},3e3)}.toString()});var xc,Sc=a(()=>{"use strict";N();xc=async r=>{let t="",e=[];for(let n of Object.values(r)){let o=n.attributes.NAME.replace("subtitle_",""),s=y(o),i=n.segments[0]?.resolvedUri;e.push({name:s,code:o,url:i})}return{movieId:t,items:e}}});var Ie,wc=a(()=>{"use strict";S();bc();Sc();Ie=class extends f{getScript(){return yc}async createManifest(r){return await xc(r)}}});var ke,vc=a(()=>{"use strict";w();ke=class extends d{}});var je,Mc=a(()=>{"use strict";v();je=class extends g{getHint(){return!location.pathname.startsWith("/shows/")&&!location.pathname.startsWith("/watch/")?null:location.pathname}getCurtain(){return document.querySelector(".video-open")}}});var Ty={};var Ic=a(()=>{"use strict";b();hc();wc();vc();Mc();h({Fetcher:Me,Injecter:Ie,Renderer:ke,Watcher:je})});var Te,kc=a(()=>{"use strict";x();Te=class extends m{}});var jc,Tc=a(()=>{"use strict";jc=function(){let r=async e=>{if(!e?.asset?.endpoints?.[0]?.url)return;let n={name:"manifest",args:e};window.postMessage(n,location.origin)},t=JSON.parse;JSON.parse=e=>{let n=t(e);return r(n),n}}.toString()});var Cc,Rc=a(()=>{"use strict";$();Cc=async r=>{let t=r.asset.endpoints[0].url,e=P(t),n=await(await fetch(t)).text(),s=new DOMParser().parseFromString(n,"application/xml").getElementsByTagName("AdaptationSet"),i="",c=[];for(let l of s){if(l.getAttribute("mimeType")!=="text/vtt")continue;let u=l.getAttribute("Label"),p=l.getAttribute("lang"),I=l.getElementsByTagName("BaseURL")[0].textContent,k=u.charAt(0).toUpperCase()+u.slice(1),C=p,j=`${e}${I}`;c.push({name:k,code:C,url:j})}return{movieId:i,items:c}}});var Ce,Nc=a(()=>{"use strict";S();Tc();Rc();Ce=class extends f{getScript(){return jc}async createManifest(r){return await Cc(r)}}});var Re,Pc=a(()=>{"use strict";w();Re=class extends d{}});var Ne,Oc=a(()=>{"use strict";v();Ne=class extends g{getHint(){return location.pathname.includes("/playback/")?location.pathname:null}}});var Cy={};var Dc=a(()=>{"use strict";b();kc();Nc();Pc();Oc();h({Fetcher:Te,Injecter:Ce,Renderer:Re,Watcher:Ne})});var Pe,Ec=a(()=>{"use strict";x();Pe=class extends m{}});var Lc,Wc=a(()=>{"use strict";Lc=function(){let r=async e=>{let n={name:"manifest",args:e};window.postMessage(n,location.origin)},t=null;setInterval(()=>{let n=document.querySelector(".bitmovinplayer-container")?.player?.subtitles?.list()??[],o=n[0]??null;o!==t&&(r({subtitles:n}),t=o)},3e3)}.toString()});var Ac,$c=a(()=>{"use strict";N();Ac=async r=>{let t="",e=[];for(let n of r.subtitles){if(n.kind!=="caption")continue;let o=n.lang,s=y(o),i=n.url;e.push({name:s,code:o,url:i})}return{movieId:t,items:e}}});var Oe,zc=a(()=>{"use strict";S();Wc();$c();Oe=class extends f{getScript(){return Lc}async createManifest(r){return await Ac(r)}}});var De,Fc=a(()=>{"use strict";w();De=class extends d{}});var Ee,qc=a(()=>{"use strict";v();Ee=class extends g{getHint(){return location.pathname.includes("/play/")?location.pathname:null}getCurtain(){return document.querySelector(".bitmovinplayer-container")}}});var Ry={};var Uc=a(()=>{"use strict";b();Ec();zc();Fc();qc();h({Fetcher:Pe,Injecter:Oe,Renderer:De,Watcher:Ee})});var Le,Hc=a(()=>{"use strict";x();Le=class extends m{}});var Vc,_c=a(()=>{"use strict";Vc=function(){let r=async e=>{if(!e?.url?.includes("/playlist"))return;let n={name:"manifest",args:e};window.postMessage(n,location.origin)},t=Response.prototype.json;Response.prototype.json=async function(){let e=this.url,n=await t.call(this);return r({url:e,data:n}),n}}.toString()});var Gc,Jc=a(()=>{"use strict";N();Gc=async r=>{let t=r.data.transcripts_urls.webvtt,e="",n=[];for(let[o,s]of Object.entries(t)){let i=y(o);n.push({name:i,code:o,url:s})}return{movieId:e,items:n}}});var We,Bc=a(()=>{"use strict";S();_c();Jc();We=class extends f{getScript(){return Vc}async createManifest(r){return await Gc(r)}}});var Ae,Xc=a(()=>{"use strict";w();Ae=class extends d{overlayOnPointerDown=r=>{r.stopPropagation()}}});var $e,Kc=a(()=>{"use strict";v();$e=class extends g{getHint(){return location.pathname.includes("/watch/")?location.pathname:null}getCurtain(){return document.querySelector("#web-player-app")}}});var Ny={};var Yc=a(()=>{"use strict";b();Hc();Bc();Xc();Kc();h({Fetcher:Le,Injecter:We,Renderer:Ae,Watcher:$e})});var Py,ze,Zc=a(()=>{"use strict";O();x();Py=(r,t)=>{let e=new URL(t),o=new URLSearchParams(e.hash.slice(1)).get("start")??"0",s=Math.round(parseFloat(o)*1e3);if(s!==0)for(let i of r.dialogues)i.start+=s},ze=class extends m{async parse(r,t){let e=q(t);return Py(e,r.url),e}}});var Qc,tl=a(()=>{"use strict";Qc=function(){let r=async(e,n)=>{if(!e||!n.includes("manifest")||!n.includes("videoId")||!n.includes("urn:video:main"))return;let o={name:"manifest",args:e};window.postMessage(o,location.origin)},t=JSON.parse;JSON.parse=e=>{let n=t(e);return r(n,e),n}}.toString()});var Oy,Dy,el,nl=a(()=>{"use strict";$();Oy=r=>{for(let t of r)for(let e of t.body.videos)if(e.type==="urn:video:main")return{indexUrl:t.body.fallbackManifest,id:t.id.split(":").pop(),tracks:e.textTracks??[],start:e.start??0};return null},Dy=async r=>{let t=P(r),e=await(await fetch(r)).text(),o=new DOMParser().parseFromString(e,"application/xml").querySelectorAll('AdaptationSet[contentType="text"]'),s={};for(let i of o){let c=i.querySelector('Role[value="caption"], Role[value="subtitle"]'),l=i.querySelector("Representation BaseURL");if(c===null||l===null)continue;let u=c.getAttribute("value"),p=i.getAttribute("lang"),I=`${t}${l.textContent}`,k=p;u==="caption"&&(k=`${k}.cc`),s[k]=I}return s},el=async r=>{let t;try{t=Oy(r)}catch{t=null}if(t===null)return null;let e=await Dy(t.indexUrl),n=t.id,o=[];for(let s of t.tracks){if(s.type!=="ClosedCaptions"&&s.type!=="Subtitles")continue;let i=s.displayName,c=s.language;s.type==="ClosedCaptions"&&(c=`${c}.cc`);let l=e[c];!l||(l=`${l}#start=${t.start}`,o.push({name:i,code:c,url:l}))}return{movieId:n,items:o}}});var Fe,rl=a(()=>{"use strict";S();tl();nl();Fe=class extends f{getScript(){return Qc}async createManifest(r){return await el(r)}}});var qe,ol=a(()=>{"use strict";w();qe=class extends d{}});var Ue,sl=a(()=>{"use strict";v();Ue=class extends g{getMovieId(){return location.pathname.split(":").pop()??null}getCurtain(){return document.querySelector("video[src]")?.parentElement?.parentElement?.parentElement??null}}});var Ey={};var il=a(()=>{"use strict";b();Zc();rl();ol();sl();h({Fetcher:ze,Injecter:Fe,Renderer:qe,Watcher:Ue})});var He,al=a(()=>{"use strict";x();He=class extends m{}});var cl,ll=a(()=>{"use strict";cl=function(){let r=async e=>{let n={name:"manifest",args:e};window.postMessage(n,location.origin)},t=null;setInterval(()=>{let o=document.querySelector("#player")?.__zone_symbol__keydownfalse?.[1]?.options?._model?.attributes?.captionsList??null;o!==t&&(r({subtitles:o??[]}),t=o)},3e3)}.toString()});var ul,pl=a(()=>{"use strict";ul=async r=>{let t="",e=[];for(let n of r.subtitles){if(!n.id.endsWith(".vtt")||n.label!=="English")continue;let o="en",s=n.label,i=n.id;e.push({name:s,code:o,url:i})}return{movieId:t,items:e}}});var Ve,ml=a(()=>{"use strict";S();ll();pl();Ve=class extends f{getScript(){return cl}async createManifest(r){return await ul(r)}}});var _e,fl=a(()=>{"use strict";w();_e=class extends d{}});var Ge,dl=a(()=>{"use strict";v();Ge=class extends g{getHint(){return location.pathname.includes("/play/")?location.pathname:null}getCurtain(){return document.querySelector("#player")}}});var Ly={};var gl=a(()=>{"use strict";b();al();ml();fl();dl();h({Fetcher:He,Injecter:Ve,Renderer:_e,Watcher:Ge})});var Je,hl=a(()=>{"use strict";x();Je=class extends m{}});var yl,bl=a(()=>{"use strict";yl=function(){let r=async e=>{let n={name:"manifest",args:e};window.postMessage(n,location.origin)},t=null;setInterval(()=>{let n=document.querySelector("video[src]")?.amp?.config?.media?.track??null;n!==t&&(r({subtitles:n??[]}),t=n)},3e3)}.toString()});var xl,Sl=a(()=>{"use strict";N();xl=async r=>{let t="",e=[];for(let n of r.subtitles){let o=n.srclang,s=y(o),i=n.src;e.push({name:s,code:o,url:i})}return{movieId:t,items:e}}});var Be,wl=a(()=>{"use strict";S();bl();Sl();Be=class extends f{getScript(){return yl}async createManifest(r){return await xl(r)}}});var Xe,vl=a(()=>{"use strict";w();Xe=class extends d{}});var Ke,Ml=a(()=>{"use strict";v();Ke=class extends g{getHint(){return location.pathname.startsWith("/playback/")?location.pathname:null}getCurtain(){return document.querySelector(".amp-video")}}});var Wy={};var Il=a(()=>{"use strict";b();hl();wl();vl();Ml();h({Fetcher:Je,Injecter:Be,Renderer:Xe,Watcher:Ke})});var Ye,kl=a(()=>{"use strict";x();Ye=class extends m{}});var jl,Tl=a(()=>{"use strict";jl=function(){let r=async e=>{if(!e?.subtitles)return;let n={name:"manifest",args:e};window.postMessage(n,location.origin)},t=JSON.parse;JSON.parse=e=>{let n=t(e);return r(n),n}}.toString()});var Cl,Rl=a(()=>{"use strict";Cl=async r=>{let t=r.subtitles,e="",n=[];for(let o of t){let s=o.label.replace(/\(.+?%\)/,""),i=o.srclang,c=o.src;n.push({name:s,code:i,url:c})}return{movieId:e,items:n}}});var Ze,Nl=a(()=>{"use strict";S();Tl();Rl();Ze=class extends f{getScript(){return jl}async createManifest(r){return await Cl(r)}}});var Qe,Pl=a(()=>{"use strict";w();Qe=class extends d{}});var tn,Ol=a(()=>{"use strict";v();tn=class extends g{getHint(){return location.pathname.includes("/videos/")?location.pathname:null}getCurtain(){return document.querySelector(".page-section .video-player")}}});var Ay={};var Dl=a(()=>{"use strict";b();kl();Nl();Pl();Ol();h({Fetcher:Ye,Injecter:Ze,Renderer:Qe,Watcher:tn})});var en,El=a(()=>{"use strict";x();en=class extends m{}});var Ll,Wl=a(()=>{"use strict";Ll=function(){let r=async e=>{let n={name:"manifest",args:e};window.postMessage(n,location.origin)},t=null;setInterval(()=>{let n=window.app?.$store?._vm?._computedWatchers?.["videoPlayerCatalog/subtitleSources"]??null;if(n!==t){let o={subtitles:n.value};r(o),t=n}},3e3)}.toString()});var Al,$l=a(()=>{"use strict";N();Al=async r=>{let t="",e=[];for(let n of r.subtitles){if(n.fileExt!=="vtt")continue;let o=n.languageCode,s=y(o),i=n.filePath;e.push({name:s,code:o,url:i})}return{movieId:t,items:e}}});var nn,zl=a(()=>{"use strict";S();Wl();$l();nn=class extends f{getScript(){return Ll}async createManifest(r){return await Al(r)}}});var rn,Fl=a(()=>{"use strict";w();rn=class extends d{}});var on,ql=a(()=>{"use strict";v();on=class extends g{getHint(){return location.pathname.startsWith("/v/")?location.pathname:null}getCurtain(){return document.querySelector(".video-js")}}});var $y={};var Ul=a(()=>{"use strict";b();El();zl();Fl();ql();h({Fetcher:en,Injecter:nn,Renderer:rn,Watcher:on})});var sn,Hl=a(()=>{"use strict";x();sn=class extends m{}});var Vl,_l=a(()=>{"use strict";Vl=function(){let r=async e=>{let n={name:"manifest",args:e};window.postMessage(n,location.origin)},t=null;setInterval(()=>{let e=window.ppp?.tech_?.sourceHandler_?.playlists?.master?.playlists??null;if(e!==t){let n=Object.entries(e).filter(([s,i])=>s.includes("SUBTITLES")&&s===i.uri),o=Object.fromEntries(n);r(o),t=e}},3e3)}.toString()});var Gl,Jl=a(()=>{"use strict";N();Gl=async r=>{let t="",e=[];for(let n of Object.values(r)){let o=n.uri.split("-").pop(),s=y(o),i=n.segments[0]?.resolvedUri;e.push({name:s,code:o,url:i})}return{movieId:t,items:e}}});var an,Bl=a(()=>{"use strict";S();_l();Jl();an=class extends f{getScript(){return Vl}async createManifest(r){return await Gl(r)}}});var cn,Xl=a(()=>{"use strict";w();cn=class extends d{}});var ln,Kl=a(()=>{"use strict";v();ln=class extends g{getHint(){return location.pathname.startsWith("/play/")?location.pathname:null}getCurtain(){return document.querySelector("#playerWrapper")}}});var zy={};var Yl=a(()=>{"use strict";b();Hl();Bl();Xl();Kl();h({Fetcher:sn,Injecter:an,Renderer:cn,Watcher:ln})});var un,Zl=a(()=>{"use strict";x();un=class extends m{}});var Ql,tu=a(()=>{"use strict";Ql=function(){let r=async e=>{let n={name:"manifest",args:e};window.postMessage(n,location.origin)},t=null;setInterval(()=>{let e=window.streamObj?.url??null;e!==t&&(r({url:e}),t=e)},3e3)}.toString()});var Fy,qy,Uy,Hy,eu,nu=a(()=>{"use strict";N();$();Ct();Fy=async r=>{let t=P(r),e=await(await fetch(r)).text(),o=new DOMParser().parseFromString(e,"application/xml").querySelectorAll('AdaptationSet[contentType="text"]'),s=[];for(let i of o){let c=i.querySelector('Role[value="subtitle"]'),l=i.querySelector("Representation BaseURL");if(c===null||l===null)continue;let u=i.getAttribute("lang"),p=`${t}${l.textContent}`,I=u;s.push({url:p,language:I})}return s},qy=async r=>{let t=P(r),e=await(await fetch(r)).text(),n=Q(e),o=[];for(let s of n){let i=`${t}${s.uri}`,c=P(i),u=(await(await fetch(i)).text()).split(`
`).map(C=>C.trim()).find(C=>C.endsWith(".vtt"));if(u===null)continue;let p=`${c}${u}`,I=s.language,k=s.name;o.push({url:p,language:I,label:k})}return o},Uy=async r=>{let t=new URL(r);return t.pathname.endsWith(".mpd")?await Fy(r):t.pathname.endsWith(".m3u8")?await qy(r):[]},Hy=async r=>{let t=await Uy(r),e={};for(let n of Object.values(t))e[n.language]=n;return Object.values(e)},eu=async r=>{let t=await Hy(r.url),e="",n=[];for(let o of t){let s=o.language,i=o.label??y(s),c=o.url;n.push({name:i,code:s,url:c})}return{movieId:e,items:n}}});var pn,ru=a(()=>{"use strict";S();tu();nu();pn=class extends f{getScript(){return Ql}async createManifest(r){return await eu(r)}}});var mn,ou=a(()=>{"use strict";w();mn=class extends d{}});var fn,su=a(()=>{"use strict";v();fn=class extends g{getCurtain(){return document.querySelector(".player-base")}}});var Vy={};var iu=a(()=>{"use strict";b();Zl();ru();ou();su();h({Fetcher:un,Injecter:pn,Renderer:mn,Watcher:fn})});var dn,au=a(()=>{"use strict";x();dn=class extends m{}});var cu,lu=a(()=>{"use strict";cu=function(){let r=async e=>{if(!e?.linked?.["onDemandVideos.v1"]?.[0]?.subtitlesVtt)return;let n={name:"manifest",args:e};window.postMessage(n,location.origin)},t=JSON.parse;JSON.parse=e=>{let n=t(e);return r(n),n}}.toString()});var _y,uu,pu=a(()=>{"use strict";Dt();_y=async(r,t=1e3)=>{let e=null;for(;e===null;)await Ot(t),e=document.querySelector(r);return e},uu=async r=>{let t=r.linked["onDemandVideos.v1"][0].subtitlesVtt,e=await _y("#select-language"),n="",o=[];for(let s of e.children){let i=s.text,c=s.value,l=t[c];!l||o.push({name:i,code:c,url:l})}return{movieId:n,items:o}}});var gn,mu=a(()=>{"use strict";S();lu();pu();gn=class extends f{getScript(){return cu}async createManifest(r){return await uu(r)}}});var hn,fu=a(()=>{"use strict";w();hn=class extends d{}});var yn,du=a(()=>{"use strict";v();yn=class extends g{getHint(){return location.pathname.includes("/lecture/")?location.pathname:null}getCurtain(){return document.querySelector("div[data-vjs-player]")}}});var Gy={};var gu=a(()=>{"use strict";b();au();mu();fu();du();h({Fetcher:dn,Injecter:gn,Renderer:hn,Watcher:yn})});var bn,hu=a(()=>{"use strict";x();bn=class extends m{}});var yu,bu=a(()=>{"use strict";yu=function(){let r=async e=>{if(!e?.asset?.captions)return;let n={name:"manifest",args:e};window.postMessage(n,location.origin)},t=JSON.parse;JSON.parse=e=>{let n=t(e);return r(n),n}}.toString()});var xu,Su=a(()=>{"use strict";xu=async r=>{let t=r.asset.captions,e=String(r.id),n=[];for(let o of t){let s=o.video_label,i=o.locale_id,c=o.url;n.push({name:s,code:i,url:c})}return{movieId:e,items:n}}});var xn,wu=a(()=>{"use strict";S();bu();Su();xn=class extends f{getScript(){return yu}async createManifest(r){return await xu(r)}}});var Sn,vu=a(()=>{"use strict";w();Sn=class extends d{}});var wn,Mu=a(()=>{"use strict";v();wn=class extends g{getHint(){return location.pathname.includes("/lecture/")?location.pathname:null}getMovieId(){return location.pathname.split("/").pop()}getCurtain(){let r='div[data-purpose="curriculum-item-viewer-content"]';return document.querySelector(r)}}});var Jy={};var Iu=a(()=>{"use strict";b();hu();wu();vu();Mu();h({Fetcher:bn,Injecter:xn,Renderer:Sn,Watcher:wn})});var vn,ku=a(()=>{"use strict";x();vn=class extends m{}});var ju,Tu=a(()=>{"use strict";ju=function(){let r=async n=>{if(!n?.talks?.[0]?.player_talks?.[0])return;let o={name:"manifest",args:n};window.postMessage(o,location.origin)},t=null;setInterval(async()=>{if(!location.pathname.startsWith("/talks/")||location.pathname===t)return;t=location.pathname;let n=`${location.pathname}/metadata.json`,o=await(await fetch(n)).json();r(o)},3e3)}.toString()});var By,Xy,Cu,Ru=a(()=>{"use strict";By=async r=>{let t=r.resources.hls.metadata,e=await(await fetch(t)).json(),n=[];for(let o of e.subtitles??[]){let s=o.name,i=o.code,c=o.webvtt;n.push({name:s,code:i,url:c})}return n},Xy=async r=>{let t=r.resources.hls.stream,e=new URL(t).search,n=[];for(let o of r.languages){let s=o.languageName,i=o.languageCode,l=`https://hls.ted.com${`/talks/${r.id}/subtitles/${i}/full.vtt`}${e}`;n.push({name:s,code:i,url:l})}return n},Cu=async r=>{let t=r.talks[0].player_talks[0],e="",n=await By(t);return n.length===0&&(n=await Xy(t)),{movieId:e,items:n}}});var Mn,Nu=a(()=>{"use strict";S();Tu();Ru();Mn=class extends f{getScript(){return ju}async createManifest(r){return await Cu(r)}}});var In,Pu=a(()=>{"use strict";w();In=class extends d{}});var kn,Ou=a(()=>{"use strict";v();kn=class extends g{getHint(){return location.pathname.includes("/talks/")?location.pathname:null}getCurtain(){return document.querySelector("#ted-player")}}});var Ky={};var Du=a(()=>{"use strict";b();ku();Nu();Pu();Ou();h({Fetcher:vn,Injecter:Mn,Renderer:In,Watcher:kn})});var Yy,jn,Eu=a(()=>{"use strict";O();x();Yy=r=>{if(!(r.dialogues[0].start<36e6))for(let e of r.dialogues)e.start-=36e6},jn=class extends m{async parse(r,t){let e=W(t);return Yy(e),e}}});var Lu,Wu=a(()=>{"use strict";Lu=function(){let r=e=>{if(e?._type!=="video")return;let n={name:"manifest",args:e};window.postMessage(n,location.origin)},t="";setInterval(async function(){let e=location.pathname.split("/").filter(s=>s!=="");if(e.length<2||e[0]!=="video"||e[e.length-1]===t)return;t=e[e.length-1];let n=`https://api.ardmediathek.de/page-gateway/mediacollection/${t}?devicetype=pc`,o=await(await fetch(n)).json();r(o)},3e3)}.toString()});var Au,$u=a(()=>{"use strict";N();Au=async r=>{let t="",e=[],n=r._subtitleUrl;if(n){let o="de",s=y(o);e.push({name:s,code:o,url:n})}return{movieId:t,items:e}}});var Tn,zu=a(()=>{"use strict";S();Wu();$u();Tn=class extends f{getScript(){return Lu}async createManifest(r){return await Au(r)}}});var Cn,Fu=a(()=>{"use strict";w();Cn=class extends d{}});var Rn,qu=a(()=>{"use strict";v();Rn=class extends g{getHint(){return location.pathname.includes("/video/")?location.pathname:null}getCurtain(){return document.querySelector(".ardplayer")}getPlayer(){return document.querySelector("video[data-uuid]")}}});var Zy={};var Uu=a(()=>{"use strict";b();Eu();zu();Fu();qu();h({Fetcher:jn,Injecter:Tn,Renderer:Cn,Watcher:Rn})});var Nn,Hu=a(()=>{"use strict";O();x();Nn=class extends m{async parse(r,t){return W(t)}}});var Vu,_u=a(()=>{"use strict";Vu=function(){let r=n=>{let o={name:"manifest",args:n};window.postMessage(o,location.origin)},t=()=>{let n=location.href;return{key:n,args:{url:n}}},e={key:null};setInterval(()=>{let n=t();n.key!==e.key&&(r(n.args),e=n)},3e3)}.toString()});var Qy,tb,Gu,Ju=a(()=>{"use strict";N();Qy={deu:"de"},tb=async r=>{let n=(await(await fetch(r.url)).text()).match(/"contentUrl": "(.+?)"/)[1].replace("{playerId}","ngplayer_2_4"),o=await(await fetch(n)).json(),s=[];for(let i of o.captions){let c=i.uri,l=Qy[i.language];!c.endsWith(".xml")||l!==void 0&&s.push({url:c,code:l})}return s},Gu=async r=>{let t=await tb(r),e="",n=[];for(let o of t){let s=o.code,i=y(s),c=o.url;n.push({name:i,code:s,url:c})}return{movieId:e,items:n}}});var Pn,Bu=a(()=>{"use strict";S();_u();Ju();Pn=class extends f{getScript(){return Vu}async createManifest(r){return await Gu(r)}}});var On,Xu=a(()=>{"use strict";w();On=class extends d{}});var Dn,Ku=a(()=>{"use strict";v();Dn=class extends g{getCurtain(){return document.querySelector(".b-zdfplayer")}}});var eb={};var Yu=a(()=>{"use strict";b();Hu();Bu();Xu();Ku();h({Fetcher:Nn,Injecter:Pn,Renderer:On,Watcher:Dn})});var En,Zu=a(()=>{"use strict";O();x();En=class extends m{async parse(r,t){return W(t)}}});var Qu,tp=a(()=>{"use strict";Qu=function(){let r=n=>{let o={name:"manifest",args:n};window.postMessage(o,location.origin)},t=()=>{let n=window.embeddedMedia?.playerInstances?.bbcMediaPlayer0?._mediaItem,o=n?.captionsURL??null;if(o!==null)return{key:o,args:{subtitle:o}};let s=n?.connections?.captions??null;if(s!==null&&s.length>0){let l=s,u={subtitle:s[0].href};return{key:l,args:u}}return{key:null,args:{subtitle:null}}},e={key:null};setInterval(()=>{let n=t();n.key!==e.key&&(r(n.args),e=n)},3e3)}.toString()});var ep,np=a(()=>{"use strict";N();ep=async r=>{let t="",e=[];if(r.subtitle!==null){let n="en",o=y(n),s=r.subtitle;e.push({name:o,code:n,url:s})}return{movieId:t,items:e}}});var Ln,rp=a(()=>{"use strict";S();tp();np();Ln=class extends f{getScript(){return Qu}async createManifest(r){return await ep(r)}}});var Wn,op=a(()=>{"use strict";w();Wn=class extends d{}});var An,sp=a(()=>{"use strict";v();An=class extends g{getHint(){return location.pathname.startsWith("/iplayer/")?location.pathname:null}getCurtain(){let r=null;return r=document.querySelector("#smphtml5iframebbcMediaPlayer0")?.parentElement??null,r!==null||(r=document.querySelector("#toucan-bbcMediaPlayer0")?.parentElement??null),r}getPlayer(){let r=null;return r=document.querySelector("#smphtml5iframebbcMediaPlayer0")?.contentDocument?.querySelector("video[src]")??null,r!==null||(r=document.querySelector("#toucan-bbcMediaPlayer0")?.shadowRoot?.querySelector("smp-playback")?.shadowRoot?.querySelector("video[src]")??null),r}}});var nb={};var ip=a(()=>{"use strict";b();Zu();rp();op();sp();h({Fetcher:En,Injecter:Ln,Renderer:Wn,Watcher:An})});var $n,ap=a(()=>{"use strict";x();$n=class extends m{}});var cp,lp=a(()=>{"use strict";cp=function(){let r=n=>{let o={name:"manifest",args:n};window.postMessage(o,location.origin)};{let n=document.createElement("style");n.textContent=".dualsub-renderer .content { min-height: revert; overflow: revert; height: revert; }",document.head.appendChild(n)}let t=()=>{let n=document.querySelectorAll("video[src] track");if(n.length===0){let c=document.querySelector(".player-buttons__selector");c&&c.dataset.touched===void 0&&(c.dataset.touched="true",c.click(),c.click())}let o=[];for(let c of n)o.push({srclang:c.srclang,label:c.label,src:c.src});return{key:o[0]?.src??null,args:{subtitles:o}}},e={key:null};setInterval(()=>{let n=t();n.key!==e.key&&(r(n.args),e=n)},3e3)}.toString()});var up,pp=a(()=>{"use strict";up=async r=>{let t="",e=[];for(let n of r.subtitles){let o=n.srclang,s=n.label,i=n.src;e.push({name:s,code:o,url:i})}return{movieId:t,items:e}}});var zn,mp=a(()=>{"use strict";S();lp();pp();zn=class extends f{getScript(){return cp}async createManifest(r){return await up(r)}}});var Fn,fp=a(()=>{"use strict";w();Fn=class extends d{}});var qn,dp=a(()=>{"use strict";v();qn=class extends g{getHint(){return location.pathname.startsWith("/watch/")?location.pathname:null}getCurtain(){return document.querySelector(".player-block__container")}}});var rb={};var gp=a(()=>{"use strict";b();ap();mp();fp();dp();h({Fetcher:$n,Injecter:zn,Renderer:Fn,Watcher:qn})});var Un,hp=a(()=>{"use strict";O();x();Un=class extends m{async parse(r,t){return W(t)}}});var yp,bp=a(()=>{"use strict";yp=function(){let r=n=>{let o={name:"manifest",args:n};window.postMessage(o,location.origin)},t=()=>{let n=window.player?.subtitles,o=[];return n?.list&&(o=n.list()??[]),{key:o[0]?.url??null,args:{subtitles:o}}},e={key:null};setInterval(()=>{let n=t();n.key!==e.key&&(r(n.args),e=n)},3e3)}.toString()});var xp,Sp=a(()=>{"use strict";xp=async r=>{let t="",e=[];for(let n of r.subtitles){let o=n.lang,s=n.label,i=n.url;e.push({name:s,code:o,url:i})}return{movieId:t,items:e}}});var Hn,wp=a(()=>{"use strict";S();bp();Sp();Hn=class extends f{getScript(){return yp}async createManifest(r){return await xp(r)}}});var Vn,vp=a(()=>{"use strict";w();Vn=class extends d{}});var _n,Mp=a(()=>{"use strict";v();_n=class extends g{getCurtain(){return document.querySelector("#my-player")}}});var ob={};var Ip=a(()=>{"use strict";b();hp();wp();vp();Mp();h({Fetcher:Un,Injecter:Hn,Renderer:Vn,Watcher:_n})});var Gn,kp=a(()=>{"use strict";x();Gn=class extends m{}});var jp,Tp=a(()=>{"use strict";jp=function(){let r=n=>{let o={name:"manifest",args:n};window.postMessage(o,location.origin)},t=()=>{let n=document.querySelectorAll("video[src] track");if(n.length===0){let c=document.querySelector("#subtitles");c&&c.dataset.touched===void 0&&(c.dataset.touched="true",c.click(),c.click())}let o=[];for(let c of n)o.push({srclang:c.srclang,label:c.label,src:c.src});return{key:o[0]?.src??null,args:{subtitles:o}}},e={key:null};setInterval(()=>{let n=t();n.key!==e.key&&(r(n.args),e=n)},3e3)}.toString()});var Cp,Rp=a(()=>{"use strict";Cp=async r=>{let t="",e=[];for(let n of r.subtitles){let o=n.srclang,s=n.label,i=n.src;e.push({name:s,code:o,url:i})}return{movieId:t,items:e}}});var Jn,Np=a(()=>{"use strict";S();Tp();Rp();Jn=class extends f{getScript(){return jp}async createManifest(r){return await Cp(r)}}});var Bn,Pp=a(()=>{"use strict";w();Bn=class extends d{}});var Xn,Op=a(()=>{"use strict";v();Xn=class extends g{getCurtain(){return document.querySelector("#video")}}});var sb={};var Dp=a(()=>{"use strict";b();kp();Np();Pp();Op();h({Fetcher:Gn,Injecter:Jn,Renderer:Bn,Watcher:Xn})});var Kn,Ep=a(()=>{"use strict";x();Kn=class extends m{}});var Lp,Wp=a(()=>{"use strict";Lp=function(){let r=n=>{let o={name:"manifest",args:n};window.postMessage(o,location.origin)},t=()=>{let n=document.querySelectorAll("video[src] track"),o=[];for(let c of n)o.push({srclang:c.srclang,src:c.src});return{key:o[0]?.src??null,args:{subtitles:o}}},e={key:null};setInterval(()=>{let n=t();n.key!==e.key&&(r(n.args),e=n)},3e3)}.toString()});var Ap,$p=a(()=>{"use strict";N();Ap=async r=>{let t="",e=[];for(let n of r.subtitles){let o=n.srclang,s=y(o),i=n.src;e.push({name:s,code:o,url:i})}return{movieId:t,items:e}}});var Yn,zp=a(()=>{"use strict";S();Wp();$p();Yn=class extends f{getScript(){return Lp}async createManifest(r){return await Ap(r)}}});var Zn,Fp=a(()=>{"use strict";w();Zn=class extends d{}});var Qn,qp=a(()=>{"use strict";v();Qn=class extends g{getHint(){return location.pathname.startsWith("/programmes/")?location.pathname:null}getCurtain(){return document.querySelector("#html5-player")}}});var ib={};var Up=a(()=>{"use strict";b();Ep();zp();Fp();qp();h({Fetcher:Kn,Injecter:Yn,Renderer:Zn,Watcher:Qn})});var tr,Hp=a(()=>{"use strict";x();tr=class extends m{}});var Vp,_p=a(()=>{"use strict";Vp=function(){let r=n=>{let o={name:"manifest",args:n};window.postMessage(o,location.origin)},t=()=>{let n;try{n=window.jwplayer().getCaptionsList().find(l=>l.id.endsWith(".vtt")).id}catch{n=null}return{key:n,args:{subtitle:n}}},e={key:null};setInterval(()=>{let n=t();n.key!==e.key&&(r(n.args),e=n)},3e3)}.toString()});var Gp,Jp=a(()=>{"use strict";N();Gp=async r=>{let t="",e=[];if(r.subtitle!==null){let n="en",o=y(n),s=r.subtitle;e.push({name:o,code:n,url:s})}return{movieId:t,items:e}}});var er,Bp=a(()=>{"use strict";S();_p();Jp();er=class extends f{getScript(){return Vp}async createManifest(r){return await Gp(r)}}});var nr,Xp=a(()=>{"use strict";w();nr=class extends d{}});var rr,Kp=a(()=>{"use strict";v();rr=class extends g{getHint(){return location.pathname.startsWith("/show/")?location.pathname:null}getCurtain(){return document.querySelector(".jwplayer")}}});var ab={};var Yp=a(()=>{"use strict";b();Hp();Bp();Xp();Kp();h({Fetcher:tr,Injecter:er,Renderer:nr,Watcher:rr})});var or,Zp=a(()=>{"use strict";x();or=class extends m{}});var Qp,tm=a(()=>{"use strict";Qp=function(){let r=n=>{let o={name:"manifest",args:n};window.postMessage(o,location.origin)},t=()=>{let n;try{n=window.jwplayer().getCaptionsList().find(l=>l.id.endsWith(".vtt")).id}catch{n=null}return{key:n,args:{subtitle:n}}},e={key:null};setInterval(()=>{let n=t();n.key!==e.key&&(r(n.args),e=n)},3e3)}.toString()});var em,nm=a(()=>{"use strict";N();em=async r=>{let t="",e=[];if(r.subtitle!==null){let n="en",o=y(n),s=r.subtitle;e.push({name:o,code:n,url:s})}return{movieId:t,items:e}}});var sr,rm=a(()=>{"use strict";S();tm();nm();sr=class extends f{getScript(){return Qp}async createManifest(r){return await em(r)}}});var ir,om=a(()=>{"use strict";w();ir=class extends d{}});var ar,sm=a(()=>{"use strict";v();ar=class extends g{getHint(){return location.pathname.startsWith("/video/")?location.pathname:null}getCurtain(){return document.querySelector(".jwplayer")}}});var cb={};var im=a(()=>{"use strict";b();Zp();rm();om();sm();h({Fetcher:or,Injecter:sr,Renderer:ir,Watcher:ar})});var cr,am=a(()=>{"use strict";x();cr=class extends m{}});var cm,lm=a(()=>{"use strict";cm=function(){let r=n=>{let o={name:"manifest",args:n};window.postMessage(o,location.origin)},t=()=>{let n=window.player?.mediainfo?.textTracks??null;return{key:n,args:{subtitles:n??[]}}},e={key:null};setInterval(()=>{let n=t();n.key!==e.key&&(r(n.args),e=n)},3e3)}.toString()});var lb,um,pm=a(()=>{"use strict";N();lb=r=>{let t={},e=[];for(let n of r.subtitles){if(n.srclang===null)continue;let o=n.src,s=n.srclang,i=n.label,c=t[s]??0;e.push({url:o,language:s,label:i,variant:c}),t[s]=c+1}return e},um=async r=>{let t=lb(r),e="",n=[];for(let o of t){let s=o.language,i=y(s),c=o.url,{variant:l}=o;l>0&&(s=`${s}.var${l}`,i=`${i} (Var ${l})`),n.push({name:i,code:s,url:c})}return{movieId:e,items:n}}});var lr,mm=a(()=>{"use strict";S();lm();pm();lr=class extends f{getScript(){return cm}async createManifest(r){return await um(r)}}});var ur,fm=a(()=>{"use strict";w();ur=class extends d{}});var pr,dm=a(()=>{"use strict";v();pr=class extends g{getCurtain(){return document.querySelector(".Player__video")}}});var ub={};var gm=a(()=>{"use strict";b();am();mm();fm();dm();h({Fetcher:cr,Injecter:lr,Renderer:ur,Watcher:pr})});var mr,hm=a(()=>{"use strict";x();mr=class extends m{}});var ym,bm=a(()=>{"use strict";ym=function(){let r=n=>{let o={name:"manifest",args:n};window.postMessage(o,location.origin)},t=()=>{let o=document.querySelector(".videoPlayer")?.player?.mediainfo?.textTracks??null;return{key:o,args:{subtitles:o??[]}}},e={key:null};setInterval(()=>{let n=t();n.key!==e.key&&(r(n.args),e=n)},3e3)}.toString()});var pb,xm,Sm=a(()=>{"use strict";N();pb=r=>{let t={},e=[];for(let n of r.subtitles){if(n.srclang===null)continue;let o=n.src.replace("http://","https://"),s=n.srclang,i=n.label,c=t[s]??0;e.push({url:o,language:s,label:i,variant:c}),t[s]=c+1}return e},xm=async r=>{let t=pb(r),e="",n=[];for(let o of t){let s=o.language,i=y(s),c=o.url,{variant:l}=o;l>0&&(s=`${s}.var${l}`,i=`${i} (Var ${l})`),n.push({name:i,code:s,url:c})}return{movieId:e,items:n}}});var fr,wm=a(()=>{"use strict";S();bm();Sm();fr=class extends f{getScript(){return ym}async createManifest(r){return await xm(r)}}});var dr,vm=a(()=>{"use strict";w();dr=class extends d{}});var gr,Mm=a(()=>{"use strict";v();gr=class extends g{getCurtain(){return document.querySelector(".videoPlayer")}}});var mb={};var Im=a(()=>{"use strict";b();hm();wm();vm();Mm();h({Fetcher:mr,Injecter:fr,Renderer:dr,Watcher:gr})});var hr,km=a(()=>{"use strict";x();hr=class extends m{}});var jm,Tm=a(()=>{"use strict";jm=function(){let r=n=>{let o={name:"manifest",args:n};window.postMessage(o,location.origin)};{let n=document.createElement("style");n.textContent=".dualsub-renderer .content { margin-top: revert; }",document.head.appendChild(n)}let t=()=>{let n=window.player?.resource?.location?.textTrackUrl??null;return{key:n,args:{subtitle:n}}},e={key:null};setInterval(()=>{let n=t();n.key!==e.key&&(r(n.args),e=n)},3e3)}.toString()});var Cm,Rm=a(()=>{"use strict";N();Cm=async r=>{let t="",e=[];if(r.subtitle!==null){let n="en",o=y(n),s=r.subtitle;e.push({name:o,code:n,url:s})}return{movieId:t,items:e}}});var yr,Nm=a(()=>{"use strict";S();Tm();Rm();yr=class extends f{getScript(){return jm}async createManifest(r){return await Cm(r)}}});var br,Pm=a(()=>{"use strict";w();br=class extends d{}});var xr,Om=a(()=>{"use strict";v();xr=class extends g{getCurtain(){return document.querySelector("#avia-player-show")}}});var fb={};var Dm=a(()=>{"use strict";b();km();Nm();Pm();Om();h({Fetcher:hr,Injecter:yr,Renderer:br,Watcher:xr})});var Sr,Em=a(()=>{"use strict";x();Sr=class extends m{}});var Lm,Wm=a(()=>{"use strict";Lm=function(){let r=n=>{let o={name:"manifest",args:n};window.postMessage(o,location.origin)},t=()=>{let n=location.pathname.match("/programs/(.+?)/play"),o=n?n[1]:null;return{key:o,args:{videoId:o}}},e={key:null};setInterval(()=>{let n=t();n.key!==e.key&&(r(n.args),e=n)},3e3)}.toString()});var db,gb,Am,$m=a(()=>{"use strict";N();db={eng:"en"},gb=async r=>{let t=r.videoId;if(t===null)return[];let e=`https://api.stan.com.au/cat/v12/programs/${t}.json`,o=(await(await fetch(e)).json()).streams?.hd?.vtt??null;if(o===null)return[];let s=[];for(let[i,c]of Object.entries(o)){let l=c.url,u=db[i];u!==void 0&&s.push({url:l,code:u})}return s},Am=async r=>{let t=await gb(r),e="",n=[];for(let o of t){let s=o.code,i=y(s),c=o.url;n.push({name:i,code:s,url:c})}return{movieId:e,items:n}}});var wr,zm=a(()=>{"use strict";S();Wm();$m();wr=class extends f{getScript(){return Lm}async createManifest(r){return await Am(r)}}});var vr,Fm=a(()=>{"use strict";w();vr=class extends d{}});var Mr,qm=a(()=>{"use strict";v();Mr=class extends g{getHint(){return location.pathname.includes("/play")?location.pathname:null}getCurtain(){return document.querySelector(".clpp-container")}}});var hb={};var Um=a(()=>{"use strict";b();Em();zm();Fm();qm();h({Fetcher:Sr,Injecter:wr,Renderer:vr,Watcher:Mr})});var Ir,Hm=a(()=>{"use strict";O();x();Ir=class extends m{async parse(r,t){return t.startsWith("WEBVTT")?q(t):J(t)}}});var Vm,_m=a(()=>{"use strict";Vm=function(){let r=async e=>{let n={name:"manifest",args:e};window.postMessage(n,location.origin)},t=null;setInterval(()=>{let n=document.querySelector("rai-player")?.videoItemJson.video??null;n!==t&&(r(n),t=n)},3e3)}.toString()});var yb,bb,xb,Gm,Jm=a(()=>{"use strict";yb={caption_ita:"it",caption_eng:"en"},bb=async r=>{let t=[];for(let e of r.subtitlesArray){let n=e.language,o=e.label,s=`${location.origin}${e.url}`;t.push({language:n,label:o,url:s})}return t},xb=async r=>{let t=r.content_url.replace("http://","https://"),e=await fetch(t);if(e.url.endsWith(".mp4"))return[];let n=await e.text(),o=await(await fetch(n)).text(),i=new DOMParser().parseFromString(o,"application/xml").querySelectorAll('AdaptationSet[mimeType="text/vtt"]'),c=[];for(let l of i){let u=l.getAttribute("lang"),p=l.querySelector("Representation").getAttribute("id"),I=l.querySelector("SegmentTemplate").getAttribute("media"),k=yb[p];k&&c.push({language:k,label:u,url:I})}return c},Gm=async r=>{let t=await bb(r);t.length===0&&(t=await xb(r));let e="",n=[];for(let o of t){let s=o.language,i=o.label,c=o.url;n.push({name:i,code:s,url:c})}return{movieId:e,items:n}}});var kr,Bm=a(()=>{"use strict";S();_m();Jm();kr=class extends f{getScript(){return Vm}async createManifest(r){return await Gm(r)}}});var jr,Xm=a(()=>{"use strict";w();jr=class extends d{}});var Tr,Km=a(()=>{"use strict";v();Tr=class extends g{getHint(){return location.pathname.startsWith("/video/")?location.pathname:null}getCurtain(){return document.querySelector(".theoplayer-container")}}});var Sb={};var Ym=a(()=>{"use strict";b();Hm();Bm();Xm();Km();h({Fetcher:Ir,Injecter:kr,Renderer:jr,Watcher:Tr})});var Cr,Zm=a(()=>{"use strict";$();x();Cr=class extends m{async createSubtitleUrls(r){let t=r.url,e=await this.fetch(r,t),n=P(t);return e.split(`
`).map(o=>o.trim()).filter(o=>o.endsWith(".vtt")).map(o=>`${n}${o}`)}}});var Qm,tf=a(()=>{"use strict";Qm=function(){let r=async e=>{let n={name:"manifest",args:e};window.postMessage(n,location.origin)},t=location.pathname.match("/(.+?)/videos/(.+?)/");if(t){let e=t[1],n=t[2],o=`https://api.arte.tv/api/player/v2/config/${e}/${n}`;r({id:n,url:o})}}.toString()});var wb,ef,nf=a(()=>{"use strict";$();Ct();wb=async r=>{let t=await(await fetch(r.url)).text(),e=Q(t);if(e.length===0)return null;let n=e[0],o=r.versions[0].label,s=n.language,c=`${P(r.url)}${n.uri}`;return{name:o,code:s,url:c}},ef=async r=>{let t=r.url,n=(await(await fetch(t)).json()).data.attributes.streams,o="",s=[];for(let i of n){let c=await wb(i);c&&s.push(c)}return{movieId:o,items:s}}});var Rr,rf=a(()=>{"use strict";S();tf();nf();Rr=class extends f{getScript(){return Qm}async createManifest(r){return await ef(r)}}});var Nr,of=a(()=>{"use strict";w();Nr=class extends d{}});var Pr,sf=a(()=>{"use strict";v();Pr=class extends g{getHint(){return location.pathname.includes("/videos/")?location.pathname:null}getCurtain(){return document.querySelector(".isDefaultMode")}}});var vb={};var af=a(()=>{"use strict";b();Zm();rf();of();sf();h({Fetcher:Cr,Injecter:Rr,Renderer:Nr,Watcher:Pr})});var Or,cf=a(()=>{"use strict";x();Or=class extends m{}});var lf,uf=a(()=>{"use strict";lf=function(){let r=async e=>{if(!e?.request)return;let n={name:"manifest",args:e};window.postMessage(n,location.origin)},t="";setInterval(async function(){let e=document.querySelector("div[data-config-url]");if(e===null||e.id===t)return;t=e.id;let n=e.dataset.configUrl,o=await(await fetch(n)).json();r(o)},3e3)}.toString()});var pf,mf=a(()=>{"use strict";pf=async r=>{let t=r.request.text_tracks??[],e="",n=[];for(let o of t){let s=o.label,i=o.lang,c=o.url;n.push({name:s,code:i,url:c})}return{movieId:e,items:n}}});var Dr,ff=a(()=>{"use strict";S();uf();mf();Dr=class extends f{getScript(){return lf}async createManifest(r){return await pf(r)}}});var Er,df=a(()=>{"use strict";w();Er=class extends d{}});var Lr,gf=a(()=>{"use strict";v();Lr=class extends g{getHint(){return location.pathname.match("/[0-9]+")?location.pathname:null}getCurtain(){return document.querySelector(".player_area")}}});var Mb={};var hf=a(()=>{"use strict";b();cf();ff();df();gf();h({Fetcher:Or,Injecter:Dr,Renderer:Er,Watcher:Lr})});var Wr,yf=a(()=>{"use strict";O();x();Wr=class extends m{async parse(r,t){return J(t)}}});var bf,xf=a(()=>{"use strict";bf=function(){let r=async e=>{let n={name:"manifest",args:e};window.postMessage(n,location.origin)},t=null;setInterval(()=>{let e=document.querySelector(".VODPlayer");if(e===null)return;let n=null;for(let[s,i]of Object.entries(e))if(s.startsWith("__reactInternalInstance$")){n=i;break}let o=n?.child?.memoizedProps?.playlist[0]??null;if(o!==t){let s={tracks:o.tracks};r(s),t=o}},3e3)}.toString()});var Ib,Sf,wf=a(()=>{"use strict";N();Ib={Chinese:"zh-hant",English:"en",German:"de",Spanish:"es",French:"fr",Italian:"it",Japanese:"ja"},Sf=async r=>{let t=r.tracks??[],e="",n=[];for(let o of t){let s=Ib[o.text];if(!s)continue;let i=y(s),c=o.file;n.push({name:i,code:s,url:c})}return{movieId:e,items:n}}});var Ar,vf=a(()=>{"use strict";S();xf();wf();Ar=class extends f{getScript(){return bf}async createManifest(r){return await Sf(r)}}});var $r,Mf=a(()=>{"use strict";w();$r=class extends d{}});var zr,If=a(()=>{"use strict";v();zr=class extends g{getHint(){return location.pathname.startsWith("/encore/")?location.pathname:null}getCurtain(){return document.querySelector(".fullscreen")}}});var kb={};var kf=a(()=>{"use strict";b();yf();vf();Mf();If();h({Fetcher:Wr,Injecter:Ar,Renderer:$r,Watcher:zr})});var Fr,jf=a(()=>{"use strict";O();x();Fr=class extends m{async parse(r,t){return J(t)}}});var Tf,Cf=a(()=>{"use strict";Tf=function(){let r=async e=>{if(!e?.data?.program?.stl)return;let n={name:"manifest",args:e};window.postMessage(n,location.origin)},t=null;setInterval(()=>{let n=window.playerObject?.package?.engine?.movieinfo?.current?.originalData??null;n!==t&&(r(n),t=n)},3e3)}.toString()});var jb,Rf,Nf=a(()=>{"use strict";jb={1:"zh-hans",2:"zh-hant",3:"en",4:"ko",18:"th",21:"ms",23:"vi",24:"id",26:"es",28:"ar"},Rf=async r=>{let t=r.data.program.stl,e="https://meta.video.iqiyi.com",n="",o=[];for(let s of t){let i=s._name,c=jb[s.lid];if(!c)continue;let l=`${e}/${s.srt}`;o.push({name:i,code:c,url:l})}return{movieId:n,items:o}}});var qr,Pf=a(()=>{"use strict";S();Cf();Nf();qr=class extends f{getScript(){return Tf}async createManifest(r){return await Rf(r)}}});var Ur,Of=a(()=>{"use strict";w();Ur=class extends d{}});var Hr,Df=a(()=>{"use strict";v();Hr=class extends g{getHint(){return location.pathname.startsWith("/play/")?location.pathname:null}getCurtain(){return document.querySelector(".iqp-player")}}});var Tb={};var Ef=a(()=>{"use strict";b();jf();Pf();Of();Df();h({Fetcher:Fr,Injecter:qr,Renderer:Ur,Watcher:Hr})});var Vr,Lf=a(()=>{"use strict";x();Vr=class extends m{}});var Wf,Af=a(()=>{"use strict";Wf=function(){let r=n=>{let o={name:"manifest",args:n};window.postMessage(o,location.origin)},t=()=>{let o=window.player?.plugins?.ctrlbar?.playData?.subtitleList??null;return{key:o,args:{subtitles:o}}},e={key:null};setInterval(()=>{let n=t();n.key!==e.key&&(r(n.args),e=n)},3e3)}.toString()});var $f,zf=a(()=>{"use strict";$f=async r=>{let t="",e=[];for(let n of r.subtitles){let o=n.lang,s=n.name,i=n.url.replace(".m3u8","");e.push({name:s,code:o,url:i})}return{movieId:t,items:e}}});var _r,Ff=a(()=>{"use strict";S();Af();zf();_r=class extends f{getScript(){return Wf}async createManifest(r){return await $f(r)}}});var Gr,qf=a(()=>{"use strict";w();Gr=class extends d{}});var Jr,Uf=a(()=>{"use strict";v();Jr=class extends g{getHint(){return location.pathname.includes("/play/")?location.pathname:null}getCurtain(){return document.querySelector("#player-wrapper")}}});var Cb={};var Hf=a(()=>{"use strict";b();Lf();Ff();qf();Uf();h({Fetcher:Vr,Injecter:_r,Renderer:Gr,Watcher:Jr})});var Br,Vf=a(()=>{"use strict";O();x();Br=class extends m{async parse(r,t){return Po(t)}}});var _f,Gf=a(()=>{"use strict";_f=function(){let r=async e=>{if(!e?.data?.subtitle?.subtitles)return;let n={name:"manifest",args:e};window.postMessage(n,location.origin)},t=JSON.parse;JSON.parse=e=>{let n=t(e);return r(n),n}}.toString()});var Jf,Bf=a(()=>{"use strict";Jf=async r=>{let t=r.data.subtitle.subtitles,e="",n=[];for(let o of t){let s=o.lan_doc,i=o.lan;i.startsWith("ai-")&&(i=i.replace("ai-",""),i=`${i}.ai`);let c=o.subtitle_url;n.push({name:s,code:i,url:c})}return{movieId:e,items:n}}});var Xr,Xf=a(()=>{"use strict";S();Gf();Bf();Xr=class extends f{getScript(){return _f}async createManifest(r){return await Jf(r)}}});var Kr,Kf=a(()=>{"use strict";w();Kr=class extends d{}});var Yr,Yf=a(()=>{"use strict";v();Yr=class extends g{getHint(){if(location.pathname.startsWith("/bangumi/"))return location.pathname;if(!location.pathname.startsWith("/video/"))return null;let r=new URL(location.href).searchParams.get("p");return r!==null?`${location.pathname}?p=${r}`:location.pathname}getCurtain(){return location.pathname.startsWith("/bangumi/")?document.querySelector(".bpx-player-container"):document.querySelector("#bilibiliPlayer")}}});var Rb={};var Zf=a(()=>{"use strict";b();Vf();Xf();Kf();Yf();h({Fetcher:Br,Injecter:Xr,Renderer:Kr,Watcher:Yr})});var Zr,Qf=a(()=>{"use strict";x();Zr=class extends m{}});var td,ed=a(()=>{"use strict";td=function(){let r=n=>{let o={name:"manifest",args:n};window.postMessage(o,location.origin)},t=()=>{let n=window.subtitleTrack??null,o=[];return n!==null&&o.push(n),{key:n,args:{subtitles:o}}},e={key:null};setInterval(()=>{let n=t();n.key!==e.key&&(r(n.args),e=n)},3e3)}.toString()});var nd,rd=a(()=>{"use strict";nd=async r=>{let t="",e=[];for(let n of r.subtitles){let o=n.lang,s=n.label,i=n.url;e.push({name:s,code:o,url:i})}return{movieId:t,items:e}}});var Qr,od=a(()=>{"use strict";S();ed();rd();Qr=class extends f{getScript(){return td}async createManifest(r){return await nd(r)}}});var to,sd=a(()=>{"use strict";w();to=class extends d{}});var eo,id=a(()=>{"use strict";v();eo=class extends g{getCurtain(){return document.querySelector(".playVideo")}}});var Nb={};var ad=a(()=>{"use strict";b();Qf();od();sd();id();h({Fetcher:Zr,Injecter:Qr,Renderer:to,Watcher:eo})});var Pb,no,cd=a(()=>{"use strict";O();$();x();Pb=r=>{let t=r.dialogues;for(let e of t)e.start+=3e3},no=class extends m{async createSubtitleUrls(r){let t=r.url,e=await this.fetch(r,t),n=P(t);return e.split(`
`).map(o=>o.trim()).filter(o=>o.endsWith(".vtt")).filter(o=>!o.includes("DUB_CARD")).map(o=>`${n}${o}`)}async createSubtitle(r){let t=await this.createSubtitleUrls(r),e=[];for(let o of t){let s=await this.fetch(r,o),i=await this.parse(r,s);e.push(...i.dialogues)}let n=new T(e);return t[0]?.includes("BUMPER")&&Pb(n),n}}});var ld,ud=a(()=>{"use strict";ld=function(){let r=o=>{let s={name:"manifest",args:o};window.postMessage(s,location.origin)},t=o=>{if(o!==null){for(let[s,i]of Object.entries(o))if(s.startsWith("__reactInternalInstance$"))return i}return null},e=()=>{let o=document.querySelector(".hudson-container"),i=t(o)?.child?.child?.child?.memoizedProps?.mediaResource?.resourceUri??null;return{key:i,args:{indexUrl:i}}},n={key:null};setInterval(()=>{let o=e();o.key!==n.key&&(r(o.args),n=o)},3e3)}.toString()});var Ob,pd,md=a(()=>{"use strict";$();Ct();Ob=async r=>{let t=r.indexUrl;if(t===null)return[];let e=await(await fetch(t)).text(),n=Q(e),o=P(t),s=[];for(let i of n){if(i.forced)continue;let c=`${o}${i.uri}`,l=i.language,u=i.name;s.push({url:c,code:l,name:u})}return s},pd=async r=>{let t=await Ob(r),e="",n=[];for(let o of t){let s=o.code,i=o.name,c=o.url;n.push({name:i,code:s,url:c})}return{movieId:e,items:n}}});var ro,fd=a(()=>{"use strict";S();ud();md();ro=class extends f{getScript(){return ld}async createManifest(r){return await pd(r)}}});var oo,dd=a(()=>{"use strict";w();oo=class extends d{}});var so,gd=a(()=>{"use strict";v();so=class extends g{getHint(){return location.pathname.includes("/video/")?location.pathname:null}getCurtain(){return document.querySelector("#app_body_content")}}});var Db={};var hd=a(()=>{"use strict";b();cd();fd();dd();gd();h({Fetcher:no,Injecter:ro,Renderer:oo,Watcher:so})});var io,yd=a(()=>{"use strict";x();io=class extends m{}});var bd,xd=a(()=>{"use strict";bd=function(){let r=n=>{let o={name:"manifest",args:n};window.postMessage(o,location.origin)};{let n=document.createElement("style");n.textContent=".dualsub-renderer .content { position: relative !important; font-size: revert; }",document.head.appendChild(n)}let t=()=>{let n=window.RTVE?.rtvePlayer?.video?.tech_?.remoteTextTrackEls_?.trackElements_??[],o=[];for(let c of n){let l=c.src??null,u=c.label??"";l!==null&&u!==""&&o.push({src:l,label:u})}return{key:o[0]?.src??null,args:{subtitles:o}}},e={key:null};setInterval(()=>{let n=t();n.key!==e.key&&(r(n.args),e=n)},3e3)}.toString()});var Sd,wd=a(()=>{"use strict";N();Sd=async r=>{let t="",e=[];for(let n of r.subtitles){let o=n.label,s=y(o),i=n.src;e.push({name:s,code:o,url:i})}return{movieId:t,items:e}}});var ao,vd=a(()=>{"use strict";S();xd();wd();ao=class extends f{getScript(){return bd}async createManifest(r){return await Sd(r)}}});var co,Md=a(()=>{"use strict";w();co=class extends d{}});var lo,Id=a(()=>{"use strict";v();lo=class extends g{getHint(){return location.pathname.includes("/videos/")?location.pathname:null}getCurtain(){return document.querySelector("#myPlayer")}}});var Eb={};var kd=a(()=>{"use strict";b();yd();vd();Md();Id();h({Fetcher:io,Injecter:ao,Renderer:co,Watcher:lo})});var uo,jd=a(()=>{"use strict";x();uo=class extends m{}});var Td,Cd=a(()=>{"use strict";Td=function(){window.DUALSUB_INSTALLED=!0}.toString()});var Rd,Nd=a(()=>{"use strict";Rd=async r=>{let t="",e=r.items;return{movieId:t,items:e}}});var po,Pd=a(()=>{"use strict";S();Cd();Nd();po=class extends f{getScript(){return Td}async createManifest(r){return await Rd(r)}}});var mo,Od=a(()=>{"use strict";w();mo=class extends d{}});var fo,Dd=a(()=>{"use strict";v();fo=class extends g{getCurtain(){return document.querySelector(".video-container")}}});var Lb={};var Ed=a(()=>{"use strict";b();jd();Pd();Od();Dd();h({Fetcher:uo,Injecter:po,Renderer:mo,Watcher:fo})});xo();var M=Rt(location.href);globalThis!==window&&(globalThis.fetch=globalThis.content.fetch);M==="youtube"&&Promise.resolve().then(()=>(Da(),gy));M==="netflix"&&Promise.resolve().then(()=>(Ua(),xy));M==="disneyplus"&&Promise.resolve().then(()=>(Ya(),wy));M==="primevideo"&&Promise.resolve().then(()=>(ic(),Iy));M==="paramountplus"&&Promise.resolve().then(()=>(gc(),jy));M==="amcplus"&&Promise.resolve().then(()=>(Ic(),Ty));M==="peacocktv"&&Promise.resolve().then(()=>(Dc(),Cy));M==="starz"&&Promise.resolve().then(()=>(Uc(),Ry));M==="hulu"&&Promise.resolve().then(()=>(Yc(),Ny));M==="hbomax"&&Promise.resolve().then(()=>(il(),Ey));M==="frndlytv"&&Promise.resolve().then(()=>(gl(),Ly));M==="hmnow"&&Promise.resolve().then(()=>(Il(),Wy));M==="viki"&&Promise.resolve().then(()=>(Dl(),Ay));M==="funimation"&&Promise.resolve().then(()=>(Ul(),$y));M==="coupangplay"&&Promise.resolve().then(()=>(Yl(),zy));M==="hotstar"&&Promise.resolve().then(()=>(iu(),Vy));M==="coursera"&&Promise.resolve().then(()=>(gu(),Gy));M==="udemy"&&Promise.resolve().then(()=>(Iu(),Jy));M==="ted"&&Promise.resolve().then(()=>(Du(),Ky));M==="ard"&&Promise.resolve().then(()=>(Uu(),Zy));M==="zdf"&&Promise.resolve().then(()=>(Yu(),eb));M==="bbciplayer"&&Promise.resolve().then(()=>(ip(),nb));M==="britbox"&&Promise.resolve().then(()=>(gp(),rb));M==="britboxcom"&&Promise.resolve().then(()=>(Ip(),ob));M==="itv"&&Promise.resolve().then(()=>(Dp(),sb));M==="channel4"&&Promise.resolve().then(()=>(Up(),ib));M==="channel5"&&Promise.resolve().then(()=>(Yp(),ab));M==="abciview"&&Promise.resolve().then(()=>(im(),cb));M==="7plus"&&Promise.resolve().then(()=>(gm(),ub));M==="9now"&&Promise.resolve().then(()=>(Im(),mb));M==="10play"&&Promise.resolve().then(()=>(Dm(),fb));M==="stan"&&Promise.resolve().then(()=>(Um(),hb));M==="raiplay"&&Promise.resolve().then(()=>(Ym(),Sb));M==="arte"&&Promise.resolve().then(()=>(af(),vb));M==="vimeo"&&Promise.resolve().then(()=>(hf(),Mb));M==="viutv"&&Promise.resolve().then(()=>(kf(),kb));M==="iqiyiint"&&Promise.resolve().then(()=>(Ef(),Tb));M==="wetv"&&Promise.resolve().then(()=>(Hf(),Cb));M==="bilibili"&&Promise.resolve().then(()=>(Zf(),Rb));M==="magellantv"&&Promise.resolve().then(()=>(ad(),Nb));M==="starplus"&&Promise.resolve().then(()=>(hd(),Db));M==="rtveplay"&&Promise.resolve().then(()=>(kd(),Eb));M==="player"&&Promise.resolve().then(()=>(Ed(),Lb));
