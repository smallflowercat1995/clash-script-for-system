var s=window.React;var Ae=window.ReactDOM;var tt=crypto.getRandomValues(new Uint32Array(1))[0].toString(36),Oe=0,nt=r=>(Oe+=1,`jss-${tt}-${Oe}-${r}`),st=(r,i)=>{for(let e of["","-webkit-","-moz-"]){let t=`${e}${r}`;if(CSS.supports(t,i))return[t,i]}return[r,i]},rt=(r,i)=>{for(let e of["","-webkit-","-moz-"]){let t=`${e}${i}`;if(CSS.supports(r,t))return[r,t]}return[r,i]},it=(r,i)=>r==="appearance"||r==="text-stroke"||r==="user-select"?st(r,i):i==="fit-content"?rt(r,i):[r,i],be=class{constructor(i){this.style=i,this.entries=[];for(let[e,t]of Object.entries(this.style))this.entries.push(this.createEntry(e,t));this.classes={};for(let e of this.entries)e.className!==""&&(this.classes[e.styleKey]=e.className);this.text=this.entries.map(e=>e.styleText).join(`
`),this.node=document.createElement("style"),this.node.textContent=this.text}createEntry(i,e){let t,n;i==="@global"?(t="",n=""):(t=nt(i),n=`.${t}`);let o=[];this.createRuleItem(n,e,o);let a=[];for(let[d,c]of o)Object.keys(c).length>0&&a.push(this.createRuleText(d,c));let p=a.join(`
`);return{styleKey:i,styleValue:e,styleText:p,className:t}}createRuleItem(i,e,t){let n=i,o={};t.push([n,o]);for(let[a,p]of Object.entries(e))if(typeof p=="object"&&!Array.isArray(p)){let d=a.replace(/&/g,n);this.createRuleItem(d,p,t)}else o[a]=p}createRuleText(i,e){let t=[`${i} {`];for(let[n,o]of Object.entries(e))n=n.replace(/[A-Z]/g,a=>`-${a.toLowerCase()}`),Array.isArray(o)&&(o=o.join(", ")),[n,o]=it(n,String(o)),t.push(`    ${n}: ${o};`);return t.push("}"),t.join(`
`)}attach(){return this.node.isConnected||document.head.appendChild(this.node),this}remove(){this.node.isConnected&&this.node.remove()}toString(){return this.text}},ot=r=>new be(r),at=r=>{r.remove()},Le=CSS.supports("-moz-appearance","none"),Me=CSS.supports("-webkit-appearance","-apple-pay-button"),pt=navigator.standalone!==void 0,lt=(r,i)=>Le||Me?{textStroke:r,paintOrder:"stroke"}:{position:"relative",zIndex:0,"&:before":{position:"absolute",left:"0",right:"0",zIndex:-1,content:`attr(${i})`,textStroke:r}},m={createStyleSheet:ot,removeStyleSheet:at,createTextStroke:lt,platform:{firefox:Le,safari:Me,ios:pt}};function V({name:r,size:i,className:e}){return e=["material-icons-outlined",e].join(" ").trim(),i=`${i}px`,s.createElement("i",{className:e,style:{fontSize:i,width:i,height:i}},r)}var{classes:ct}=m.createStyleSheet({ul:{margin:0,padding:"0 8px",borderBottom:"1px solid #ccc"},li:{display:"inline-block",marginBottom:"-1px"},label:{background:"#fff",borderBottom:"1px solid #ccc",borderLeft:"1px solid #fff",borderRight:"1px solid #fff",borderTop:"1px solid #fff",cursor:"default",fontSize:"14px",lineHeight:"16px",padding:"6px 12px",userSelect:"none"},value:{borderBottom:"1px solid #fff",borderLeft:"1px solid #ccc",borderRight:"1px solid #ccc",borderTop:"1px solid #333"},icon:{float:"left",marginRight:"6px"}}).attach(),{classes:dt}=m.createStyleSheet({ul:{margin:0,padding:"0 8px",borderTop:"1px solid #ccc"},li:{display:"inline-block",marginTop:"-1px"},label:{background:"#fff",borderBottom:"1px solid #fff",borderLeft:"1px solid #fff",borderRight:"1px solid #fff",borderTop:"1px solid #ccc",cursor:"default",fontSize:"14px",lineHeight:"16px",padding:"6px 12px",userSelect:"none"},value:{borderBottom:"1px solid #333",borderLeft:"1px solid #ccc",borderRight:"1px solid #ccc",borderTop:"1px solid #fff"},icon:{float:"left",marginRight:"6px"}}).attach(),{classes:ut}=m.createStyleSheet({ul:{margin:0,padding:"8px 0",width:"max-content",borderRight:"1px solid #ccc"},li:{display:"block",marginRight:"-1px"},label:{background:"#fff",borderBottom:"1px solid #fff",borderLeft:"1px solid #fff",borderRight:"1px solid #ccc",borderTop:"1px solid #fff",cursor:"default",fontSize:"14px",lineHeight:"16px",padding:"6px 12px",textAlign:"right",userSelect:"none"},value:{borderBottom:"1px solid #ccc",borderLeft:"1px solid #333",borderRight:"1px solid #fff",borderTop:"1px solid #ccc"},icon:{float:"left",marginRight:"6px"}}).attach(),mt={bottom:dt,left:ut,top:ct},I=class extends s.PureComponent{constructor(){super(...arguments);this.handleOnClick=e=>()=>{this.props.onChange&&this.props.onChange(e.value)};this.renderChild=(e,t)=>{let n=this.getClasses(),o=n.label;return e.value===this.props.value&&(o=`${o} ${n.value}`),s.createElement("li",{className:n.li,key:t},s.createElement("div",{className:o,onClick:this.handleOnClick(e)},e.icon&&s.createElement(V,{className:n.icon,name:e.icon,size:"16"}),s.createElement("span",null,e.label)))};this.renderChildren=()=>this.props.schema.items.map(this.renderChild)}getClasses(){return mt[this.props.position??"top"]}render(){let e=this.getClasses(),t=this.props.className;return t=[e.ul,t].join(" ").trim(),s.createElement("ul",{className:t},this.renderChildren())}};var Pe="https://www.dualsub.xyz/",Ee="https://www.dualsub.xyz/quickstart.html",Ve="https://www.dualsub.xyz/feedback.html",Ie="https://www.dualsub.xyz/changelog.html";var{classes:ht}=m.createStyleSheet({root:{position:"absolute",top:"8px",right:"8px",fontSize:"14px",lineHeight:"30px"}}).attach(),B=class extends s.PureComponent{renderLink(i,e){return s.createElement("a",{href:i,rel:"noreferrer",target:"_blank"},e)}renderLinkSettings(){let i=this.props.i18ns.popup;return s.createElement("a",{href:"",onClick:t=>{t.preventDefault(),this.props.agent.settings()}},i.settings)}render(){let i=this.props.i18ns.popup;return s.createElement("div",{className:ht.root},this.renderLink(Ee,i.tutorial),s.createElement("span",null," "),this.renderLinkSettings())}};var gt=r=>m.platform.firefox?(r.border="1px solid #8f8f9d",r.borderRadius="2px",r.backgroundColor="#fff",r):(m.platform.safari&&(m.platform.ios?(r.borderRadius="5px",r.border="1px solid -apple-system-secondary-label",r.color="#000",r.backgroundColor="#fff"):r.border="1px solid #c0c0c0"),r),{classes:ft}=m.createStyleSheet({root:gt({boxSizing:"border-box",fontSize:"14px",height:"28px",padding:"2px 4px"})}).attach(),j=class extends s.PureComponent{constructor(){super(...arguments);this.handleOnChange=e=>{let t=e.target,n=parseInt(t.value),o=this.props.schema.items[n].value;this.props.onChange&&this.props.onChange(o)};this.renderChild=(e,t)=>{let{label:n,title:o}=e;return s.createElement("option",{key:t,value:t,title:o},n)};this.renderChildren=()=>{let{items:e,groups:t}=this.props.schema;if(t===void 0||t.length===0)return e.map(this.renderChild);let n=0,o=[];for(let[a,p]of t.entries()){let{label:d,count:c}=p,l=c>0?n+c:e.length,h=[];for(;n<l;)h.push(this.renderChild(e[n],n)),n+=1;d===""?o.push(s.createElement(s.Fragment,{key:a},h)):o.push(s.createElement("optgroup",{key:a,label:d},h))}return o}}render(){let e=this.props.className;e=[ft.root,e].join(" ").trim();let t=this.props.style,{schema:n,value:o}=this.props,a=n.items.findIndex(c=>c.value===o),p=null;a===-1?a=0:p=n.items[a].title;let d=this.props.disabled;return s.createElement("select",{className:e,style:t,value:a,disabled:d,title:p,onChange:this.handleOnChange},this.renderChildren())}};var U=class extends s.PureComponent{constructor(){super(...arguments);this.onChange=e=>t=>{let n={...this.props.value};n[e]=t,this.props.onChange(n,e)}}renderSelectFile(){let e=this.props.i18n,{value:t,schema:n}=this.props,o={items:[{label:`${e.close} (${n.files.length})`,value:""},...n.files]},a=t.file;return s.createElement(j,{schema:o,value:a,onChange:this.onChange("file")})}renderSelectTranslate(){let e=this.props.i18n,{value:t,schema:n}=this.props,o={items:[{label:`${e.close} (${n.translates.length})`,value:""},...n.translates]},a=t.translate;return s.createElement(j,{schema:o,value:a,onChange:this.onChange("translate")})}renderSelectLegend(){let e=this.props.i18n,{value:t,schema:n}=this.props,o={items:[{label:`${e.close} (${n.legends.length})`,value:""},...n.legends]},a=t.legend;return s.createElement(j,{schema:o,value:a,onChange:this.onChange("legend")})}render(){return s.createElement(s.Fragment,null,this.renderSelectFile(),this.renderSelectTranslate(),this.renderSelectLegend())}};var{classes:ce}=m.createStyleSheet({root:{display:"grid",gridAutoFlow:"row",gridColumnGap:"4px",gridRowGap:"4px","& > label":{fontSize:"14px",fontWeight:"bold",lineHeight:"20px",padding:"0 2px",whiteSpace:"nowrap"}},index:{fontSize:"14px",fontWeight:"bold",lineHeight:"28px",padding:"0 2px"},hideTranslate:{"& > *:nth-child(4n+3)":{display:"none"}},hideLegend:{"& > *:nth-child(4n+4)":{display:"none"}}}).attach(),q=class extends s.PureComponent{constructor(){super(...arguments);this.onChange=e=>(t,n)=>{let o=[...this.props.value];o[e]=t,this.props.onChange(o,[String(e),n])}}render(){let e=[ce.root],t=["min-content","minmax(0, 1fr)","minmax(0, 1fr)","minmax(0, 1fr)"];this.props.hideTranslate&&(e.push(ce.hideTranslate),t.pop()),this.props.hideLegend&&(e.push(ce.hideLegend),t.pop());let n=e.join(" "),o={gridTemplateColumns:t.join(" ")},a=this.props.i18n,p=this.props.schema,c=this.props.value.map((l,h)=>s.createElement(s.Fragment,{key:h},s.createElement("span",{className:ce.index},h+1),s.createElement(U,{i18n:a,schema:p,value:l,onChange:this.onChange(h)})));return s.createElement("div",{className:n,style:o},s.createElement("label",null),s.createElement("label",null,a.subtitleLanguage),s.createElement("label",null,a.machineTranslation),s.createElement("label",null,a.themeStyle),c)}};var{classes:yt}=m.createStyleSheet({notice:{fontSize:"14px",padding:"8px",border:"1px solid #ccc",borderLeftWidth:"4px",borderRadius:"4px",lineHeight:"20px","& .title":{fontWeight:"bold"}}}).attach(),K=class extends s.PureComponent{constructor(e){super(e);this.onChange=(e,t)=>{let n={menus:e},a={data:{schema:this.state.context.data.schema,value:n}};this.setState({context:a}),this.props.agent.change(n)};this.state={context:null}}componentDidMount(){this.load()}async load(){let e=await this.props.agent.initial();this.setState({context:e})}renderNoticeNodata(){let e=this.props.i18ns.popup;return s.createElement("div",{className:yt.notice},s.createElement("div",{className:"title"},e.nodataTitle),s.createElement("div",null,s.createElement("div",null,e.nodataLine0Tip),s.createElement("div",null,e.nodataLine1ModeStandard),s.createElement("div",null,e.nodataLine2Loading),s.createElement("div",null,e.nodataLine3Permission)))}render(){if(this.state.context===null)return null;let e=this.state.context.data;if(!e)return this.renderNoticeNodata();let t=this.props.i18ns.popup;return s.createElement(q,{i18n:t,schema:e.schema.menus,value:e.value.menus,onChange:this.onChange,hideTranslate:!1,hideLegend:!1})}};var{classes:bt}=m.createStyleSheet({notice:{fontSize:"14px",padding:"8px",border:"1px solid #ccc",borderLeftWidth:"4px",borderRadius:"4px",lineHeight:"20px","& .title":{fontWeight:"bold"}}}).attach(),W=class extends s.PureComponent{constructor(e){super(e);this.onChange=(e,t)=>{let n={menus:e},a={data:{schema:this.state.context.data.schema,value:n}};this.setState({context:a}),this.props.agent.change(n)};this.state={context:null}}componentDidMount(){this.load()}async load(){let e=await this.props.agent.initial();this.setState({context:e})}renderNoticeNodata(){let e=this.props.i18ns.popup;return s.createElement("div",{className:bt.notice},s.createElement("div",{className:"title"},e.nodataTitle),s.createElement("div",null,s.createElement("div",null,e.nodataLine0Tip),s.createElement("div",null,e.nodataLine1ModeSimple),s.createElement("div",null,e.nodataLine2Loading),s.createElement("div",null,e.nodataLine3Permission)))}render(){if(this.state.context===null)return null;let e=this.state.context.data;if(!e)return this.renderNoticeNodata();let t=this.props.i18ns.popup;return s.createElement(q,{i18n:t,schema:e.schema.menus,value:e.value.menus,onChange:this.onChange,hideTranslate:!1,hideLegend:!0})}};var de=(r,i)=>{let e=r.type;if(e==="string"||e==="number"||e==="boolean")return typeof i===e;if(e==="null")return i===null;if(e==="array")return Array.isArray(i);if(e==="object")return!(typeof i!="object"||i===null||Array.isArray(i));throw`invalid schema type: ${e}`},qe=(r,i)=>{let e=r.type;if(e==="string"||e==="number"||e==="boolean"){r=r,i!==void 0&&r.enum!==void 0&&(r.enum.includes(i)||(i=void 0));let t=!1;if(i!==void 0&&(t=de(r,i)),t||(i=r.default,i!==void 0&&(t=de(r,i))),e==="string")return t?i:"";if(e==="number")return t?i:0;if(e==="boolean")return t?i:!1}if(e==="null")return null;if(e==="array")return[];if(e==="object")return{};throw`invalid schema type: ${e}`},xt=(r,i)=>{let e=r.type;if(e==="string"||e==="number"||e==="boolean")return qe(r)===i;if(e==="null")return!0;if(e==="array")return i.length===0;if(e==="object")return Object.keys(i).length===0;throw`invalid schema type: ${e}`};function Q(r,i,e){let t=i.type;if(t==="string"||t==="number"||t==="boolean")return qe(i,e);if(t==="null")return null;if(t==="array"){if(i=i,i.items===void 0)return[];de(i,e)||(e=[]);let n=i.items,o=[];for(let a of e)o.push(Q(r,n,a));return o}if(t==="object"){if(i=i,i.properties===void 0)return{};de(i,e)||(e={});let n=i.properties,o=i.required??[],a={};for(let[p,d]of Object.entries(n)){let c=e[p];if(r==="expand"){let l=Q(r,d,c);a[p]=l;continue}if(r==="shrink"){let l=Q(r,d,c);xt(d,l)||(a[p]=l);continue}if(r==="inject"){let l=c!==void 0,h=o.includes(p);if(l||h){let y=Q(r,d,c);a[p]=y}continue}throw`invalid mode: ${r}`}return a}throw`invalid schema type: ${t}`}var w=(r,i)=>Q("inject",r,i);function R(r,i){i=i??new WeakMap;let e=typeof r;if(e==="string"||e==="number"||e==="boolean"||e==="function"||r===null)return r;if(e!=="object")throw`invalid type: ${e}`;if(i.has(r))throw"circular reference";if(Array.isArray(r)){i.set(r,!0);let n=r.map(o=>R(o,i));return i.delete(r),n}i.set(r,!0);let t={};for(let[n,o]of Object.entries(r))t[n]=R(o,i);return i.delete(r),t}function T(r){let i=typeof r;if(i==="string"||i==="number"||i==="boolean"||i==="function"||r===null)return r;if(i!=="object")throw`invalid type: ${i}`;return Array.isArray(r)?r.slice():Object.assign({},r)}function xe(r){let i=typeof r;if(i==="string"||i==="number"||i==="boolean")return{type:i,default:r};if(r===null)return{type:"null"};if(Array.isArray(r))return{type:typeof r[0],default:r[0],enum:r};if(i!=="object")throw`invalid value type: ${i}`;let e=r,t=e.type;if(!(t==="string"||t==="number"||t==="boolean"||t==="null")){if(t==="array"){let n=xe(e.items);n!==void 0&&(e.items=n);return}if(t==="object"){let n=e.properties??{};for(let[o,a]of Object.entries(n)){let p=xe(a);p!==void 0&&(n[o]=p)}e.required===!0&&(e.required=Object.keys(n)),e.required===!1&&(e.required=[]);return}throw`invalid schema type: ${t}`}}var ze=r=>{let i=R(r);return xe(i),i};var vt=r=>(m.platform.firefox&&(r.height="16px"),r),{classes:ue}=m.createStyleSheet({root:{display:"inline-block"},wrap:{alignItems:"center",display:"flex"},label:{fontSize:"14px",lineHeight:"1em"},input:vt({fontSize:"14px",lineHeight:"16px",width:"100%",margin:"0 4px 0 0",padding:"4px","&:last-child":{marginRight:0}})}).attach(),_=class extends s.PureComponent{constructor(){super(...arguments);this.handleOnChange=e=>{let t=e.target,n;this.props.schema.type==="number"?n=parseInt(t.value):n=t.value,this.props.onChange&&this.props.onChange(n)}}render(){let e=this.props.className;e=[ue.root,e].join(" ").trim();let t=this.props.style,n=this.props.schema,o=this.props.value,a=this.props.disabled;return s.createElement("span",{className:e,style:t},s.createElement("span",{className:ue.wrap},s.createElement("input",{className:ue.input,type:n.type,placeholder:n.placeholder,spellCheck:n.spellcheck,title:n.tooltip,value:o,disabled:a,onChange:this.handleOnChange}),n.label&&s.createElement("span",{className:ue.label},n.label)))}};var{classes:Fe}=m.createStyleSheet({root:{},textarea:{padding:"4px",fontSize:"14px",lineHeight:"18px"}}).attach(),Y=class extends s.PureComponent{constructor(){super(...arguments);this.handleOnChange=e=>{let n=e.target.value;this.props.onChange&&this.props.onChange(n)}}render(){let e=this.props.className;e=[Fe.root,e].join(" ").trim();let t=this.props.style,{schema:n,value:o}=this.props;return s.createElement("div",{className:e,style:t},s.createElement("textarea",{className:Fe.textarea,rows:n.rows,cols:n.cols,placeholder:n.placeholder,spellCheck:n.spellcheck,value:o,onChange:this.handleOnChange}))}};var{classes:ve}=m.createStyleSheet({root:{boxSizing:"border-box",display:"inline-block",fontSize:"14px",height:"28px",padding:"6px 4px",whiteSpace:"nowrap"},label:{display:"inline-block",verticalAlign:"middle",lineHeight:"1em"},input:{display:"inline-block",verticalAlign:"middle",width:"16px",height:"16px",margin:"0 4px 0 0","&:last-child":{marginRight:0}}}).attach(),z=class extends s.PureComponent{constructor(){super(...arguments);this.hanldeOnChange=e=>{let n=e.target.checked;this.props.onChange&&this.props.onChange(n)}}render(){let e=this.props.className;e=[ve.root,e].join(" ").trim();let t=this.props.style,n=this.props.schema,o=this.props.value===!0;return s.createElement("label",{className:e,style:t},s.createElement("input",{className:ve.input,type:"checkbox",checked:o,onChange:this.hanldeOnChange}),n.label&&s.createElement("span",{className:ve.label},n.label))}};var wt=r=>(m.platform.firefox&&(r.border="1px solid #8f8f9d",r.borderRadius="2px"),r),{classes:we}=m.createStyleSheet({root:{display:"inline-block"},label:{display:"inline-block",fontFamily:"var(--font-mono)",fontSize:"12px",lineHeight:"1em"},input:wt({boxSizing:"border-box",height:"28px",margin:"0 4px 0 0",verticalAlign:"middle",width:"28px"})}).attach(),Z=class extends s.PureComponent{constructor(){super(...arguments);this.handleChange=e=>{let n=e.target.value;this.props.onChange&&this.props.onChange(n)}}render(){let e=this.props.className;e=[we.root,e].join(" ").trim();let t=this.props.style,n=this.props.value;return s.createElement("span",{className:e,style:t},s.createElement("input",{className:we.input,type:"color",value:n,onChange:this.handleChange}),s.createElement("span",{className:we.label},n))}};var St=r=>(m.platform.safari&&(m.platform.ios?(r.height="28px",r.border="1px solid -apple-system-secondary-label",r.borderRadius="5px",r.color="#000"):(r.appearance="square-button",r.height="28px")),r),{classes:Se}=m.createStyleSheet({root:St({margin:0,padding:0}),label:{fontSize:"14px",lineHeight:"16px",padding:"4px",userSelect:"none"},icon:{marginRight:"4px",verticalAlign:"top","&:last-child":{marginRight:0}}}).attach(),C=class extends s.PureComponent{constructor(){super(...arguments);this.handleOnClick=()=>{let e=this.props.value;this.props.onClick&&this.props.onClick(e)}}renderChildren(){let{label:e,icon:t}=this.props;return s.createElement("div",{className:Se.label},t&&s.createElement(V,{className:Se.icon,name:t,size:"16"}),e&&s.createElement("span",null,e))}render(){let e=this.props.className;e=[Se.root,e].join(" ").trim();let t=this.props.disabled;return s.createElement("button",{className:e,disabled:t,onClick:this.handleOnClick},this.renderChildren())}};var{classes:A}=m.createStyleSheet({root:{border:"1px solid #ccc",width:"max-content",display:"flex",flexDirection:"column"},ul:{margin:0,padding:0,overflow:"auto"},li:{display:"block"},label:{background:"#fff",cursor:"default",fontSize:"14px",lineHeight:"16px",padding:"6px 12px",textAlign:"left",userSelect:"none",display:"flex","& > span":{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}},value:{color:"#fff",background:"#0075ff"},icon:{float:"left",marginRight:"12px"},toolbar:{borderBottom:"1px solid #ccc",padding:"4px",textAlign:"right"},button:{marginRight:"4px","&:last-child":{marginRight:0}}}).attach(),D=class extends s.PureComponent{constructor(){super(...arguments);this.handleItemOnClick=e=>()=>{this.props.onChange&&this.props.onChange(e.value)};this.handleButtonOnClick=e=>()=>{this.props.onClick&&this.props.onClick(e)};this.renderChild=(e,t)=>{let n=A.label;return e.value===this.props.value&&(n=`${n} ${A.value}`),s.createElement("li",{className:A.li,key:t},s.createElement("div",{className:n,onClick:this.handleItemOnClick(e)},e.icon&&s.createElement(V,{className:A.icon,name:e.icon,size:"16"}),s.createElement("span",null,e.label)))};this.renderChildren=()=>{let e=this.props.schema.items;if(e.length!==0)return s.createElement("ul",{className:A.ul},e.map(this.renderChild))};this.renderToolbar=()=>{let e=this.props.schema.actions??[];if(e.length!==0)return s.createElement("div",{className:A.toolbar},e.includes("add")&&s.createElement(C,{className:A.button,icon:"add",value:"add",onClick:this.handleButtonOnClick("add")}),e.includes("remove")&&s.createElement(C,{className:A.button,icon:"remove",value:"remove",onClick:this.handleButtonOnClick("remove")}),e.includes("up")&&s.createElement(C,{className:A.button,icon:"arrow_upward",value:"up",onClick:this.handleButtonOnClick("up")}),e.includes("down")&&s.createElement(C,{className:A.button,icon:"arrow_downward",value:"down",onClick:this.handleButtonOnClick("down")}))}}render(){let e=this.props.className;e=[A.root,e].join(" ").trim();let t=this.props.style;return s.createElement("div",{className:e,style:t},this.renderToolbar(),this.renderChildren())}};var{classes:Ct}=m.createStyleSheet({panel:{padding:"8px"},panel1:{padding:"8px",borderLeft:"4px solid #8bc34a"},panel2:{padding:"8px",borderLeft:"4px solid #ff9800"},toolbar:{"& > *":{marginRight:"8px","&:last-child":{marginRight:0}}},code:{margin:0,padding:"8px"}}).attach();var Ge=r=>{let i=r.className;i=[Ct.code,i].join(" ").trim();let e=r.style,t=r.value;return s.createElement("pre",{className:i,style:e},t)},J=(r,i)=>{for(let[e,t]of Object.entries(i)){let n=new RegExp("\\{"+e+"\\}","g");r=r.replace(n,t)}return r};var{classes:Ce}=m.createStyleSheet({root:{display:"inline-block",position:"relative"},label:{display:"inline-block",fontFamily:"var(--font-mono)",fontSize:"12px",lineHeight:"1em",position:"absolute",top:0},input:{boxSizing:"border-box",height:"28px",margin:"0 4px 0 0",verticalAlign:"middle",width:"100%"}}).attach(),X=class extends s.PureComponent{constructor(){super(...arguments);this.handleChange=e=>{let t=e.target,n=parseInt(t.value);this.props.onChange&&this.props.onChange(n)}}render(){let e=this.props.className;e=[Ce.root,e].join(" ").trim();let t=this.props.style,n=this.props.value,o=J(this.props.label??"{value}",{value:n}),p={[n>50?"left":"right"]:0};return s.createElement("span",{className:e,style:t},s.createElement("input",{className:Ce.input,type:"range",value:n,onChange:this.handleChange}),s.createElement("span",{className:Ce.label,style:p},o))}};var N=(...r)=>r.join(" ").trim(),{classes:f}=m.createStyleSheet({root:{fontSize:"14px"},gridLayout:{display:"grid",gridColumnGap:"4px",gridRowGap:"4px",gridTemplateColumns:"repeat(5, max-content)"},gridText:{lineHeight:"28px"},gridEdit:{"& > *":{width:"100%"}},gridDisabled:{opacity:"0.5",pointerEvents:"none"},topLayout:{display:"grid",gridRowGap:"8px",gridTemplateRows:"auto 1fr"},topMenu:{marginBottom:"8px","& > select":{width:"100%"}},topHeader:{borderBottom:"1px solid #ccc",borderTop:"1px solid transparent",lineHeight:"16px",padding:"6px 0",fontWeight:"bold"},leftLayout:{display:"grid",gridColumnGap:"8px",gridTemplateColumns:"auto 1fr"},leftHeader:{borderRight:"1px solid #ccc",lineHeight:"16px",padding:"6px 8px 6px 0",fontWeight:"bold",textAlign:"right"},flatLayout:{display:"grid",gridRowGap:"8px"},flowLayout:{display:"grid",gridAutoFlow:"column",gridColumnGap:"4px",alignItems:"center"},pickLayout:{display:"grid",gridRowGap:"4px",gridColumnGap:"4px",alignItems:"center"},pickChecked:{color:"#000"},pickDeleted:{"& span":{opacity:"0.5"}}}).attach(),ee=class extends s.PureComponent{constructor(){super(...arguments);this.handleOnChange=e=>t=>{this.props.onChange&&this.props.onChange(e,t)};this.handleOnActive=e=>t=>{this.props.onActive&&this.props.onActive(e,t)};this.handleOnPrepare=e=>t=>{this.props.onPrepare&&this.props.onPrepare(e,t)};this.handleOnRemove=(e,t)=>()=>{this.props.onRemove&&this.props.onRemove(e,t)};this.handleOnAdd=(e,t)=>n=>{this.props.onAdd&&this.props.onAdd(e,t,n)};this.handleOnClick=(e,t)=>n=>{let[o,a]=t;if(n==="add"&&this.props.onAdd){this.props.onAdd(e,o);return}if(n==="remove"&&this.props.onRemove){a>=0&&this.props.onRemove(e,a);return}if(n==="up"&&this.props.onMoveUp){a>0&&this.props.onMoveUp(e,a);return}if(n==="down"&&this.props.onMoveDown){a<o-1&&this.props.onMoveDown(e,a);return}};this.extractEnumMappings=e=>{let t={},n=e.items.properties??{};for(let o of Object.keys(n)){let a=n[o],p=a.widget??{},d=a.enum??[],c=p.enumNames??[],l={};for(let[h,y]of d.entries())l[String(y)]=c[h];t[o]=l}return t};this.createFormatReplaces=(e,t)=>{let n={...e};for(let[o,a]of Object.entries(e)){let p=t[o];p&&(n[`:${o}`]=p[String(a)])}return n}}renderEnumerate(e,t,n){t=w(e,t);let o=e.widget??{},a=o.enumNames??[],p=o.enumTitles??[],c={items:e.enum.map((l,h)=>{let y=a[h]??l,u=p[h];return{label:y,value:l,title:u}})};return s.createElement(j,{className:o.className,style:o.style,schema:c,value:t,onChange:this.handleOnChange(n)})}renderTypeString(e,t,n){t=w(e,t);let o=e.widget??{};if(o.type==="color")return s.createElement(Z,{className:o.className,style:o.style,value:t,onChange:this.handleOnChange(n)});if(o.type==="text"){let p={rows:o.rows,cols:o.cols,placeholder:o.placeholder,spellcheck:o.spellcheck};return s.createElement(Y,{className:o.className,style:o.style,schema:p,value:t,onChange:this.handleOnChange(n)})}let a={type:"string",placeholder:o.placeholder,spellcheck:o.spellcheck,tooltip:o.tooltip};return s.createElement(_,{className:o.className,style:o.style,schema:a,value:t,onChange:this.handleOnChange(n)})}renderTypeNumber(e,t,n){t=w(e,t);let o=e.widget??{};if(o.type==="slider")return s.createElement(X,{className:o.className,style:o.style,value:t,onChange:this.handleOnChange(n)});let a={type:"number",tooltip:o.tooltip};return s.createElement(_,{className:o.className,style:o.style,schema:a,value:t,onChange:this.handleOnChange(n)})}renderTypeBoolean(e,t,n){t=w(e,t);let o=e.widget??{},a={};return s.createElement(z,{className:o.className,style:o.style,schema:a,value:t,onChange:this.handleOnChange(n)})}renderTypeNull(e,t){t=w(e,t);let n=e.widget??{};return s.createElement(Ge,{className:n.className,style:n.style,value:t})}renderTypeObjectTab(e,t,n){t=w(e,t);let o=e.properties??[],a=e.widget??{},p=[];for(let v of Object.keys(o))p.push({value:v,label:o[v].title??v});let d={items:p},c=a.active??p[0].value,l=o[c],h=t[c],y=[...n,c],u=a.position??"top",{topLayout:g,leftLayout:b}=f,x=u==="top"?g:b;return x=N(x,a.className),s.createElement("div",{className:x,style:a.style},s.createElement(I,{schema:d,value:c,position:a.position,onChange:this.handleOnActive(n)}),s.createElement("div",null,this.renderSchema(l,h,y)))}renderTypeObjectMenu(e,t,n){t=w(e,t);let o=e.properties??[],a=e.widget??{},p=[];for(let b of Object.keys(o))p.push({value:b,label:o[b].title??b});let d=a.groups,c={items:p,groups:d},l=a.active;l&&t[l]===void 0&&(l=void 0),!l&&a.single&&(l=Object.keys(t)[0]),l||(l=p[0].value);let h=o[l],y=t[l],u=[...n,l],g=a.className;return s.createElement("div",{className:g,style:a.style},s.createElement("div",{className:f.topMenu},s.createElement(j,{schema:c,value:l,onChange:this.handleOnActive(n)})),s.createElement("div",null,this.renderSchema(h,y,u)))}renderTypeObjectFlat(e,t,n){t=w(e,t);let o=e.properties??[],a=e.widget??{},{topLayout:p,leftLayout:d,topHeader:c,leftHeader:l}=f,h=a.position??"top",y=h==="top"?p:d,u=h==="top"?c:l,g=[];for(let x of Object.keys(o)){let v=o[x],k=t[x],M=[...n,x];g.push(s.createElement("div",{className:y,key:x},s.createElement("div",{className:u},v.title??x),s.createElement("div",null,this.renderSchema(v,k,M))))}let b=N(f.flatLayout,a.className);return s.createElement("div",{className:b,style:a.style},g)}renderTypeObjectList(e,t,n){t=w(e,t);let o=e.properties??[],a=e.widget??{},p=[];for(let g of Object.keys(o))p.push({value:g,label:o[g].title??g,icon:a.icon});let d={items:p},c=a.active??p[0].value,l=o[c],h=t[c],y=[...n,c],u=N(f.leftLayout,a.className);return s.createElement("div",{className:u,style:a.style},s.createElement(D,{style:{width:"100%"},schema:d,value:c,onChange:this.handleOnActive(n)}),s.createElement("div",null,this.renderSchema(l,h,y)))}renderTypeObjectFlow(e,t,n){t=w(e,t);let o=e.properties??[],a=e.widget??{},p=e.required??[],d=[];for(let[l,h]of p.entries()){let y=o[h],u=t[h],g=[...n,h],b=a.separator&&l+1<p.length;d.push(s.createElement(s.Fragment,{key:h},s.createElement("span",{className:f.gridEdit},this.renderSchema(y,u,g)),b&&s.createElement("span",null,a.separator)))}let c=N(f.flowLayout,a.className);return s.createElement("div",{className:c,style:a.style},d)}renderTypeObjectGridInline(e,t,n){t=w(e,t);let o=e.properties??[],a=e.required??[],p=e.widget??{},d=[];for(let l of Object.keys(o)){let h=o[l],y=t[l],u=[...n,l],g=h.widget??{},b=a.includes(l),x=h.title??l;p.title&&(x=J(p.title,{title:h.title,key:l}));let v=f.gridText,k=f.gridEdit,M=f.gridText,E=f.gridText;!b&&y===void 0&&(v=N(f.gridDisabled,v),k=N(f.gridDisabled,k),M=N(f.gridDisabled,M),E=N(f.gridDisabled,E));let ye=null;b||(y===void 0?ye=s.createElement(C,{icon:"add",onClick:this.handleOnAdd(n,l)}):ye=s.createElement(C,{icon:"remove",onClick:this.handleOnRemove(n,l)})),d.push(s.createElement(s.Fragment,{key:l},s.createElement("span",{className:v},x),s.createElement("span",{className:M},g.prefix),s.createElement("span",{className:k},this.renderSchema(h,y,u)),s.createElement("span",{className:E},g.suffix),s.createElement("span",null,ye)))}let c=N(f.gridLayout,p.className);return s.createElement("div",{className:c,style:p.style},d)}renderTypeObjectGridNewline(e,t,n){t=w(e,t);let o=e.properties??[],a=e.required??[],p=e.widget??{},d={};for(let u of Object.keys(o))d[u]=a.includes(u);for(let u of Object.keys(t))o[u]&&(d[u]=!0);let c=[],l=[];for(let[u,g]of Object.entries(d))g?c.push(u):l.push(u);let h=[];for(let u of c){let g=o[u],b=t[u],x=[...n,u],v=g.widget??{},k=a.includes(u),M=g.title??u;p.title&&(M=J(p.title,{title:g.title,key:u})),h.push(s.createElement(s.Fragment,{key:u},s.createElement("span",{className:f.gridText},M),s.createElement("span",{className:f.gridText},v.prefix),s.createElement("span",{className:f.gridEdit},this.renderSchema(g,b,x)),s.createElement("span",{className:f.gridText},v.suffix),s.createElement("span",null,k??s.createElement(C,{icon:"remove",onClick:this.handleOnRemove(n,u)}))))}if(l.length>0){let u=l.map(x=>({label:o[x].title??x,value:x})),g=p.prepare??l[0],b=s.createElement(j,{schema:{items:u},value:g,onChange:this.handleOnPrepare(n)});h.push(s.createElement(s.Fragment,{key:"+"},s.createElement("span",{className:f.gridEdit},b),s.createElement("span",null),s.createElement("span",null,s.createElement(C,{icon:"add",onClick:this.handleOnAdd(n,g)}))))}let y=N(f.gridLayout,p.className);return s.createElement("div",{className:y,style:p.style},h)}renderTypeObject(e,t,n){let o=e.widget??{};return o.type==="tab"?this.renderTypeObjectTab(e,t,n):o.type==="menu"?this.renderTypeObjectMenu(e,t,n):o.type==="flat"?this.renderTypeObjectFlat(e,t,n):o.type==="list"?this.renderTypeObjectList(e,t,n):o.type==="flow"?this.renderTypeObjectFlow(e,t,n):o.mode==="inline"?this.renderTypeObjectGridInline(e,t,n):this.renderTypeObjectGridNewline(e,t,n)}renderTypeArrayList(e,t,n){t=w(e,t);let o=e.widget??{},a=[];for(let[b,x]of t.entries()){let v=o.label;typeof v=="function"&&(v=v(x,b,t));let k=o.icon;typeof k=="function"&&(k=k(x,b,t)),a.push({value:b,label:v,icon:k})}let d={items:a,actions:["add","remove","up","down"]},c=o.active??0;c=c>=t.length?t.length-1:c;let l=e.items,h=t[c],y=[...n,c],u=c!==-1&&c<t.length,g=N(f.leftLayout,o.className);return s.createElement("div",{className:g,style:o.style},s.createElement(D,{style:{width:"100%"},schema:d,value:c,onChange:this.handleOnActive(n),onClick:this.handleOnClick(n,[t.length,c])}),s.createElement("div",null,u&&this.renderSchema(l,h,y)))}renderTypeArrayPick(e,t,n){t=w(e,t);let o=e.widget??{},a={gridColumnStart:1},p=o.columns?[...o.columns]:[];for(let u=1;u<p.length;u++)p[u]+=p[u-1];let d,c;o.enum?(d=o.enum.codes??[],c=o.enum.names??[]):(d=e.items.enum??[],c=e.items.widget?.enumNames??[]);let l=[];for(let[u,g]of d.entries()){let b=c[u]??g,x=t.indexOf(g),v=x!==-1,k=v?f.pickChecked:void 0,M=p.includes(u)?a:void 0,E;v?E=this.handleOnRemove(n,x):E=()=>this.handleOnAdd(n,t.length)(g),l.push(s.createElement(s.Fragment,{key:l.length},s.createElement("span",{className:k,style:M},s.createElement(z,{schema:{label:b},value:v,onChange:E}))))}let h=!1;for(let[u,g]of t.entries()){if(d.includes(g))continue;let b;h||(b=a,h=!0),l.push(s.createElement(s.Fragment,{key:l.length},s.createElement("span",{className:f.pickDeleted,style:b},s.createElement(z,{schema:{label:g},value:!0,onChange:this.handleOnRemove(n,u)}))))}let y=N(f.pickLayout,o.className);return s.createElement("div",{className:y,style:o.style},l)}renderTypeArrayGrid(e,t,n){t=w(e,t);let o=e.widget??{},a=[];for(let[d,c]of t.entries()){let l=e.items,h=[...n,d],y=l.widget??{};a.push(s.createElement(s.Fragment,{key:d},s.createElement("span",{className:f.gridText},d+1),s.createElement("span",{className:f.gridText},y.prefix),s.createElement("span",{className:f.gridEdit},this.renderSchema(l,c,h)),s.createElement("span",{className:f.gridText},y.suffix),s.createElement("span",null,s.createElement(C,{icon:"remove",onClick:this.handleOnRemove(n,d)}))))}a.push(s.createElement(s.Fragment,{key:"+"},t.length>0&&s.createElement(s.Fragment,null,s.createElement("span",null),s.createElement("span",null)),s.createElement("span",null,s.createElement(C,{icon:"add",onClick:this.handleOnAdd(n,t.length)}))));let p=N(f.gridLayout,o.className);return s.createElement("div",{className:p,style:o.style},a)}renderTypeArray(e,t,n){let o=e.widget??{};return o.type==="list"?this.renderTypeArrayList(e,t,n):o.type==="pick"?this.renderTypeArrayPick(e,t,n):this.renderTypeArrayGrid(e,t,n)}renderSchema(e,t,n){if(e.enum)return this.renderEnumerate(e,t,n);if(e.type==="string")return this.renderTypeString(e,t,n);if(e.type==="number")return this.renderTypeNumber(e,t,n);if(e.type==="boolean")return this.renderTypeBoolean(e,t,n);if(e.type==="null")return this.renderTypeNull(e,t);if(e.type==="object")return this.renderTypeObject(e,t,n);if(e.type==="array")return this.renderTypeArray(e,t,n);throw"Invalid schema type"}render(){let e=this.props.className;e=[f.root,e].join(" ").trim();let t=this.props.schema,n=this.props.value;return s.createElement("div",{className:e},this.renderSchema(t,n,[]))}};var F=class extends s.PureComponent{constructor(e){super(e);this.executeOnChange=(e,t,n)=>{!this.props.onChange||(n!==void 0&&(t=[...t,n]),this.props.onChange(e,t))};this.executeOnActive=(e,t,n)=>{!this.props.onActive||(n!==void 0&&(t=[...t,n]),this.props.onActive(e,t))};this.querySchemas=(e,t)=>{let n=e,o=null;for(let a of t)o=n,n.type==="object"?n=n.properties[a]:n=n.items;return[n,o]};this.queryValues=(e,t)=>{let n=e;for(let a=0;a<t.length-1;a++){let p=t[a],d=t[a+1];n[p]===void 0&&(n[p]=typeof d=="string"?{}:[]),n=n[p]}n=e;let o=null;for(let a of t)o=e,e=e[a];return[e,o]};this.handleOnChange=(e,t)=>{if(e.length===0){this.executeOnChange(t,e),this.setState({value:t});return}let n=e.pop(),o=T(this.state.value),a=this.queryValues(o,e)[0];a[n]=t,this.executeOnChange(o,e,n),this.setState({value:o})};this.handleOnRemove=(e,t)=>{let n=T(this.state.value),o=this.queryValues(n,e)[0];typeof t=="string"?delete o[t]:o.splice(t,1),this.executeOnChange(n,e,t),this.setState({value:n})};this.handleOnActive=(e,t)=>{let n=T(this.state.schema),[o,a]=this.querySchemas(n,[...e,t]);if(a.widget={...a.widget,active:t},!a.widget.single){this.executeOnActive(this.state.value,e,t),this.setState({schema:n});return}let p=T(this.state.value),d=this.queryValues(p,[...e,t])[1];for(let c of Object.keys(d))c!==t&&delete d[c];d[t]===void 0&&(d[t]=w(o)),this.executeOnChange(p,e,t),this.setState({schema:n,value:p})};this.handleOnPrepare=(e,t)=>{let n=T(this.state.schema),o=this.querySchemas(n,e)[0];o.widget={...o.widget,prepare:t},this.setState({schema:n})};this.handleOnAdd=(e,t,n)=>{let o=T(this.state.schema),[a,p]=this.querySchemas(o,[...e,t]);if(p.widget){let l=p.widget;delete l.prepare}p.widget={...p.widget,active:t};let d=T(this.state.value),c=this.queryValues(d,[...e,t])[1];n=n===void 0?w(a):n,typeof t=="string"?c[t]=n:c.push(n),this.executeOnChange(d,e,t),this.setState({schema:o,value:d})};this.handleOnMoveUp=(e,t)=>{let n=T(this.state.schema),o=this.querySchemas(n,e)[0];o.widget={...o.widget,active:t-1};let a=T(this.state.value),p=this.queryValues(a,e)[0];p.splice(t-1,2,p[t],p[t-1]),this.executeOnChange(a,e,t-1),this.setState({schema:n,value:a})};this.handleOnMoveDown=(e,t)=>{let n=T(this.state.schema),o=this.querySchemas(n,e)[0];o.widget={...o.widget,active:t+1};let a=T(this.state.value),p=this.queryValues(a,e)[0];p.splice(t,2,p[t+1],p[t]),this.executeOnChange(a,e,t+1),this.setState({schema:n,value:a})};let t=R(e.defaultSchema),n=w(t,e.defaultValue);this.state={schema:t,value:n}}render(){let e=this.props.className,t=this.state.schema,n=this.state.value;return s.createElement(ee,{className:e,schema:t,onChange:this.handleOnChange,onActive:this.handleOnActive,onPrepare:this.handleOnPrepare,onRemove:this.handleOnRemove,onAdd:this.handleOnAdd,onMoveUp:this.handleOnMoveUp,onMoveDown:this.handleOnMoveDown,value:n})}};var kt=m.createStyleSheet({input:{width:"300px"},grid:{gridTemplateColumns:["max-content","32px","300px","32px","max-content"].join(" ")},gridAlt:{gridTemplateColumns:["160px","32px","300px","32px","max-content"].join(" ")},list:{gridColumnGap:"16px",gridTemplateColumns:"200px 1fr",minHeight:"400px"},flat:{gridRowGap:"16px"},menu:{"& > :first-child":{width:"300px"}},pick:{gridTemplateColumns:"repeat(1, max-content)"},pick2:{gridTemplateColumns:"repeat(2, max-content)"},pick3:{gridTemplateColumns:"repeat(3, max-content)"},pick4:{gridTemplateColumns:"repeat(4, max-content)"},pick5:{gridTemplateColumns:"repeat(5, max-content)"},code:{"& input":{fontFamily:"var(--font-mono)"},"& textarea":{width:"100%",boxSizing:"border-box"}}}).attach(),O=kt.classes,te={grid:{type:"grid",className:O.grid},gridAlt:{type:"grid",className:O.gridAlt},pick:{type:"pick",className:O.pick},pick2:{type:"pick",className:O.pick2},pick3:{type:"pick",className:O.pick3},pick4:{type:"pick",className:O.pick4},pick5:{type:"pick",className:O.pick5},flat:{type:"flat",className:O.flat},codeline:{className:O.code,spellcheck:!1},codetext:{type:"text",className:O.code,spellcheck:!1,rows:5}},Nt={names:r=>{let i=[];for(let e of r){let t=e.name;t!==""&&!i.includes(t)&&i.push(t)}return i},conflict:(r,i,e)=>{if(r.name==="")return!0;for(let t of e){if(t===r)return!1;if(r.name===t.name)return!0}return!1}},Ks={type:"list",className:O.list,label:r=>r.name,icon:(r,i,e)=>Nt.conflict(r,i,e)?"error_outline":"check_circle_outline"};var Ne=r=>{let i=r.option,e={bottomMargin:{title:i.bottomMargin,type:"number",default:100,widget:{suffix:"px"}},baseStyle:{title:i.baseStyle,type:"string",default:"stroke",enum:["stroke","background","classic","none"],widget:{enumNames:[i.stroke,i.background,i.classic,i.none]}},mouseAction:{title:i.mouseAction,type:"string",default:"none",enum:["none","text"],widget:{enumNames:[i.none,i.selectText]}}};return{title:i.subtitleRendering,type:"object",properties:e,required:Object.keys(e),widget:te.gridAlt}},Tt=r=>{let i=r.option,e={subtitleCount:{title:i.subtitleCount,type:"number",default:2,enum:[2,3,4,5,6,7,8]},showOnlyLanguages:{title:i.showOnlyLanguages,type:"string",widget:te.codeline}};return{title:i.subtitleMenu,type:"object",properties:e,required:Object.keys(e),widget:te.gridAlt}},jt=r=>{let i={rendering:Ne(r),dropdown:Tt(r)};return{type:"object",properties:i,required:Object.keys(i),widget:te.flat}},ke=class extends s.PureComponent{render(){return s.createElement(F,{defaultSchema:jt(this.props.i18ns),defaultValue:this.props.defaultValue,onChange:this.props.onChange})}};var ne=class extends s.PureComponent{render(){return s.createElement(F,{defaultSchema:Ne(this.props.i18ns),defaultValue:this.props.defaultValue,onChange:this.props.onChange})}};var se=class extends s.PureComponent{constructor(e){super(e);this.onChange=async e=>{await this.props.agent.save(e)};this.state={config:null}}componentDidMount(){this.load()}async load(){let e=await this.props.agent.load();this.setState({config:e})}render(){return this.state.config===null?null:s.createElement(ne,{i18ns:this.props.i18ns,defaultValue:this.state.config,onChange:this.onChange})}};var{classes:re}=m.createStyleSheet({root:{fontSize:"14px",display:"flex",flexDirection:"column",gap:"16px"},section:{display:"flex",flexDirection:"column",gap:"8px"},header:{borderBottom:"1px solid #ccc",borderTop:"1px solid transparent",lineHeight:"16px",padding:"6px 0",fontWeight:"bold"},content:{lineHeight:"16px"},links:{"& ul":{margin:"8px",paddingInlineStart:"16px"},"& li":{padding:"4px 0"}}}).attach(),ie=class extends s.PureComponent{renderLink(i,e){return s.createElement("a",{href:i,rel:"noreferrer",target:"_blank"},e)}renderSectionLinks(){let i=this.props.i18ns.option;return s.createElement("div",{className:re.section},s.createElement("div",{className:re.header,style:{display:"none"}}),s.createElement("div",{className:re.content},s.createElement("div",{className:re.links},s.createElement("ul",null,s.createElement("li",null,this.renderLink(Pe,i.homepage)),s.createElement("li",null,this.renderLink(Ve,i.feedback)),s.createElement("li",null,this.renderLink(Ie,i.changelog))))))}render(){return s.createElement("div",{className:re.root},this.renderSectionLinks())}};var At=r=>({items:[{label:r.standardMode,value:"standard"},{label:r.simpleMode,value:"simple"},{label:r.quickSettings,value:"quick"},{label:r.about,value:"about"}]}),{classes:He}=m.createStyleSheet({root:{padding:"8px",position:"relative",display:"flex",flexDirection:"column",gap:"8px"},content:{padding:"0 8px"}}).attach(),oe=class extends s.PureComponent{constructor(e){super(e);this.onChangeTab=e=>{this.setState({tab:e}),this.props.onTab&&this.props.onTab(e)};this.state={tab:e.defaultTab??"standard"}}renderHeader(){return s.createElement(B,{i18ns:this.props.i18ns,agent:this.props.agents.header})}renderTabbar(){let e=this.props.i18ns.popup,t=this.state.tab;return s.createElement(I,{schema:At(e),value:t,onChange:this.onChangeTab})}renderPanel(){let e=this.state.tab;return e==="standard"?s.createElement(K,{i18ns:this.props.i18ns,agent:this.props.agents.standard}):e==="simple"?s.createElement(W,{i18ns:this.props.i18ns,agent:this.props.agents.simple}):e==="quick"?s.createElement(se,{i18ns:this.props.i18ns,agent:this.props.agents.quick}):e==="about"?s.createElement(ie,{i18ns:this.props.i18ns}):null}renderContent(){let e=this.state.tab,t={};return(e==="standard"||e==="simple")&&(t.padding="0"),s.createElement("div",{className:He.content,style:t},this.renderPanel())}render(){return s.createElement("div",{className:He.root},this.renderHeader(),this.renderTabbar(),this.renderContent())}};var Ot=function(r){return r=r.toLowerCase().replace("_","-").trim(),r===""?"en":r==="zh-tw"||r==="zh-hk"||r==="zh-mo"||r==="zh-hant"?"zh-hant":r.match(/^zh\b/)?"zh-hans":r.split("-")[0]},Lt=r=>{let i={};for(let e of r)for(let[t,n]of Object.entries(e))i[t]||(i[t]={}),Object.assign(i[t],n);return i},me=class{constructor(i){this.dataset=Lt(i)}get(i){return i=Ot(i),this.dataset[i]||(i="en"),this.dataset[i]}};var _e={en:{about:"About",background:"Background",baseStyle:"Base Style",bottomMargin:"Bottom Margin",changelog:"Changelog",classic:"Classic",close:"Close",feedback:"Feedback",homepage:"Homepage",machineTranslation:"Machine Translation",mouseAction:"Mouse Action",nodataLine0Tip:"Possible reasons:",nodataLine1ModeSimple:"1. This mode only supports YouTube video pages.",nodataLine1ModeStandard:"1. The current page is not a video page.",nodataLine2Loading:"2. The current page has not finished loading.",nodataLine3Permission:"3. No permission to access the current page.",nodataTitle:"Could not get the subtitle menu data of the current page.",none:"None",quickSettings:"Quick Settings",selectText:"Select Text",settings:"Settings",simpleMode:"Simple Mode",standardMode:"Standard Mode",stroke:"Stroke",subtitleLanguage:"Subtitle Language",themeStyle:"Theme Style",tutorial:"Tutorial"}};var De={"zh-hans":{about:"\u5173\u4E8E",background:"\u80CC\u666F",baseStyle:"\u57FA\u7840\u6837\u5F0F",bottomMargin:"\u5E95\u90E8\u8FB9\u8DDD",changelog:"\u66F4\u65B0\u65E5\u5FD7",classic:"\u7ECF\u5178",close:"\u5173\u95ED",feedback:"\u95EE\u9898\u53CD\u9988",homepage:"\u5B98\u65B9\u7F51\u7AD9",machineTranslation:"\u673A\u5668\u7FFB\u8BD1",mouseAction:"\u9F20\u6807\u52A8\u4F5C",nodataLine0Tip:"\u53EF\u80FD\u7684\u539F\u56E0\uFF1A",nodataLine1ModeSimple:"1. \u6B64\u6A21\u5F0F\u4EC5\u652F\u6301 YouTube \u89C6\u9891\u9875\u9762\u3002",nodataLine1ModeStandard:"1. \u5F53\u524D\u9875\u9762\u4E0D\u662F\u89C6\u9891\u9875\u9762\u3002",nodataLine2Loading:"2. \u5F53\u524D\u9875\u9762\u5C1A\u672A\u5B8C\u5168\u52A0\u8F7D\u5B8C\u6BD5\u3002",nodataLine3Permission:"3. \u6CA1\u6709\u8BBF\u95EE\u5F53\u524D\u9875\u9762\u7684\u6743\u9650\u3002",nodataTitle:"\u672A\u80FD\u83B7\u5F97\u5F53\u524D\u9875\u9762\u7684\u5B57\u5E55\u83DC\u5355\u6570\u636E\u3002",none:"\u65E0",quickSettings:"\u5FEB\u901F\u8BBE\u7F6E",selectText:"\u9009\u62E9\u6587\u672C",settings:"\u8BBE\u7F6E",simpleMode:"\u7B80\u5355\u6A21\u5F0F",standardMode:"\u6807\u51C6\u6A21\u5F0F",stroke:"\u63CF\u8FB9",subtitleLanguage:"\u5B57\u5E55\u8BED\u8A00",themeStyle:"\u4E3B\u9898\u6837\u5F0F",tutorial:"\u6559\u7A0B"}};var $e={"zh-hant":{about:"\u95DC\u65BC",background:"\u80CC\u666F",baseStyle:"\u57FA\u790E\u6A23\u5F0F",bottomMargin:"\u5E95\u90E8\u908A\u8DDD",changelog:"\u66F4\u65B0\u65E5\u8A8C",classic:"\u7D93\u5178",close:"\u95DC\u9589",feedback:"\u554F\u984C\u53CD\u994B",homepage:"\u5B98\u65B9\u7DB2\u7AD9",machineTranslation:"\u6A5F\u5668\u7FFB\u8B6F",mouseAction:"\u9F20\u6A19\u52D5\u4F5C",nodataLine0Tip:"\u53EF\u80FD\u7684\u539F\u56E0\uFF1A",nodataLine1ModeSimple:"1. \u6B64\u6A21\u5F0F\u50C5\u652F\u6301 YouTube \u8996\u983B\u9801\u9762\u3002",nodataLine1ModeStandard:"1. \u7576\u524D\u9801\u9762\u4E0D\u662F\u8996\u983B\u9801\u9762\u3002",nodataLine2Loading:"2. \u7576\u524D\u9801\u9762\u5C1A\u672A\u5B8C\u5168\u52A0\u8F09\u5B8C\u7562\u3002",nodataLine3Permission:"3. \u6C92\u6709\u8A2A\u554F\u7576\u524D\u9801\u9762\u7684\u6B0A\u9650\u3002",nodataTitle:"\u672A\u80FD\u7372\u5F97\u7576\u524D\u9801\u9762\u7684\u5B57\u5E55\u83DC\u55AE\u6578\u64DA\u3002",none:"\u7121",quickSettings:"\u5FEB\u901F\u8A2D\u7F6E",selectText:"\u9078\u64C7\u6587\u672C",settings:"\u8A2D\u7F6E",simpleMode:"\u7C21\u55AE\u6A21\u5F0F",standardMode:"\u6A19\u6E96\u6A21\u5F0F",stroke:"\u63CF\u908A",subtitleLanguage:"\u5B57\u5E55\u8A9E\u8A00",themeStyle:"\u4E3B\u984C\u6A23\u5F0F",tutorial:"\u6559\u7A0B"}};var Be={en:{LANG_CODE:"en",LANG_NAME:"English",LANG_LOCAL:"English"},"zh-hans":{LANG_CODE:"zh-hans",LANG_NAME:"Chinese (Simplified)",LANG_LOCAL:"\u4E2D\u6587 (\u7B80\u4F53)"},"zh-hant":{LANG_CODE:"zh-hant",LANG_NAME:"Chinese (Traditional)",LANG_LOCAL:"\u4E2D\u6587 (\u7E41\u9AD4)"}};var Ue=new me([_e,De,$e,Be]);var Ke=r=>(r=r.toLowerCase().replace("_","-").trim(),r==="zh-tw"||r==="zh-hk"||r==="zh-mo"||r==="zh-hant"?"zh-hant":r.match(/^zh\b/)?"zh-hans":"en");var It=Ke(navigator.language),We={i18nCode:It};var qt=r=>({popup:Ue.get(r)}),ae=qt(We.i18nCode);var zt={get:r=>new Promise((i,e)=>{chrome.storage.local.get(r,t=>{let n=chrome.runtime.lastError;n?e(n):i(t)})}),set:r=>new Promise((i,e)=>{chrome.storage.local.set(r,()=>{let t=chrome.runtime.lastError;t?e(t):i()})})},Ft={sendMessage:r=>new Promise((i,e)=>{chrome.runtime.sendMessage(r,t=>{let n=chrome.runtime.lastError;n?e(n):i(t)})})},Gt={query:r=>new Promise(i=>{chrome.tabs.query(r,e=>{i(e)})}),sendMessage:(r,i)=>new Promise((e,t)=>{chrome.tabs.sendMessage(r,i,n=>{let o=chrome.runtime.lastError;o?t(o):e(n)})})},Ht={storage:zt,runtime:Ft,tabs:Gt},G=Ht;var _t={type:"object",properties:{bottomMargin:100,baseStyle:["stroke","background","classic","none"],mouseAction:["none","text"]},required:!0},Dt={type:"object",properties:{subtitleCount:[2,3,4,5,6,7,8],showOnlyLanguages:""},required:!0},Qe={type:"object",properties:{rendering:_t,dropdown:Dt},required:!0};var $t={type:"object",properties:{languageList:["popular","available"],translationEngine:["google","microsoft"],translationMode:["auto","enhance","normal"]},required:!0},Bt={type:"object",properties:{pinyinScheme:["putonghua","guangzhouhua","jyutping"]},required:!0},Ut={type:"object",properties:{furiganaCharacter:["kanji","kana"]},required:!0},Re={type:"object",properties:{translation:$t,chinese:Bt,japanese:Ut},required:!0};var P={type:"array",items:""},L={fontSize:100,fontColor:"#ffffff",fontOpacity:100,fontEdgeEffect:["none","shadow","raised","depressed","outline","stroke"],fontEdgeColor:"#ffffff",fontEdgeSize:0,fontBold:!0,fontItalic:!0,backgroundColor:"#ffffff",backgroundOpacity:100,backgroundEdgeEffect:["none","shadow"],backgroundEdgeColor:"#ffffff",borderSize:0,borderColor:"#ffffff"},H={display1:["true","false"],display2:["true","false","preserve"],flexAlign:["center","left","right","evenly"]},Kt={flexAlign:H.flexAlign,...L},Wt={...L},Qt={display:H.display2,...L},Rt={display:H.display2,flexAlign:H.flexAlign,...L},Yt={display:H.display2,backgroundColor:L.backgroundColor,backgroundEdgeEffect:L.backgroundEdgeEffect,backgroundEdgeColor:L.backgroundEdgeColor,borderSize:L.borderSize,borderColor:L.borderColor},$={display:H.display1,match:"",...L},pe={display:H.display1,match:P,...L},S=r=>({type:"object",properties:r,required:!1}),Zt={type:"object",properties:{none:null,dialogue:S(Kt),contents:S(Wt),readings:S(Qt),grammars:S(Rt),dividers:S(Yt),pinyin:S($),hiragana:S($),katakana:S($),romaji:S($),loanword:S($),pos:S(pe),form:S(pe),tag:S(pe),base:S($),sense:S(pe),jlpt:S(pe)},required:!1},Jt={type:"object",properties:{text:"",hiragana:"",katakana:"",romaji:"",loanword:"",pos:P,form:P,tag:P,base:"",sense:P,jlpt:P},required:!1},Xt={type:"object",properties:{name:"",component:Zt},required:!0},en={type:"object",properties:{name:"",genres:P,tokens:Jt},required:!0},tn={type:"object",properties:{name:"",genres:P,rulers:P,toolkit:"none"},required:!0},nn={type:"array",items:Xt},sn={type:"array",items:en},rn={type:"array",items:tn},Ye={type:"object",properties:{genres:nn,rulers:sn,themes:rn},required:!0};var on={type:"object",properties:{name:"",type:["none","style","script","standard","simple"],code:"",urls:{type:"array",items:""}},required:!0},Ze={type:"object",properties:{items:{type:"array",items:on}},required:!0};var an={type:"object",properties:{name:"",lang:"",code:"",urls:{type:"array",items:""}},required:!0},Je={type:"object",properties:{items:{type:"array",items:an}},required:!0};var pn={type:"object",properties:{apiUrl:["https://api.dualsub.xyz/"],apiKey:""},required:!0},Xe={type:"object",properties:{server:pn},required:!0};var ln={type:"object",properties:{general:Qe,language:Re,style:Ye,plugin:Ze,file:Je,network:Xe},required:!0},cn=ze(ln),Te=r=>w(cn,r);var dn={loadSetting:async()=>{let{setting:r}=await G.storage.get(["setting"]);return Te(r)},saveSetting:async r=>{let i=Te(r);await G.storage.set({setting:i})}},he=dn;var ge=async(r,i,e)=>{let{ok:t,data:n}=await G.tabs.sendMessage(r,{name:i,args:e});if(!t)throw n;return n},un={loadSimple:async r=>await ge(r,"loadSimple"),saveSimple:async(r,i)=>await ge(r,"saveSimple",i),loadStandard:async r=>await ge(r,"loadStandard"),saveStandard:async(r,i)=>await ge(r,"saveStandard",i)},le=un;var fe=async()=>{let r={currentWindow:!0,active:!0};return(await G.tabs.query(r))[0].id},mn={header:{settings:async()=>{chrome.runtime.openOptionsPage()}},standard:{initial:async()=>{let r=await fe(),i;try{i=await le.loadStandard(r)}catch{return{}}return{data:i}},change:async r=>{let i=await fe();await le.saveStandard(i,{value:r})}},simple:{initial:async()=>{let r=await fe(),i;try{i=await le.loadSimple(r)}catch{return{}}return{data:i}},change:async r=>{let i=await fe();await le.saveSimple(i,{value:r})}},quick:{load:async()=>(await he.loadSetting()).general.rendering,save:async r=>{let i=await he.loadSetting();i.general.rendering=r,await he.saveSetting(i)}}},et=mn;ae.option=ae.popup;ae.option.subtitleRendering="";var je=class extends s.PureComponent{render(){return s.createElement("div",{style:{minWidth:"700px",minHeight:"138px",background:"#fff"}},s.createElement(oe,{i18ns:ae,agents:et}))}},hn=document.querySelector("#app"),gn=Ae.createRoot(hn);gn.render(s.createElement(je,null));
