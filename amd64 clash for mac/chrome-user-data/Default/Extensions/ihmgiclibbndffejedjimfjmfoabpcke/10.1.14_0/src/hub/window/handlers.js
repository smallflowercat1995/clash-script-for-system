!function(e){var t=$(".translation-input");pl.extend(ke.app.handlers,{onHistoryLinkClick:function(){chrome.tabs.create({url:chrome.extension.getURL("/pages/public/history.html")}),ke.IS_SAFARI||window.close()},onSettingsLinkClick:function(){chrome.tabs.create({url:chrome.extension.getURL("/pages/public/options.html")}),ke.IS_SAFARI||window.close()},onPhrasebookOpen:function(){chrome.tabs.create({url:chrome.extension.getURL("/pages/public/phrasebook.html")}),ke.IS_SAFARI||window.close()},onUnpinLinkClick:function(){ke.app.flags.pro?(ke.IS_EDGE?chrome.windows.create({url:"pages/public/window.html#unpinned_",left:10,top:10,width:550,height:460,focused:!0}):window.open(chrome.extension.getURL("/pages/public/window.html#unpinned_"),"_blank","width=550,height=440"),"undefined"!=typeof ga&&ga("send","event","window","unpin","unpinned")):(ke.ui.pro_alert.show(ke.getLocale("Window_UnpinPro"),"toolbar-unpin"),"undefined"!=typeof ga&&ga("send","event","window","unpin","need-to-upgrade"))},clearInput:function(e){var t=function(){ke.app.handlers.toggleRawControls(!0),ke.particles.tr_input.model.saveValueOnKeyup(),ke.particles.translate.model.translateSimple(),ke.app.handlers.countTextLength(),$(".translation-input").focus()};$(".stop-audio").click(),ke.app.$input.val().length<=16?pl(".translation-input").clear(t):(ke.app.$input.val(""),t()),$(".original-ipa").hide(),"undefined"!=typeof ga&&ga("send","event","window","input-clear","window")},closeAutocorrection:function(){$(".autocorrection-layout").hide()},dontAutocorrect:function(e){var t=$(this).html();$(".autocorrection-layout").hide(),$(".translation-input").val(t),"undefined"!=typeof ga&&ga("send","event","window","autocorrection","do-not"),ke.app.flags.isAutocorrected=!1,ke.particles.translate.model.getTranslation(ke.particles.translate.model.routeTranslation,!1,t,!0)},onResize:function(){var e=0,t=0;ke.IS_EDGE?(e=2,t=62):ke.IS_FIREFOX?(e=0,t=35,ke.isMac||(e+=15,t+=10)):ke.IS_OPERA?(e=0,t=35,ke.isMac||(e+=15,t+=32)):ke.isMac||(e=16,t=20),ke.IS_SAFARI||window.resizeTo(550+e,463+t)},rateUsNow:function(e){e.fadeOut(250),ke.ext.util.storageUtil.setIntValue("last_rate_show",-1),"undefined"!=typeof ga&&ga("send","event","window","rate","now"),chrome.tabs.create({url:ke.storeLink})},rateUsLater:function(e){e.hide(),ke.ext.util.storageUtil.setIntValue("last_rate_show",Date.now()),"undefined"!=typeof ga&&ga("send","event","window","rate","later")},rateUsNever:function(e){e.fadeOut(250),ke.ext.util.storageUtil.setIntValue("last_rate_show",-1),"undefined"!=typeof ga&&ga("send","event","window","rate","never")},countTextLength:function(e){var t=ke.app.$input.val().length;t>ke.ext.googleApi.MAX_TEXT_LEN?ke.app.$chars_used.html(ke.ext.googleApi.MAX_TEXT_LEN-t):ke.app.$chars_used.html("")},onShortcutsUp:function(e){(ke.ext.event.isDown("cmd+shift+s",ke.ext.event.IN_STR)||ke.ext.event.isDown("ctrl+shift+s",ke.ext.event.IN_STR))&&ke.app.handlers.onSwapLang()},useSynonym:function(e){var n=pl(e.target).html();t.val(n),ke.particles.translate.model.translateSimple(null,!1),ke.app.flags.save&&ke.particles.tr_input.model.saveValueOnKeyup()},wereRawControlsEmpty:null,toggleRawControls:function(e){ke.particles.stt.model.ctrlMicVisibility(ke.app.getCurrentFromLang()),ke.app.handlers.closeAutocorrection(),ke.particles.listen.model.ctrlRawVisibility(),$(".insert").hide(),e?($(".clear-input").slideUp(125,"easeOutCubic"),$(".insert").addClass("on-empty"),$(".original-ipa").hide(),$(".original-article").slideUp(125),$(".translation-input").removeClass("with-article"),ke.app.flags.instant||$(".translate-button").fadeOut(125,"easeOutCubic"),"auto"===ke.app.temp.currentFromLang&&ke.app.initDropdown()):($(".clear-input").slideDown(125,"easeOutCubic"),$(".insert").removeClass("on-empty"),ke.app.flags.instant||ke.app.flags.isTranslating||$(".translate-button").fadeIn(125,"easeOutCubic"))},onSwapLang:function(e){var t=ke.ui.dropdown.getActiveOptionValue(1),n=ke.ui.dropdown.getActiveOptionValue(2);"auto"===t&&ke.app.temp.currentDetectedLang&&(t=ke.app.temp.currentDetectedLang),"auto"!==t&&(e&&$(".translation-input").val(ke.particles.listen.model._getTransValue("window")),ke.app.flags.save&&ke.particles.tr_input.model.saveValueOnKeyup(),ke.ui.dropdown.data.callback(1,n,null,!0),ke.ui.dropdown.data.callback(2,t,null,!1),ke.app.temp.toLang=t)},onPageUnload:function(){chrome.extension.getBackgroundPage().ke.app.handlers._processEventHandlers.app.audio.stop({},(()=>{}))},openTrialManagement:function(){chrome.tabs.create({url:chrome.extension.getURL("/pages/public/tour.html")}),ke.IS_SAFARI||window.close()},like:function(e){e.find(".like-window").fadeOut(250,(function(){e.find(".rate-window").fadeIn(250)})),ke.ext.util.storageUtil.setVal("last_rate_show",-1),"undefined"!=typeof ga&&ga("send","event","window","like-window","like")},dislike:function(e){e.find(".like-window").fadeOut(250,(function(){e.find(".email-window").fadeIn(250)})),ke.ext.util.storageUtil.setVal("last_rate_show",-1),"undefined"!=typeof ga&&ga("send","event","window","like-window","dislike")},writeEmail:function(e){chrome.runtime.sendMessage({action:ke.processCall("app","opt","sendEmail")}),e.fadeOut(250),"undefined"!=typeof ga&&ga("send","event","window","like-window","email")},showShareDialog:function(e){e.find(".share-question-window").fadeOut(250,(function(){e.find(".share-window").fadeIn(250)})),e.find(".mate-link").val(ke.storeLink).on("focus",(function(){$(this)[0].select(),ke.ext.clipboard.copyToClipboard(ke.storeLink),ke.ui.notifications.show(ke.getLocale("Common_Copied"),2500),"undefined"!=typeof ga&&ga("send","event","window","like-window","link-copied")})),ke.ext.util.storageUtil.setVal("invite_friends_shown",!0),"undefined"!=typeof ga&&ga("send","event","window","like-window","show-share")},adjustOriginalIpa:function(){let e=$(".translation-input").lines(),t=parseInt($(".translation-input").css("font-size"),10),n=parseInt($(".translation-input").css("padding-top"),10);$(".original-ipa").css("top",n+(t+5)*e+"px")},closeShareQuestion:function(e){e.fadeOut(250),ke.ext.util.storageUtil.setVal("invite_friends_shown",!0),"undefined"!=typeof ga&&ga("send","event","window","like-window","close")},onProBannerAdsClicked:function(){"undefined"!=typeof ga&&ga("send","event","window","pro-banner-ads","clicked"),ke.ui.pro_alert.show(ke.getLocale("Window_ProBannerAds"),"toolbar-window-pro-banner")},openSponsorship:function(e){chrome.tabs.create({url:ke.app.temp.current_ad.link}),"undefined"!=typeof ga&&ga("send","event","affiliate-ads",ke.app.temp.current_ad.id,"clicked")},dismissSponsorship:function(e){e.stopPropagation(),ke.app.flags.pro?(ke.app.handlers.hideSponsorshipsBar(),ke.ext.util.storageUtil.setVal("sponsorships_dismissed",!0),"undefined"!=typeof ga&&ga("send","event","affiliate-ads","dismissed")):(ke.ui.pro_alert.show(ke.getLocale("Sponsorship_DismissPro"),"affiliate-ads"),"undefined"!=typeof ga&&ga("send","event","affiliate-ads","free-user-tried-to-dismiss"))},hideSponsorshipsBar:function(){$(".sponsorship-bar").hide(),$("html, body").addClass("without-sponsorship")},showArticleUpgrade:function(){ke.ui.pro_alert.show(ke.getLocale("Pro_Articles_Msg"),"noun-articles")},showIpaUpgrade:function(){ke.ui.pro_alert.show(ke.getLocale("Pro_IPA_Msg"),"ipa-translit")},discardEmail:function(e){e.fadeOut(250)},closeNetflix:function(e){e.fadeOut(250),ke.ext.util.storageUtil.setVal("netflix_update_shown",!0)},share:function(e){window.open(ke.ext.tpl.compile(ke.share_links[$(this).attr("data-source")],{link:ke.storeLink,text:ke.getLocale("Settings_ShareText").replace("{{platform}}",ke.browserName)}),"Share Mate Translate","fullscreen=no,width=520,height=480"),"undefined"!=typeof ga&&ga("send","event","window","like-window","share-social"),e.fadeOut(250)},toggleDarkMode:function(){if(ke.isProUser){const e=!$("body").hasClass("dark-mode");$("body").toggleClass("dark-mode"),ke.ext.util.storageUtil.setVal("dark_mode",e),"undefined"!=typeof ga&&ga("send","event","window","dark-mode","toggled-"+(e?"dark":"light"))}else ke.ui.pro_alert.show(ke.getLocale("Pro_DarkMode"),"dark-mode"),"undefined"!=typeof ga&&ga("send","event","window","dark-mode","show-upgrade")},_processEventHandlers:{app:{audio:{},trans:{translateSelectedText:function(e,t){console.log(e)}}}}})}();