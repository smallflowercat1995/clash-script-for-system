!function(e){var t,i,l=ke.getLocale("History_Options_Delete_AllHeadline"),s=ke.getLocale("History_Options_Delete_AllProposal"),a=ke.getLocale("History_Options_Delete_AllPos"),o=ke.getLocale("History_Options_Delete_AllNeg"),n=!0,p=function(e){return pl(e).hasClass("active-st")},c=function(e,t){p(e)||ke.particles.hist_opt_delete.model.onTickerClick.call(e,t)};pl.extend(ke.particles.hist_opt_delete.model,{onClearHistoryClick:function(){ke.ui.tooltip.confirm.ask([l,s,a,o],(function(e){e&&ke.idb.clear("it","history",(function(){ke.particles.hist_list.model.fadeOutList()}))}))},onDeleteSelectionClick:function(){$("body").toggleClass("delete-mode"),ke.particles.hist_opt_delete.model.toggleSlidingWrap()},onTickerClick:function(e,l){t=$(this).find(".box").get(),$(this).toggleClass("active-st");var s=+$(this).data("id"),a=!1;if(pl(this).hasClass("active-st")?(ke.ext.arr.pushUnique(ke.app.temp.selected,s),a=!0):ke.ext.arr.delete(ke.app.temp.selected,s),null!==e&&e.stopPropagation&&e.stopPropagation(),null!==i&&ke.app.flags.isShiftDown){var o=this,n=[],p=+$(this).data("id")<+$(i).data("id"),d=!1;pl(".selection-ticker").each((function(){if(p){if(this.isEqualNode(i))return void(d=!0);this.isEqualNode(o)&&(d=!1)}else{if(this.isEqualNode(o))return void(d=!0);this.isEqualNode(i)&&(d=!1)}d&&n.push(this)})),pl.each(n,(function(){c(this,e)}))}i=a?this:null,ke.particles.hist_opt_delete.model.updateAmountBadge()},toggleSlidingWrap:function(){ke.app.flags.isTickerWrapActive=!ke.app.flags.isTickerWrapActive,pl(".history-list").toggleClass("i-hoverable"),$(".selection-sliding-wrap").each((function(){ke.ext.dom.isVisible(this)?$(this).animate({width:0+(ke.app.flags.isTickerWrapActive?52:0)},ke.getAnimSpeed("fast_slide_up")/(n?ke.getAnimSpeed("fast_slide_up"):1),ke.getAnimType("fast_slide_up"),(function(){$(this)["fade"+(ke.app.flags.isTickerWrapActive?"In":"Out")](ke.getAnimSpeed("fade_out"),ke.getAnimType("fade_out"),(function(){}))})):$(this).css({width:0+(ke.app.flags.isTickerWrapActive?52:0),display:"none"})})),ke.app.flags.isTickerWrapActive&&(ke.app.render.events.bindDownFastSelection(),$(".selection-sliding-wrap").removeClass("invisible-sw")),n=!1},registerMouseMoving:function(e){pl(e.target).hasClass("box")&&!ke.app.flags.isShiftDown&&ke.app.flags.isMouseDown&&!e.target.isEqualNode(t)&&(t=e.target)},selectAll:function(){console.time("select"),ke.app.temp.selected=ke.ext.arr.clone(ke.app.temp.all_items),pl(".selection-ticker").each((function(){c(this,null)})),console.timeEnd("select")},deselectAll:function(){console.time("deselect"),ke.app.temp.selected=[],pl(".selection-ticker").each((function(){var e,t;t=null,p(e=this)&&ke.particles.hist_opt_delete.model.onTickerClick.call(e,t)})),console.timeEnd("deselect")},deleteSelected:function(){ke.ext.cache.deleteFewByIdOnClient(ke.app.temp.selected,(function(e){e&&(pl.each(ke.app.temp.selected,(function(e,t){ke.particles.hist_list.model.removeItemFromListById(t,ke.particles.hist_list.view.toggleEmptyHistoryCap)})),ke.app.temp.selected=[],ke.particles.hist_opt_delete.model.updateAmountBadge(),ke.particles.hist_opt_delete.model.onDeleteSelectionClick())}))},updateAmountBadge:function(){pl(".to-delete-label").html(ke.app.temp.selected.length)},qaCancel:function(e){ke.particles.hist_list.model.onScrollingStateChange()}})}();