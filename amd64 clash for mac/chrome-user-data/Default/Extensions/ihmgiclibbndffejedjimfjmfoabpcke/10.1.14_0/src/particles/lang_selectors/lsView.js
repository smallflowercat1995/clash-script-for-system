!function(e){ke.import("ext.const.lang");var t=ke.getLocale("Kernel_RemoveFromRecent");$.extend(ke.particles.lang_selectors.view,{TYPES:{FROM:1,TO:2},fillDropdown:function(e,t,a,n,l){ke.particles.lang_selectors.view.getDropdownHtml(e,t,a,l,!1,n)},fillFPDropdown:function(e,t,a,n,l){n=n||ke.ext.const.lang.list,ke.ext.util.storageUtil.requestBackgroundOption("getVal",["fp_to_lang"],(e=>{var o,r=document.createDocumentFragment(),i=[],g=a&&a.excludes||[];for(var u in n)"auto"!==n[u]&&(o={key:u,value:n[u],i18n:ke.getLocale("Kernel_Lang_"+u)},i.push(o));i.sort((function(e,t){return e.i18n<t.i18n?-1:e.i18n>t.i18n?1:0})).reverse();var s,d=i.length;pl.each(i,(function(t,a){var n;a.value===e&&(s=a.value),$(r).prepend($("<li>").addClass("lang-"+a.value).addClass((n=a.value,n===e?ke.getPrefix()+"option_selected":ke.getPrefix()+"option")).addClass(~pl.inArray(a.value,g)?ke.getConst("ROOT_PREFIX")+"hidden":"").attr({index:d}).html($("<span>").attr({id:"lang-"+a.value,val:a.value}).addClass("lang-"+a.value).html(a.i18n).get(0)).get(0)),--d})),l({num:t,code:pl("<div>").append(r).html(),select:ke.getLocale("Kernel_Lang_"+ke.ext.util.langUtil.getLangNameByKey(s))})}))},getDropdownHtml:function(e,a,n,l,o,r){r=r||ke.ext.const.lang.list;var i=!!n;ke.ext.util.storageUtil.chainRequestBackgroundOption([{fn:"getVal",args:["from_lang"]},{fn:"getVal",args:["to_lang"]}],(g=>{(n=n||{}).from||(n.from=g[0].response),n.to||(n.to=g[1].response);var u,s,d=function(t){return i?1===e&&t===n.from||2===e&&t===n.to:ke.ext.util.langUtil["is"+(1===e?"From":"To")+"Lang"](t)},p=function(e){return d(e)?ke.getPrefix()+"option_selected":ke.getPrefix()+"option"},c=document.createDocumentFragment(),v=[],m=[],k=n&&n.excludes||[];ke.ext.util.storageUtil.requestBackgroundOption("getDecodedVal",["recently_used_lang"],(function(e){for(var o in r)"auto"!==r[o]&&(u={key:o,value:r[o],i18n:ke.getLocale("Kernel_Lang_"+o)},v.push(u));(!i||i&&n.is_main)&&pl.each(e,(function(e,t){s=ke.ext.util.langUtil.getLangNameByKey(t),u={key:s,value:t,i18n:ke.getLocale("Kernel_Lang_"+s)},m.push(u),k.push(u.value)})),v.sort((function(e,t){return e.i18n<t.i18n?-1:e.i18n>t.i18n?1:0})).reverse(),~pl.inArray("auto",k)||v.push({key:"Auto",value:"auto",i18n:ke.getLocale("Kernel_Lang_Auto")});var g,_=v.length+m.length;pl.each(v,(function(e,t){"auto"===t.value&&2===a||(d(t.value)&&(g=t.value),$(c).prepend($("<li>").addClass("lang-"+t.value).addClass(p(t.value)).addClass(~pl.inArray(t.value,k)?ke.getConst("ROOT_PREFIX")+"hidden":"").attr({index:_}).html($("<span>").attr({id:"lang-"+t.value,val:t.value}).addClass("lang-"+t.value).html(t.i18n).get(0)).get(0)),--_)})),pl.empty(m)||(_+=2,$(c).prepend($("<li>").addClass("group").attr("index",--_).html($("<span>").addClass("group-title").html(ke.getLocale("Window_Content_AllLang")).get()).get()),pl.each(m.reverse(),(function(e,n){"auto"===n.value&&2===a||(d(n.value)&&(g=n.value),$(c).prepend($("<li>").addClass("lang-"+n.value).addClass(p(n.value)).attr("index",_).append($("<span>").addClass("group-element").attr({id:"lang-"+n.value,val:n.value}).html(n.i18n).get(0)).append($("<div>").addClass("rm-recent").attr("title",t).get()).get()),--_)})),$(c).prepend($("<li>").addClass("group").attr("index",--_).html($("<span>").addClass("group-title").html(ke.getLocale("Window_Content_RecentlyUsedLang")).get()).get())),l({num:a,code:pl("<div>").append(c).html(),select:ke.getLocale("Kernel_Lang_"+ke.ext.util.langUtil.getLangNameByKey(g))})}),o)}))}})}();