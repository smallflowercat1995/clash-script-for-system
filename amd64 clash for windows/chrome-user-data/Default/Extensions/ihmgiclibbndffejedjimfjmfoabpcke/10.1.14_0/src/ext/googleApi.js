!function(e){ke.import("ext.util.storageUtil"),ke.import("ui_views.multi_variant");const t="en,af,bs,ca,cs,da,de,el,eo,es,fi,fr,hr,hu,it,kn,ku,lv,nl,pl,pt,ro,sk,sr,sv,sw,ta,tr,cy,grc,hi,hy,id,is,ka,la,mk,"+"no,sq,vi".split(","),a="de,fr,it,pt-br,es".split(","),n={"zh-CN":"zh","zh-TW":"zh",jw:"jv",iw:"he",auto:"jv"};var c={"":0,noun:1,verb:2,adjective:3,adverb:4,pronoun:5,preposition:6,conjunction:7,interjection:8,abbreviation:9,phrase:10,suffix:11,auxiliaryverb:12},r=[];for(var s in c)r.push(s);var l=function(e,t){for(var a=0;a<t.length-2;a+=3){var n=t[a+2];n="a"<=n?n.charCodeAt(0)-87:Number(n),n="+"==t[a+1]?e>>>n:e<<n,e="+"==t[a]?e+n&4294967295:e^n}return e},f=function(e){for(var t=[],a=0,n=0;a<e.length;++a){var c=e.charCodeAt(a);128>c?t[n++]=c:(2048>c?t[n++]=c>>6|192:(t[n++]=c>>12|224,t[n++]=c>>6&63|128),t[n++]=63&c|128)}var r=0;for(n=0;n<t.length;n++)r+=t[n],r=l(r,"+-a^+6");return 0>(r=l(r,"+-3^+b+-f"))&&(r=2147483648+(2147483647&r)),(r%=1e6).toString()+"."+(0^r).toString()};const o="trnsl.1.1.20181102T213252Z.15973c8fd1497069.dfef0ce2d1d66c4b3a560986cfd349cc27adceef,trnsl.1.1.20181102T213332Z.79148d90f1c6e2d5.c05d93cb4000e5eb194a8cb0302a2577e1786456,trnsl.1.1.20181102T213412Z.b7d99cd224b50875.78b25ec3b559d218c468a15718d62aa9160a6775,trnsl.1.1.20181102T213431Z.541628d09094c1a3.ff27af10a741cd223c176acde97e02d088e5f924,trnsl.1.1.20181102T213450Z.93ccf977a373c675.e773350d58a6b56434efb4e1192683e45462d7e9,trnsl.1.1.20181102T213509Z.f880b66413c0aaf3.9571c4386c6aeb148626ba31ec284691dec1ccaf,trnsl.1.1.20181102T213527Z.eb68115e91aab47f.4da25db7117bff3b15b1dc06fababa6a3c3a8535,trnsl.1.1.20181102T213549Z.ae5a65262a8dcd37.6d7ca0bc28077563a22044c73982101d802110ce,trnsl.1.1.20181102T213613Z.0bad11f72f75fcfa.5a93be6a7aa651b1ef3a36f1fe4ca9af3ac7e32b,trnsl.1.1.20181102T213633Z.a390634b03f595d9.451e188304339141a5c73bcd8b5c25bc0afa4dd9,trnsl.1.1.20181102T213652Z.d9d75034bf77120a.1737bc1c6984c39aeccf2e3581077be809b09b45,trnsl.1.1.20181102T213710Z.8b323dc6d80bba83.f83adcebeaca98ce4445a3d0d328acb59fb577a4,trnsl.1.1.20181102T213729Z.d50920bce790c915.e87f433ef69c108970909acd514734b31556ca4b,trnsl.1.1.20181102T213749Z.3e2b20c226adc8f7.fa0e8f8179d9824864262c0df8d98a222bf06e95,trnsl.1.1.20181102T213808Z.9c3b0910f60f8844.d7a5174868016700c629708e491842a4ff7dfff4,trnsl.1.1.20181102T213936Z.7c005f281fd3959e.a88a3f0411a0b373f941de434e960ec512f1892b,trnsl.1.1.20181102T214014Z.c351b40bd641f99c.114eb8303466d0add7fbca0f7a661d75def7f4c9,trnsl.1.1.20181102T214042Z.77ed3fa8560a999d.9001ccdb59651617814c0720a35dfc1c4ca32bc1,trnsl.1.1.20181102T214151Z.8c6ed1edcf6b527c.7a505097fe32ea5711ff27d44fadd1f84d64e87f,trnsl.1.1.20181102T204954Z.06a524538afb5370.d7c3461460c2e788cb6f67da941b076d65ee49f4,trnsl.1.1.20181102T205629Z.8c5a5671b2c94734.1cebf2b46d03aa6f21a3aada2c6f0dea72b2bb7c,trnsl.1.1.20181102T205740Z.53924bf8bf038b66.1497238b25def89dc7ef38dc919556eb18419aee,trnsl.1.1.20181102T205833Z.6fa2c1193d34ae03.095847fc36981d0abbc9f2d08ff4f2209ce4cbc9,trnsl.1.1.20181102T205859Z.f48f25f673c18de8.2662ca40ff4d9276e19d1a751353976374eb5027,trnsl.1.1.20181102T205922Z.8fcd584cb97e7b7b.96635d8adeb31ac33d8af5f1b84b94bca7785a1b,trnsl.1.1.20181102T205943Z.c107053b80b3da23.33f28db3a836c230ab1fb2ec519c94e6b07f9375,trnsl.1.1.20181102T210007Z.3aba0562159ceb75.5ff0ac290dbd2d01a62023b130581f594c65bd62,trnsl.1.1.20181102T210030Z.48694ecb9d7aef4e.39aa18ca356b09014ce79c7b8cda4f56e7646f58,trnsl.1.1.20181102T210101Z.8ca38ca32d1eeae2.9cf56256c908fd101a9e0bceccaf2ffd729099c4,trnsl.1.1.20181102T210122Z.14226828ff16677d.e64bf54ba3da5fa26a43d522a979e11760cb878a,trnsl.1.1.20181102T210145Z.3ff15c7295b2dec4.252e06955b1265504be710c4871b1b829166f7e9,trnsl.1.1.20181102T210207Z.9c8d671f4e895030.90514dfd6b7cc782e3ff2bcbd046835a661106d1,trnsl.1.1.20181102T210233Z.acd76b1b0033dd87.f0d1034c8b9a9ebd5abd89a0beee582b34a3ee7a,trnsl.1.1.20181102T210309Z.084714f2e6d4c8d6.2113ff52f70e8edb8d15e5dc6b5edc04882d4847,trnsl.1.1.20181102T214252Z.c7d523a692f21cf9.f061c197cf868b9bb22fa1000ed73a131a87a241,trnsl.1.1.20181102T214324Z.68589c5b7b1beaca.4887133744773fe4890cd25061e8619d5817e545,trnsl.1.1.20181102T214351Z.a5f4ec70259dfcdd.e657e0c9a59f33274144633d7cf42475077afb67,trnsl.1.1.20181102T214416Z.cc1f850655586c0f.b6d2866d529d2e001a0318180bc7e9e715f0a5b5,trnsl.1.1.20181102T214444Z.24553e66aa23b466.be6804cb85f09c6f64c5c5f3a17720cf47dc9e86,trnsl.1.1.20181102T214947Z.dfd66bd7b21dd3af.275de56c2ea7a5109ddd1fbc43406a9f485cca65,trnsl.1.1.20181102T215052Z.ec57c48f3cb24691.54a8091b9c8f364af1a9277a7aeb642356476d87,trnsl.1.1.20181102T215122Z.af8710eead58551a.97f86308053dccb2d148577e2c023c0a13489b54,trnsl.1.1.20181102T215154Z.ae797e662ffc0055.af3030fcbd863a5cc71b24afd8a3122b5a6bc2b2,trnsl.1.1.20181102T215230Z.23c8ec80d3d564ee.0285f07c82e3d91e03c274b72d889701a7de7485,trnsl.1.1.20181102T215258Z.3d6142281267b1ee.ef871a7bae00682a9225f34f40c2084aa0cd1f51,trnsl.1.1.20181102T215327Z.b0324d3620775026.f61c65f8c6c31b2f45973397e86eeb4af8ef7bc9,trnsl.1.1.20181102T215356Z.e72ddaaa2e5d3029.fc6d21d8bf367760164caf2073be332b87e558c5,trnsl.1.1.20181102T215421Z.e7bb329825ab40c2.6b4368f077ab1f36aca314f1f5d3855de9b7ffb4,trnsl.1.1.20181102T215447Z.3d4324e2958136ff.8d6085bf3873f653c02d07433ad2f336de64c23f,trnsl.1.1.20181102T215517Z.c17384773f356575.be5756d5d3ede5b0823a865aa8b2a401d5b1cf8d,trnsl.1.1.20181102T215548Z.89db0ce5c7b3bef8.c8407a45bc8655af5ab12da309f504475756371b,trnsl.1.1.20181102T215618Z.c22f22948a0fdbd1.876a5521c7737b41b6a43ca9af0b66e3f8166ab6,trnsl.1.1.20181102T215641Z.fe52de1dc3618d73.740023052cbd6a0bc98bd5bf5ff05a55770350be,trnsl.1.1.20181102T215711Z.9c77c09515106e89.72841b56546a7f19ed8f77b27b91a6dee93a59b1,trnsl.1.1.20181102T215736Z.162caa5087e102a8.6f8bbfcf5ef76652dc6c1b3249c35fc7cd944d19,trnsl.1.1.20181102T215811Z.6e967911b314d9f2.040c8dc577ac16ddea33e33225a2b334b8fd0be3,trnsl.1.1.20181102T215859Z.467b4f132813ab8a.5c04bd040c0ddbccdb9fd1be799384e6826a5635,trnsl.1.1.20181102T220047Z.ad0e4a72ac465775.9f9a21610f30534627db70c35c2c1e453cbc7c36,trnsl.1.1.20181102T220117Z.09ce6c0292c9761c.8cc1dfc8f30b6c3bf30c8e356088ef2685f37d86".split(",");pl.extend(ke.ext.googleApi,{get MAX_TEXT_LEN(){return 2e4},get MAX_IPA_LEN(){return 100},get IPA_LANGS(){return t},supportsArticles:function(e){return a.indexOf(e)>-1},getSourceTranslitFromJson:function(e){return e[10]||e[11]},getTargetTranslitFromJson:function(e){return e[2]||e[4]},getBingToken:function(e){var t={"Ocp-Apim-Subscription-Key":"0484d3977728436681fc369e7a614a43"};$.ajax({url:"https://api.cognitive.microsoft.com/sts/v1.0/issueToken",type:"POST",headers:t,success:function(t){e(t)},error:function(t){e(null)}})},googleLangsToBingLangs:function(e){return e=(e=(e=(e=(e=(e=e.replace("auto","")).replace("bs","bs-Latn")).replace("sr","sr-Cyrl")).replace("zh-TW","zh-CHT")).replace("zh-CN","zh-CHS")).replace("no","nb")},getBingTranslation:function(e,t,a,n){ke.ext.googleApi.getBingToken((function(c){if(c){e=ke.ext.googleApi.googleLangsToBingLangs(e),t=ke.ext.googleApi.googleLangsToBingLangs(t);var r=""===e?"":"&from="+e;$.ajax({url:"https://api.cognitive.microsofttranslator.com/translate?api-version=3.0&to="+t+r,type:"POST",contentType:"application/json",headers:{Authorization:"Bearer "+c},data:JSON.stringify([{Text:a}]),success:function(c){if(c){var r=c[0].translations[0].text;n({dict:[],sentences:[{orig:a,trans:r}],ld_result:{srclangs:[c[0].detectedLanguage?c[0].detectedLanguage.language:""]}})}else ke.ext.googleApi.getYandexTranslation(e,t,a,n)},error:function(c){ke.ext.googleApi.getYandexTranslation(e,t,a,n)}})}else ke.ext.googleApi.getYandexTranslation(e,t,a,n)}))},getYandexTranslation:function(e,t,a,c){e=n[e]||e,t=n[t]||t;let r=o[Math.floor(Math.random()*o.length)];$.ajax({url:"https://translate.yandex.net/api/v1.5/tr.json/translate",type:"GET",dataType:"json",contentType:"application/json",headers:{Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"},data:{key:r,format:"plain",options:1,lang:e+"-"+t,text:a},success:function(e){if(console.log(e),e.text){var t=e.text[0];c({dict:[],sentences:[{orig:a,trans:t}],ld_result:{srclangs:[e.detected.lang]}})}else c({error:!0})},error:function(e){c({error:!0})}})},getWordsInfo:function(e,t){var a=null;const n=Date.now();var c=$.ajax({url:ke.ext.util.storageUtil.getVal("misc_server")+"/v3/get_words_info",type:"POST",dataType:"json",data:JSON.stringify({words:e}),success:function(e){null!==a&&clearTimeout(a);const c=(r=Date.now()-n)<=100?"<=100":r>100&&r<200?"100-200":r>200&&r<300?"200-300":r>300&&r<400?"300-400":r>400&&r<500?"400-500":r>500&&r<600?"500-600":r>600&&r<700?"600-700":r>700&&r<800?"700-800":r>800&&r<900?"800-900":r>900&&r<1e3?"900-1000":r>1e3?">1000":void 0;var r;"undefined"!=typeof ga&&ga("send","event","translation","words-api-time-buckets",ke.ext.util.storageUtil.getVal("user_country")+" - "+c),t(e)},error:function(e){null!==a&&clearTimeout(a),console.log(e),t({words_info:null})}});a=setTimeout((function(){c.abort()}),1e3)},getGoogleOldTranslation:function(e,t,a,n){$.ajax({url:"http://clients5.google.com/translate_a/t",type:"GET",dataType:"json",headers:{Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"},data:{client:"dict-chrome-ex",q:a,sl:e,tl:t,tbb:1,ie:"UTF-8",oe:"UTF-8",hl:"en"},success:function(t){const c={sentences:[{trans:t[0],orig:a}],src:e,ld_result:{srclangs:[e]}};n(c)},error:function(c){console.log("Error while translating with Google:",c),console.log("Trying with Bing..."),ke.ext.googleApi.getBingTranslation(e,t,a,n)}})},getTextTranslation:function(e,t,a,n){var c=ke.ext.string.chunkate(a,1e3),r=new Array(c.length),s=function(a){if(a>=c.length){for(var l=r[0],f=!(!l.sentences||!l.sentences.length)&&void 0!==l.sentences[l.sentences.length-1].translit,o=(a=1,r.length),d=f?1:0;a<o;++a){for(var i=0;i<r[a].sentences.length-d;++i){l.sentences[l.sentences.length-1-d].orig+=" "+r[a].sentences[i].orig;var b="";(0===i||i>0&&" "!==r[a].sentences[i-1].trans[r[a].sentences[i-1].trans.length-1])&&(b=" "),l.sentences[l.sentences.length-1-d].trans+=b+r[a].sentences[i].trans}f&&(l.sentences[l.sentences.length-1].translit+=" "+r[a].sentences[r[a].sentences.length-1].translit)}n(l)}else ke.ext.googleApi.getTranslation(e,t,c[a],(function(e){e.error?n(e):(r[a]=e,s(a+1))}))};s(0)},getTranslation:function(e,t,a,n){e=e||"auto",$.ajax({url:"https://translate.googleapis.com/translate_a/single?dt=t&dt=bd&dt=qc&dt=rm&dt=ex",type:"GET",dataType:"json",headers:{Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"},data:{client:"gtx",hl:"en",sl:e,tl:t,q:a,dj:1,tk:f(a)},success:function(e){n(e)},error:function(c){console.log("Error while translating with Google:",c),console.log("Trying with older GApi..."),ke.ext.googleApi.getGoogleOldTranslation(e,t,a,n)}})},parseResponse:function(e){return e.replace(/(\,\,)/g,',"",').replace(/\[\,/g,'["",').replace(/\,\]/g,',""]')},getAudioFileLink:function(e,t){return ke.app.tts_link.replace("{{domain}}",ke.app.getCountry()).replace("{{text}}",encodeURIComponent(t)).replace("{{lang}}",e).replace("{{textparts}}",t.split(" ").length).replace("{{textlen}}",t.length).replace("{{dictation_speed}}","0.5")},getBingAudioFileLink:function(e,t){return"iw"===e&&(e="he"),"https://www.bing.com/tspeak?&format=audio%2Fmp3&language={{lang}}&IG=D5DFBE5EEA97455182D4DEA272551DCD&IID=translator.5036.43&text={{text}}".replace("{{text}}",encodeURIComponent(t)).replace("{{lang}}",e)},getTranslationPageLink:function(e,t,a){return"https://translate.google."+ke.app.getCountry()+"/#%from%|%to%|%text%".replace(/%from%/,t||ke.ext.util.langUtil.getFromLang()).replace(/%to%/,a||ke.ext.util.langUtil.getToLang()).replace(/%text%/,e)},getPartOfSpeechByIndex:function(e){return r[e]},getInternalJSONFormat:function(e,t){var a="object"==typeof e?e:JSON.parse(this.parseResponse(e));if("boolean"==typeof a[0])return a;var n=[!1,"","","","","","",[[],[],[],[],[],[],[],[],[],[],[],[],[]],"","","",""];if(pl.type(a,"arr")&&null!=a[0].Alignment)n[0]=!1,n[1]=t,n[2]="",n[3]=a[0].TranslatedText,n[4]="",n[5]=a[0].From;else if(a.dict||pl.type(a[1],"arr"))a.dict?(n[0]=!0,n[1]=a.sentences[0].orig,n[2]=(a.sentences[1]||{}).src_translit||"",n[3]=a.sentences[0].trans,n[4]=(a.sentences[1]||{}).translit||"",n[5]=a.ld_result.srclangs[0],pl.each(a.dict,(function(e,t){pl.each(t.entry,(function(e,a){var r=[a.word,a.reverse_translation];"string"==typeof a.previous_word?r.push(a.previous_word):r.push(""),n[7][c[t.pos.toLowerCase().replace(" ","")]||0].push(r)}))}))):(n[0]=!0,n[1]=a[0][0][1],n[2]=(a[0][1]?a[0][1][0]:"")||"",n[3]=a[0][0][1],n[4]=(a[0][1]?a[0][1][1]:"")||"",n[5]=a[2],pl.each(a[1],(function(e,t){pl.each(t[2],(function(e,a){var r=[a[0],a[1]];"string"==typeof a[3]?r.push(a[3]):r.push(""),n[7][c[t[0]]||0].push(r)}))})));else if("object"==typeof a.sentences){for(var r=0,s=a.sentences.length;r<s;++r)a.sentences[r].orig&&(n[1]+=a.sentences[r].orig),a.sentences[r].trans&&(n[3]+=a.sentences[r].trans);n[11]=(a.sentences[a.sentences.length-1]||{}).src_translit||"",n[4]=(a.sentences[a.sentences.length-1]||{}).translit||"",n[0]=!1,n[5]=a.ld_result.srclangs[0]}else n[0]=!1,n[1]=a[0][0][1],n[2]=(a[0][1]?a[0][1][0]:"")||"",n[3]=a[0][0][0],n[4]=(a[0][1]?a[0][1][1]:"")||"",n[5]=a[1];return n},parseReceivedTranslation:function(e,t,a,n,c){if(e[0]){var r=[e[0],ke.ui_views.multi_variant.wrap(!0,e,t,a,n)];if(t){var s=r;r=[s[0],e[3],s[1]],delete s}return r}return[!1,ke.ui_views.multi_variant.wrap(!1,e,t,a,n,c)]}})}();