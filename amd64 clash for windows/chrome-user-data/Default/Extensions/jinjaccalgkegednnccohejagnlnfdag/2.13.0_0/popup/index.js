(e=>{function t(t){for(var a,o,r=t[0],l=t[1],c=t[2],u=0,p=[];u<r.length;u++)o=r[u],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&p.push(n[o][0]),n[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(d&&d(t);p.length;)p.shift()();return i.push.apply(i,c||[]),s()}function s(){for(var e,t=0;t<i.length;t++){for(var s=i[t],a=!0,r=1;r<s.length;r++){var l=s[r];0!==n[l]&&(a=!1)}a&&(i.splice(t--,1),e=o(o.s=s[0]))}return e}var a={},n={7:0},i=[];function o(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=e,o.c=a,o.d=(e,t,s)=>{o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=(e,t)=>{if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(s,a,(t=>e[t]).bind(null,a));return s},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,"a",t),t},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.p="/";var r=window.webpackJsonp=window.webpackJsonp||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var d=l;i.push([189,1,0]),s()})({188:(e,t,s)=>{"use strict";var a=s(60);s.n(a).a},189:function(e,t,s){"use strict";s.r(t);var a=s(28),n=s(0),i=s(3),o=s(34),r=s(35),l=s(1),c=(s(65),s(4)),d=s.n(c),u=s(20),p=s.n(u),m=s(7),b=s(16),f=s(21),x=s(10);const g={scripts:[],frameScripts:[],scriptIds:[],commands:[],domain:"",injectionFailure:null,injectable:!0,blacklisted:!1},v={init(e=100){this.ready=new Promise(t=>{this.resolve=t,setTimeout(t,e)})}},h={isApplied:m.a.get("isApplied"),filtersPopup:m.a.get("filtersPopup")||{}};m.a.hook(e=>{"isApplied"in e&&(h.isApplied=e.isApplied),"filtersPopup"in e&&(h.filtersPopup=d()({},h.filtersPopup,{},e.filtersPopup))});var C={components:{Icon:f.a,Tooltip:p.a},data:()=>({store:g,options:h,activeMenu:"scripts",activeExtras:null,message:null,focusedId:null}),computed:{injectionScopes(){const{sort:e,enabledFirst:t,hideDisabled:s}=this.options.filtersPopup,a="alpha"===e||t;return[g.injectable&&["scripts",Object(n.n)("menuMatchedScripts")],["frameScripts",Object(n.n)("menuMatchedFrameScripts")]].filter(Boolean).map(([i,o])=>{let r=this.store[i];const l=r.length,c=r.reduce((e,t)=>e+t.config.enabled,0);return s&&(r=r.filter(e=>e.config.enabled)),r=r.map((s,o)=>{const{config:r,custom:l,meta:c}=s,d=Object(n.l)(s);return{id:`${i}/${s.props.id}`,name:d,data:s,home:l.homepageURL||c.homepageURL||c.homepage,key:a&&`${t&&+!r.enabled}${"alpha"===e?d.toLowerCase():`${1e6+o}`.slice(1)}`,excludesValue:null}}),a&&r.sort((e,t)=>e.key<t.key?-1:e.key>t.key),l&&{name:i,title:o,list:r,totals:c<l?`${c} / ${l}`:`${l}`}}).filter(Boolean)},failureReason:()=>[!g.injectable&&"noninjectable",g.blacklisted&&"blacklisted",!1===h.isApplied&&"scripts-disabled"].filter(Boolean).join(" "),failureReasonText:()=>!g.injectable&&Object(n.n)("failureReasonNoninjectable")||g.blacklisted&&Object(n.n)("failureReasonBlacklisted")||!1===h.isApplied&&Object(n.n)("menuScriptDisabled")||"",tabIndex(){return this.activeExtras?-1:0}},methods:{toggleMenu(e){this.activeMenu=this.activeMenu===e?null:e},toggleExtras(e,t){this.activeExtras=this.activeExtras===e?null:e,x.c.setContext("activeExtras",this.activeExtras),this.activeExtras&&(e.el=t.target.closest(".script"),this.$nextTick(()=>{const{extrasMenu:e}=this.$refs;e.style.top=`${Math.min(window.innerHeight-e.getBoundingClientRect().height,(t.currentTarget||t.target).getBoundingClientRect().top+16)}px`}))},getSymbolCheck:e=>`toggle-${e?"on":"off"}`,onToggle(){m.a.set("isApplied",h.isApplied=!h.isApplied),this.checkReload()},onManage(){browser.runtime.openOptionsPage(),window.close()},onVisitWebsite(){Object(n.w)("TabOpen",{url:"https://violentmonkey.github.io/"}),window.close()},onEditScript(e){Object(n.w)("OpenEditor",e.data.props.id),window.close()},onFindSameDomainScripts(){Object(n.w)("TabOpen",{url:`https://greasyfork.org/scripts/by-site/${encodeURIComponent(this.store.domain)}`}),window.close()},onCommand(e,t){Object(n.y)(g.currentTab.id,"Command",`${e}:${t}`),window.close()},onToggleScript(e){const{data:t}=e,s=!t.config.enabled;Object(n.w)("UpdateScriptInfo",{id:t.props.id,config:{enabled:s}}).then(()=>{t.config.enabled=s,this.checkReload()})},checkReload(){m.a.get("autoReload")&&(browser.tabs.reload(g.currentTab.id),g.scriptIds.length=0,g.scripts.length=0,g.frameScripts.length=0,v.init())},async onCreateScript(){Object(n.w)("OpenEditor"),window.close()},async onInjectionFailureFix(){m.a.set("defaultInjectInto",i.d),await Object(n.s)(100),await browser.tabs.reload(),window.close()},onRemoveScript({data:{config:e,props:{id:t}}}){const s=+!e.removed;e.removed=s,Object(n.w)("MarkRemoved",{id:t,removed:s})},onExclude(){const e=this.activeExtras;e.excludesValue=[...e.data.custom.excludeMatch||[],`${g.currentTab.url.split("#")[0]}*`].join("\n"),this.$nextTick(()=>{const t=e.el.querySelector("textarea");Object(b.a)([t]),t.focus()})},onExcludeClose(e){e.excludesValue=null,this.focus(e)},async onExcludeSave(e){await Object(n.w)("UpdateScriptInfo",{id:e.data.props.id,custom:{excludeMatch:e.excludesValue.split("\n").map(e=>e.trim()).filter(Boolean)}}),this.onExcludeClose(e),this.checkReload()},navigate(e){var t;const{activeElement:s}=document,a=Array.from(this.$el.querySelectorAll('[tabindex="0"]')).map(e=>({el:e,rect:e.getBoundingClientRect()})).filter(({rect:e})=>e.width&&e.height);a.sort(((...e)=>(t,s)=>{for(const a of e){const e=a(t),n=a(s);if(e<n)return-1;if(e>n)return 1}return 0})(e=>e.rect.top,e=>e.rect.left));let n=a.findIndex(({el:e})=>e===s);const i=(e,t)=>{for(let s=n+e;s>=0&&s<a.length;s+=e)if(t(a[n],a[s]))return s};if(n<0)n=0;else if("u"===e||"d"===e){const t="u"===e?-1:1;if(n=i(t,(e,s)=>(e.rect.top-s.rect.top)*t<0),"u"===e)for(;n>0&&a[n-1].rect.top===a[n].rect.top;)n-=1}else{const t="l"===e?-1:1;n=i(t,(e,s)=>(e.rect.left-s.rect.left)*t<0)}null==(t=a[n])||t.el.focus()},focus(e){var t,s;null==e||null==(t=e.el)||null==(s=t.querySelector(".menu-area"))||s.focus()},delegateMouseEnter(e){const{target:t}=e;t.tabIndex>=0&&t.focus()},delegateMouseLeave(e){const{target:t}=e;t!==document.activeElement||Object(x.b)(t)||t.blur()},updateMessage(){var e;this.message=(null==(e=document.activeElement)?void 0:e.dataset.message)||""}},mounted(){x.c.enable(),this.disposeList=[x.c.register("escape",()=>{const e=this.activeExtras;this.toggleExtras(null),this.focus(e)},{condition:"activeExtras"}),x.c.register("escape",()=>{const{body:e,activeElement:t}=document;t!==e&&e.contains(t)?t.blur():window.close()},{condition:"!activeExtras"}),x.c.register("up",()=>{this.navigate("u")},{condition:"!inputFocus"}),x.c.register("down",()=>{this.navigate("d")},{condition:"!inputFocus"}),x.c.register("left",()=>{this.navigate("l")},{condition:"!inputFocus"}),x.c.register("right",()=>{this.navigate("r")},{condition:"!inputFocus"})]},beforeDestroy(){var e;x.c.disable(),null==(e=this.disposeList)||e.forEach(e=>{e()})}},w=(s(188),s(5)),y=Object(w.a)(C,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page-popup",attrs:{"data-failure-reason":e.failureReason},on:{click:t=>{e.activeExtras&&e.toggleExtras(null)},contextmenu:t=>{e.activeExtras&&(e.toggleExtras(null),t.preventDefault())},"!mouseenter":t=>e.delegateMouseEnter(t),"!mouseleave":t=>e.delegateMouseLeave(t),"!focus":t=>e.updateMessage(t)}},[s("div",{staticClass:"flex menu-buttons"},[s("div",{staticClass:"logo",class:{disabled:!e.options.isApplied}},[s("img",{attrs:{src:"/public/images/icon128.png"}})]),s("div",{staticClass:"flex-1 ext-name",class:{disabled:!e.options.isApplied},domProps:{textContent:e._s(e.i18n("extName"))}}),s("span",{staticClass:"menu-area",class:{disabled:!e.options.isApplied},attrs:{"data-message":e.options.isApplied?e.i18n("menuScriptEnabled"):e.i18n("menuScriptDisabled"),tabIndex:e.tabIndex},on:{click:e.onToggle}},[s("icon",{attrs:{name:e.getSymbolCheck(e.options.isApplied)}})],1),s("span",{staticClass:"menu-area",attrs:{"data-message":e.i18n("menuDashboard"),tabIndex:e.tabIndex},on:{click:e.onManage}},[s("icon",{attrs:{name:"cog"}})],1),s("span",{staticClass:"menu-area",attrs:{"data-message":e.i18n("menuNewScript"),tabIndex:e.tabIndex},on:{click:e.onCreateScript}},[s("icon",{attrs:{name:"plus"}})],1)]),e.store.injectable?s("div",{directives:[{name:"show",rawName:"v-show",value:e.store.domain,expression:"store.domain"}],staticClass:"menu"},[s("div",{staticClass:"menu-item menu-area menu-find",attrs:{tabIndex:e.tabIndex},on:{click:e.onFindSameDomainScripts}},[s("icon",{attrs:{name:"search"}}),s("div",{staticClass:"flex-1",domProps:{textContent:e._s(e.i18n("menuFindScripts"))}})],1)]):e._e(),e.failureReasonText?s("div",{staticClass:"failure-reason"},[e.injectionScopes[0]&&!e.options.isApplied?s("tooltip",{staticClass:"reload-hint",attrs:{content:e.i18n("labelAutoReloadCurrentTabDisabled"),align:"start",placement:"bottom"}},[s("icon",{attrs:{name:"info"}})],1):e._e(),s("span",{domProps:{textContent:e._s(e.failureReasonText)}}),e.store.blacklisted?s("code",{staticClass:"ellipsis inline-block",domProps:{textContent:e._s(e.store.blacklisted)}}):e._e()],1):e._e(),e._l(e.injectionScopes,t=>s("div",{key:t.name,staticClass:"menu menu-scripts",class:{expand:e.activeMenu===t.name,"block-scroll":e.activeExtras},attrs:{"data-type":t.name}},[s("div",{staticClass:"menu-item menu-area menu-group",attrs:{tabIndex:e.tabIndex},on:{click:s=>e.toggleMenu(t.name)}},[s("div",{staticClass:"flex-auto",attrs:{"data-totals":t.totals},domProps:{textContent:e._s(t.title)}}),s("icon",{staticClass:"icon-collapse",attrs:{name:"arrow"}})],1),s("div",{staticClass:"submenu"},e._l(t.list,(t,a)=>s("div",{key:a,staticClass:"script",class:{disabled:!t.data.config.enabled,failed:t.data.failed,removed:t.data.config.removed,"extras-shown":e.activeExtras===t,"excludes-shown":t.excludesValue}},[s("div",{staticClass:"menu-item menu-area",attrs:{tabIndex:e.tabIndex,"data-message":t.name},on:{focus:s=>{e.focusedId=t.id},click:s=>e.onToggleScript(t)}},[s("img",{staticClass:"script-icon",attrs:{src:t.data.safeIcon}}),s("icon",{attrs:{name:e.getSymbolCheck(t.data.config.enabled)}}),s("div",{staticClass:"script-name flex-auto ellipsis",domProps:{textContent:e._s(t.name)},on:{click:s=>s.ctrlKey?s.shiftKey||s.altKey||s.metaKey?null:(s.stopPropagation(),e.onEditScript(t)):null,contextmenu:s=>s.ctrlKey||s.shiftKey||s.altKey||s.metaKey?null:(s.stopPropagation(),e.onEditScript(t)),mousedown:s=>"button"in s&&1!==s.button||s.ctrlKey||s.shiftKey||s.altKey||s.metaKey?null:(s.stopPropagation(),e.onEditScript(t))}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:e.activeExtras===t||e.focusedId===t.id,expression:"activeExtras === item || focusedId === item.id"}],staticClass:"submenu-buttons"},[s("div",{staticClass:"submenu-button",attrs:{tabIndex:e.tabIndex,title:e.i18n("buttonEditClickHint")},on:{click:s=>e.onEditScript(t)}},[s("icon",{attrs:{name:"code"}})],1),s("div",{staticClass:"submenu-button",attrs:{tabIndex:e.tabIndex},on:{click:s=>(s.stopPropagation(),e.toggleExtras(t,s))}},[s("icon",{attrs:{name:"more"}})],1)]),null!=t.excludesValue?s("div",{staticClass:"excludes-menu flex flex-col"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.excludesValue,expression:"item.excludesValue"}],attrs:{spellcheck:"false"},domProps:{value:t.excludesValue},on:{input:s=>{s.target.composing||e.$set(t,"excludesValue",s.target.value)}}}),e._v(" "),s("div",[s("button",{domProps:{textContent:e._s(e.i18n("buttonOK"))},on:{click:s=>e.onExcludeSave(t)}}),s("button",{domProps:{textContent:e._s(e.i18n("buttonCancel"))},on:{click:s=>e.onExcludeClose(t)}}),s("details",[s("summary",[s("icon",{attrs:{name:"info"}})],1),s("small",[s("span",{domProps:{textContent:e._s(e.i18n("menuExcludeHint"))}}),e._m(0,!0)])])])]):e._e(),s("div",{staticClass:"submenu-commands"},e._l(e.store.commands[t.data.props.id],(a,n)=>s("div",{key:n,staticClass:"menu-item menu-area",attrs:{tabIndex:e.tabIndex,"data-message":a},on:{click:s=>e.onCommand(t.data.props.id,a)}},[s("icon",{attrs:{name:"command"}}),s("div",{staticClass:"flex-auto ellipsis",domProps:{textContent:e._s(a)}})],1)),0)])),0)])),e.store.injectionFailure?s("div",{staticClass:"failure-reason"},[s("div",{domProps:{textContent:e._s(e.i18n("menuInjectionFailed"))}}),e.store.injectionFailure.fixable?s("a",{attrs:{href:"#"},domProps:{textContent:e._s(e.i18n("menuInjectionFailedFix"))},on:{click:t=>(t.preventDefault(),e.onInjectionFailureFix(t))}}):e._e()]):e._e(),e.store.currentTab&&e.store.currentTab.incognito?s("div",{staticClass:"incognito",domProps:{textContent:e._s(e.i18n("msgIncognitoChanges"))}}):e._e(),s("footer",[s("a",{attrs:{href:"https://violentmonkey.github.io/",tabIndex:e.tabIndex},domProps:{textContent:e._s(e.i18n("visitWebsite"))},on:{click:t=>(t.preventDefault(),e.onVisitWebsite(t))}})]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.message,expression:"message"}],staticClass:"message"},[s("div",{domProps:{textContent:e._s(e.message)}})]),e.activeExtras?s("div",{ref:"extrasMenu",staticClass:"extras-menu"},[e.activeExtras.home?s("a",{attrs:{tabindex:"0",href:e.activeExtras.home,rel:"noopener noreferrer",target:"_blank"},domProps:{textContent:e._s(e.i18n("buttonHome"))}}):e._e(),s("div",{attrs:{tabindex:"0"},domProps:{textContent:e._s(e.i18n("menuExclude"))},on:{click:e.onExclude}}),s("div",{attrs:{tabindex:"0"},domProps:{textContent:e._s(e.activeExtras.data.config.removed?e.i18n("buttonRestore"):e.i18n("buttonRemove"))},on:{click:t=>e.onRemoveScript(e.activeExtras)}})]):e._e()],2)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("ul",{staticClass:"monospace-font mt-1"},[t("li",[this._v("https://www.foo.com/path/*bar*")]),t("li",[this._v("*://www.foo.com/*")]),t("li",[this._v("*://*.foo.com/*")])])}],!1,null,null,null).exports;v.init(),a.default.prototype.i18n=n.n;const j=new a.default({render:e=>e(y)}).$mount();document.body.append(j.$el),Object.assign(o.a,{async SetPopup(e,t){if(g.currentTab&&g.currentTab.id!==t.tab.id)return;const s=0===t.frameId;s||await v.ready;const a=e.ids.filter(e=>!g.scriptIds.includes(e));var o;if(g.scriptIds.push(...a),s&&(v.resolve(),g.commands=(o=e.menus,l.f).call(o,([,e])=>Object.keys(e).sort())),a.length){var c;const t=g[s?"scripts":"frameScripts"],o=(null==(c=e.scripts)?void 0:c.filter(({props:{id:e}})=>a.includes(e)))||Object.assign(e,await Object(n.x)("GetData",a)).scripts;o.forEach(t=>Object(r.a)(t,e.cache)),t.push(...o),e.failedIds.forEach(s=>{t.forEach(t=>{t.props.id===s&&(t.failed=!0,g.injectionFailure||(g.injectionFailure={fixable:e.injectInto===i.f}))})})}}}),Object(n.x)("CachePop","SetPopup").then(e=>{l.e.call(e,e=>o.a.SetPopup(...e))}),(null==CSS.supports?void 0:CSS.supports("list-style-type","disclosure-open"))||document.styleSheets[0].insertRule(".excludes-menu ::-webkit-details-marker {display:none}"),Object(n.x)("GetTabDomain").then(async({tab:e,domain:t})=>{g.currentTab=e,g.domain=t,browser.runtime.connect({name:`${e.id}`}),i.c.test(e.url)?g.blacklisted=await Object(n.x)("TestBlacklist",e.url):g.injectable=!1})},60:(e,t,s)=>{}});