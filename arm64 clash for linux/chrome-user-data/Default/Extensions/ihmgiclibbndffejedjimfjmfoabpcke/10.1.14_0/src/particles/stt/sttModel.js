!function(){var t,e,s=$(".translation-input"),n=$(".stt-layout");pl.extend(ke.particles.stt.model,{toggle:function(){ke.isProUser?(ke.app.handlers.closeAutocorrection(),ke.app.$stt_button.hasClass("active")?("undefined"!=typeof ga&&ga("send","event","stt","export-history"),t.stop()):("undefined"!=typeof ga&&ga("send","event","stt","start-listening"),n.fadeIn(150,"easeInSine"),ke.app.siriWave.start(),ke.app.$stt_button.addClass("active"),(t=new speechRecognition).lang=ke.ext.const.lang.stt[ke.ext.util.langUtil.getFromLang()][0],t.continuous=!0,t.interimResults=!0,e=setInterval((function(){ke.app.siriWave.setNoise(ke.app.siriWave._interpolation.amplitude-.05)}),100),t.onresult=function(e){s.val(e.results[0][0].transcript),ke.app.siriWave.setNoise(ke.app.siriWave._interpolation.amplitude+.25),e.results[0].isFinal&&(t.onend(null),ke.app.handlers.toggleRawControls(!1),ke.particles.translate.model.translateSimple(null,!0))},t.onerror=function(t){"not-allowed"===t.error&&ke.particles.stt.model.requestPermission()},t.onstart=function(t){},t.onend=function(t){ke.particles.stt.model.stop()},t.start())):ke.ui.pro_alert.show(ke.getLocale("Pro_STTFeature"),"stt")},stop:function(){ke.app.siriWave.stop(),n.fadeOut(150,"easeInSine"),ke.app.siriWave._clear(),ke.app.$stt_button.removeClass("active"),clearInterval(e),ke.app.flags.shouldHideSttButtonAfterEnd&&(ke.app.flags.shouldHideSttButtonAfterEnd=!1,ke.app.$stt_button.hide()),t.stop()},ctrlMicVisibility:function(t){t in ke.ext.const.lang.stt&&(ke.IS_SAMSUNG||ke.IS_CHROME)?ke.app.$stt_button.show():ke.app.$stt_button.hasClass("active")?ke.app.flags.shouldHideSttButtonAfterEnd=!0:ke.app.$stt_button.hide()},requestPermission:function(){window.open("../public/mic_access.html","_blank","resizable=0, scrollbars=0, titlebar=0, width=550, height=441, top=10, left=10")}})}();