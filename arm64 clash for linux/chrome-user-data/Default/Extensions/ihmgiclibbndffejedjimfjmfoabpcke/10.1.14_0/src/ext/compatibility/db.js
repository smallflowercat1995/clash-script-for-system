pl.extend(ke.ext.compatibility.db,{switchToIDB:function(t){window.openDatabase&&(ke.db.choose(ke.getAppConst("db"),"100 mB"),ke.db.execSql("SELECT * FROM "+ke.getAppConst("t_history"),[],(function(e){for(var o=e.rows.length,i=0,n=0;n<e.rows.length;++n){var s=e.rows.item(n);ke.idb.exists("it","history",["input",s.input],{l_from:s.l_from,l_to:s.l_to},(function(t,e,o,n){t||ke.idb.add("it","history",n,"translation",(function(){})),++i}),{l_from:s.l_from,l_to:s.l_to,input:s.input,it_resp:JSON.parse(s.output),time:s.time,sources:JSON.parse(s.sources)})}n=setInterval((function(){i===o&&(clearInterval(n),ke.db.execSql("DROP TABLE "+ke.getAppConst("t_history"),[],t))}),10)}),t))},updateIDBv4:function(t){t()}});