!function(e){pl.extend(ke.app.handlers,{trackShiftT:function(){ke.ext.event.isDown("shift+t")&&(ke.ui.info_alert.show(ke.getLocale("Tour_UhHuh"),ke.ext.tpl.compile(ke.getLocale("Tour_NoShiftT"),{browser:ke.browserName}),ke.getLocale("Tour_GotIt")),"undefined"!=typeof ga&&ga("send","event","tour","shift-t"))},onDoubleClick:function(t){(t.target.className||"").indexOf(ke.getPrefix())>-1||chrome.runtime.sendMessage({action:ke.processCall("app","option","getDoubleClickOptionActiveness"),identificator:"tooltip"},(function(t){t.is_active&&!pl.empty(ke.particles.translate_ctt.model.getSelectedText())&&(ke.app.handlers.skipSelectTranslation=!0,"undefined"!=typeof ga&&ga("send","event","tour","double-click"),chrome.runtime.sendMessage({action:ke.processCall("app","option","getMainLanguagePair"),identificator:"tooltip"},(function(t){ke.particles.translate_ctt.model.showTranslation(e,t.from_lang,t.to_lang,null,null,"double-click")})))}))},lastTranslationCallArgs:{},skipSelectTranslation:!1,onSelection:function(e){pl.empty(ke.particles.translate_ctt.model.getSelectedText())||(e.target.className||"").indexOf(ke.getPrefix())>-1?$("."+ke.getPrefix()+"translate-selection-button").fadeOut(150,(function(){$(this).remove()})):chrome.runtime.sendMessage({action:ke.processCall("app","option","getTranslateOnSelectActiveness"),identificator:"tooltip"},(function(e){chrome.runtime.sendMessage({action:ke.processCall("app","option","getMainLanguagePair"),identificator:"tooltip"},(function(e){if(ke.app.handlers.skipSelectTranslation)ke.app.handlers.skipSelectTranslation=!1;else{var t=ke.particles.translate_ctt.model.getSelection(),n=ke.ui.tooltip.helpSelected._getSelectionParameters(t);ke.app.handlers.lastTranslationCallArgs.text=t.toString(),ke.app.handlers.lastTranslationCallArgs.selectionBB=n,"undefined"!=typeof ga&&ga("send","event","tour","text-selection"),$("."+ke.getPrefix()+"translate-selection-button").remove(),$("body").append($('<div class="'+ke.getPrefix()+'translate-selection-button"></div>').css({top:n.top+n.height+10+window.pageYOffset,left:n.left+window.pageXOffset}).data("l-from",e.from_lang).data("l-to",e.to_lang).on("click",ke.app.handlers.translateSelection))}}))}))},translateSelection:function(t){t.stopPropagation(),t.preventDefault();var n=$(this).data("l-from"),a=$(this).data("l-to");ke.particles.translate_ctt.model.showTranslation(e,n,a,null,null,"selection")},showPreviousCarouselTab:function(){var e=ke.app.temp.currentTab-1;ke.IS_CHROME||e!==ke.app.PDF_TAB_NUM||e--;var t=Math.max(1,e);ke.app.temp.currentTab!==t&&(ke.app.render.organize.showCarouselTab(t),ke.app.temp.currentTab=t)},showNextCarouselTab:function(){var e=ke.app.temp.currentTab+1;ke.IS_CHROME||e!==ke.app.PDF_TAB_NUM||e++;var t=Math.min(ke.app.TABS,e);ke.app.temp.currentTab!==t&&(ke.app.render.organize.showCarouselTab(t),ke.app.temp.currentTab=t)},upgrade:function(){ke.particles.pro_block.model.upgrade()},gotIt:function(e){chrome.runtime.sendMessage({action:ke.processCall("app","commands","sendAnalyticsEvent"),cat:"tour",event:"start-using"}),chrome.runtime.sendMessage({action:ke.processCall("app","option","enableOption"),option:"gdpr_consent"}),window.close()},handleLoginStateChange:function(e){var t=ke.parseProcessCall(e.action);"app"===t.lib&&"login"===t.cmd&&"done"===t.exact&&window.close()},getListenValue:function(e,t){var n=t.target?$(ke.ext.util.selectorsUtil.getTooltipWrapRecursively(t.target)):t;return"orig"===e?n.find("."+ke.getPrefix()+"original-wrap ."+ke.getPrefix()+"mv-text-part").html()||n.find("."+ke.getPrefix()+"original-wrap ."+ke.getPrefix()+"tpart").html():"trans"===e?n.find("."+ke.getPrefix()+"main-variant ."+ke.getPrefix()+"mv-text-part").html()||n.find("."+ke.getPrefix()+"trans-wrap ."+ke.getPrefix()+"tpart").html():""},settings:function(){chrome.runtime.sendMessage({action:ke.processCall("app","opt","newTab"),url:chrome.extension.getURL("/pages/public/options.html#2")}),chrome.runtime.sendMessage({action:ke.processCall("app","commands","sendAnalyticsEvent"),cat:"tour",event:"settings"})},closeInlineOption:function(e){e.stopPropagation();var t=+$(this).data("ttid"),n=$(this).parent().data("option");$(this).parent().slideUp(125,"easeInOutQuint",(function(){$(this).remove(),$("."+ke.getPrefix()+"hsw-"+t).removeClass(ke.getPrefix()+"with-info-warn")})),chrome.runtime.sendMessage({action:ke.processCall("app","commands","sendAnalyticsEvent"),cat:"tour",event:"inline-option-close",subevent:n})},disableInlineOption:function(){var e=$(this).data("option");chrome.runtime.sendMessage({action:ke.processCall("app","option","disableOption"),option:e}),chrome.runtime.sendMessage({action:ke.processCall("app","commands","sendAnalyticsEvent"),cat:"tour",event:"inline-option-disable",subevent:e}),$(this).addClass(ke.getPrefix()+"disabled").find("span").html(ke.getLocale("Tooltip_InlineOptionDisabled"))},onLanguagePickerOpen:function(e,t){ke.particles.scrollbars.model.setupComboOptionsDropdownScroll(2,t)},onLanguagePickerChange:function(e,t){ke.ext.util.storageUtil.requestBackgroundOption("setVal",["to_lang",t]),ke.ext.const.lang.isFPSupported(t)&&ke.ext.util.storageUtil.requestBackgroundOption("setVal",["fp_to_lang",t]),chrome.runtime.sendMessage({action:ke.processCall("app","commands","sendAnalyticsEvent"),cat:"tour",event:"set-lang",subevent:t}),chrome.runtime.sendMessage({action:ke.processCall("app","opt","generateDropdownHtml")},ke.app.initLanguagePicker)},accepted:!1,onBeforeUnload:function(e){chrome.runtime.sendMessage({action:ke.processCall("app","commands","sendAnalyticsEvent"),cat:"tour",event:"close",subevent:ke.app.temp.currentTab})},openPP:function(){chrome.tabs.create({url:"https://www.matetranslate.com/privacy-policy"}),chrome.runtime.sendMessage({action:ke.processCall("app","commands","sendAnalyticsEvent"),cat:"tour",event:"open-privacy"})},openToS:function(){chrome.tabs.create({url:"https://www.matetranslate.com/terms-of-use"}),chrome.runtime.sendMessage({action:ke.processCall("app","commands","sendAnalyticsEvent"),cat:"tour",event:"open-tos"})},hideImportanceAlert:function(){$(".importance-alert").fadeOut(250)},startSafariTrial:function(){ke.ext.util.storageUtil.setIntValue("trial_start",Date.now()),"undefined"!=typeof ga&&ga("send","event","tour","start-trial"),ke.app.handlers.accepted=!0,chrome.runtime.sendMessage({action:ke.processCall("app","option","enableOption"),option:"trial_started"}),chrome.runtime.sendMessage({action:ke.processCall("app","option","enableOption"),option:"gdpr_consent"}),window.close()}})}();