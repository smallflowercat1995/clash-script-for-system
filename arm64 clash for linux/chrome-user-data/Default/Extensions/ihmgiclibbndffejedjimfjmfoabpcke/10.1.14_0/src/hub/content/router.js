pl.extend(ke.app,{import:["ext.tpl","ext.event","ext.audio","ext.dom","ext.string","ext.googleApi","ext.const.lang","ext.util.selectorsUtil","ext.util.langUtil","ext.const.netflix_langs","bg_events.audio","particles.listen.lModel","particles.translate_ctt.tcModel","particles.scrollbars.sModel","particles.3dots_button.3dotsModel","particles.3dots_button.3dotsView","s:ui_components.fpTranslator","particles.full_page.fpTranslator","ui_components.dropdown.dropdown","particles.scrollbars.sModel","particles.lang_selectors.lsView","particles.lang_selectors.lsModel","ui_components.scrollbar.scrollbar","ui_components.tooltip.simple","ui_components.tooltip.helpSelected","ui_components.notifications","s:ui_components.contextMenu","lib.contextMenu"],tts_link:("https:"===window.location.protocol?"https":"http")+"://translate.google.com/translate_tts?ie=UTF-8&q={{text}}&tl={{lang}}&total={{textparts}}&idx=0&textlen={{textlen}}&client=dict-chrome-ex&prev=input&ttsspeed={{dictation_speed}}",translation_link:"",getCountry:function(){return"com"},callbacksInitialization:{},flags:{isCurrentTranslationMulti:!1,tt_transUtterancePermission:!1,isPlayingTooltipTrans:!1,netflix_player_loaded:!1,dark_mode:!1,show_netflix:!0,pro:!1},temp:{iframes:[],windows:[],documents:[],currentDetectedLang:"",to_lang:"",netflix_title:"",netflix_subtitles_lang:"auto",netflix_subtitles_fontsize:"28px",bottom_controls_height:"104px",landing_href:"",subtitle_update_int:null,scale:.75,wordlist_id:null,tooltip_detected_from_lang:null},get bodyScrollLeft(){return document.documentElement.scrollLeft||document.body.scrollLeft||0},get bodyScrollTop(){return document.documentElement.scrollTop||document.body.scrollTop||0},init:function(){ke.ext.util.storageUtil.chainRequestBackgroundOption([{fn:"isTrueOption",args:["gdpr_consent"]},{fn:"isTrueOption",args:["chr_pro_flag"]},{fn:"getIntValue",args:["trial_start"]},{fn:"isTrueOption",args:["trial_started"]},{fn:"isTrueOption",args:["dark_mode"]},{fn:"isTrueOption",args:["netflix"]},{fn:"isTrueOption",args:["zendesk_user"]},{fn:"getVal",args:["to_lang"]}],(function(e){e[1].response,e[2].response,e[3].response;var t=e[6].response;e[7].response,ke.app.flags.dark_mode=e[4].response,ke.app.flags.show_netflix=e[5].response,ke.app.temp.landing_href=document.location.href,ke.app.temp.landing_href.indexOf("netflix.com")>-1&&new MutationObserver((function(e){e.forEach((function(){ke.app.handlers.netflix.handleNavigation()}))})).observe(document.querySelector("body"),{childList:!0,subtree:!0}),!t&&document.location.href.indexOf("zendesk.com")>-1&&ke.app.handlers.checkZendeskTickets(),$(window).dblclick(ke.app.handlers.onDoubleClick),ke.ui.tooltip.simple._bindCloseEvent(),ke.IS_SAMSUNG&&$(window).on("touchend",ke.app.handlers.onSelection),$(window).on("mouseup",ke.app.handlers.onSelection),ke.IS_SAMSUNG||ke.ext.event.listen(ke.EF,ke.EF,ke.app.handlers.onKeyCombinationClick),ke.app.initBackgroundEventListener(),ke.app.initNetflixSubtitleTranslator(),tryShowingMateBar()})),window.addEventListener("message",(function(e){e.source==window&&e.data.action&&"goog-loaded"===e.data.action&&ke.app.handlers.googleWidgetLoaded(e.data.lang)}))},initBackgroundEventListener:function(){chrome.runtime.onMessage.addListener((function(e,t,n){var o=ke.parseProcessCall(e.action);(ke.app.handlers._processEventHandlers[o.lib][o.cmd][o.exact]||ke.EF)(e,n)}))},initNetflixSubtitleTranslator:function(){if(ke.app.flags.show_netflix&&document.location.href.indexOf("https://www.netflix.com/watch/")>-1&&!ke.app.flags.netflix_player_loaded){$("body").append("<style>.player-timedtext-text-container span { opacity: 0.0 !important; }</style>");var e=setInterval((function(){var t=$('button[data-uia="control-audio-subtitle"]');if(t.length>0&&ke.app.flags.netflix_player_loaded){clearInterval(e);var n=setInterval((function(){$('button[data-uia="control-audio-subtitle"]').click();var e=$('li[data-uia^="subtitle-item-selected-"]');e.length>0&&(clearInterval(n),ke.app.handlers.netflix.setNewParsedSubtitleLang(e.text()),ke.app.handlers.netflix.fetchWordlistId(),$('div[data-uia="player"]').trigger("click"),t.on("click mouseover",ke.app.handlers.netflix.onSubtitlesLangChange))}),1e3)}}),1e3),t=setInterval((function(){var e=$(".watch-video .player-timedtext");e.length>0&&(clearInterval(t),$("body").addClass(ke.getPrefix()+"with-mate-subtitles"),ke.app.temp.netflix_title=$('div[data-uia="video-title"] h4').text(),ke.app.temp.netflix_episode_code=$('div[data-uia="video-title"] span:eq(0)').text(),ke.app.temp.netflix_episode_name=$('div[data-uia="video-title"] span:eq(1)').text(),ke.app.flags.netflix_player_loaded=!0,ke.app.temp.subtitle_update_int=setInterval((function(){var t=e.find(".player-timedtext-text-container span");ke.app.temp.bottom_controls_height=$(".watch-video--bottom-controls-container").css("height"),t.length>0?(ke.app.temp.netflix_subtitles_fontsize=t.css("font-size"),ke.app.handlers.netflix.parseAndShowSubtitle(t)):ke.app.handlers.netflix.showClickableSubtitle("")}),100))}),1e3)}},initDropdowns:function(e){ke.app.temp.tooltip_detected_from_lang=e,ke.ui.dropdown.init(ke.app.handlers.onPageLangDropdownValueChanged,[ke.app.handlers.onPageLangDropdownOpened,ke.EF],ke.app.render.organize.fillOnPageLangDropdown,"",(function(){}))}});