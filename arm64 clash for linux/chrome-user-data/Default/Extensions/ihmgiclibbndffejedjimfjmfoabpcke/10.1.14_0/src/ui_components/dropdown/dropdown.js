!function(e){ke.import("s:ui_components.dropdown"),ke.import("ext.input"),ke.import("ext.string"),ke.import("ext.event"),ke.import("ext.dom");var t=function(){};pl.extend(ke.ui,{dropdown:{}});var i=!0;pl.extend(ke.ui.dropdown,{data:{isOpened:!1,isFocused:!0,overOption:!1,ind:999,callback:t,callbacksOnOpenClose:[t,t],ui_search:{},openedOptionsSerial:0,mouseX:0,mouseY:0,changeMode:1,applied:0},init:function(e,t,i,o,n){o=o||"",pl(document).unbind().bind({click:ke.ui.dropdown.externalClick,keydown:ke.ui.dropdown.arrowsNavigation,mousemove:ke.ui.dropdown.mouseMove}),ke.ui.dropdown.applySelects(i,o,(function(){pl("."+ke.getPrefix()+"options ."+ke.getPrefix()+"list li[index]").unbind().bind({click:ke.ui.dropdown.optionClick,mouseover:ke.ui.dropdown.optionHover,mouseout:ke.ui.dropdown.optionOut}),n()})),pl.empty(t)||(ke.ui.dropdown.data.callbacksOnOpenClose=t),$("."+ke.getPrefix()+"select").off().on("click",ke.ui.dropdown.dropdownClick),ke.ui.dropdown.data.callback=e},applySelects:function(e,t,o){var n,a,r=pl(pl.type(t,"int")?"."+ke.getPrefix()+"opt-"+t:(a=t,(pl.type(a,"str")&&!pl.empty(a)?t+" ":"")+"."+ke.getPrefix()+"options")),d=r.len(),s=0;r.each((function(){if(n=+$(this).data("serial"),isNaN(n))--d;else{var t=this;e(n,null,(function(e){if($(t).css("z-index",--ke.ui.dropdown.data.ind).find("."+ke.getPrefix()+"list").html(e.code),i&&ke.ui.dropdown.data.applied++,!pl.empty(e.select)){var n=$("."+ke.getPrefix()+"opt-"+e.num).parent().find("."+ke.getPrefix()+"select");n.removeClass(ke.getPrefix()+"just-added").html(ke.ui.dropdown.cropCaption(e.select,n.get()))}$(t).find("."+ke.getPrefix()+"dd-input").unbind().bind({keyup:ke.ui.dropdown.onSearchKeyUp}).attr("data-width",parseInt($(this).find("."+ke.getPrefix()+"dd-input").css("width"))),++s===d&&o&&o()}))}})).hide(),i=!1},mouseMove:function(e){e.pageX===ke.ui.dropdown.data.mouseX&&e.pageY===ke.ui.dropdown.data.mouseY||(ke.ui.dropdown.data.mouseX=e.pageX,ke.ui.dropdown.data.mouseY=e.pageY,ke.ui.dropdown.data.changeMode=1)},optionHover:function(){1===ke.ui.dropdown.data.changeMode&&(ke.ui.dropdown.data.overOption=!0,pl(this).addClass(ke.getPrefix()+"whenHover"))},optionOut:function(){1===ke.ui.dropdown.data.changeMode&&(ke.ui.dropdown.data.overOption=!1,pl(this).parent().find("."+ke.getPrefix()+"whenHover").removeClass(ke.getPrefix()+"whenHover"))},arrowsNavigation:function(e){if(!ke.ui.dropdown.data.isOpened)return!0;ke.ui.dropdown.data.changeMode=2;var t=$("."+ke.getPrefix()+"opt-"+ke.ui.dropdown.data.openedOptionsSerial),i=t.find("."+ke.getPrefix()+"whenHover"),o=t.find("."+ke.getPrefix()+"option_selected");$.isEmptyObject(i.get())&&(i=o);var n=function(e,t){for(var i=e;(i=i[t]())&&!$.isEmptyObject(i.get());)if(!i.hasClass(ke.getPrefix()+"search-li")&&!i.hasClass(ke.getPrefix()+"group")&&i.is(":visible")){e=i;break}return e};if(ke.ext.event.is("enter",e))ke.ui.dropdown.optionClick.call(i);else{i.removeClass(ke.getPrefix()+"whenHover");ke.ext.event.is("arrowdown",e)?i=n(i,"next"):ke.ext.event.is("arrowup",e)&&(!0,i=n(i,"prev")),i.addClass(ke.getPrefix()+"whenHover")}},externalClick:function(e,t){!0!==t&&(pl(e.target).hasClass(ke.getPrefix()+"option")||pl(e.target).parent().hasClass(ke.getPrefix()+"option")||pl(e.target).hasClass(ke.getPrefix()+"option_selected")||pl(e.target).parent().hasClass(ke.getPrefix()+"option_selected")||pl(e.target).hasClass(ke.getPrefix()+"options")||pl(e.target).hasClass(ke.getPrefix()+"search-li")||pl(e.target).hasClass(ke.getPrefix()+"dd-search")||pl(e.target).hasClass(ke.getPrefix()+"dd-input")||pl(e.target).hasClass(ke.getPrefix()+"select")||pl(e.target).parent().hasClass(ke.getPrefix()+"select")||pl(e.target).hasClass(ke.getPrefix()+"group")||pl(e.target).parent().hasClass(ke.getPrefix()+"group")||e.target!=document.body&&pl(e.target).parent(4).hasClass(ke.getPrefix()+"options"))||($("."+ke.getPrefix()+"ui_selector ."+ke.getPrefix()+"dd-search input").val(""),ke.ui.dropdown.applySearch("",(()=>{ke.ui.dropdown.data.openedOptionsSerial=0,ke.ui.dropdown.data.callbacksOnOpenClose[1](),$("."+ke.getPrefix()+"ui_selector ."+ke.getPrefix()+"options").slideUp(ke.getAnimSpeed("fast_slide_up")/2.5,ke.getAnimType("slide_up")),$("."+ke.getPrefix()+"ui_selector ."+ke.getPrefix()+"options-arrow").hide(),pl("."+ke.getPrefix()+"select").removeClass(ke.getPrefix()+"active"),pl("."+ke.getPrefix()+"options ."+ke.getPrefix()+"whenHover").removeClass(ke.getPrefix()+"whenHover"),ke.ui.dropdown.data.isOpened=!1})))},dropdownClick:function(){var e=+$(this).data("for-serial")||+$(this).parent().find("."+ke.getPrefix()+"options").data("serial");if($(this).hasClass(ke.getPrefix()+"active"))ke.ui.dropdown.externalClick(null,!0);else{ke.ui.dropdown.data.openedOptionsSerial=e,$("."+ke.getPrefix()+"ui_selector ."+ke.getPrefix()+"options").hide(),$("."+ke.getPrefix()+"ui_selector ."+ke.getPrefix()+"options-arrow").hide(),$("."+ke.getPrefix()+"select").removeClass(ke.getPrefix()+"active"),$(this).addClass(ke.getPrefix()+"active");var t=this,i=0;"static"!==$("."+ke.getPrefix()+"select."+ke.getPrefix()+"active").parent().css("position")&&(i=($("."+ke.getPrefix()+"select."+ke.getPrefix()+"active").parent().offset()||{left:0}).left);for(var o=$("."+ke.getPrefix()+"select."+ke.getPrefix()+"active").width()+2*parseInt($("."+ke.getPrefix()+"select."+ke.getPrefix()+"active").css("padding-left")),n=$("."+ke.getPrefix()+"opt-"+e).width()+2*parseInt($("."+ke.getPrefix()+"opt-"+e).css("padding-left")),a=$("."+ke.getPrefix()+"select."+ke.getPrefix()+"active").offset().left-i-n/2+o/2;a+i+n>$(window).width()-16;)a-=10;if($(this).parent().find("."+ke.getPrefix()+"opt-"+e).hasClass(ke.getPrefix()+"standalone")){var r=$("."+ke.getPrefix()+"select."+ke.getPrefix()+"active").offset().left-i+o/2-parseInt($(this).parent().find("."+ke.getPrefix()+"options-arrow").css("width"))/2;$(this).parent().find("."+ke.getPrefix()+"options-arrow").show().css({left:r+"px","z-index":++ke.ui.dropdown.data.ind})}let d={left:a+"px"};$(this).parent().find("."+ke.getPrefix()+"opt-"+e).css(d).slideDown(1.5*ke.getAnimSpeed("fast_slide_down"),ke.getAnimType("slide_down"),(function(){var i=pl(t).parent().find("."+ke.getPrefix()+"opt-"+e+" ."+ke.getPrefix()+"option_selected").get().offsetTop-34;ke.ui.dropdown.data.isOpened=!0,ke.ui.dropdown.data.callbacksOnOpenClose[0](e,i),ke.IS_SAMSUNG||$(this).find("."+ke.getPrefix()+"dd-input").focus()}))}},cropCaption:function(e,t){return e},globalRecrop:function(){$("."+ke.getPrefix()+"select").each((function(){$(this).html(ke.ui.dropdown.cropCaption($(this).text(),this))}))},onSearchFocus:function(){$(this).animate({"background-position-x":5,width:parseInt($(this).data("width"))+2,paddingLeft:20},1,ke.getAnimType("fast_slide_down"))},onSearchBlur:function(){if(pl.empty($(this).val())){var e=$(this).width(),t=parseInt($(this).css("padding-left")),i=t/2+e/2-$(this).placeholderWidth()/2+6;$(this).animate({"background-position-x":i-6,width:e-i/2-t+2,paddingLeft:i+6+3},ke.getAnimSpeed("fast_slide_down")/2,ke.getAnimType("fast_slide_down"))}},onSearchKeyUp:function(e){if(pl.type(ke.ui.dropdown.data.searchTimeout,"null")||clearTimeout(ke.ui.dropdown.data.searchTimeout),ke.ext.event.is("ctrl",e)||ke.ext.event.is("alt",e))return!0;13===e.keyCode&&ke.ui.dropdown.selectFirst();var t=this;ke.ui.dropdown.data.searchTimeout=setTimeout((function(){ke.ui.dropdown.applySearch(pl(t).val())}),525)},selectFirst:function(){var e=$("."+ke.getPrefix()+"opt-"+ke.ui.dropdown.data.openedOptionsSerial).find("."+ke.getPrefix()+"option:visible span").attr("val"),t=$("."+ke.getPrefix()+"opt-"+ke.ui.dropdown.data.openedOptionsSerial).parent().find("."+ke.getPrefix()+"select");e&&(ke.ui.dropdown.data.callback(ke.ui.dropdown.data.openedOptionsSerial,e),ke.ui.dropdown.dropdownClick.call(t[0]))},applySearch:function(e,t){var i,o=ke.ui.dropdown.data.openedOptionsSerial,n=0,a=0,r=0,d=0,s=0,p=function(){--s},l=function(e,t){$("."+ke.getPrefix()+"opt-"+o+" ."+ke.getPrefix()+"group:eq("+e+")").length>0&&(++s,$("."+ke.getPrefix()+"opt-"+o+" ."+ke.getPrefix()+"group:eq("+e+")")["slide"+ke.capitalize(t)](ke.getAnimSpeed("slide_up"),ke.getAnimType("slide_up"),p))};e=e.toLowerCase();var k=pl("."+ke.getPrefix()+"opt-"+o+" li").last().get(),f=-1;$("."+ke.getPrefix()+"opt-"+o+" li").each((function(){if(!$(this).hasClass(ke.getPrefix()+"search-li")){if($(this).hasClass(ke.getPrefix()+"group"))return d==r&&l(f,"up"),d=0,r=0,void++f;++n,++d,~(i=$(this).find("span:eq(0)").text()).toLowerCase().indexOf(e)?(++s,pl.empty(e)||(i=ke.ext.string.highlight(i,e)),$(this).find("span").html(i),$(this).slideDown(ke.getAnimSpeed("slide_down"),ke.getAnimType("slide_down"),p)):(++r,++a,++s,$(this).slideUp(ke.getAnimSpeed("slide_up"),ke.getAnimType("slide_up"),p)),this.isEqualNode(k)&&d==r?l(f,"up"):(pl.empty(e)||d!=r)&&l(f,"down")}}));var c=setInterval((function(){0==s&&(clearInterval(c),pl("."+ke.getPrefix()+"opt-"+o).find("."+ke.getPrefix()+"search-failed-plaque").remove(),n==a&&pl("."+ke.getPrefix()+"opt-"+o+" ."+ke.getPrefix()+"inner-options-layout").append(pl("<div>").addClass(ke.getPrefix()+"search-failed-plaque").html(ke.getLocale("CommonUi_NoResults")).get()),ke.ui.dropdown.data.callbacksOnOpenClose[0](o),"function"==typeof t&&t())}),10)},optionClick:function(){if(!$(this).hasClass(ke.getPrefix()+"group")){var e=$(this).parent().parent().parent().parent().parent().parent(),t=e.find("."+ke.getPrefix()+"select");if(0===t.length&&(t=e.parent().find("."+ke.getPrefix()+"select")),e.find("."+ke.getPrefix()+"option_selected").length>0){var i=e.find("."+ke.getPrefix()+"option_selected").find("span").attr("val");$(this).parent().find("."+ke.getPrefix()+"option_selected").removeClass(ke.getPrefix()+"option_selected")}$(this).addClass(ke.getPrefix()+"option_selected"),ke.ui.dropdown.data.callback(ke.ui.dropdown.data.openedOptionsSerial,$(this).parent().find("."+ke.getPrefix()+"option_selected").find("span").attr("val"),i),ke.ui.dropdown.dropdownClick.call(t[0])}},getActiveOptionValue:function(e){return $("."+ke.getPrefix()+"opt-"+e).find("."+ke.getPrefix()+"option_selected span").attr("val")}})}();