!function(){function e(t,n,o){function r(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[a]={exports:{}};t[a][0].call(u.exports,function(e){var n=t[a][1][e];return r(n||e)},u,u.exports,e,t,n,o)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}return e}()({1:[function(e,t,n){"use strict";var o;!function(e){function t(e,t){if(e<1)return[];if(t<1)throw new Error("maxPerBucket cannot be less than 1 but was: "+t);if(e<=t)return[e];for(var n=Math.ceil(e/t),o=Math.floor(e/n),r=e%n,i=[],a=0;a<n;a++)i.push(o+(a<r?1:0));return i}function n(t,n){if(0===t.length)return[];for(var o=e.createEvenBuckets(t.length,n),r=[],i=0,a=0;a<o.length;a++){var s=i+o[a];r.push(t.slice(i,s)),i=s}return r}function o(e){for(var t=0;t<e.length;t++)if(!e[t])return!1;return!0}e.createEvenBuckets=t,e.partition=n,e.isArrayComplete=o}(o=n.ArrayUtils||(n.ArrayUtils={}))},{}],2:[function(e,t,n){"use strict";var o;!function(e){function t(e){var t=document.createElement("iframe");t.hidden=!0,t.style.display="none",t.src=e,document.body.appendChild(t)}function n(){return!window.addEventListener||navigator.appVersion.indexOf("MSIE 9")>=0}function o(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>=0)return"IE"+e.substring(t+5,e.indexOf(".",t));if(e.indexOf("Trident/")>=0){var n=e.indexOf("rv:");return"IE"+e.substring(n+3,e.indexOf(".",n))}return e.indexOf("Edge/")>=0?"Edge":void 0}function r(e,t,n){void 0===t&&(t=1e3),void 0===n&&(n=700);var o=screen.width?(screen.width-t)/2:0,r=screen.height?(screen.height-n)/2:0,i="height="+n+",width="+t+",top="+r+",left="+o+",scrollbars=yes,resizable=yes,location=no,menubar=no,status=yes,titlebar=no,toolbar=no";return window.open(e,"_blank",i)}e.appendHiddenIframeToDocument=t,e.browserNotSupported=n,e.ieVersion=o,e.openPopupWindow=r}(o=n.BrowserUtils||(n.BrowserUtils={}))},{}],3:[function(e,t,n){"use strict";var o;!function(e){e[e.Bookmarklet=0]="Bookmarklet",e[e.ChromeExtension=1]="ChromeExtension",e[e.EdgeExtension=2]="EdgeExtension",e[e.FirefoxExtension=3]="FirefoxExtension",e[e.SafariExtension=4]="SafariExtension"}(o=n.ClientType||(n.ClientType={}))},{}],4:[function(e,t,n){"use strict";var o,r=e("../constants"),i=e("../localization/localization"),a=e("../logging/log"),s=e("./frontEndGlobals");!function(e){function t(t,o){if(t&&o){t.setCustomProperty(a.PropertyName.Custom.CorrelationId,o.responseHeaders[r.Constants.HeaderValues.correlationId]),t.setStatus(a.Status.Failed),t.setFailureInfo(o);var i=n(o);if(i){var l=d(i);l||s.Clipper.logger.logFailure(a.Failure.Label.UnhandledApiCode,a.Failure.Type.Unexpected,void 0,i),e.isExpected(i)&&t.setFailureType(a.Failure.Type.Expected),t.setCustomProperty(a.PropertyName.Custom.IsRetryable,e.isRetryable(i))}}}function n(e){if(e&&e.response){var t;try{t=JSON.parse(e.response)}catch(t){s.Clipper.logger.logJsonParseUnexpected(e.response)}var n;return t&&t.error&&t.error.code&&(n=t.error.code),n?n:void 0}}function o(e){var t=d(e);return t?t.message:i.Localization.getLocalizedString("WebClipper.Error.GenericError")}function l(e){var t=i.Localization.getLocalizedString("WebClipper.SectionPicker.NotebookLoadUnretryableFailureMessage"),n=["10008","10013"],o=n.indexOf(e)>-1;if(o){var r=document.createElement("A");r.href="https://aka.ms/onapi-too-many-items-actionable",r.innerText=i.Localization.getLocalizedString("WebClipper.SectionPicker.NotebookLoadUnretryableFailureLinkMessage");var a=i.Localization.getLocalizedString("WebClipper.SectionPicker.NotebookLoadUnretryableFailureMessageWithExplanation")+"\n"+r.outerHTML;return a}var s=d(e);return s&&s.message?s.message:t}function c(e){var t=d(e);return!!t&&t.requiresSignout}function u(e){var t=d(e);return!!t&&t.isExpected}function p(e){var t=d(e);return!!t&&t.isRetryable}function d(e){var t={10001:{message:i.Localization.getLocalizedString("WebClipper.Error.GenericError"),isRetryable:!0,isExpected:!0},10002:{message:i.Localization.getLocalizedString("WebClipper.Error.GenericError"),isRetryable:!0,isExpected:!0},10004:{message:i.Localization.getLocalizedString("WebClipper.Error.PasswordProtected"),isRetryable:!1,isExpected:!0},10006:{message:i.Localization.getLocalizedString("WebClipper.Error.CorruptedSection"),isRetryable:!1,isExpected:!0},10007:{message:i.Localization.getLocalizedString("WebClipper.Error.GenericError"),isRetryable:!0,isExpected:!0},19999:{message:i.Localization.getLocalizedString("WebClipper.Error.GenericError"),isRetryable:!0,isExpected:!1},20102:{message:i.Localization.getLocalizedString("WebClipper.Error.ResourceDoesNotExist"),isRetryable:!1,isExpected:!0},30101:{message:i.Localization.getLocalizedString("WebClipper.Error.QuotaExceeded"),isRetryable:!1,isExpected:!0},30102:{message:i.Localization.getLocalizedString("WebClipper.Error.SectionTooLarge"),isRetryable:!1,isExpected:!0},30103:{message:i.Localization.getLocalizedString("WebClipper.Error.GenericError"),isRetryable:!0,isExpected:!0},30104:{message:i.Localization.getLocalizedString("WebClipper.Error.UserAccountSuspended"),isRetryable:!1,isExpected:!0},30105:{message:i.Localization.getLocalizedString("WebClipper.Error.NotProvisioned"),isRetryable:!1,isExpected:!0},40004:{message:i.Localization.getLocalizedString("WebClipper.Error.UserDoesNotHaveUpdatePermission"),isRetryable:!1,isExpected:!0,requiresSignout:!0}};if(e)return t[e]}function g(e){var t=[];return e.forEach(function(e){var n='<p><img src="'+e+'" /></p>&nbsp;';t.push({target:"body",action:"append",content:n})}),t}var f;!function(e){e.imagesPerRequestLimit=30}(f=e.Limits||(e.Limits={})),e.logOneNoteApiRequestError=t,e.getApiResponseCode=n,e.getLocalizedErrorMessage=o,e.getLocalizedErrorMessageForGetNotebooks=l,e.requiresSignout=c,e.isExpected=u,e.isRetryable=p,e.createPatchRequestBody=g}(o=n.OneNoteApiUtils||(n.OneNoteApiUtils={}))},{"../constants":74,"../localization/localization":105,"../logging/log":108,"./frontEndGlobals":49}],5:[function(e,t,n){"use strict";var o=function(){function e(){}return e.stopAnimationsThen=function(e,t){Velocity.animate(e,"stop",!0),setTimeout(t,1)},e}();n.AnimationHelper=o},{}],6:[function(e,t,n){"use strict";var o;!function(e){e[e.GoingIn=0]="GoingIn",e[e.GoingOut=1]="GoingOut",e[e.In=2]="In",e[e.Out=3]="Out",e[e.Transitioning=4]="Transitioning",e[e.Stopped=5]="Stopped"}(o=n.AnimationState||(n.AnimationState={}))},{}],7:[function(e,t,n){"use strict";var o=e("../../communicator/smartValue"),r=e("./animationHelper"),i=e("./animationState"),a=function(){function e(e,t){this.animationDuration=e,this.animationState=t||new o.SmartValue(i.AnimationState.Stopped)}return e.prototype.getAnimationState=function(){return this.animationState.get()},e.prototype.setAnimationState=function(e){this.animationState.set(e)},e.prototype.animate=function(e){var t=this;r.AnimationHelper.stopAnimationsThen(e,function(){t.setAnimationState(i.AnimationState.Transitioning),t.doAnimate(e).then(function(){t.setAnimationState(i.AnimationState.Stopped)})})},e}();n.AnimationStrategy=a},{"../../communicator/smartValue":73,"./animationHelper":5,"./animationState":6}],8:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../constants"),i=e("./animationState"),a=e("./transitioningAnimationStrategy"),s=function(e){function t(t){var n=e.call(this,500,t)||this;return n.animationTimeout=100,n.reverseChildAnimations=!0,n}return o(t,e),t.prototype.doAnimateIn=function(e){var t=this;return new Promise(function(n){t.reverseChildAnimations=!0,clearTimeout(t.animationTimeoutId),t.options.onAnimateInExpand&&(t.animationTimeoutId=setTimeout(function(){t.options.onAnimateInExpand(e)},t.animationTimeout)),Velocity.animate(e,{opacity:1,right:20,width:r.Constants.Styles.clipperUiWidth},{complete:function(){t.reverseChildAnimations=!1,n()},duration:t.animationDuration,easing:"easeOutExpo"})})},t.prototype.doAnimateOut=function(e){var t=this;return new Promise(function(n){clearTimeout(t.animationTimeoutId),t.animationTimeoutId=setTimeout(function(){Velocity.animate(e,{opacity:0,right:0,width:0},{complete:function(){n()},duration:t.animationDuration,easing:"easeOutExpo"})},t.animationTimeout)})},t.prototype.intShouldAnimateIn=function(e){return this.getAnimationState()===i.AnimationState.GoingOut||this.getAnimationState()===i.AnimationState.Out},t.prototype.intShouldAnimateOut=function(e){return this.getAnimationState()===i.AnimationState.GoingIn||this.getAnimationState()===i.AnimationState.In},t}(a.TransitioningAnimationStrategy);n.ExpandFromRightAnimationStrategy=s},{"../../constants":74,"./animationState":6,"./transitioningAnimationStrategy":12}],9:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("./animationState"),i=e("./transitioningAnimationStrategy"),a=function(e){function t(t){return e.call(this,200,t)||this}return o(t,e),t.prototype.doAnimateIn=function(e){var t=this;return new Promise(function(n){e.style.opacity="0",Velocity.animate(e,{opacity:1},{complete:function(){n()},duration:t.animationDuration,easing:"easeInOutQuad"})})},t.prototype.doAnimateOut=function(e){var t=this;return new Promise(function(n){Velocity.animate(e,{opacity:0},{complete:function(){n()},duration:t.animationDuration,easing:"easeInOutQuad"})})},t.prototype.intShouldAnimateIn=function(e){return this.getAnimationState()===r.AnimationState.Out},t.prototype.intShouldAnimateOut=function(e){return this.getAnimationState()===r.AnimationState.In},t}(i.TransitioningAnimationStrategy);n.FadeInAnimationStrategy=a},{"./animationState":6,"./transitioningAnimationStrategy":12}],10:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("./animationState"),i=e("./transitioningAnimationStrategy"),a=function(e){function t(t){var n=e.call(this,void 0,t,t.currentAnimationState)||this;return n.animateInDuration=367,n.animateOutDuration=267,n.animateOutSlideUpDelta=23,n.contentToAnimate=t.contentToAnimate,n}return o(t,e),t.prototype.doAnimateIn=function(e){var t=this;return new Promise(function(n){for(var o=0;o<t.contentToAnimate.length;o++)for(var r=t.contentToAnimate[o],i=e.querySelectorAll(r.cssSelector),a=0;a<i.length;a++){var s=o===t.contentToAnimate.length-1&&a===i.length-1;t.animateElementIn(i[a],r.animateInOptions.slideDownDeltas[a],r.animateInOptions.delaysInMs[a],s).then(function(e){e&&n()})}})},t.prototype.doAnimateOut=function(e){var t=this;return new Promise(function(n){var o=t.contentToAnimate.map(function(e){return e.cssSelector}).join(", "),r=e.querySelectorAll(o);Velocity.animate(r,{top:-t.animateOutSlideUpDelta,opacity:[0,"linear"]},{complete:function(){n()},duration:t.animateOutDuration,easing:[1,0,1,1]})})},t.prototype.intShouldAnimateIn=function(e){return this.getAnimationState()===r.AnimationState.Out},t.prototype.intShouldAnimateOut=function(e){return this.getAnimationState()===r.AnimationState.In},t.prototype.animateElementIn=function(e,t,n,o){var r=this;return new Promise(function(i){e.style.top=-t+"px",e.style.opacity="0",Velocity.animate(e,{top:0,opacity:[1,"linear"]},{complete:function(){i(o?!0:!1)},delay:n,duration:r.animateInDuration,easing:[0,0,0,1]})})},t}(i.TransitioningAnimationStrategy);n.SlideContentInFromTopAnimationStrategy=a},{"./animationState":6,"./transitioningAnimationStrategy":12}],11:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("./animationStrategy"),i=function(e){function t(t,n){var o=e.call(this,200)||this;return o.containerId=t,o.options=n,o}return o(t,e),t.prototype.doAnimate=function(e){var t=this;return new Promise(function(n){var o=document.getElementById(t.containerId),r=t.getContainerTrueHeight(o,e);if(t.options.onBeforeHeightAnimatorDraw&&t.options.onBeforeHeightAnimatorDraw(r),r.actualPanelHeight===r.newPanelHeight)return void n();var i=r.actualPanelHeight>r.newPanelHeight;!i&&t.options.onAfterHeightAnimatorDraw&&t.options.onAfterHeightAnimatorDraw(r),Velocity.animate(e,{maxHeight:r.newPanelHeight,minHeight:r.newPanelHeight},{complete:function(){i&&t.options.onAfterHeightAnimatorDraw&&t.options.onAfterHeightAnimatorDraw(r),n()},duration:t.animationDuration,easing:"easeOutQuad"})})},t.prototype.getContainerTrueHeight=function(e,t){var n=parseFloat(t.style.maxHeight.replace("px",""));isNaN(n)&&(n=0),t.style.maxHeight="",t.style.minHeight="";var o=e?e.offsetHeight:0,r=t.offsetHeight;return t.style.maxHeight=n+"px",t.style.minHeight=n+"px",{actualPanelHeight:n,newContainerHeight:o,newPanelHeight:r}},t}(r.AnimationStrategy);n.SlidingHeightAnimationStrategy=i},{"./animationStrategy":7}],12:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../objectUtils"),i=e("../../communicator/smartValue"),a=e("./animationHelper"),s=e("./animationState"),l=e("./animationStrategy"),c=function(e){function t(t,n,o){var a=this;return o=o||new i.SmartValue,r.ObjectUtils.isNullOrUndefined(o.get())&&o.set(s.AnimationState.Out),a=e.call(this,t,o)||this,a.options=n,a}return o(t,e),t.prototype.animate=function(e){this.doAnimate(e)},t.prototype.doAnimate=function(e){return this.options.extShouldAnimateIn()&&this.intShouldAnimateIn(e)?this.animateIn(e):this.options.extShouldAnimateOut()&&this.intShouldAnimateOut(e)?this.animateOut(e):void 0},t.prototype.animateIn=function(e){var t=this;return new Promise(function(n){a.AnimationHelper.stopAnimationsThen(e,function(){t.options.onBeforeAnimateIn&&t.options.onBeforeAnimateIn(e),t.setAnimationState(s.AnimationState.GoingIn),t.doAnimateIn(e).then(function(){t.setAnimationState(s.AnimationState.In),t.options.onAfterAnimateIn&&t.options.onAfterAnimateIn(e),n()})})})},t.prototype.animateOut=function(e){var t=this;return new Promise(function(n){a.AnimationHelper.stopAnimationsThen(e,function(){t.options.onBeforeAnimateOut&&t.options.onBeforeAnimateOut(e),t.setAnimationState(s.AnimationState.GoingOut),t.doAnimateOut(e).then(function(){t.setAnimationState(s.AnimationState.Out),t.options.onAfterAnimateOut&&t.options.onAfterAnimateOut(e),n()})})})},t}(l.AnimationStrategy);n.TransitioningAnimationStrategy=c},{"../../communicator/smartValue":73,"../../objectUtils":123,"./animationHelper":5,"./animationState":6,"./animationStrategy":7}],13:[function(e,t,n){"use strict";var o;!function(e){e[e.Augmentation=0]="Augmentation",e[e.Bookmark=1]="Bookmark",e[e.FullPage=2]="FullPage",e[e.Pdf=3]="Pdf",e[e.Region=4]="Region",e[e.Selection=5]="Selection"}(o=n.ClipMode||(n.ClipMode={}))},{}],14:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../userInfo"),i=e("../browserUtils"),a=e("../constants"),s=e("../objectUtils"),l=e("../polyfills"),c=e("./tooltipType"),u=e("../urlUtils"),p=e("../communicator/communicator"),d=e("../communicator/iframeMessageHandler"),g=e("../communicator/inlineMessageHandler"),f=e("../communicator/smartValue"),h=e("../contentCapture/augmentationHelper"),v=e("../contentCapture/bookmarkHelper"),y=e("../contentCapture/fullPageScreenshotHelper"),C=e("../contentCapture/pdfScreenshotHelper"),S=e("../domParsers/domUtils"),b=e("../domParsers/videoUtils"),w=e("../extensions/invokeOptions"),P=e("../extensions/bookmarklet/inlineExtension"),I=e("../http/cachedHttp"),T=e("../localization/localization"),E=e("../logging/log"),L=e("../logging/communicatorLoggerPure"),A=e("../saveToOneNote/oneNoteSaveableFactory"),U=e("../saveToOneNote/saveToOneNote"),x=e("../saveToOneNote/saveToOneNoteLogger"),N=e("../storage/clipperStorageKeys"),O=e("./clipMode"),R=e("./frontEndGlobals"),F=e("./clipperStateUtilities"),k=e("./componentBase"),_=e("./mainController"),B=e("./oneNoteApiUtils"),z=e("./previewViewer"),D=e("./ratingsHelper"),W=e("./regionSelector"),M=e("./status"),H=e("lodash"),V=function(e){function t(t){var n=e.call(this,t)||this;return n.isFullScreen=new f.SmartValue(!1),n.initializeCommunicators(),n.initializeSmartValues(),n}return o(t,e),t.prototype.getInitialState=function(){var e=this;return{uiExpanded:!0,currentMode:new f.SmartValue(this.getDefaultClipMode()),userResult:{status:M.Status.NotStarted},fullPageResult:{status:M.Status.NotStarted},pdfResult:{data:new f.SmartValue,status:M.Status.NotStarted},regionResult:{status:M.Status.NotStarted,data:[]},augmentationResult:{status:M.Status.NotStarted},oneNoteApiResult:{status:M.Status.NotStarted},bookmarkResult:{status:M.Status.NotStarted},setState:function(n){e.setState(n),e.isFullScreen.set(t.shouldShowPreviewViewer(e.state)||t.shouldShowRegionSelector(e.state))},previewGlobalInfo:{annotation:"",fontSize:parseInt(T.Localization.getLocalizedString("WebClipper.FontSize.Preview.SansSerifDefault"),10),highlighterEnabled:!1,serif:!1},augmentationPreviewInfo:{},selectionPreviewInfo:{},pdfPreviewInfo:{allPages:!0,isLocalFileAndNotAllowed:!0,selectedPageRange:"",shouldAttachPdf:!1,shouldDistributePages:!1,shouldShowPopover:!1},clipSaveStatus:{numItemsTotal:void 0,numItemsCompleted:void 0},reset:function(){e.state.setState(e.getResetState())}}},t.prototype.getResetState=function(){return{currentMode:this.state.currentMode.set(this.getDefaultClipMode()),oneNoteApiResult:{status:M.Status.NotStarted}}},t.prototype.initializeInjectCommunicator=function(e,t){var n=this;R.Clipper.getInjectCommunicator().registerFunction(a.Constants.FunctionKeys.noOpTracker,function(e){var t=new E.Event.BaseEvent(E.Event.Label.ClearNoOpTracker);return t.setCustomProperty(E.PropertyName.Custom.TimeToClearNoOpTracker,(new Date).getTime()-e),t.setCustomProperty(E.PropertyName.Custom.Channel,a.Constants.CommunicationChannels.injectedAndUi),R.Clipper.logger.logEvent(t),Promise.resolve()}),R.Clipper.getInjectCommunicator().registerFunction(a.Constants.FunctionKeys.showRefreshClipperMessage,function(e){n.state.badState||(R.Clipper.logger.logFailure(E.Failure.Label.OrphanedWebClippersDueToExtensionRefresh,E.Failure.Type.Expected,{error:e}),n.state.setState({badState:!0}))}),R.Clipper.getInjectCommunicator().registerFunction(a.Constants.FunctionKeys.toggleClipper,function(){n.state.setState({uiExpanded:!n.state.uiExpanded})}),R.Clipper.getInjectCommunicator().registerFunction(a.Constants.FunctionKeys.onSpaNavigate,function(){if(n.state.uiExpanded){var e=new E.Event.BaseEvent(E.Event.Label.HideClipperDueToSpaNavigate);R.Clipper.logger.logEvent(e),n.state.setState({uiExpanded:!1})}}),R.Clipper.getInjectCommunicator().registerFunction(a.Constants.FunctionKeys.setInvokeOptions,function(e){n.setInvokeOptions(e)}),R.Clipper.getInjectCommunicator().broadcastAcrossCommunicator(this.isFullScreen,a.Constants.SmartValueKeys.isFullScreen),R.Clipper.getInjectCommunicator().subscribeAcrossCommunicator(e,a.Constants.SmartValueKeys.pageInfo,function(e){if(e){var t=H.extend(n.state.previewGlobalInfo,{previewTitleText:e.contentTitle});n.state.setState({pageInfo:e,previewGlobalInfo:t}),n.capturePdfScreenshotContent(),n.captureFullPageScreenshotContent(),n.captureAugmentedContent(),n.captureBookmarkContent(),R.Clipper.logger.setContextProperty(E.Context.Custom.ContentType,OneNoteApi.ContentType[e.contentType])}}),R.Clipper.getInjectCommunicator().setErrorHandler(function(e){E.ErrorUtils.handleCommunicatorError(a.Constants.CommunicationChannels.injectedAndUi,e,t)})},t.prototype.capturePdfScreenshotContent=function(){var e=this;this.state.pageInfo.contentType===OneNoteApi.ContentType.EnhancedUrl&&this.state.pdfResult.status===M.Status.NotStarted&&(this.state.setState({pdfResult:{data:new f.SmartValue(void 0),status:M.Status.InProgress}}),this.getPdfScreenshotResultFromRawUrl(this.state.pageInfo.rawUrl).then(function(t){e.state.pdfResult.data.set(t),e.state.setState({pdfResult:{data:e.state.pdfResult.data,status:M.Status.Succeeded}})}).catch(function(){e.state.pdfResult.data.set({failureMessage:T.Localization.getLocalizedString("WebClipper.Preview.FullPageModeGenericError")}),e.state.setState({pdfResult:{data:e.state.pdfResult.data,status:M.Status.Failed}}),e.state.pdfResult.data.forceUpdate()}))},t.prototype.getPdfScreenshotResultFromRawUrl=function(e){return 0===e.indexOf("file:///")?C.PdfScreenshotHelper.getLocalPdfData(e):C.PdfScreenshotHelper.getPdfData(e)},t.prototype.captureFullPageScreenshotContent=function(){var e=this;this.state.pageInfo.contentType===OneNoteApi.ContentType.EnhancedUrl?this.state.setState({fullPageResult:{data:{failureMessage:T.Localization.getLocalizedString("WebClipper.Preview.NoContentFound")},status:M.Status.Failed}}):(this.state.setState({fullPageResult:{status:M.Status.InProgress}}),y.FullPageScreenshotHelper.getFullPageScreenshot(this.state.pageInfo.contentData).then(function(t){e.state.setState({fullPageResult:{data:t,status:M.Status.Succeeded}})},function(){e.state.setState({fullPageResult:{data:{failureMessage:T.Localization.getLocalizedString("WebClipper.Preview.NoFullPageScreenshotFound")},status:M.Status.Failed}})}))},t.prototype.captureAugmentedContent=function(){var e=this;if(this.state.pageInfo.contentType===OneNoteApi.ContentType.EnhancedUrl)this.state.setState({augmentationResult:{data:{failureMessage:T.Localization.getLocalizedString("WebClipper.Preview.NoContentFound")},status:M.Status.Failed}});else{this.state.setState({augmentationResult:{status:M.Status.InProgress}});var t=this.state.pageInfo,n=t.canonicalUrl;(t.rawUrl.indexOf("youtube.com")>-1||t.rawUrl.indexOf("vimeo.com")>-1)&&(n=t.rawUrl),h.AugmentationHelper.augmentPage(n,t.contentLocale,t.contentData).then(function(t){t.ContentInHtml=S.DomUtils.cleanHtml(t.ContentInHtml),e.state.setState({augmentationResult:{data:t,status:M.Status.Succeeded},augmentationPreviewInfo:{previewBodyHtml:t.ContentInHtml}})},function(){e.state.setState({augmentationResult:{data:{failureMessage:T.Localization.getLocalizedString("WebClipper.Preview.AugmentationModeGenericError")},status:M.Status.Failed}})})}},t.prototype.captureBookmarkContent=function(){var e=this;this.state.setState({bookmarkResult:{status:M.Status.InProgress}});var t=this.state.pageInfo,n=t.rawUrl,o=t.contentTitle,r=S.DomUtils.getDocumentFromDomString(t.contentData),i=v.BookmarkHelper.getElementsByTagName(r,v.BookmarkHelper.metadataTagNames),a=v.BookmarkHelper.getElementsByTagName(r.body,[S.DomUtils.tags.img]),s=[];try{s=v.BookmarkHelper.getNonWhiteSpaceTextElements(r,!0)}catch(e){}v.BookmarkHelper.bookmarkPage(n,o,i,!0,a,s).then(function(t){e.state.setState({bookmarkResult:{data:t,status:M.Status.Succeeded}})},function(t){e.state.setState({bookmarkResult:{data:{url:t.url,title:o,description:t.description,thumbnailSrc:t.thumbnailSrc,failureMessage:T.Localization.getLocalizedString("WebClipper.Preview.BookmarkModeGenericError")},status:M.Status.Failed}})})},t.prototype.setInvokeOptions=function(e){switch(this.setState({invokeOptions:e}),this.setState({currentMode:this.state.currentMode.set(this.getDefaultClipMode())}),e.invokeMode){case w.InvokeMode.ContextImage:this.setState({regionResult:{data:[e.invokeDataForMode],status:M.Status.Succeeded}});break;case w.InvokeMode.ContextTextSelection:this.state.setState({selectionPreviewInfo:{previewBodyHtml:e.invokeDataForMode}})}},t.prototype.initializeExtensionCommunicator=function(e){var t=this;R.Clipper.getExtensionCommunicator().registerFunction(a.Constants.FunctionKeys.noOpTracker,function(e){var t=new E.Event.BaseEvent(E.Event.Label.ClearNoOpTracker);return t.setCustomProperty(E.PropertyName.Custom.TimeToClearNoOpTracker,(new Date).getTime()-e),t.setCustomProperty(E.PropertyName.Custom.Channel,a.Constants.CommunicationChannels.extensionAndUi),R.Clipper.logger.logEvent(t),Promise.resolve()}),R.Clipper.getExtensionCommunicator().registerFunction(a.Constants.FunctionKeys.createHiddenIFrame,function(e){i.BrowserUtils.appendHiddenIframeToDocument(e)});var n=function(e){if(e){var n=new E.Event.BaseEvent(E.Event.Label.UserInfoUpdated);n.setCustomProperty(E.PropertyName.Custom.UserUpdateReason,r.UpdateReason[e.updateReason]),n.setCustomProperty(E.PropertyName.Custom.LastUpdated,new Date(e.lastUpdated).toUTCString()),R.Clipper.logger.logEvent(n)}if(e&&e.user){var o={data:e.user,lastUpdated:e.lastUpdated},i=I.CachedHttp.valueHasExpired(o,1e3*e.user.accessTokenExpiration-18e4);i&&R.Clipper.logger.logFailure(E.Failure.Label.UserSetWithInvalidExpiredData,E.Failure.Type.Unexpected),t.state.setState({userResult:{status:M.Status.Succeeded,data:e}}),R.Clipper.logger.setContextProperty(E.Context.Custom.AuthType,e.user.authType),R.Clipper.logger.setContextProperty(E.Context.Custom.UserInfoId,e.user.cid)}else t.state.setState({userResult:{status:M.Status.Failed,data:e}})};this.state.setState({userResult:{status:M.Status.InProgress}}),R.Clipper.getExtensionCommunicator().callRemoteFunction(a.Constants.FunctionKeys.getInitialUser,{callback:function(e){e&&e.user?R.Clipper.logger.logUserFunnel(E.Funnel.Label.AuthAlreadySignedIn):e||n(e),R.Clipper.getExtensionCommunicator().subscribeAcrossCommunicator(new f.SmartValue,a.Constants.SmartValueKeys.user,function(e){n(e)})}}),this.state.setState({fetchLocStringStatus:M.Status.InProgress}),R.Clipper.getExtensionCommunicator().callRemoteFunction(a.Constants.FunctionKeys.clipperStrings,{callback:function(e){e&&T.Localization.setLocalizedStrings(e),t.state.setState({fetchLocStringStatus:M.Status.Succeeded})}}),R.Clipper.getExtensionCommunicator().registerFunction(a.Constants.FunctionKeys.extensionNotAllowedToAccessLocalFiles,function(){t.state.pdfPreviewInfo.isLocalFileAndNotAllowed&&R.Clipper.logger.logEvent(new E.Event.BaseEvent(E.Event.Label.LocalFilesNotAllowedPanelShown)),H.assign(H.extend(t.state.pdfPreviewInfo,{isLocalFileAndNotAllowed:!1}),t.state.setState)}),R.Clipper.getExtensionCommunicator().subscribeAcrossCommunicator(e,a.Constants.SmartValueKeys.clientInfo,function(e){e&&t.state.setState({clientInfo:e})}),R.Clipper.getExtensionCommunicator().setErrorHandler(function(t){E.ErrorUtils.handleCommunicatorError(a.Constants.CommunicationChannels.extensionAndUi,t,e)})},t.prototype.initializeCommunicators=function(){var e=this,t=new f.SmartValue,n=new f.SmartValue;R.Clipper.setInjectCommunicator(new p.Communicator(new d.IFrameMessageHandler(function(){return parent}),a.Constants.CommunicationChannels.injectedAndUi)),R.Clipper.getInjectCommunicator().registerFunction(a.Constants.FunctionKeys.setInjectOptions,function(o){if(e.setState({injectOptions:o}),e.state.injectOptions.useInlineBackgroundWorker){var r=new P.InlineExtension,i=r.getInlineMessageHandler(),s=new g.InlineMessageHandler(i);i.setOtherSide(s),R.Clipper.setExtensionCommunicator(new p.Communicator(s,a.Constants.CommunicationChannels.extensionAndUi))}else R.Clipper.setExtensionCommunicator(new p.Communicator(new d.IFrameMessageHandler(function(){return parent}),a.Constants.CommunicationChannels.extensionAndUi));e.initializeExtensionCommunicator(n),R.Clipper.getExtensionCommunicator().subscribeAcrossCommunicator(R.Clipper.sessionId,a.Constants.SmartValueKeys.sessionId),R.Clipper.logger=new L.CommunicatorLoggerPure(R.Clipper.getExtensionCommunicator()),e.initializeInjectCommunicator(t,n),R.Clipper.getInjectCommunicator().registerFunction(a.Constants.FunctionKeys.tabToLowestIndexedElement,function(){var e,t=document.querySelectorAll("[tabindex]");if(t.length>0){for(var n=0;n<t.length;n++){var o=t[n];(!e||o.tabIndex<e.tabIndex)&&o.tabIndex>=0&&(e=o)}e.focus()}}),e.initializeNumSuccessfulClips(),D.RatingsHelper.preCacheNeededValues()}),n.subscribe(function(t){t&&e.state.setState({currentMode:e.state.currentMode.set(e.getDefaultClipMode())})})},t.prototype.initializeSmartValues=function(){this.state.currentMode.subscribe(function(e){switch(e){case O.ClipMode.FullPage:case O.ClipMode.Augmentation:R.Clipper.getInjectCommunicator().callRemoteFunction(a.Constants.FunctionKeys.updatePageInfoIfUrlChanged)}},{callOnSubscribe:!1})},t.prototype.initializeNumSuccessfulClips=function(){var e=this;R.Clipper.getStoredValue(N.ClipperStorageKeys.numSuccessfulClips,function(t){var n=parseInt(t,10);e.state.numSuccessfulClips=s.ObjectUtils.isNullOrUndefined(n)||isNaN(n)?0:n})},t.prototype.getDefaultClipMode=function(){if(this.state&&this.state.invokeOptions)switch(this.state.invokeOptions.invokeMode){case w.InvokeMode.ContextImage:if(this.state.regionResult.data.length>0)return O.ClipMode.Region;break;case w.InvokeMode.ContextTextSelection:return O.ClipMode.Selection}if(this.state&&this.state.pageInfo){if(this.state.pageInfo.contentType===OneNoteApi.ContentType.EnhancedUrl)return O.ClipMode.Pdf;if(u.UrlUtils.onWhitelistedDomain(this.state.pageInfo.rawUrl))return O.ClipMode.Augmentation}return O.ClipMode.FullPage},t.prototype.updateFrameHeight=function(e){R.Clipper.getInjectCommunicator().callRemoteFunction(a.Constants.FunctionKeys.updateFrameHeight,{param:e})},t.prototype.handleSignIn=function(e){var t=this;R.Clipper.logger.logUserFunnel(E.Funnel.Label.AuthAttempted);var n=new E.Event.PromiseEvent(E.Event.Label.HandleSignInEvent);this.setState({userResult:{status:M.Status.InProgress}}),R.Clipper.getExtensionCommunicator().callRemoteFunction(a.Constants.FunctionKeys.signInUser,{param:e,callback:function(o){var i=o,a=o,s=a.error||a.errorDescription;s&&(a.errorDescription=r.AuthType[e]+": "+a.error+": "+a.errorDescription,t.state.setState({userResult:{status:M.Status.Failed,data:a}}),n.setStatus(E.Status.Failed),n.setFailureInfo({error:a.errorDescription}),n.setCustomProperty(E.PropertyName.Custom.CorrelationId,a.correlationId),R.Clipper.logger.logUserFunnel(E.Funnel.Label.AuthSignInFailed));var l=i&&!!i.user;l&&(R.Clipper.storeValue(N.ClipperStorageKeys.hasPatchPermissions,"true"),R.Clipper.logger.logUserFunnel(E.Funnel.Label.AuthSignInCompleted)),n.setCustomProperty(E.PropertyName.Custom.UserInformationReturned,l),n.setCustomProperty(E.PropertyName.Custom.SignInCancelled,!s&&!l),R.Clipper.logger.logEvent(n)}})},t.prototype.handleSignOut=function(e){this.state.setState(this.getSignOutState()),R.Clipper.getExtensionCommunicator().callRemoteFunction(a.Constants.FunctionKeys.signOutUser,{param:r.AuthType[e]}),R.Clipper.logger.logUserFunnel(E.Funnel.Label.SignOut),R.Clipper.logger.logSessionEnd(E.Session.EndTrigger.SignOut),R.Clipper.logger.logSessionStart()},t.prototype.getSignOutState=function(){var e=this.getResetState();return e.saveLocation=void 0,e.userResult=void 0,e},t.prototype.handleStartClip=function(){var e=this;R.Clipper.logger.logUserFunnel(E.Funnel.Label.ClipAttempted),this.state.setState({userResult:{status:M.Status.InProgress,data:this.state.userResult.data}}),R.Clipper.getExtensionCommunicator().callRemoteFunction(a.Constants.FunctionKeys.ensureFreshUserBeforeClip,{callback:function(t){if(t&&t.user){var n=e.state.currentMode.get();if(n===O.ClipMode.FullPage)R.Clipper.getInjectCommunicator().callRemoteFunction(a.Constants.FunctionKeys.updatePageInfoIfUrlChanged,{callback:function(){e.startClip()}});else if(n===O.ClipMode.Bookmark){var o=document.getElementById("previewBody").innerHTML;e.state.setState({bookmarkPreviewInfo:{previewBodyHtml:o}}),e.startClip()}else e.startClip()}}})},t.prototype.startClip=function(){var e=this;this.state.setState({oneNoteApiResult:{status:M.Status.InProgress}}),this.storeLastClippedInformation(),x.SaveToOneNoteLogger.logClip(this.state);var t=new E.Event.PromiseEvent(E.Event.Label.ClipToOneNoteAction);
new A.OneNoteSaveableFactory(this.state).getSaveable().then(function(n){var o={page:n,saveLocation:e.state.saveLocation,progressCallback:e.updateClipSaveProgress.bind(e)},r=new U.SaveToOneNote(e.state.userResult.data.user.accessToken);r.save(o).then(function(n){var o=Array.isArray(n)?n[0]:n;t.setCustomProperty(E.PropertyName.Custom.CorrelationId,o.request.getResponseHeader(a.Constants.HeaderValues.correlationId));var r=e.state.numSuccessfulClips+1;R.Clipper.storeValue(N.ClipperStorageKeys.numSuccessfulClips,r.toString()),e.state.setState({oneNoteApiResult:{data:o.parsedResponse,status:M.Status.Succeeded},numSuccessfulClips:r,showRatingsPrompt:D.RatingsHelper.shouldShowRatingsPrompt(e.state)})}).catch(function(n){B.OneNoteApiUtils.logOneNoteApiRequestError(t,n),e.state.setState({oneNoteApiResult:{data:n,status:M.Status.Failed}})}).then(function(){R.Clipper.logger.logEvent(t)})})},t.prototype.updateClipSaveProgress=function(e,t){this.state.setState({clipSaveStatus:{numItemsCompleted:e,numItemsTotal:t}})},t.prototype.storeLastClippedInformation=function(){if(R.Clipper.storeValue(N.ClipperStorageKeys.lastClippedDate,Date.now().toString()),this.state.currentMode.get()===O.ClipMode.Pdf&&R.Clipper.storeValue(N.ClipperStorageKeys.lastClippedTooltipTimeBase+c.TooltipType[c.TooltipType.Pdf],Date.now().toString()),this.state.currentMode.get()===O.ClipMode.Augmentation){var e=h.AugmentationHelper.getAugmentationType(this.state);R.Clipper.storeValue(N.ClipperStorageKeys.lastClippedTooltipTimeBase+e,Date.now().toString())}b.VideoUtils.videoDomainIfSupported(this.state.pageInfo.rawUrl)&&R.Clipper.storeValue(N.ClipperStorageKeys.lastClippedTooltipTimeBase+c.TooltipType[c.TooltipType.Video],Date.now().toString())},t.shouldShowOptions=function(e){return e.uiExpanded&&F.ClipperStateUtilities.isUserLoggedIn(e)&&e.oneNoteApiResult.status===M.Status.NotStarted&&!e.badState},t.shouldShowPreviewViewer=function(e){return this.shouldShowOptions(e)&&(e.currentMode.get()!==O.ClipMode.Region||e.regionResult.status===M.Status.Succeeded)},t.shouldShowRegionSelector=function(e){return this.shouldShowOptions(e)&&e.currentMode.get()===O.ClipMode.Region&&e.regionResult.status!==M.Status.Succeeded},t.shouldShowMainController=function(e){return e.regionResult.status!==M.Status.InProgress||e.badState},t.prototype.render=function(){var e=t.shouldShowPreviewViewer(this.state)?m.component(z.PreviewViewer,{clipperState:this.state}):void 0,n=t.shouldShowRegionSelector(this.state)?m.component(W.RegionSelector,{clipperState:this.state}):void 0,o=t.shouldShowMainController(this.state)?{}:{display:"none"};return{tag:"div",attrs:{},children:[e,n,{tag:"div",attrs:{style:o},children:[m.component(_.MainController,{clipperState:this.state,onSignInInvoked:this.handleSignIn.bind(this),onSignOutInvoked:this.handleSignOut.bind(this),updateFrameHeight:this.updateFrameHeight.bind(this),onStartClip:this.handleStartClip.bind(this)})]}]}},t}(k.ComponentBase);l.Polyfills.init();var j=window.onerror;window.onerror=function(e,t,n,o,r){var i=r?E.Failure.getStackTrace(r):"[unknown stacktrace]";R.Clipper.logger.logFailure(E.Failure.Label.UnhandledExceptionThrown,E.Failure.Type.Unexpected,{error:e+" ("+t+":"+n+":"+o+") at "+i},"ClipperUI"),j&&j(e,t,n,o,r)};var K=V.componentize();n.Clipper=K,m.mount(document.getElementById("clipperUIPlaceholder"),K)},{"../browserUtils":2,"../communicator/communicator":69,"../communicator/iframeMessageHandler":70,"../communicator/inlineMessageHandler":71,"../communicator/smartValue":73,"../constants":74,"../contentCapture/augmentationHelper":75,"../contentCapture/bookmarkHelper":76,"../contentCapture/fullPageScreenshotHelper":77,"../contentCapture/pdfScreenshotHelper":79,"../domParsers/domUtils":83,"../domParsers/videoUtils":86,"../extensions/bookmarklet/inlineExtension":90,"../extensions/invokeOptions":95,"../http/cachedHttp":101,"../localization/localization":105,"../logging/communicatorLoggerPure":107,"../logging/log":108,"../objectUtils":123,"../polyfills":125,"../saveToOneNote/oneNoteSaveableFactory":129,"../saveToOneNote/saveToOneNote":133,"../saveToOneNote/saveToOneNoteLogger":134,"../storage/clipperStorageKeys":138,"../urlUtils":142,"../userInfo":143,"./clipMode":13,"./clipperStateUtilities":15,"./componentBase":16,"./frontEndGlobals":49,"./mainController":50,"./oneNoteApiUtils":51,"./previewViewer":63,"./ratingsHelper":64,"./regionSelector":65,"./status":66,"./tooltipType":67,lodash:150}],15:[function(e,t,n){"use strict";var o,r=e("../objectUtils"),i=e("./clipMode"),a=e("./status");!function(e){function t(e){return e.userResult&&e.userResult.status&&e.userResult.data&&!!e.userResult.data.user}function n(e){return e.userResult&&e.userResult.data&&e.userResult.data.user&&e.userResult.data.user.authType&&"msa"===e.userResult.data.user.authType.toLowerCase()}function o(e){var t=e.currentMode.get();switch(t){case i.ClipMode.Pdf:return!!e.pdfPreviewInfo.isLocalFileAndNotAllowed&&(e.pdfResult.status===a.Status.Succeeded&&(!!e.pdfPreviewInfo.allPages||!(!e.pdfPreviewInfo.allPages&&r.ObjectUtils.isNullOrUndefined(e.pdfPreviewInfo.selectedPageRange))));case i.ClipMode.FullPage:var n=e.fullPageResult;return n.status===a.Status.Succeeded;case i.ClipMode.Region:var o=e.regionResult;return o.status===a.Status.Succeeded&&o.data&&o.data.length>0;case i.ClipMode.Augmentation:var s=e.augmentationResult;return s.status===a.Status.Succeeded&&s.data&&!!s.data.ContentInHtml;case i.ClipMode.Bookmark:var l=e.bookmarkResult;return l.status===a.Status.Succeeded;case i.ClipMode.Selection:return!0;default:return}}e.isUserLoggedIn=t,e.isMsaUser=n,e.clipButtonEnabled=o}(o=n.ClipperStateUtilities||(n.ClipperStateUtilities={}))},{"../objectUtils":123,"./clipMode":13,"./status":66}],16:[function(e,t,n){"use strict";var o=e("../constants"),r=e("./frontEndGlobals"),i=function(){function e(e){this.props=e,this.state=this.getInitialState(),this.refs={}}return e.prototype.getInitialState=function(){return{}},e.prototype.setState=function(e){m.startComputation();for(var t in e)e.hasOwnProperty(t)&&(this.state[t]=e[t]);m.endComputation()},e.prototype.ref=function(e){var t=this;return{config:function(n){t.refs[e]=n}}},e.prototype.onElementDraw=function(e){return e=e.bind(this),{config:function(t,n){e(t,!n)}}},e.prototype.onElementFirstDraw=function(e){return e=e.bind(this),{config:function(t,n){n||e(t)}}},e.prototype.enableAriaInvoke=function(t){var n=t.callback,r=t.tabIndex,i=t.args,a=t.idOverride,s=t.ariaSetName,l=t.autoSelect,c=void 0!==l&&l;n&&(n=n.bind(this,i));var u=this.enableInvoke({callback:n,tabIndex:r,args:i,idOverride:a}),p=u.onkeyup;return u.onkeyup=function(t){var n=t.currentTarget;if(p(t),t.which===o.Constants.KeyCodes.home){var r=1;e.focusOnButton(s,r,c)}else if(t.which===o.Constants.KeyCodes.end){var i=parseInt(n.getAttribute("aria-setsize"),10);e.focusOnButton(s,i,c)}var a=parseInt(n.getAttribute("aria-posinset"),10);if(t.which===o.Constants.KeyCodes.up||t.which===o.Constants.KeyCodes.left){if(a<=1)return;var l=a-1;e.focusOnButton(s,l,c)}else if(t.which===o.Constants.KeyCodes.down||t.which===o.Constants.KeyCodes.right){var u=parseInt(n.getAttribute("aria-setsize"),10);if(a>=u)return;var l=a+1;e.focusOnButton(s,l,c)}},u["data-"+o.Constants.CustomHtmlAttributes.setNameForArrowKeyNav]=s,u},e.prototype.enableInvoke=function(t){var n=t.callback,r=t.tabIndex,i=t.args,a=t.idOverride;return n&&(n=n.bind(this,i)),{onclick:function(t){var o=t.currentTarget;e.triggerSelection(o,a,n,t)},onkeyup:function(t){var r=t.currentTarget;t.which===o.Constants.KeyCodes.enter||t.which===o.Constants.KeyCodes.space?"A"===r.tagName&&r.hasAttribute("href")||e.triggerSelection(r,void 0,n,t):t.which===o.Constants.KeyCodes.tab&&(r.style.outlineStyle="")},onkeydown:function(e){e.which!==o.Constants.KeyCodes.space&&e.which!==o.Constants.KeyCodes.up&&e.which!==o.Constants.KeyCodes.down&&e.which!==o.Constants.KeyCodes.left&&e.which!==o.Constants.KeyCodes.right&&e.which!==o.Constants.KeyCodes.home&&e.which!==o.Constants.KeyCodes.end||(e.preventDefault(),e.stopImmediatePropagation())},onmousedown:function(e){var t=e.currentTarget;t.style.outlineStyle="none"},tabIndex:r}},e.triggerSelection=function(e,t,n,o){var i=t?t:e.id;r.Clipper.logger.logClickEvent(i),n&&n(o)},e.focusOnButton=function(e,t,n){for(var r=document.querySelectorAll("[data-"+o.Constants.CustomHtmlAttributes.setNameForArrowKeyNav+"="+e+"]"),i=0;i<r.length;i++){var a=r[i],s=parseInt(a.getAttribute("aria-posinset"),10);if(s===t)return a.style.outlineStyle="",void(n?a.click():a.focus())}},e.componentize=function(){var e=this,t=function(){};return t.controller=function(t){return new e(t)},t.view=function(e,t){return e.props=t,e.render()},t},e}();n.ComponentBase=i},{"../constants":74,"./frontEndGlobals":49}],17:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../constants"),i=e("../../localization/localization"),a=e("../componentBase"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.addTextAreaListener=function(){var e=this;document.addEventListener("input",function(t){var n=t.target,o=document.getElementById(r.Constants.Ids.annotationField);n&&n===o&&e.handleAnnotationFieldChanged(o.value)})},t.prototype.handleAnnotationFieldChanged=function(e){this.props.clipperState.setState({previewGlobalInfo:{previewTitleText:this.props.clipperState.previewGlobalInfo.previewTitleText,annotation:e,fontSize:this.props.clipperState.previewGlobalInfo.fontSize,serif:this.props.clipperState.previewGlobalInfo.serif}})},t.prototype.render=function(){return t.textAreaListenerAttached||(this.addTextAreaListener(),t.textAreaListenerAttached=!0),{tag:"div",attrs:{id:r.Constants.Ids.annotationContainer},children:[{tag:"pre",attrs:{id:r.Constants.Ids.annotationFieldMirror,className:r.Constants.Classes.textAreaInputMirror},children:[{tag:"span",attrs:{style:i.Localization.getFontFamilyAsStyle(i.Localization.FontFamily.Regular)},children:[this.props.clipperState.previewGlobalInfo.annotation?this.props.clipperState.previewGlobalInfo.annotation:""]},{tag:"br",attrs:{}}]},{tag:"textarea",attrs:{id:r.Constants.Ids.annotationField,className:r.Constants.Classes.textAreaInput,role:"textbox",rows:1,tabIndex:211,"aria-label":i.Localization.getLocalizedString("WebClipper.Accessibility.ScreenReader.InputBoxToChangeNotesToAddToPage"),style:i.Localization.getFontFamilyAsStyle(i.Localization.FontFamily.Regular),value:this.props.clipperState.previewGlobalInfo.annotation?this.props.clipperState.previewGlobalInfo.annotation:"",placeholder:i.Localization.getLocalizedString("WebClipper.Label.AnnotationPlaceholder")}}]}},t}(a.ComponentBase);s.textAreaListenerAttached=!1;var l=s.componentize();n.AnnotationInput=l},{"../../constants":74,"../../localization/localization":105,"../componentBase":16}],18:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../constants"),i=e("../../extensions/extensionUtils"),a=e("../../localization/localization"),s=e("../componentBase"),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getInitialState=function(){return{}},t.prototype.render=function(){return{tag:"div",attrs:{id:r.Constants.Ids.closeButtonContainer},children:[{tag:"a",attrs:Object.assign({id:r.Constants.Ids.closeButton,role:"button","aria-label":a.Localization.getLocalizedString("WebClipper.Action.CloseTheClipper"),title:a.Localization.getLocalizedString("WebClipper.Action.CloseTheClipper")},this.enableInvoke({callback:this.props.onClickHandler,tabIndex:300,args:this.props.onClickHandlerParams})),children:[{tag:"img",attrs:{className:"closeButtonIcon",src:i.ExtensionUtils.getImageResourceUrl("close.svg"),"aria-hidden":"true"}}]}]}},t}(s.ComponentBase),c=l.componentize();n.CloseButton=c},{"../../constants":74,"../../extensions/extensionUtils":93,"../../localization/localization":105,"../componentBase":16}],19:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../browserUtils"),i=e("../../clientType"),a=e("../../clipperUrls"),s=e("../../constants"),l=e("../../extensions/extensionUtils"),c=e("../../localization/localization"),u=e("../../logging/log"),p=e("../frontEndGlobals"),d=e("../clipperStateUtilities"),g=e("../componentBase"),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getFeedbackWindowRef=function(){return this.feedbackWindowRef},t.prototype.getInitialState=function(){return{userSettingsOpened:!1}},t.prototype.userControlHandler=function(){this.setState({userSettingsOpened:!this.state.userSettingsOpened})},t.prototype.handleSignOutButton=function(){this.setState({userSettingsOpened:!1}),this.props.onSignOutInvoked&&this.props.onSignOutInvoked(this.props.clipperState.userResult.data.user.authType)},t.prototype.handleFeedbackButton=function(e,t){if(t.altKey&&t.shiftKey){var n=i.ClientType[this.props.clipperState.clientInfo.clipperType]+": "+this.props.clipperState.clientInfo.clipperVersion;return n+="\nID: "+this.props.clipperState.clientInfo.clipperId,n+="\nUsid: "+p.Clipper.getUserSessionId(),p.Clipper.logger.logEvent(new u.Event.BaseEvent(u.Event.Label.DebugFeedback)),void window.alert(n)}this.feedbackWindowRef&&!this.feedbackWindowRef.closed||(this.feedbackUrl||(this.feedbackUrl=a.ClipperUrls.generateFeedbackUrl(this.props.clipperState,p.Clipper.getUserSessionId(),s.Constants.LogCategories.oneNoteClipperUsage)),this.feedbackWindowRef=r.BrowserUtils.openPopupWindow(this.feedbackUrl))},t.prototype.render=function(){var e=d.ClipperStateUtilities.isUserLoggedIn(this.props.clipperState),t=d.ClipperStateUtilities.isMsaUser(this.props.clipperState);return{tag:"div",attrs:{id:s.Constants.Ids.clipperFooterContainer,className:"footerFont",style:c.Localization.getFontFamilyAsStyle(c.Localization.FontFamily.Regular)},children:[{tag:"div",attrs:{className:s.Constants.Ids.footerButtonsContainer},children:[{tag:"div",attrs:{className:"footerButtonsLeft"},children:[t?void 0:{tag:"a",attrs:Object.assign({id:s.Constants.Ids.feedbackButton,role:"button"},this.enableInvoke({callback:this.handleFeedbackButton,tabIndex:80})),children:[{tag:"img",attrs:{id:s.Constants.Ids.feedbackImage,src:l.ExtensionUtils.getImageResourceUrl("feedback_smiley.svg"),"aria-hidden":"true"}},{tag:"span",attrs:{id:s.Constants.Ids.feedbackLabel,class:"buttonTextInHighContrast"},children:[c.Localization.getLocalizedString("WebClipper.Action.Feedback")]}]}]},e?{tag:"div",attrs:{className:"footerButtonsRight"},children:[{tag:"a",attrs:Object.assign({id:s.Constants.Ids.currentUserControl,role:"button"},this.enableInvoke({callback:this.userControlHandler,tabIndex:81}),{"aria-expanded":this.state.userSettingsOpened}),children:[{tag:"div",attrs:{id:s.Constants.Ids.currentUserDetails},children:[this.props.clipperState.userResult.data.user.fullName?{tag:"div",attrs:{id:s.Constants.Ids.currentUserName,class:"buttonTextInHighContrast"},children:[this.props.clipperState.userResult.data.user.fullName]}:{tag:"div",attrs:{id:s.Constants.Ids.currentUserName,class:"buttonTextInHighContrast"},children:[c.Localization.getLocalizedString("WebClipper.Label.SignedIn")]},this.props.clipperState.userResult.data.user.emailAddress?{tag:"div",attrs:{id:s.Constants.Ids.currentUserId,className:"buttonTextInHighContrast currentUserIdFont",style:c.Localization.getFontFamilyAsStyle(c.Localization.FontFamily.Regular)},children:[this.props.clipperState.userResult.data.user.emailAddress]}:""]},{tag:"img",attrs:{"aria-hidden":"true",id:s.Constants.Ids.userDropdownArrow,src:l.ExtensionUtils.getImageResourceUrl("dropdown_arrow.svg")}}]}]}:void 0]},this.state.userSettingsOpened?{tag:"div",attrs:{id:s.Constants.Ids.userSettingsContainer,className:"userSettingsFont",role:"complementary","aria-label":c.Localization.getLocalizedString("WebClipper.Accessibility.ScreenReader.Footer"),style:c.Localization.getFontFamilyAsStyle(c.Localization.FontFamily.Regular)},children:[{tag:"hr",attrs:{className:"userDivider","aria-hidden":"true"}},{tag:"div",attrs:{className:"userDetails"},children:[{tag:"label",attrs:{for:s.Constants.Ids.signOutButton,id:s.Constants.Ids.currentUserEmail,"aria-hidden":"true"},children:[this.props.clipperState.userResult.data.user.emailAddress]},{tag:"a",attrs:Object.assign({id:s.Constants.Ids.signOutButton,role:"button",className:"userActionButton buttonTextInHighContrast","aria-label":c.Localization.getLocalizedString("WebClipper.Action.SignOut")+" "+this.props.clipperState.userResult.data.user.emailAddress},this.enableInvoke({callback:this.handleSignOutButton,tabIndex:82})),children:[c.Localization.getLocalizedString("WebClipper.Action.SignOut")]}]}]}:void 0]}},t}(g.ComponentBase),h=f.componentize();n.Footer=h},{"../../browserUtils":2,"../../clientType":3,"../../clipperUrls":68,"../../constants":74,"../../extensions/extensionUtils":93,"../../localization/localization":105,"../../logging/log":108,"../clipperStateUtilities":15,"../componentBase":16,"../frontEndGlobals":49}],20:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../constants"),i=e("../../localization/localization"),a=e("../clipMode"),s=e("../componentBase"),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.initiallySetFocus=function(e){this.props.selected&&e.focus()},t.prototype.buttonHandler=function(){this.props.onModeSelected(this.props.myMode)},t.prototype.render=function(){var e="modeButton";this.props.selected&&(e+=" selected");var t=a.ClipMode[this.props.myMode];t=t[0].toLowerCase()+t.slice(1);var n=t+"Button";return{tag:"a",attrs:Object.assign({className:e,role:"option","aria-selected":this.props.selected,id:n,title:this.props.tooltipText?this.props.tooltipText:"","aria-setsize":this.props["aria-setsize"],"aria-posinset":this.props["aria-posinset"]},this.onElementFirstDraw(this.initiallySetFocus),this.enableAriaInvoke({callback:this.buttonHandler,tabIndex:this.props.tabIndex,ariaSetName:r.Constants.AriaSet.modeButtonSet})),children:[{tag:"img",attrs:{className:"icon",src:this.props.imgSrc,"aria-hidden":"true"}},{tag:"span",attrs:{className:"label buttonLabelFont",style:i.Localization.getFontFamilyAsStyle(i.Localization.FontFamily.Regular)},children:[this.props.label]}]}},t}(s.ComponentBase),c=l.componentize();n.ModeButton=c},{"../../constants":74,"../../localization/localization":105,"../clipMode":13,"../componentBase":16}],21:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../constants"),i=e("../../contentCapture/augmentationHelper"),a=e("../../extensions/extensionUtils"),s=e("../../extensions/invokeOptions"),l=e("../../localization/localization"),c=e("../clipMode"),u=e("../componentBase"),p=e("./modeButton"),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.onModeSelected=function(e){this.props.clipperState.setState({currentMode:this.props.clipperState.currentMode.set(e)})},t.prototype.getScreenReaderThatAnnouncesCurrentModeProps=function(e){var t=l.Localization.getLocalizedString("WebClipper.Accessibility.ScreenReader.CurrentModeHasChanged");return t=t.replace("{0}",c.ClipMode[e]),{tag:"div",attrs:{"aria-live":"polite","aria-relevant":"text",className:r.Constants.Classes.srOnly},children:[t]}},t.prototype.getPdfButtonProps=function(e){if(this.props.clipperState.pageInfo.contentType===OneNoteApi.ContentType.EnhancedUrl)return{imgSrc:a.ExtensionUtils.getImageResourceUrl("pdf.png"),label:l.Localization.getLocalizedString("WebClipper.ClipType.Pdf.Button"),myMode:c.ClipMode.Pdf,selected:e===c.ClipMode.Pdf,onModeSelected:this.onModeSelected.bind(this),tooltipText:l.Localization.getLocalizedString("WebClipper.ClipType.Pdf.Button.Tooltip")}},t.prototype.getAugmentationButtonProps=function(e){if(this.props.clipperState.pageInfo.contentType!==OneNoteApi.ContentType.EnhancedUrl){var t=i.AugmentationHelper.getAugmentationType(this.props.clipperState),n=l.Localization.getLocalizedString("WebClipper.ClipType."+t+".Button"),o=l.Localization.getLocalizedString("WebClipper.ClipType.Button.Tooltip").replace("{0}",n),r=e===c.ClipMode.Augmentation;return{imgSrc:"Article"===t?a.ExtensionUtils.getImageResourceUrl("article.svg"):a.ExtensionUtils.getImageResourceUrl(t+".png"),label:n,myMode:c.ClipMode.Augmentation,selected:r,onModeSelected:this.onModeSelected.bind(this),tooltipText:o}}},t.prototype.getFullPageButtonProps=function(e){if(this.props.clipperState.pageInfo.contentType!==OneNoteApi.ContentType.EnhancedUrl)return{imgSrc:a.ExtensionUtils.getImageResourceUrl("fullpage.svg"),label:l.Localization.getLocalizedString("WebClipper.ClipType.ScreenShot.Button"),myMode:c.ClipMode.FullPage,selected:e===c.ClipMode.FullPage,onModeSelected:this.onModeSelected.bind(this),tooltipText:l.Localization.getLocalizedString("WebClipper.ClipType.ScreenShot.Button.Tooltip")}},t.prototype.getRegionButtonProps=function(e){var t=this.props.clipperState.injectOptions&&this.props.clipperState.injectOptions.enableRegionClipping,n=this.props.clipperState.invokeOptions&&this.props.clipperState.invokeOptions.invokeMode===s.InvokeMode.ContextImage;if(t||n)return{imgSrc:a.ExtensionUtils.getImageResourceUrl("region.svg"),label:l.Localization.getLocalizedString(this.getRegionButtonLabel()),myMode:c.ClipMode.Region,selected:e===c.ClipMode.Region,onModeSelected:this.onModeSelected.bind(this),tooltipText:l.Localization.getLocalizedString("WebClipper.ClipType.MultipleRegions.Button.Tooltip")}},t.prototype.getRegionButtonLabel=function(){return"WebClipper.ClipType.Region.Button"},t.prototype.getSelectionButtonProps=function(e){if(this.props.clipperState.invokeOptions.invokeMode===s.InvokeMode.ContextTextSelection)return{imgSrc:a.ExtensionUtils.getImageResourceUrl("select.png"),label:l.Localization.getLocalizedString("WebClipper.ClipType.Selection.Button"),myMode:c.ClipMode.Selection,selected:e===c.ClipMode.Selection,onModeSelected:this.onModeSelected.bind(this),tooltipText:l.Localization.getLocalizedString("WebClipper.ClipType.Selection.Button.Tooltip")}},t.prototype.getBookmarkButtonProps=function(e){if(0!==this.props.clipperState.pageInfo.rawUrl.indexOf("file:///"))return{imgSrc:a.ExtensionUtils.getImageResourceUrl("bookmark.svg"),label:l.Localization.getLocalizedString("WebClipper.ClipType.Bookmark.Button"),myMode:c.ClipMode.Bookmark,selected:e===c.ClipMode.Bookmark,onModeSelected:this.onModeSelected.bind(this),tooltipText:l.Localization.getLocalizedString("WebClipper.ClipType.Bookmark.Button.Tooltip")}},t.prototype.getListOfButtons=function(){for(var e=this.props.clipperState.currentMode.get(),t=[this.getFullPageButtonProps(e),this.getRegionButtonProps(e),this.getAugmentationButtonProps(e),this.getSelectionButtonProps(e),this.getBookmarkButtonProps(e),this.getPdfButtonProps(e)],n=[],o=t.filter(function(e){return!!e}),r=0;r<o.length;r++){var i=o[r],a=r+1;n.push(m.component(p.ModeButton,Object.assign({},i,{"aria-setsize":o.length,"aria-posinset":a,tabIndex:i.selected?40:-1})))}return n},t.prototype.render=function(){var e=this.props.clipperState.currentMode.get();return{tag:"div",attrs:{},children:[this.getScreenReaderThatAnnouncesCurrentModeProps(e),{tag:"div",attrs:{style:l.Localization.getFontFamilyAsStyle(l.Localization.FontFamily.Semilight),role:"listbox",className:"modeButtonContainer"},children:[this.getListOfButtons()]}]}},t}(u.ComponentBase),g=d.componentize();n.ModeButtonSelector=g},{"../../constants":74,"../../contentCapture/augmentationHelper":75,"../../extensions/extensionUtils":93,"../../extensions/invokeOptions":95,"../../localization/localization":105,"../clipMode":13,"../componentBase":16,"./modeButton":20}],22:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../localization/localization"),i=e("../../constants"),a=e("../../extensions/extensionUtils"),s=e("../componentBase"),l=e("../status"),c=e("../animations/animationHelper"),u=e("../animations/animationState"),p=e("../animations/fadeInAnimationStrategy"),d=e("./pdfPageSelectionRadioButton"),g=e("lodash"),f=function(e){function t(t){var n=e.call(this,t)||this;return n.hiddenOptionsAnimationStrategy=new p.FadeInAnimationStrategy({extShouldAnimateIn:function(){return n.state.moreOptionsOpened},extShouldAnimateOut:function(){return!n.state.moreOptionsOpened}}),n}return o(t,e),t.prototype.getInitialState=function(){return{moreOptionsOpened:!1}},t.prototype.onCheckboxChange=function(e){var t=this.props.clipperState.pdfResult.status===l.Status.Succeeded,n=t&&this.props.clipperState.pdfResult.data.get().byteLength>i.Constants.Settings.maximumMimeSizeLimit;t&&!n&&g.assign(g.extend(this.props.clipperState.pdfPreviewInfo,{shouldAttachPdf:e}),this.props.clipperState.setState)},t.prototype.onDistributionChange=function(e){g.assign(g.extend(this.props.clipperState.pdfPreviewInfo,{shouldDistributePages:e}),this.props.clipperState.setState)},t.prototype.onMoreClicked=function(){this.setState({moreOptionsOpened:!this.state.moreOptionsOpened})},t.prototype.getDistributePagesCheckbox=function(){var e=this.props.clipperState.pdfPreviewInfo;return{tag:"div",attrs:Object.assign({className:"pdf-control",id:i.Constants.Ids.checkboxToDistributePages,"aria-checked":e.shouldDistributePages},this.enableInvoke({callback:this.onDistributionChange,tabIndex:65,args:!e.shouldDistributePages})),children:[{tag:"div",attrs:{className:"pdf-indicator pdf-checkbox-indicator"}},e.shouldDistributePages?{tag:"div",attrs:{className:i.Constants.Classes.checkboxCheck}}:"",{tag:"div",attrs:{className:"pdf-label-margin"},children:[{tag:"span",attrs:{className:"pdf-label focused"},children:[r.Localization.getLocalizedString("WebClipper.Label.PdfDistributePagesCheckbox")]}]}]}},t.prototype.getAttachmentCheckbox=function(){var e=this.props.clipperState.pdfResult.status===l.Status.Succeeded,t=e&&this.props.clipperState.pdfResult.data.get().byteLength>i.Constants.Settings.maximumMimeSizeLimit;return t?this.getAttachmentIsTooLargeCheckbox():this.getAttachmentPdfCheckbox(e)},t.prototype.getAttachmentIsTooLargeCheckbox=function(){var e=" disabled";return{tag:"div",attrs:{className:"pdf-control"+e,id:i.Constants.Ids.pdfIsTooLargeToAttachIndicator,tabIndex:67},children:[{tag:"img",attrs:{className:"warning-image",src:a.ExtensionUtils.getImageResourceUrl("warning.png")}},{tag:"div",attrs:{className:"pdf-label-margin"},children:[{tag:"span",attrs:{className:"pdf-label disabled"},children:[r.Localization.getLocalizedString("WebClipper.Label.PdfTooLargeToAttach")]}]}]}},t.prototype.getAttachmentPdfCheckbox=function(e){var t=this.props.clipperState.pdfPreviewInfo,n=e?"":" disabled";return{tag:"div",attrs:Object.assign({className:"pdf-control"+n,id:i.Constants.Ids.checkboxToAttachPdf,"aria-checked":e},this.enableInvoke({callback:e?this.onCheckboxChange:void 0,tabIndex:66,args:!t.shouldAttachPdf})),children:[{tag:"div",attrs:{className:"pdf-indicator pdf-checkbox-indicator"+n}},t.shouldAttachPdf?{tag:"div",attrs:{className:i.Constants.Classes.checkboxCheck}}:"",{tag:"div",attrs:{className:"pdf-label-margin"},children:[{tag:"span",attrs:{className:"pdf-label focused"+n},children:[r.Localization.getLocalizedString("WebClipper.Label.AttachPdfFile")+" ",{tag:"span",attrs:{className:"sub-label"+n},children:[r.Localization.getLocalizedString("WebClipper.Label.AttachPdfFileSubText")]}]}]}]}},t.prototype.onHiddenOptionsDraw=function(e){var t=this;this.hiddenOptionsAnimationStrategy.animate(e);var n=this.hiddenOptionsAnimationStrategy.getAnimationState();n===u.AnimationState.GoingOut&&this.state.moreOptionsOpened&&c.AnimationHelper.stopAnimationsThen(e,function(){t.hiddenOptionsAnimationStrategy.setAnimationState(u.AnimationState.Out),t.setState({})})},t.prototype.render=function(){var e=this.state.moreOptionsOpened?r.Localization.getLocalizedString("WebClipper.Action.Less"):r.Localization.getLocalizedString("WebClipper.Action.More");return{tag:"div",attrs:{className:"clipOptionsContainer"},children:[{tag:"div",attrs:{className:"clipOptionsTitleContainer"},children:[{tag:"span",attrs:{className:"clipOptionsTitle"},children:[r.Localization.getLocalizedString("WebClipper.Label.PdfOptions")]},{tag:"span",attrs:Object.assign({className:"moreClipOptions",id:i.Constants.Ids.moreClipOptions},this.enableInvoke({callback:this.onMoreClicked,tabIndex:60})),children:[e,{tag:"img",attrs:{className:"arrow",src:a.ExtensionUtils.getImageResourceUrl("dropdown_arrow.svg")}}]}]},m.component(d.PdfPageSelectionRadioButton,{clipperState:this.props.clipperState}),{tag:"div",attrs:Object.assign({className:"hiddenOptionsAnimator"},this.onElementDraw(this.onHiddenOptionsDraw)),children:[this.state.moreOptionsOpened?{tag:"div",attrs:{className:"hiddenOptions"},children:[this.getDistributePagesCheckbox(),this.getAttachmentCheckbox()]}:void 0]}]}},t}(s.ComponentBase),h=f.componentize();n.PdfClipOptions=h},{"../../constants":74,"../../extensions/extensionUtils":93,"../../localization/localization":105,"../animations/animationHelper":5,"../animations/animationState":6,"../animations/fadeInAnimationStrategy":9,"../componentBase":16,"../status":66,"./pdfPageSelectionRadioButton":23,lodash:150}],23:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../constants"),i=e("../../localization/localization"),a=e("./popover"),s=e("lodash"),l=e("../../stringUtils"),c=e("../../operationResult"),u=e("../componentBase"),p=function(e){function t(n){var o=e.call(this,n)||this;return t.textAreaListenerAttached||(o.addTextAreaListener(),t.textAreaListenerAttached=!0),o}return o(t,e),t.prototype.getRadioButtonGroups=function(){return[this.getRadioButtons()]},t.prototype.addTextAreaListener=function(){var e=this;document.addEventListener("input",function(t){var n=t.target,o=document.getElementById(r.Constants.Ids.rangeInput);n&&n===o&&e.onTextChange(o.value)})},t.prototype.onTextChange=function(e){s.assign(s.extend(this.props.clipperState.pdfPreviewInfo,{selectedPageRange:e}),this.props.clipperState.setState)},t.prototype.onTextInputFocus=function(){this.props.clipperState.pdfPreviewInfo.shouldShowPopover&&s.assign(s.extend(this.props.clipperState.pdfPreviewInfo,{shouldShowPopover:!1}),this.props.clipperState.setState)},t.prototype.onSelectionChange=function(e){s.assign(s.extend(this.props.clipperState.pdfPreviewInfo,{allPages:e,shouldShowPopover:!1}),this.props.clipperState.setState),document.getElementById(e?r.Constants.Ids.radioAllPagesLabel:r.Constants.Ids.rangeInput).focus()},t.prototype.getErrorMessageForInvalidPageRange=function(){var e=this.props.clipperState.pdfPreviewInfo,t=l.StringUtils.parsePageRange(e.selectedPageRange,this.props.clipperState.pdfResult.data.get().pdf.numPages());if(t.status===c.OperationResult.Succeeded)throw Error("Given that shouldShowPopover is true, parsing the pageRange should never succeed: PageRange: "+e.selectedPageRange);return i.Localization.getLocalizedString("WebClipper.Popover.PdfInvalidPageRange").replace("{0}",t.result);
},t.prototype.getRadioButtons=function(){var e=this.props.clipperState.pdfPreviewInfo,t=e.shouldShowPopover?"invalid":"",n=60,o=-1;return{role:"radiogroup",isAriaSet:!0,innerElements:[{tag:"div",attrs:Object.assign({role:"radio",id:r.Constants.Ids.radioAllPagesLabel,className:"pdf-control","aria-selected":e.allPages},this.enableAriaInvoke({callback:this.onSelectionChange,tabIndex:e.allPages?n:o,args:!0,ariaSetName:r.Constants.AriaSet.pdfPageSelection,autoSelect:!0})),children:[{tag:"div",attrs:{className:"pdf-indicator pdf-radio-indicator"},children:[e.allPages?{tag:"div",attrs:{className:r.Constants.Classes.radioIndicatorFill}}:void 0]},{tag:"div",attrs:{className:"pdf-label-margin"},children:[{tag:"span",attrs:{className:"pdf-label"+(e.allPages?" focused":"")},children:[i.Localization.getLocalizedString("WebClipper.Label.PdfAllPagesRadioButton")]}]}]},{tag:"div",attrs:Object.assign({id:r.Constants.Ids.radioPageRangeLabel,className:"pdf-control"+(e.allPages?"":" focused"),"aria-selected":!e.allPages},this.enableAriaInvoke({callback:this.onSelectionChange,tabIndex:e.allPages?o:n,args:!1,ariaSetName:r.Constants.AriaSet.pdfPageSelection,autoSelect:!0})),children:[{tag:"div",attrs:{className:"pdf-indicator pdf-radio-indicator"},children:[e.allPages?void 0:{tag:"div",attrs:{className:r.Constants.Classes.radioIndicatorFill}}]},{tag:"input",attrs:Object.assign({type:"text",id:r.Constants.Ids.rangeInput,className:t+(e.allPages?"":" selected"),placeholder:"e.g. 1-5, 7, 9-12",onFocus:this.onTextInputFocus.bind(this),value:this.props.clipperState.pdfPreviewInfo.selectedPageRange},this.enableInvoke({callback:this.onSelectionChange,tabIndex:o,args:!1}))},e.shouldShowPopover?m.component(a.Popover,{referenceElementId:r.Constants.Ids.rangeInput,placement:"bottom",parentId:r.Constants.Ids.mainController,content:this.getErrorMessageForInvalidPageRange(),classNames:[r.Constants.Classes.popover],arrowClassNames:[r.Constants.Classes.popoverArrow],modifiersIgnored:["flip"],removeOnDestroy:!0}):void 0]}]}},t.prototype.render=function(){for(var e=[],t=this.getRadioButtonGroups(),n=0;n<t.length;n++){var o=t[n],r=o.role,i=o.isAriaSet;if(i)for(var a=o.innerElements.length,s=0;s<a;s++)o.innerElements[s].attrs["aria-posinset"]=s+1,o.innerElements[s].attrs["aria-setsize"]=a;e.push({tag:"div",attrs:{role:r?r:""},children:[o.innerElements]})}return{tag:"div",attrs:{},children:[e]}},t}(u.ComponentBase);p.textAreaListenerAttached=!1;var d=p.componentize();n.PdfPageSelectionRadioButton=d},{"../../constants":74,"../../localization/localization":105,"../../operationResult":124,"../../stringUtils":141,"../componentBase":16,"./popover":24,lodash:150}],24:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../componentBase"),i=e("popper.js"),a=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.prototype.handlePopoverLifecycle=function(e,t,n){var o=this;if(!t){var r=this.generatePopperElement(this.props.parentId),a={placement:this.props.placement,removeOnDestroy:this.props.removeOnDestroy,modifiers:{}};if(this.props.modifiersIgnored)for(var s=0;s<this.props.modifiersIgnored.length;s++)a.modifiers[this.props.modifiersIgnored[s]]={enabled:!1};this.refToPopper=new i(document.getElementById(this.props.referenceElementId),r,a)}t&&this.refToPopper&&this.refToPopper.update(),n.onunload=function(){o.refToPopper&&(o.refToPopper.destroy(),o.refToPopper=void 0)}},t.prototype.generatePopperElement=function(e){var t=document.createElement("div");if(t.innerText=this.props.content,this.props.classNames)for(var n=0;n<this.props.classNames.length;n++)t.classList.add(this.props.classNames[n]);if(this.props.arrowClassNames){for(var o=document.createElement("div"),n=0;n<this.props.arrowClassNames.length;n++)o.classList.add(this.props.arrowClassNames[n]);o.setAttribute("x-arrow",""),t.appendChild(o)}var r=e?document.getElementById(e):void 0;return r?r.appendChild(t):document.body.appendChild(t),t},t.prototype.render=function(){return{tag:"div",attrs:{config:this.handlePopoverLifecycle.bind(this)}}},t}(r.ComponentBase),s=a.componentize();n.Popover=s},{"../componentBase":16,"popper.js":151}],25:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../../constants"),i=e("../../componentBase"),a=e("../../components/spriteAnimation"),s=e("../../../extensions/extensionUtils"),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getViewportStyle=function(){var e="max-width: "+this.props.viewportDimensions.width+"px;";return e+"max-height: "+this.props.viewportDimensions.height+"px;"},t.prototype.getPlaceholderStyle=function(){return"padding-bottom: "+this.props.viewportDimensions.height/this.props.viewportDimensions.width*100+"%;"},t.prototype.getSpinner=function(){var e=m.component(a.SpriteAnimation,{spriteUrl:s.ExtensionUtils.getImageResourceUrl("spinner_loop_colored.png"),imageHeight:Math.min(65,this.props.viewportDimensions.height),imageWidth:Math.min(45,this.props.viewportDimensions.width),totalFrameCount:21,loop:!0});return{tag:"div",attrs:{className:r.Constants.Classes.centeredInCanvas},children:[e]}},t.prototype.render=function(){return{tag:"div",attrs:{"data-pageindex":this.props.index,style:this.getViewportStyle()},children:[this.props.imgUrl?{tag:"img",attrs:{className:r.Constants.Classes.pdfPreviewImage,src:this.props.imgUrl,style:this.getViewportStyle()}}:{tag:"div",attrs:{style:this.getPlaceholderStyle()},children:[this.getSpinner()]}]}},t}(i.ComponentBase),c=l.componentize();n.PdfPageViewport=c},{"../../../constants":74,"../../../extensions/extensionUtils":93,"../../componentBase":16,"../../components/spriteAnimation":48}],26:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../../constants"),i=e("../../../contentCapture/augmentationHelper"),a=e("../../../extensions/extensionUtils"),s=e("../../../localization/localization"),l=e("../../status"),c=e("../../components/spriteAnimation"),u=e("./editorPreviewComponentBase"),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getHighlightableContentBodyForCurrentStatus=function(){var e=this.props.clipperState;return this.convertAugmentationResultToContentData(e.augmentationResult)},t.prototype.getStatus=function(){return this.props.clipperState.augmentationResult.status},t.prototype.getTitleTextForCurrentStatus=function(){var e,t=s.Localization.getLocalizedString("WebClipper.Preview.NoContentFound"),n=this.getStatus();switch(n){case l.Status.Succeeded:return this.props.clipperState.augmentationResult.data&&this.props.clipperState.augmentationResult.data.ContentModel!==i.AugmentationModel.None?this.props.clipperState.previewGlobalInfo.previewTitleText:s.Localization.getLocalizedString("WebClipper.Preview.NoContentFound");case l.Status.NotStarted:case l.Status.InProgress:return s.Localization.getLocalizedString("WebClipper.Preview.LoadingMessage");default:case l.Status.Failed:return e=this.props.clipperState.augmentationResult.data.failureMessage,e?e:t}},t.prototype.handleBodyChange=function(e){this.props.clipperState.setState({augmentationPreviewInfo:{previewBodyHtml:e}})},t.prototype.convertAugmentationResultToContentData=function(e){switch(e.status){case l.Status.Succeeded:if(this.props.clipperState.augmentationResult.data&&this.props.clipperState.augmentationResult.data.ContentModel!==i.AugmentationModel.None)return m.trust(this.props.clipperState.augmentationPreviewInfo.previewBodyHtml);break;case l.Status.NotStarted:case l.Status.InProgress:return this.getSpinner();default:case l.Status.Failed:}},t.prototype.getSpinner=function(){var e=m.component(c.SpriteAnimation,{spriteUrl:a.ExtensionUtils.getImageResourceUrl("spinner_loop_colored.png"),imageHeight:65,imageWidth:45,totalFrameCount:21,loop:!0});return{tag:"div",attrs:{className:r.Constants.Classes.centeredInPreview},children:[e]}},t}(u.EditorPreviewComponentBase),d=p.componentize();n.AugmentationPreview=d},{"../../../constants":74,"../../../contentCapture/augmentationHelper":75,"../../../extensions/extensionUtils":93,"../../../localization/localization":105,"../../components/spriteAnimation":48,"../../status":66,"./editorPreviewComponentBase":28}],27:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../../constants"),i=e("../../../objectUtils"),a=e("../../../extensions/extensionUtils"),s=e("../../../localization/localization"),l=e("../../status"),c=e("../../components/spriteAnimation"),u=e("./previewComponentBase"),p=e("./previewViewerBookmarkHeader"),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getStatus=function(){return this.props.clipperState.bookmarkResult.status},t.prototype.getTitleTextForCurrentStatus=function(){var e,t=s.Localization.getLocalizedString("WebClipper.Preview.BookmarkModeGenericError"),n=this.getStatus();switch(n){case l.Status.Succeeded:return this.props.clipperState.previewGlobalInfo.previewTitleText;case l.Status.NotStarted:case l.Status.InProgress:return s.Localization.getLocalizedString("WebClipper.Preview.LoadingMessage");default:case l.Status.Failed:return e=this.props.clipperState.bookmarkResult.data.failureMessage,e?e:t}},t.prototype.getContentBodyForCurrentStatus=function(){var e=this.getStatus();switch(e){case l.Status.Succeeded:return this.convertBookmarkResultToContentData(this.props.clipperState.bookmarkResult.data);case l.Status.NotStarted:case l.Status.InProgress:return[this.getSpinner()];default:case l.Status.Failed:return[]}},t.prototype.getSpinner=function(){var e=m.component(c.SpriteAnimation,{spriteUrl:a.ExtensionUtils.getImageResourceUrl("spinner_loop_colored.png"),imageHeight:65,imageWidth:45,totalFrameCount:21,loop:!0});return{tag:"div",attrs:{className:r.Constants.Classes.centeredInPreview},children:[e]}},t.prototype.getHeader=function(){return m.component(p.PreviewViewerBookmarkHeader,{clipperState:this.props.clipperState})},t.prototype.getPreviewContentContainerClass=function(){return r.Constants.Ids.bookmarkPreviewContentContainer},t.prototype.getPreviewInnerContainerClass=function(){return r.Constants.Ids.bookmarkPreviewInnerContainer},t.prototype.convertBookmarkResultToContentData=function(e){var t=e.url,n="";i.ObjectUtils.isNullOrUndefined(e.thumbnailSrc)||(n+="padding-left:16px;");var o="white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding:2px;";return i.ObjectUtils.isNullOrUndefined(e.description)||(o+="padding-bottom:13px;"),{tag:"table",attrs:{style:"table-layout:auto;border-collapse:collapse;margin-bottom:24px;"},children:[{tag:"tr",attrs:{style:"vertical-align:top;"},children:[this.renderThumbnailIfExists(e.thumbnailSrc),{tag:"td",attrs:{style:n},children:[{tag:"table",attrs:{},children:[this.renderTitleIfExists(e.title),{tag:"tr",attrs:{},children:[{tag:"td",attrs:{style:o},children:[{tag:"a",attrs:{class:"tabbableLink",tabIndex:250,href:t,target:"_blank",title:t},children:[t]}]}]},this.renderDescriptionIfExists(e.description)]}]}]}]}},t.prototype.renderTitleIfExists=function(e){if(!i.ObjectUtils.isNullOrUndefined(e)&&e.length>0)return{tag:"tr",attrs:{},children:[{tag:"td",attrs:{},children:[{tag:"h2",attrs:{style:"margin:0;margin-bottom:13px;"},children:[e]}]}]}},t.prototype.renderDescriptionIfExists=function(e){if(!i.ObjectUtils.isNullOrUndefined(e)&&e.length>0)return{tag:"tr",attrs:{},children:[{tag:"td",attrs:{style:"word-wrap:break-word;"},children:[e]}]}},t.prototype.renderThumbnailIfExists=function(e){if(!i.ObjectUtils.isNullOrUndefined(e)&&e.length>0){var t="112";return{tag:"td",attrs:{width:t,style:"padding-top:9px;"},children:[{tag:"img",attrs:{id:r.Constants.Ids.bookmarkThumbnail,src:e,alt:"thumbnail",width:t}}]}}},t}(u.PreviewComponentBase),g=d.componentize();n.BookmarkPreview=g},{"../../../constants":74,"../../../extensions/extensionUtils":93,"../../../localization/localization":105,"../../../objectUtils":123,"../../components/spriteAnimation":48,"../../status":66,"./previewComponentBase":34,"./previewViewerBookmarkHeader":36}],28:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../../constants"),i=e("../../../extensions/extensionUtils"),a=e("../../../highlighting/highlighter"),s=e("./previewComponentBase"),l=e("./previewViewerAugmentationHeader"),c=e("lodash"),u=e("../../../localization/localization"),p=e("../../frontEndGlobals"),d=e("../../../logging/log"),g=function(e){function t(n){var o=e.call(this,n)||this;return o.clickHandler=o.handleClick.bind(o),t.currentClickHandler&&window.removeEventListener("click",t.currentClickHandler),window.addEventListener("click",o.clickHandler),t.currentClickHandler=o.clickHandler,o}return o(t,e),t.prototype.getContentBodyForCurrentStatus=function(){return[{tag:"div",attrs:{id:r.Constants.Ids.highlightablePreviewBody,tabindex:"0"},children:[this.getHighlightableContentBodyForCurrentStatus()]}]},t.prototype.getPreviewBodyConfig=function(){this.state.textHighlighter||this.setHighlighter(),this.props.clipperState.previewGlobalInfo.highlighterEnabled?this.state.textHighlighter.enable():this.state.textHighlighter.disable()},t.prototype.getHeader=function(){return m.component(l.PreviewViewerAugmentationHeader,{toggleHighlight:this.toggleHighlight.bind(this),changeFontFamily:this.changeFontFamily.bind(this),changeFontSize:this.changeFontSize.bind(this),serif:this.props.clipperState.previewGlobalInfo.serif,textHighlighterEnabled:this.props.clipperState.previewGlobalInfo.highlighterEnabled})},t.prototype.getPreviewBodyClass=function(){return this.state.textHighlighter&&this.state.textHighlighter.isEnabled()?r.Constants.Classes.highlightable:""},t.prototype.announceWithAriaLive=function(e){var t=document.getElementById(r.Constants.Ids.previewAriaLiveDiv);return t?(t.textContent===e&&(e+=" "),void(t.textContent=e)):void p.Clipper.logger.logTrace(d.Trace.Label.General,d.Trace.Level.Warning,"Aria-live div with id "+r.Constants.Ids.sectionLocationContainer+" not found")},t.prototype.changeFontFamily=function(e){c.assign(c.extend(this.props.clipperState.previewGlobalInfo,{serif:e}),this.props.clipperState.setState),e?this.announceWithAriaLive(u.Localization.getLocalizedString("WebClipper.Accessibility.ScreenReader.ChangeFontToSerif")):this.announceWithAriaLive(u.Localization.getLocalizedString("WebClipper.Accessibility.ScreenReader.ChangeFontToSansSerif"))},t.prototype.changeFontSize=function(e){var t=this.props.clipperState.previewGlobalInfo.fontSize+(e?2:-2);t<r.Constants.Settings.minimumFontSize?t=r.Constants.Settings.minimumFontSize:t>r.Constants.Settings.maximumFontSize&&(t=r.Constants.Settings.maximumFontSize),c.assign(c.extend(this.props.clipperState.previewGlobalInfo,{fontSize:t}),this.props.clipperState.setState),e?this.announceWithAriaLive(u.Localization.getLocalizedString("WebClipper.Accessibility.ScreenReader.IncreaseFontSize")):this.announceWithAriaLive(u.Localization.getLocalizedString("WebClipper.Accessibility.ScreenReader.DecreaseFontSize"))},t.prototype.deleteHighlight=function(e){for(var t=document.getElementById(r.Constants.Ids.highlightablePreviewBody),n=t.querySelectorAll("span.highlighted[data-timestamp='"+e+"']"),o=0;o<n.length;o++){var i=n[o],a=i.parentNode;a.insertBefore(document.createTextNode(i.innerText),i),a.removeChild(i)}this.handleBodyChange(t.innerHTML)},t.prototype.handleClick=function(e){if(e&&e.target){var t=e.target;t.className&&t.className.indexOf(r.Constants.Classes.deleteHighlightButton)!==-1&&(this.deleteHighlight(parseInt(t.getAttribute("data-timestamp"),10)),e.preventDefault())}},t.prototype.setHighlighter=function(){var e=this,t=function(t,n){if(n&&n.length>0){for(var o=document.getElementById(r.Constants.Ids.highlightablePreviewBody),a=n.map(function(e){return parseInt(e.getAttribute("data-timestamp"),10)}),s=Math.max.apply(void 0,a),l=0;l<n.length;l++)for(var c=n[l].getAttribute("data-timestamp"),u=o.querySelectorAll("span."+r.Constants.Classes.highlighted+"[data-timestamp='"+c+"']"),p=0;p<u.length;p++){for(var d=u[p].querySelectorAll("img."+r.Constants.Classes.deleteHighlightButton),g=0;g<d.length;g++)d[g].parentNode.removeChild(d[g]);u[p].setAttribute("data-timestamp",""+s)}var f=o.querySelector("span.highlighted[data-timestamp='"+s+"']");if(f){var h=document.createElement("img");h.src=i.ExtensionUtils.getImageResourceUrl("editoroptions/delete_button.svg"),h.className=r.Constants.Classes.deleteHighlightButton,h.setAttribute("data-timestamp",""+s),h.setAttribute("tabindex","0"),f.insertBefore(h,f.childNodes[0])}e.handleBodyChange(o.innerHTML)}},n=a.Highlighter.reconstructInstance(document.getElementById(r.Constants.Ids.highlightablePreviewBody),{color:r.Constants.Styles.Colors.oneNoteHighlightColor,contextClass:r.Constants.Classes.highlightable,onAfterHighlight:t});this.setState({textHighlighter:n})},t.prototype.toggleHighlight=function(){this.props.clipperState.previewGlobalInfo.highlighterEnabled||window.getSelection().isCollapsed||!this.selectionIsInPreviewBody()?c.assign(c.extend(this.props.clipperState.previewGlobalInfo,{highlighterEnabled:!this.props.clipperState.previewGlobalInfo.highlighterEnabled}),this.props.clipperState.setState):this.state.textHighlighter.doHighlight()},t.prototype.selectionIsInPreviewBody=function(){var e=document.getElementById(r.Constants.Ids.highlightablePreviewBody);if(!e)return!1;var t=window.getSelection();if(t.rangeCount>0){for(var n=0;n<t.rangeCount;n++){var o=t.getRangeAt(n).commonAncestorContainer;if(o!==e&&!e.contains(o))return!1}return!0}return!1},t}(s.PreviewComponentBase);n.EditorPreviewComponentBase=g},{"../../../constants":74,"../../../extensions/extensionUtils":93,"../../../highlighting/highlighter":99,"../../../localization/localization":105,"../../../logging/log":108,"../../frontEndGlobals":49,"./previewComponentBase":34,"./previewViewerAugmentationHeader":35,lodash:150}],29:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../../constants"),i=e("../../../extensions/extensionUtils"),a=e("../../../localization/localization"),s=e("../../status"),l=e("../../components/rotatingMessageSpriteAnimation"),c=e("./previewComponentBase"),u=e("./previewViewerFullPageHeader"),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getContentBodyForCurrentStatus=function(){var e=this.props.clipperState;return e.pageInfo?this.convertFullPageResultToContentData(e.fullPageResult):[this.getSpinner()]},t.prototype.getHeader=function(){return m.component(u.PreviewViewerFullPageHeader,{clipperState:this.props.clipperState})},t.prototype.getStatus=function(){return this.props.clipperState.pageInfo?this.props.clipperState.fullPageResult.status:s.Status.NotStarted},t.prototype.getTitleTextForCurrentStatus=function(){var e,t=a.Localization.getLocalizedString("WebClipper.Preview.NoContentFound"),n=this.getStatus(),o=this.props.clipperState.pageInfo;switch(n){case s.Status.Succeeded:return o&&!this.props.clipperState.fullPageResult.data?a.Localization.getLocalizedString("WebClipper.Preview.NoContentFound"):this.props.clipperState.previewGlobalInfo.previewTitleText;case s.Status.NotStarted:case s.Status.InProgress:return a.Localization.getLocalizedString("WebClipper.Preview.LoadingMessage");default:case s.Status.Failed:return e=this.props.clipperState.fullPageResult.data.failureMessage,e?e:t}},t.prototype.convertFullPageResultToContentData=function(e){var t=[];switch(e.status){case s.Status.Succeeded:var n=this.props.clipperState.pageInfo?this.props.clipperState.pageInfo.contentTitle:"",o=a.Localization.getLocalizedString("WebClipper.Preview.FullPageModeScreenshotDescription").replace("{0}",n);if(this.props.clipperState.fullPageResult.data)for(var r=this.props.clipperState.fullPageResult.data,i=0,l=r.Images;i<l.length;i++){var c=l[i],u="data:image/"+r.ImageFormat+";"+r.ImageEncoding+","+c;t.push({tag:"img",attrs:{src:u,alt:o}})}break;case s.Status.NotStarted:case s.Status.InProgress:t.push(this.getSpinner());break;default:case s.Status.Failed:}return t},t.prototype.getSpinner=function(){var e=m.component(l.RotatingMessageSpriteAnimation,{spriteUrl:i.ExtensionUtils.getImageResourceUrl("spinner_loop_colored.png"),imageHeight:65,imageWidth:45,totalFrameCount:21,loop:!0,messageToDisplay:a.Localization.getLocalizedString("WebClipper.Preview.LoadingMessage"),shouldDisplayMessage:!1});return{tag:"div",attrs:{className:r.Constants.Classes.centeredInPreview},children:[e]}},t}(c.PreviewComponentBase),d=p.componentize();n.FullPagePreview=d},{"../../../constants":74,"../../../extensions/extensionUtils":93,"../../../localization/localization":105,"../../components/rotatingMessageSpriteAnimation":46,"../../status":66,"./previewComponentBase":34,"./previewViewerFullPageHeader":37}],30:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../../constants"),i=e("../../../localization/localization"),a=e("../../componentBase"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.render=function(){return{tag:"div",attrs:{id:r.Constants.Ids.previewOuterContainer,style:i.Localization.getFontFamilyAsStyle(i.Localization.FontFamily.Regular)},children:[{tag:"div",attrs:{id:r.Constants.Ids.previewInnerWrapper},children:[{tag:"div",attrs:{id:r.Constants.Ids.previewInnerContainer,style:"height: auto;"},children:[{tag:"div",attrs:{id:r.Constants.Ids.previewOptionsContainer},children:[{tag:"div",attrs:{className:"control-button-group"},children:[{tag:"span",attrs:{id:r.Constants.Ids.localPdfFileTitle,style:i.Localization.getFontFamilyAsStyle(i.Localization.FontFamily.Regular),className:"buttonLabelFont"},children:[this.props.header]}]}]},{tag:"div",attrs:{id:r.Constants.Ids.previewContentContainer,className:"local-pdf-file-content-container"},children:[{tag:"div",attrs:{className:r.Constants.Classes.localPdfPanelTitle},children:[this.props.title]},{tag:"div",attrs:{className:r.Constants.Classes.localPdfPanelSubtitle},children:[this.props.subtitle]}]}]}]}]}},t}(a.ComponentBase);n.LocalFilesNotAllowedPanelClass=s;var l=s.componentize();n.LocalFilesNotAllowedPanel=l},{"../../../constants":74,"../../../localization/localization":105,"../../componentBase":16}],31:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../../constants"),i=e("../../../objectUtils"),a=e("../../../operationResult"),s=e("../../../stringUtils"),l=e("../../../urlUtils"),c=e("../../../domParsers/domUtils"),u=e("../../../extensions/extensionUtils"),p=e("../../../localization/localization"),d=e("../../clipMode"),g=e("../../status"),f=e("../../components/rotatingMessageSpriteAnimation"),h=e("./pdfPreviewAttachment"),v=e("./pdfPreviewPage"),y=e("./previewComponentBase"),C=e("./previewViewerPdfHeader"),S=e("lodash"),b=function(e){function t(t){var n=e.call(this,t)||this;return n.initPageRenderCalled=!1,n.addScrollListener(),n}return o(t,e),t.prototype.getInitialState=function(){return{showPageNumbers:!1,renderedPageIndexes:{}}},t.prototype.searchForVisiblePageBoundary=function(e,t,n){for(var o=t,r=e[o];r&&this.pageIsVisible(r);)o+=n,r=e[o];return Math.max(o-=n,0)},t.prototype.getIndicesOfVisiblePages=function(){var e,t,n=document.querySelectorAll("div[data-pageindex]"),o=Math.floor(c.DomUtils.getScrollPercent(document.getElementById("previewContentContainer"),!0)*(n.length-1));if(this.pageIsVisible(n[o]))e=this.searchForVisiblePageBoundary(n,o,-1),t=this.searchForVisiblePageBoundary(n,o,1);else{for(var r=1,i=o+r,a=n[i];!this.pageIsVisible(a);)r>0?r*=-1:r=r*-1+1,i=o+r,a=n[i];r>0?(e=i,t=this.searchForVisiblePageBoundary(n,e,1)):(t=i,e=this.searchForVisiblePageBoundary(n,t,-1))}return S.range(e,t+1)},t.prototype.setDataUrlsOfImagesInViewportInState=function(){var e=this.getIndicesOfVisiblePages();if(e.length>0){var t=e[0],n=S.range(Math.max(t-r.Constants.Settings.pdfExtraPageLoadEachSide,0),t),o=e[e.length-1]+1,i=S.range(o,Math.min(o+r.Constants.Settings.pdfExtraPageLoadEachSide,this.props.clipperState.pdfResult.data.get().pdf.numPages()));e=n.concat(e).concat(i)}this.setDataUrlsOfImagesInState(e)},t.prototype.pageIsVisible=function(e){if(!e)return!1;var t=e.getBoundingClientRect();return t.top<=window.innerHeight&&t.bottom>=0},t.prototype.setDataUrlsOfImagesInState=function(e){var t=this;this.props.clipperState.pdfResult.data.get().pdf.getPageListAsDataUrls(e).then(function(n){for(var o={},r=0;r<n.length;r++)o[e[r]]=n[r];t.setState({renderedPageIndexes:o})})},t.prototype.getPageComponents=function(){var e,t=[],n=this.props.clipperState.pdfResult.data.get(),o=s.StringUtils.parsePageRange(this.props.clipperState.pdfPreviewInfo.selectedPageRange);e=o.status!==a.OperationResult.Succeeded?[]:o.result,e=e.map(function(e){return e-1});for(var r=0;r<n.pdf.numPages();r++)t.push(m.component(v.PdfPreviewPage,{showPageNumber:this.state.showPageNumbers,isSelected:this.props.clipperState.pdfPreviewInfo.allPages||e.indexOf(r)>=0,viewportDimensions:n.viewportDimensions[r],imgUrl:this.state.renderedPageIndexes[r],index:r}));return t},t.prototype.addScrollListener=function(){var e=this;t.latestScrollListener&&window.removeEventListener("scroll",t.latestScrollListener,!0),t.latestScrollListener=function(n){var o=n.target;o&&o.id===r.Constants.Ids.previewContentContainer&&(i.ObjectUtils.isNumeric(t.scrollListenerTimeout)&&clearTimeout(t.scrollListenerTimeout),t.scrollListenerTimeout=setTimeout(function(){e.setState({showPageNumbers:!1}),e.props.clipperState.currentMode.get()===d.ClipMode.Pdf&&e.props.clipperState.pdfResult.status===g.Status.Succeeded&&e.setDataUrlsOfImagesInViewportInState()},r.Constants.Settings.timeUntilPdfPageNumbersFadeOutAfterScroll),e.state.showPageNumbers||e.setState({showPageNumbers:!0}))},window.addEventListener("scroll",t.latestScrollListener,!0)},t.prototype.getContentBodyForCurrentStatus=function(){var e=this.props.clipperState;return e.pdfResult.status===g.Status.InProgress||e.pdfResult.status===g.Status.NotStarted?[this.getSpinner()]:this.convertPdfResultToContentData(e.pdfResult)},t.prototype.getHeader=function(){return m.component(C.PreviewViewerPdfHeader,{dummy:!0})},t.prototype.getStatus=function(){return this.props.clipperState.pageInfo?this.props.clipperState.pdfResult.status:g.Status.NotStarted},t.prototype.getTitleTextForCurrentStatus=function(){var e,t=p.Localization.getLocalizedString("WebClipper.Preview.NoContentFound"),n=this.getStatus(),o=this.props.clipperState.pdfResult;switch(n){case g.Status.Succeeded:return o&&!o.data.get()?p.Localization.getLocalizedString("WebClipper.Preview.NoContentFound"):this.props.clipperState.previewGlobalInfo.previewTitleText;case g.Status.NotStarted:case g.Status.InProgress:return p.Localization.getLocalizedString("WebClipper.Preview.LoadingMessage");default:case g.Status.Failed:return e=this.props.clipperState.pdfResult.data.get().failureMessage,e?e:t}},t.prototype.convertPdfResultToContentData=function(e){var t=[];switch(e.status){case g.Status.Succeeded:this.initPageRenderCalled||(this.initPageRenderCalled=!0,this.setDataUrlsOfImagesInState(S.range(Math.min(r.Constants.Settings.pdfInitialPageLoadCount,e.data.get().pdf.numPages()))));var n=this.props.clipperState.pdfPreviewInfo.shouldAttachPdf,o="Original.pdf",i=this.props.clipperState.pageInfo?l.UrlUtils.getFileNameFromUrl(this.props.clipperState.pageInfo.rawUrl,o):o;n&&t.push(m.component(h.PdfPreviewAttachment,{name:i.split(".")[0]})),t=t.concat(this.getPageComponents());break;case g.Status.NotStarted:case g.Status.InProgress:t.push(this.getSpinner());break;default:case g.Status.Failed:}return t},t.prototype.getSpinner=function(){var e=m.component(f.RotatingMessageSpriteAnimation,{spriteUrl:u.ExtensionUtils.getImageResourceUrl("spinner_loop_colored.png"),imageHeight:65,imageWidth:45,totalFrameCount:21,loop:!0,shouldDisplayMessage:!1});return{tag:"div",attrs:{className:r.Constants.Classes.centeredInPreview},children:[e]}},t}(y.PreviewComponentBase),w=b.componentize();n.PdfPreview=w},{"../../../constants":74,"../../../domParsers/domUtils":83,"../../../extensions/extensionUtils":93,"../../../localization/localization":105,"../../../objectUtils":123,"../../../operationResult":124,"../../../stringUtils":141,"../../../urlUtils":142,"../../clipMode":13,"../../components/rotatingMessageSpriteAnimation":46,"../../status":66,"./pdfPreviewAttachment":32,"./pdfPreviewPage":33,"./previewComponentBase":34,"./previewViewerPdfHeader":39,lodash:150}],32:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../../constants"),i=e("../../../extensions/extensionUtils"),a=e("../../componentBase"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.render=function(){return{tag:"span",attrs:{className:r.Constants.Classes.attachmentOverlay},children:[{tag:"img",attrs:{src:i.ExtensionUtils.getImageResourceUrl("editorOptions/pdf_attachment_icon.png")}},{tag:"div",attrs:{className:"file-name"},children:[this.props.name]}]}},t}(a.ComponentBase),l=s.componentize();n.PdfPreviewAttachment=l},{"../../../constants":74,"../../../extensions/extensionUtils":93,"../../componentBase":16}],33:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../../constants"),i=e("../../componentBase"),a=e("./PdfPageViewport"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.render=function(){return{tag:"div",attrs:{className:"pdf-preview-image-container"},children:[{tag:"div",attrs:{className:r.Constants.Classes.pdfPreviewImageCanvas+(this.props.isSelected?"":" "+r.Constants.Classes.unselected)},children:[m.component(a.PdfPageViewport,{viewportDimensions:this.props.viewportDimensions,imgUrl:this.props.imgUrl,index:this.props.index})]},{tag:"div",attrs:{className:r.Constants.Classes.overlay+(this.props.showPageNumber?"":" "+r.Constants.Classes.overlayHidden)},children:[{tag:"span",attrs:{className:r.Constants.Classes.overlayNumber},children:[this.props.index+1]}]}]}},t}(i.ComponentBase),l=s.componentize();n.PdfPreviewPage=l},{"../../../constants":74,"../../componentBase":16,"./PdfPageViewport":25}],34:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("lodash"),i=e("../../../clientType"),a=e("../../../constants"),s=e("../../../localization/localization"),l=e("../../clipMode"),c=e("../../componentBase"),u=e("../../status"),p=e("../annotationInput"),d=function(e){
function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getPreviewBodyConfig=function(){},t.prototype.addTextAreaListener=function(){var e=this;document.addEventListener("input",function(t){var n=t.target,o=document.getElementById(a.Constants.Ids.previewHeaderInput);n&&n===o&&e.handleTitleChange(o.value)})},t.prototype.handleTitleChange=function(e){r.assign(r.extend(this.props.clipperState.previewGlobalInfo,{previewTitleText:e}),this.props.clipperState.setState)},t.prototype.getPreviewTitle=function(e,t,n){if(this.props.clipperState.currentMode.get()!==l.ClipMode.Bookmark)return{tag:"div",attrs:{id:a.Constants.Ids.previewTitleContainer},children:[{tag:"pre",attrs:{className:a.Constants.Classes.textAreaInputMirror},children:[{tag:"span",attrs:{},children:[e]},{tag:"br",attrs:{}}]},{tag:"textarea",attrs:{rows:"1",id:a.Constants.Ids.previewHeaderInput,tabIndex:this.getStatus()===u.Status.Succeeded?200:-1,"aria-label":s.Localization.getLocalizedString("WebClipper.Accessibility.ScreenReader.InputBoxToChangeTitleOfOneNotePage"),className:t?a.Constants.Classes.textAreaInput:a.Constants.Classes.textAreaInput+n,value:e,readOnly:!t,placeholder:s.Localization.getLocalizedString("WebClipper.Label.PageTitlePlaceholder")}}]}},t.prototype.getPreviewSubtitle=function(){var e=s.Localization.getLocalizedString("WebClipper.FromCitation").replace("{0}",""),t=this.props.clipperState.pageInfo?this.props.clipperState.pageInfo.rawUrl:"";return{tag:"div",attrs:{id:a.Constants.Ids.previewSubtitleContainer},children:[this.props.clipperState.injectOptions&&this.props.clipperState.injectOptions.enableAddANote?m.component(p.AnnotationInput,{clipperState:this.props.clipperState}):void 0,this.props.clipperState.currentMode.get()!==l.ClipMode.Bookmark?{tag:"div",attrs:{id:a.Constants.Ids.previewUrlContainer,role:"none",title:t},children:[{tag:"span",attrs:{"aria-hidden":"true"},children:[e]},{tag:"a",attrs:{class:"tabbableLink",tabIndex:250,href:t,target:"_blank","aria-label":e+t},children:[t]}]}:void 0]}},t.prototype.getPreviewBodyClass=function(){return""},t.prototype.getPreviewContentContainerClass=function(){return""},t.prototype.getPreviewInnerContainerClass=function(){return""},t.prototype.isTitleEnabled=function(){return!0},t.prototype.render=function(){t.textAreaListenerAttached||(this.addTextAreaListener(),t.textAreaListenerAttached=!0);var e=this.getTitleTextForCurrentStatus(),n=this.getContentBodyForCurrentStatus(),o=this.props.clipperState.injectOptions&&this.props.clipperState.injectOptions.enableEditableTitle,r=o&&this.getStatus()===u.Status.Succeeded&&e===this.props.clipperState.previewGlobalInfo.previewTitleText,l=this.props.clipperState.previewGlobalInfo.serif?"WebClipper.FontFamily.Preview.SerifDefault":"WebClipper.FontFamily.Preview.SansSerifDefault",c={fontFamily:s.Localization.getLocalizedString(l),fontSize:this.props.clipperState.previewGlobalInfo.fontSize.toString()+"px"},p=this.getStatus(),d=p===u.Status.InProgress?" in-progress":"",g=this.props.clipperState.clientInfo.clipperType===i.ClientType.Bookmarklet?"":this.getPreviewInnerContainerClass();return{tag:"div",attrs:{id:a.Constants.Ids.previewOuterContainer,style:s.Localization.getFontFamilyAsStyle(s.Localization.FontFamily.Regular)},children:[{tag:"div",attrs:{id:a.Constants.Ids.previewInnerWrapper},children:[{tag:"div",attrs:{id:a.Constants.Ids.previewInnerContainer,className:g,role:"region","aria-label":s.Localization.getLocalizedString("WebClipper.Accessibility.ScreenReader.PagePreview")},children:[{tag:"div",attrs:{id:a.Constants.Ids.previewAriaLiveDiv,"aria-live":"polite","aria-relevant":"additions text",className:a.Constants.Classes.srOnly}},{tag:"div",attrs:{id:a.Constants.Ids.previewOptionsContainer},children:[this.getHeader()]},{tag:"div",attrs:{id:a.Constants.Ids.previewContentContainer,className:d+" "+this.getPreviewContentContainerClass()},children:[this.isTitleEnabled()?{tag:"div",attrs:{id:a.Constants.Ids.previewHeaderContainer},children:[this.getPreviewTitle(e,r,d),this.getPreviewSubtitle()]}:"",{tag:"div",attrs:{style:c,id:a.Constants.Ids.previewBody,className:d+" "+this.getPreviewBodyClass(),config:this.getPreviewBodyConfig.bind(this)},children:[n]}]}]}]}]}},t}(c.ComponentBase);d.textAreaListenerAttached=!1,n.PreviewComponentBase=d},{"../../../clientType":3,"../../../constants":74,"../../../localization/localization":105,"../../clipMode":13,"../../componentBase":16,"../../status":66,"../annotationInput":17,lodash:150}],35:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../../constants"),i=e("../../../extensions/extensionUtils"),a=e("../../../localization/localization"),s=e("./previewViewerHeaderComponentBase"),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getControlGroups=function(){return[this.getTitleGroup(),this.getHighlightGroup(),this.getSerifGroup(),this.getFontSizeGroup()]},t.prototype.getTitleGroupPrivate=function(e,t,n){return{id:e,innerElements:[{tag:"div",attrs:{id:n,style:a.Localization.getFontFamilyAsStyle(a.Localization.FontFamily.Regular),className:"buttonLabelFont"},children:[{tag:"span",attrs:{},children:[t]}]}]}},t.prototype.getTitleGroup=function(){return this.getTitleGroupPrivate("augmentationHeaderControlGroupId",a.Localization.getLocalizedString("WebClipper.ClipType.Article.Button"),"augmentationHeaderTitle")},t.prototype.getHighlightGroup=function(){var e=this.props.textHighlighterEnabled,t=e?s.HeaderClasses.Button.active:"",n=e?"editorOptions/highlight_tool_on.svg":"editorOptions/highlight_tool_off.svg";return{id:r.Constants.Ids.highlightControl,innerElements:[{tag:"img",attrs:Object.assign({role:"button","aria-label":a.Localization.getLocalizedString("WebClipper.Accessibility.ScreenReader.ToggleHighlighterModeForArticle"),title:a.Localization.getLocalizedString("WebClipper.Accessibility.ScreenReader.ToggleHighlighterModeForArticle"),"aria-pressed":e?"true":"false",id:r.Constants.Ids.highlightButton},this.enableInvoke({callback:this.props.toggleHighlight,tabIndex:100}),{className:t,src:i.ExtensionUtils.getImageResourceUrl(n)})}]}},t.prototype.getSerifGroup=function(){var e=101,t=-1;return{id:r.Constants.Ids.serifControl,role:"radiogroup",isAriaSet:!0,innerElements:[{tag:"button",attrs:Object.assign({"aria-label":a.Localization.getLocalizedString("WebClipper.Accessibility.ScreenReader.ChangeFontToSansSerif"),title:a.Localization.getLocalizedString("WebClipper.Accessibility.ScreenReader.ChangeFontToSansSerif"),"aria-checked":!this.props.serif+"",id:r.Constants.Ids.sansSerif},this.enableAriaInvoke({callback:this.props.changeFontFamily,tabIndex:this.props.serif?t:e,args:!1,ariaSetName:r.Constants.AriaSet.serifGroupSet}),{className:this.props.serif?s.HeaderClasses.Button.controlButton:s.HeaderClasses.Button.activeControlButton,role:"radio"}),children:[a.Localization.getLocalizedString("WebClipper.Preview.Header.SansSerifButtonLabel")]},{tag:"button",attrs:Object.assign({"aria-label":a.Localization.getLocalizedString("WebClipper.Accessibility.ScreenReader.ChangeFontToSerif"),title:a.Localization.getLocalizedString("WebClipper.Accessibility.ScreenReader.ChangeFontToSerif"),"aria-checked":this.props.serif+"",id:r.Constants.Ids.serif},this.enableAriaInvoke({callback:this.props.changeFontFamily,tabIndex:this.props.serif?e:t,args:!0,ariaSetName:r.Constants.AriaSet.serifGroupSet}),{className:this.props.serif?s.HeaderClasses.Button.activeControlButton:s.HeaderClasses.Button.controlButton,role:"radio"}),children:[a.Localization.getLocalizedString("WebClipper.Preview.Header.SerifButtonLabel")]}]}},t.prototype.getFontSizeGroup=function(){return{id:r.Constants.Ids.fontSizeControl,className:s.HeaderClasses.Button.relatedButtons,isAriaSet:!0,innerElements:[{tag:"button",attrs:Object.assign({className:s.HeaderClasses.Button.controlButton,"aria-label":a.Localization.getLocalizedString("WebClipper.Accessibility.ScreenReader.DecreaseFontSize"),title:a.Localization.getLocalizedString("WebClipper.Accessibility.ScreenReader.DecreaseFontSize"),type:"button"},this.enableInvoke({callback:this.props.changeFontSize,tabIndex:103,args:!1}),{id:r.Constants.Ids.decrementFontSize}),children:[{tag:"img",attrs:{src:i.ExtensionUtils.getImageResourceUrl("editorOptions/font_down.svg"),"aria-hidden":"true"}}]},{tag:"button",attrs:Object.assign({className:s.HeaderClasses.Button.controlButton,"aria-label":a.Localization.getLocalizedString("WebClipper.Accessibility.ScreenReader.IncreaseFontSize"),title:a.Localization.getLocalizedString("WebClipper.Accessibility.ScreenReader.IncreaseFontSize"),type:"button"},this.enableInvoke({callback:this.props.changeFontSize,tabIndex:104,args:!0}),{id:r.Constants.Ids.incrementFontSize}),children:[{tag:"img",attrs:{src:i.ExtensionUtils.getImageResourceUrl("editorOptions/font_up.svg"),"aria-hidden":"true"}}]}]}},t}(s.PreviewViewerHeaderComponentBase),c=l.componentize();n.PreviewViewerAugmentationHeader=c},{"../../../constants":74,"../../../extensions/extensionUtils":93,"../../../localization/localization":105,"./previewViewerHeaderComponentBase":38}],36:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../../constants"),i=e("../../../localization/localization"),a=e("./previewViewerTitleOnlyHeaderComponentBase"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getControlGroupId=function(){return r.Constants.Ids.bookmarkControl},t.prototype.getHeader=function(){return i.Localization.getLocalizedString("WebClipper.ClipType.Bookmark.Button")},t.prototype.getHeaderId=function(){return r.Constants.Ids.bookmarkHeaderTitle},t}(a.PreviewViewerTitleOnlyHeaderComponentBase),l=s.componentize();n.PreviewViewerBookmarkHeader=l},{"../../../constants":74,"../../../localization/localization":105,"./previewViewerTitleOnlyHeaderComponentBase":42}],37:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../../constants"),i=e("../../../localization/localization"),a=e("./previewViewerTitleOnlyHeaderComponentBase"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getControlGroupId=function(){return r.Constants.Ids.fullPageControl},t.prototype.getHeader=function(){return i.Localization.getLocalizedString("WebClipper.ClipType.ScreenShot.Button")},t.prototype.getHeaderId=function(){return r.Constants.Ids.fullPageHeaderTitle},t}(a.PreviewViewerTitleOnlyHeaderComponentBase),l=s.componentize();n.PreviewViewerFullPageHeader=l},{"../../../constants":74,"../../../localization/localization":105,"./previewViewerTitleOnlyHeaderComponentBase":42}],38:[function(e,t,n){"use strict";var o,r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("../../componentBase");!function(e){var t;!function(e){e.active=" active",e.controlButton=" control-button",e.relatedButtons=" related-buttons",e.activeControlButton=e.active+e.controlButton}(t=e.Button||(e.Button={}))}(o=n.HeaderClasses||(n.HeaderClasses={}));var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.render=function(){for(var e="control-button-group",t=[],n=this.getControlGroups(),o=0;o<n.length;o++){var r=n[o],i=r.id,a=r.className,s=r.role,l=r.isAriaSet;if(l)for(var c=r.innerElements.length,u=0;u<c;u++)r.innerElements[u].attrs["aria-posinset"]=u+1,r.innerElements[u].attrs["aria-setsize"]=c;t.push({tag:"div",attrs:{id:i?i:"",className:a?a:e,role:s?s:""},children:[r.innerElements]})}return{tag:"div",attrs:{},children:[t]}},t}(i.ComponentBase);n.PreviewViewerHeaderComponentBase=a},{"../../componentBase":16}],39:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../../constants"),i=e("../../../localization/localization"),a=e("./previewViewerTitleOnlyHeaderComponentBase"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getControlGroupId=function(){return r.Constants.Ids.pdfControl},t.prototype.getHeader=function(){return i.Localization.getLocalizedString("WebClipper.ClipType.Pdf.Button")},t.prototype.getHeaderId=function(){return r.Constants.Ids.pdfHeaderTitle},t}(a.PreviewViewerTitleOnlyHeaderComponentBase),l=s.componentize();n.PreviewViewerPdfHeader=l},{"../../../constants":74,"../../../localization/localization":105,"./previewViewerTitleOnlyHeaderComponentBase":42}],40:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../../constants"),i=e("../../../extensions/extensionUtils"),a=e("../../../localization/localization"),s=e("../../status"),l=e("./previewViewerHeaderComponentBase"),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.addAnotherRegion=function(){this.props.clipperState.setState({regionResult:{status:s.Status.InProgress,data:this.props.clipperState.regionResult.data}})},t.prototype.getControlGroups=function(){return[this.getScreenReaderTitleGroup(),this.getAddRegionGroup()]},t.prototype.getScreenReaderTitleGroup=function(){return{className:r.Constants.Classes.srOnly,innerElements:[{tag:"div",attrs:{},children:[a.Localization.getLocalizedString("WebClipper.ClipType.Region.Button")]}]}},t.prototype.getAddRegionGroup=function(){return{id:r.Constants.Ids.addRegionControl,innerElements:[{tag:"button",attrs:Object.assign({id:r.Constants.Ids.addAnotherRegionButton},this.enableInvoke({callback:this.addAnotherRegion.bind(this),tabIndex:100}),{className:l.HeaderClasses.Button.controlButton,style:a.Localization.getFontFamilyAsStyle(a.Localization.FontFamily.Regular),type:"button"}),children:[{tag:"img",attrs:{src:i.ExtensionUtils.getImageResourceUrl("editorOptions/add_icon.svg")}},{tag:"span",attrs:{},children:[a.Localization.getLocalizedString("WebClipper.Preview.Header.AddAnotherRegionButtonLabel")]}]}]}},t}(l.PreviewViewerHeaderComponentBase),u=c.componentize();n.PreviewViewerRegionHeader=u},{"../../../constants":74,"../../../extensions/extensionUtils":93,"../../../localization/localization":105,"../../status":66,"./previewViewerHeaderComponentBase":38}],41:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../../constants"),i=e("../../../localization/localization"),a=e("./previewViewerTitleOnlyHeaderComponentBase"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getControlGroupId=function(){return r.Constants.Ids.regionControl},t.prototype.getHeader=function(){return i.Localization.getLocalizedString("WebClipper.ClipType.Region.Button")},t.prototype.getHeaderId=function(){return r.Constants.Ids.regionHeaderTitle},t}(a.PreviewViewerTitleOnlyHeaderComponentBase),l=s.componentize();n.PreviewViewerRegionTitleOnlyHeader=l},{"../../../constants":74,"../../../localization/localization":105,"./previewViewerTitleOnlyHeaderComponentBase":42}],42:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../../localization/localization"),i=e("./previewViewerHeaderComponentBase"),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getControlGroups=function(){return[this.getTitleGroup(this.getControlGroupId(),this.getHeader(),this.getHeaderId())]},t.prototype.getTitleGroup=function(e,t,n){return{id:e,innerElements:[{tag:"div",attrs:{id:n,style:r.Localization.getFontFamilyAsStyle(r.Localization.FontFamily.Regular),className:"buttonLabelFont"},children:[{tag:"span",attrs:{},children:[t]}]}]}},t}(i.PreviewViewerHeaderComponentBase);n.PreviewViewerTitleOnlyHeaderComponentBase=a},{"../../../localization/localization":105,"./previewViewerHeaderComponentBase":38}],43:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../../localization/localization"),i=e("../../status"),a=e("../../components/regionSelection"),s=e("./previewComponentBase"),l=e("./previewViewerRegionHeader"),c=e("./previewViewerRegionTitleOnlyHeader"),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getContentBodyForCurrentStatus=function(){var e=this.props.clipperState;return this.convertRegionResultToContentData(e.regionResult)},t.prototype.getHeader=function(){return this.props.clipperState.injectOptions.enableRegionClipping?m.component(l.PreviewViewerRegionHeader,{clipperState:this.props.clipperState}):m.component(c.PreviewViewerRegionTitleOnlyHeader,{clipperState:this.props.clipperState})},t.prototype.getStatus=function(){return this.props.clipperState.regionResult.status},t.prototype.getTitleTextForCurrentStatus=function(){var e=r.Localization.getLocalizedString("WebClipper.Preview.NoContentFound"),t=this.getStatus();switch(t){case i.Status.Succeeded:return this.props.clipperState.previewGlobalInfo.previewTitleText;case i.Status.NotStarted:case i.Status.InProgress:return r.Localization.getLocalizedString("WebClipper.Preview.LoadingMessage");default:case i.Status.Failed:return e}},t.prototype.convertRegionResultToContentData=function(e){var t=this,n=[];switch(e.status){case i.Status.Succeeded:for(var o=this.props.clipperState.regionResult.data,r=this.props.clipperState.injectOptions&&this.props.clipperState.injectOptions.enableRegionClipping?function(e){var n=t.props.clipperState.regionResult.data;n.splice(e,1),0===n.length?t.props.clipperState.setState({regionResult:{status:i.Status.NotStarted,data:n}}):t.props.clipperState.setState({regionResult:{status:i.Status.Succeeded,data:n}})}:void 0,s=0;s<o.length;s++)n.push(m.component(a.RegionSelection,{index:s,imageSrc:o[s],onRemove:r}));break;default:case i.Status.NotStarted:case i.Status.InProgress:case i.Status.Failed:}return n},t}(s.PreviewComponentBase),p=u.componentize();n.RegionPreview=p},{"../../../localization/localization":105,"../../components/regionSelection":45,"../../status":66,"./previewComponentBase":34,"./previewViewerRegionHeader":40,"./previewViewerRegionTitleOnlyHeader":41}],44:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../status"),i=e("./editorPreviewComponentBase"),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getHighlightableContentBodyForCurrentStatus=function(){return m.trust(this.props.clipperState.selectionPreviewInfo.previewBodyHtml)},t.prototype.getStatus=function(){return r.Status.Succeeded},t.prototype.getTitleTextForCurrentStatus=function(){return this.props.clipperState.previewGlobalInfo.previewTitleText},t.prototype.handleBodyChange=function(e){this.props.clipperState.setState({selectionPreviewInfo:{previewBodyHtml:e}})},t}(i.EditorPreviewComponentBase),s=a.componentize();n.SelectionPreview=s},{"../../status":66,"./editorPreviewComponentBase":28}],45:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../logging/log"),i=e("../../extensions/extensionUtils"),a=e("../componentBase"),s=e("../../localization/localization"),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.buttonHandler=function(){this.props.onRemove&&this.props.onRemove(this.props.index)},t.prototype.getRemoveButton=function(){return this.props.onRemove?{tag:"a",attrs:Object.assign({className:"region-selection-remove-button",role:"button"},this.enableInvoke({callback:this.buttonHandler,tabIndex:300,idOverride:r.Click.Label.regionSelectionRemoveButton})),children:[{tag:"img",attrs:{src:i.ExtensionUtils.getImageResourceUrl("editorOptions/delete_button.svg"),alt:s.Localization.getLocalizedString("WebClipper.Preview.RemoveSelectedRegion")}}]}:void 0},t.prototype.render=function(){return{tag:"div",attrs:{},children:[{tag:"p",attrs:{className:"region-selection"},children:[this.getRemoveButton(),{tag:"img",attrs:{className:"region-selection-image",src:this.props.imageSrc,alt:s.Localization.getLocalizedString("WebClipper.Preview.SelectedRegion")}}]}]}},t}(a.ComponentBase),c=l.componentize();n.RegionSelection=c},{"../../extensions/extensionUtils":93,"../../localization/localization":105,"../../logging/log":108,"../componentBase":16}],46:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../constants"),i=e("../../localization/localization"),a=e("../componentBase"),s=e("./spriteAnimation"),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.render=function(){var e=!("shouldDisplayMessage"in this.props)||this.props.shouldDisplayMessage,t=e?this.props.messageToDisplay?this.props.messageToDisplay:i.Localization.getLocalizedString("WebClipper.Preview.Spinner.ClipAnyTimeInFullPage"):void 0;return{tag:"div",attrs:{},children:[m.component(s.SpriteAnimation,{spriteUrl:this.props.spriteUrl,imageHeight:this.props.imageHeight,imageWidth:this.props.imageWidth,totalFrameCount:this.props.totalFrameCount,loop:this.props.loop,ariaLabel:t}),e?{tag:"div",attrs:{id:r.Constants.Ids.spinnerText,className:"spinnerText",style:i.Localization.getFontFamilyAsStyle(i.Localization.FontFamily.Semilight)},children:[{tag:"span",attrs:{"aria-hidden":"true"},children:[t]}]}:""]}},t}(a.ComponentBase),c=l.componentize();n.RotatingMessageSpriteAnimation=c},{"../../constants":74,"../../localization/localization":105,"../componentBase":16,"./spriteAnimation":48}],47:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../constants"),i=e("../../localization/localization"),a=e("../../logging/log"),s=e("../../settings"),l=e("../../storage/clipperStorageKeys"),c=e("../clipperStateUtilities"),u=e("../componentBase"),p=e("../frontEndGlobals"),d=e("../oneNoteApiUtils"),g=e("../status"),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getInitialState=function(){return{notebooks:void 0,status:g.Status.NotStarted,curSection:void 0}},t.prototype.onSectionClicked=function(e){this.props.clipperState.setState({saveLocation:e.section.id}),this.setState({curSection:e}),p.Clipper.storeValue(l.ClipperStorageKeys.currentSelectedSection,JSON.stringify(e)),p.Clipper.logger.logClickEvent(a.Click.Label.sectionComponent)},t.prototype.onPopupToggle=function(e){e&&p.Clipper.logger.logClickEvent(a.Click.Label.sectionPickerLocationContainer),this.props.onPopupToggle(e)},t.prototype.setDataSource=function(){if(!c.ClipperStateUtilities.isUserLoggedIn(this.props.clipperState))return!1;var e=this.props.clipperState.userResult.data.user.accessToken;return t.dataSource=new OneNotePicker.OneNotePickerDataSource(e),!0},t.prototype.retrieveAndUpdateNotebookAndSectionSelection=function(){var e=this;return new Promise(function(n,o){e.dataSourceUninitialized()&&e.setDataSource(),e.setState({status:g.Status.InProgress}),e.fetchCachedNotebookAndSectionInfoAsState(function(i){i&&(e.setState(i),e.props.clipperState.setState({saveLocation:i.curSection&&i.curSection.section?i.curSection.section.id:""}));var s=new a.Event.PromiseEvent(a.Event.Label.GetNotebooks);e.fetchFreshNotebooks(p.Clipper.getUserSessionId()).then(function(i){var c=i.request.getResponseHeader(r.Constants.HeaderValues.correlationId);s.setCustomProperty(a.PropertyName.Custom.CorrelationId,c);var u=i.parsedResponse;if(!u){s.setStatus(a.Status.Failed);var d={error:"GetNotebooks Promise was resolved but returned null or undefined value for notebooks."};return s.setFailureInfo(d),e.setState({status:g.Status.Failed}),void o(d)}s.setCustomProperty(a.PropertyName.Custom.MaxDepth,OneNoteApi.NotebookUtils.getDepthOfNotebooks(u)),p.Clipper.storeValue(l.ClipperStorageKeys.cachedNotebooks,JSON.stringify(u));var f=t.convertNotebookListToState(u),h=!0;if(e.state.curSection&&e.state.curSection.section){var m=OneNoteApi.NotebookUtils.sectionExistsInNotebooks(u,e.state.curSection.section.id);m&&(f.curSection=e.state.curSection,h=!1),s.setCustomProperty(a.PropertyName.Custom.CurrentSectionStillExists,m)}h&&(p.Clipper.storeValue(l.ClipperStorageKeys.currentSelectedSection,JSON.stringify(f.curSection)),e.props.clipperState.setState({saveLocation:f.curSection?f.curSection.section.id:void 0})),e.setState(f),n(f)}).catch(function(t){e.setState({apiResponseCode:d.OneNoteApiUtils.getApiResponseCode(t)}),e.state.notebooks?t.error+=". Falling back to storage.":e.setState({status:g.Status.Failed}),d.OneNoteApiUtils.logOneNoteApiRequestError(s,t),o(t)}).then(function(){p.Clipper.logger.logEvent(s)})})})},t.prototype.dataSourceUninitialized=function(){return!t.dataSource||!t.dataSource.authToken||!c.ClipperStateUtilities.isUserLoggedIn(this.props.clipperState)||t.dataSource.authToken!==this.props.clipperState.userResult.data.user.accessToken},t.prototype.fetchCachedNotebookAndSectionInfoAsState=function(e){p.Clipper.getStoredValue(l.ClipperStorageKeys.cachedNotebooks,function(t){p.Clipper.getStoredValue(l.ClipperStorageKeys.currentSelectedSection,function(n){if(t){var o=void 0;try{o=JSON.parse(t)}catch(e){p.Clipper.logger.logJsonParseUnexpected(t)}var r=void 0;if(o&&n)try{r=JSON.parse(n)}catch(e){p.Clipper.logger.logJsonParseUnexpected(n)}e({notebooks:o,status:g.Status.Succeeded,curSection:r})}else e(void 0)})})},t.prototype.fetchFreshNotebooks=function(e){this.dataSourceUninitialized()&&this.setDataSource();var n={};return n[r.Constants.HeaderValues.appIdKey]=s.Settings.getSetting("App_Id"),n[r.Constants.HeaderValues.userSessionIdKey]=e,t.dataSource.getNotebooks(n)},t.convertNotebookListToState=function(e){var n=OneNoteApi.NotebookUtils.getPathFromNotebooksToSection(e,function(e){return e.isDefault}),o=t.formatSectionInfoForStorage(n);return{notebooks:e,status:g.Status.Succeeded,curSection:o}},t.formatSectionInfoForStorage=function(e){if(e&&0!==e.length)return{path:e.map(function(e){return e.name}).join(" > "),section:e[e.length-1]}},t.prototype.addSrOnlyLocationDiv=function(e){var t=document.getElementById(r.Constants.Ids.sectionLocationContainer);if(!t)return void p.Clipper.logger.logTrace(a.Trace.Label.General,a.Trace.Level.Warning,"Unable to add sr-only div: Parent element with id "+r.Constants.Ids.sectionLocationContainer+" not found");var n=document.createElement("div");n.textContent=i.Localization.getLocalizedString("WebClipper.Label.ClipLocation")+": ",n.setAttribute("class",r.Constants.Classes.srOnly),t.insertBefore(n,t.firstChild)},t.prototype.render=function(){var e=this;if(this.dataSourceUninitialized()){var t=this.setDataSource();t&&this.retrieveAndUpdateNotebookAndSectionSelection()}else this.state.notebooks||this.state.status!==g.Status.NotStarted||this.fetchCachedNotebookAndSectionInfoAsState(function(t){t&&(e.setState(t),e.props.clipperState.setState({saveLocation:t.curSection&&t.curSection.section?t.curSection.section.id:""}))});var n,o={defaultLocation:i.Localization.getLocalizedString("WebClipper.SectionPicker.DefaultLocation"),loadingNotebooks:i.Localization.getLocalizedString("WebClipper.SectionPicker.LoadingNotebooks"),noNotebooksFound:i.Localization.getLocalizedString("WebClipper.SectionPicker.NoNotebooksFound"),notebookLoadFailureMessage:i.Localization.getLocalizedString("WebClipper.SectionPicker.NotebookLoadFailureMessage")},a=o.defaultLocation;this.state.status===g.Status.Succeeded&&this.state.curSection&&(n=this.state.curSection.section.id,a=this.state.curSection.path),this.state.apiResponseCode&&!d.OneNoteApiUtils.isRetryable(this.state.apiResponseCode)&&(o.notebookLoadFailureMessage=d.OneNoteApiUtils.getLocalizedErrorMessageForGetNotebooks(this.state.apiResponseCode));var s=i.Localization.getLocalizedString("WebClipper.Label.ClipLocation");return{tag:"div",attrs:Object.assign({id:r.Constants.Ids.locationPickerContainer},this.onElementFirstDraw(this.addSrOnlyLocationDiv)),children:[{tag:"div",attrs:{id:r.Constants.Ids.optionLabel,className:"optionLabel"},children:[{tag:"label",attrs:{htmlFor:r.Constants.Ids.sectionLocationContainer,"aria-label":s,className:"buttonLabelFont",style:i.Localization.getFontFamilyAsStyle(i.Localization.FontFamily.Regular)},children:[{tag:"span",attrs:{"aria-hidden":"true"},children:[s]}]}]},m.component(OneNotePicker.OneNotePickerComponent,{id:r.Constants.Ids.sectionLocationContainer,tabIndex:70,notebooks:this.state.notebooks,status:g.Status[this.state.status],onPopupToggle:this.onPopupToggle.bind(this),onSectionClicked:this.onSectionClicked.bind(this),textToDisplay:a,curSectionId:n,localizedStrings:o})]}},t}(u.ComponentBase);n.SectionPickerClass=f;var h=f.componentize();n.SectionPicker=h},{"../../constants":74,"../../localization/localization":105,"../../logging/log":108,"../../settings":135,"../../storage/clipperStorageKeys":138,"../clipperStateUtilities":15,"../componentBase":16,"../frontEndGlobals":49,"../oneNoteApiUtils":51,"../status":66}],48:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../componentBase"),i=e("../../constants"),a=e("../../localization/localization"),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.currentFrame=0,t.currentTime=t.rightNow(),t}return o(t,e),t.prototype.initiallySetFocus=function(e){this.props.shouldTakeFocus&&e.focus()},t.prototype.getInitialState=function(){var e=this;return requestAnimationFrame(function(){e.updateFrame()}),{inProgress:!0}},t.prototype.updateFrame=function(){var e=this;if(!this.spinnerElement)return void this.stop();if(this.state.inProgress){var t=this.rightNow(),n=24,o=(t-this.currentTime)/1e3;this.currentTime=t,this.currentFrame+=o*n;var r=Math.floor(this.currentFrame);r>=this.props.totalFrameCount&&(this.onFinishLoop(),this.props.loop?r=this.currentFrame=0:(this.stop(),r=this.currentFrame=this.props.totalFrameCount-1));var i=r*this.props.imageHeight;this.spinnerElement.style.backgroundPosition="0 -"+i+"px",requestAnimationFrame(function(){e.updateFrame()})}},t.prototype.stop=function(){this.setState({inProgress:!1})},t.prototype.onFinishLoop=function(){},t.prototype.rightNow=function(){return window.performance&&window.performance.now?window.performance.now():Date.now()},t.prototype.configForSpinner=function(e,t,n){
var o=this;this.spinnerElement=e,t||this.initiallySetFocus(e),n.onunload=function(){o.stop()}},t.prototype.render=function(){var e=this.props.imageWidth?this.props.imageWidth:32,t=this.props.ariaLabel?this.props.ariaLabel:a.Localization.getLocalizedString("WebClipper.Accessibility.ScreenReader.Loading"),n={backgroundImage:"url("+this.props.spriteUrl+")",backgroundRepeat:"no-repeat",height:this.props.imageHeight+"px",width:e+"px"};return{tag:"div",attrs:{className:i.Constants.Classes.spinner,config:this.configForSpinner.bind(this),style:n,tabIndex:"290","aria-label":t,role:"progressbar","aria-valuemin":"0","aria-valuemax":"100"}}},t}(r.ComponentBase),l=s.componentize();n.SpriteAnimation=l},{"../../constants":74,"../../localization/localization":105,"../componentBase":16}],49:[function(e,t,n){"use strict";var o=e("../communicator/smartValue"),r=e("../storage/remoteStorage"),i=function(){function e(){}return e.getUserSessionId=function(){return e.sessionId.get()},e.getUserSessionIdWhenDefined=function(){return new Promise(function(t){var n=e.sessionId.get();n?t(n):e.sessionId.subscribe(function(e){t(e)},{times:1,callOnSubscribe:!1})})},e.getInjectCommunicator=function(){return e.injectCommunicator},e.setInjectCommunicator=function(t){e.injectCommunicator=t},e.getExtensionCommunicator=function(){return e.extensionCommunicator},e.setExtensionCommunicator=function(t){e.extensionCommunicator=t,e.setUpRemoteStorage(t)},e.getCachedValue=function(t){if(!e.storage)throw new Error("The remote storage needs to be set up with the extension communicator first");return e.storage.getCachedValue(t)},e.getStoredValue=function(t,n,o){if(!e.storage)throw new Error("The remote storage needs to be set up with the extension communicator first");e.storage.getValue(t,n,o)},e.preCacheStoredValues=function(t){if(!e.storage)throw new Error("The remote storage needs to be set up with the extension communicator first");e.storage.getValues(t,function(){},!0)},e.storeValue=function(t,n){if(!e.storage)throw new Error("The remote storage needs to be set up with the extension communicator first");e.storage.setValue(t,n,void 0)},e.setUpRemoteStorage=function(t){e.storage=new r.RemoteStorage(e.getExtensionCommunicator())},e}();i.sessionId=new o.SmartValue,n.Clipper=i},{"../communicator/smartValue":73,"../storage/remoteStorage":140}],50:[function(e,t,n){"use strict";var o,r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("../communicator/smartValue"),a=e("../constants"),s=e("../localization/localization"),l=e("../logging/log"),c=e("./animations/animationHelper"),u=e("./animations/animationState"),p=e("./animations/expandFromRightAnimationStrategy"),d=e("./animations/fadeInAnimationStrategy"),g=e("./animations/slidingHeightAnimationStrategy"),f=e("./clipMode"),h=e("./clipperStateUtilities"),v=e("./componentBase"),y=e("./components/closeButton"),C=e("./components/footer"),S=e("./frontEndGlobals"),b=e("./oneNoteApiUtils"),w=e("./panels/clippingPanel"),P=e("./panels/clippingPanelWithDelayedMessage"),I=e("./panels/clippingPanelWithProgressIndicator"),T=e("./panels/errorDialogPanel"),E=e("./panels/loadingPanel"),L=e("./panels/optionsPanel"),A=e("./panels/ratingsPanel"),U=e("./panels/regionSelectingPanel"),x=e("./panels/signInPanel"),N=e("./panels/successPanel"),O=e("./status");!function(e){e[e.CloseButton=0]="CloseButton",e[e.EscPress=1]="EscPress"}(o=n.CloseReason||(n.CloseReason={}));var R;!function(e){e[e.None=0]="None",e[e.BadState=1]="BadState",e[e.Loading=2]="Loading",e[e.SignInNeeded=3]="SignInNeeded",e[e.ClipOptions=4]="ClipOptions",e[e.RegionInstructions=5]="RegionInstructions",e[e.ClippingToApi=6]="ClippingToApi",e[e.ClippingFailure=7]="ClippingFailure",e[e.ClippingSuccess=8]="ClippingSuccess"}(R=n.PanelType||(n.PanelType={}));var F=function(e){function t(t){var n=e.call(this,t)||this;return n.initAnimationStrategy(),S.Clipper.getInjectCommunicator().registerFunction(a.Constants.FunctionKeys.escHandler,function(){n.handleEscPress()}),document.onkeydown=function(e){e.keyCode===a.Constants.KeyCodes.esc&&n.handleEscPress()},n}return r(t,e),t.prototype.getInitialState=function(){return{currentPanel:R.None}},t.prototype.handleEscPress=function(){this.isCloseable()&&this.closeClipper(o.EscPress)},t.prototype.initAnimationStrategy=function(){var e=this;this.controllerAnimationStrategy=new p.ExpandFromRightAnimationStrategy({extShouldAnimateIn:function(){return e.props.clipperState.uiExpanded},extShouldAnimateOut:function(){return!e.props.clipperState.uiExpanded},onBeforeAnimateOut:function(){e.setState({currentPanel:R.None})},onBeforeAnimateIn:function(){e.props.clipperState.reset()},onAnimateInExpand:function(){e.setState({currentPanel:e.getPanelTypeToShow()})},onAfterAnimateOut:function(){S.Clipper.getInjectCommunicator().callRemoteFunction(a.Constants.FunctionKeys.hideUi)}}),this.panelAnimationStrategy=new d.FadeInAnimationStrategy({extShouldAnimateIn:function(){return e.state.currentPanel!==R.None},extShouldAnimateOut:function(){return e.getPanelTypeToShow()!==e.state.currentPanel},onAfterAnimateOut:function(){e.setState({currentPanel:e.getPanelTypeToShow()})},onAfterAnimateIn:function(){e.setState({currentPanel:e.getPanelTypeToShow()})}}),this.heightAnimationStrategy=new g.SlidingHeightAnimationStrategy(a.Constants.Ids.mainController,{onAfterHeightAnimatorDraw:function(t){e.popupIsOpen?e.updateFrameHeightAfterPopupToggle(e.popupIsOpen):e.props.updateFrameHeight(t.newContainerHeight)}})},t.prototype.isCloseable=function(){var e=this.state.currentPanel;return e!==R.None&&e!==R.ClippingToApi},t.prototype.onPopupToggle=function(e){this.popupIsOpen=e,this.updateFrameHeightAfterPopupToggle(e)},t.prototype.updateFrameHeightAfterPopupToggle=function(e){var t=document.getElementById(a.Constants.Ids.saveToLocationContainer);if(t){var n=t.getBoundingClientRect(),o=a.Constants.Styles.sectionPickerContainerHeight+n.top+n.height,r=document.getElementById(a.Constants.Ids.mainController).offsetHeight,i=e?o:r;this.props.updateFrameHeight(i)}},t.prototype.getPanelTypeToShow=function(){if(this.props.clipperState.badState)return R.BadState;if(!this.props.clipperState.uiExpanded)return R.None;if(this.props.clipperState.userResult&&this.props.clipperState.userResult.status===O.Status.InProgress||this.props.clipperState.fetchLocStringStatus===O.Status.InProgress||!this.props.clipperState.invokeOptions)return R.Loading;if(!h.ClipperStateUtilities.isUserLoggedIn(this.props.clipperState))return R.SignInNeeded;if(this.props.clipperState.currentMode.get()===f.ClipMode.Region&&this.props.clipperState.regionResult.status!==O.Status.Succeeded)switch(this.props.clipperState.regionResult.status){case O.Status.InProgress:return R.Loading;default:return R.RegionInstructions}switch(this.props.clipperState.oneNoteApiResult.status){default:case O.Status.NotStarted:return R.ClipOptions;case O.Status.InProgress:return R.ClippingToApi;case O.Status.Failed:return R.ClippingFailure;case O.Status.Succeeded:return R.ClippingSuccess}},t.prototype.closeClipper=function(e){var t=new l.Event.BaseEvent(l.Event.Label.CloseClipper);t.setCustomProperty(l.PropertyName.Custom.CurrentPanel,R[this.state.currentPanel]),t.setCustomProperty(l.PropertyName.Custom.CloseReason,o[e]),S.Clipper.logger.logEvent(t),this.props.clipperState.setState({uiExpanded:!1,regionResult:{status:O.Status.NotStarted,data:[]}})},t.prototype.onMainControllerDraw=function(e){this.controllerAnimationStrategy.animate(e)},t.prototype.onPanelAnimatorDraw=function(e){var t=this,n=this.getPanelTypeToShow(),o=n===this.state.currentPanel;n===R.ClipOptions&&this.state.currentPanel!==R.ClipOptions&&(this.popupIsOpen=!1),this.panelAnimationStrategy.animate(e),o||this.panelAnimationStrategy.getAnimationState()!==u.AnimationState.GoingIn||c.AnimationHelper.stopAnimationsThen(e,function(){t.panelAnimationStrategy.setAnimationState(u.AnimationState.In),t.setState({})})},t.prototype.onHeightAnimatorDraw=function(e){this.heightAnimationStrategy.animate(e)},t.prototype.getCurrentPanel=function(){var e=this,t=this.state.currentPanel,n=[];switch(t){case R.BadState:return n.push({id:a.Constants.Ids.refreshPageButton,label:s.Localization.getLocalizedString("WebClipper.Action.RefreshPage"),handler:function(){S.Clipper.getInjectCommunicator().callRemoteFunction(a.Constants.FunctionKeys.refreshPage)}}),m.component(T.ErrorDialogPanel,{message:s.Localization.getLocalizedString("WebClipper.Error.OrphanedWebClipperDetected"),buttons:n});case R.Loading:return m.component(E.LoadingPanel,{clipperState:this.props.clipperState});case R.SignInNeeded:return m.component(x.SignInPanel,{clipperState:this.props.clipperState,onSignInInvoked:this.props.onSignInInvoked});case R.ClipOptions:return m.component(L.OptionsPanel,{onPopupToggle:this.onPopupToggle.bind(this),clipperState:this.props.clipperState,onStartClip:this.props.onStartClip});case R.RegionInstructions:return m.component(U.RegionSelectingPanel,{clipperState:this.props.clipperState});case R.ClippingToApi:return this.props.clipperState.currentMode.get()===f.ClipMode.Pdf?this.props.clipperState.pdfPreviewInfo.shouldDistributePages?m.component(I.ClippingPanelWithProgressIndicator,{clipperState:this.props.clipperState}):m.component(P.ClippingPanelWithDelayedMessage,{clipperState:this.props.clipperState,delay:a.Constants.Settings.pdfClippingMessageDelay,message:s.Localization.getLocalizedString("WebClipper.ClipType.Pdf.ProgressLabelDelay")}):m.component(w.ClippingPanel,{clipperState:this.props.clipperState});case R.ClippingFailure:var o=this.props.clipperState.oneNoteApiResult.data,r=b.OneNoteApiUtils.getApiResponseCode(o);return b.OneNoteApiUtils.isRetryable(r)&&n.push({id:a.Constants.Ids.dialogTryAgainButton,label:s.Localization.getLocalizedString("WebClipper.Action.TryAgain"),handler:this.props.onStartClip}),b.OneNoteApiUtils.requiresSignout(r)?n.push({id:a.Constants.Ids.dialogSignOutButton,label:s.Localization.getLocalizedString("WebClipper.Action.SignOut"),handler:function(){e.props.onSignOutInvoked&&e.props.onSignOutInvoked(e.props.clipperState.userResult.data.user.authType)}}):n.push({id:a.Constants.Ids.dialogBackButton,label:s.Localization.getLocalizedString("WebClipper.Action.BackToHome"),handler:function(){e.props.clipperState.setState({oneNoteApiResult:{data:e.props.clipperState.oneNoteApiResult.data,status:O.Status.NotStarted}})}}),m.component(T.ErrorDialogPanel,{message:b.OneNoteApiUtils.getLocalizedErrorMessage(r),buttons:n});case R.ClippingSuccess:var l=[m.component(N.SuccessPanel,{clipperState:this.props.clipperState})];return this.state.ratingsPanelAnimationState||(this.state.ratingsPanelAnimationState=new i.SmartValue(u.AnimationState.Out)),this.props.clipperState.showRatingsPrompt&&l.push(m.component(A.RatingsPanel,{clipperState:this.props.clipperState,animationState:this.state.ratingsPanelAnimationState})),l;default:return}},t.prototype.getCloseButtonForType=function(){return this.isCloseable()?m.component(y.CloseButton,{onClickHandler:this.closeClipper.bind(this),onClickHandlerParams:[o.CloseButton]}):void 0},t.prototype.getCurrentFooter=function(){var e=this.state.currentPanel;switch(e){case R.ClipOptions:case R.ClippingFailure:var t=this.props.clipperState.oneNoteApiResult.data,n=b.OneNoteApiUtils.getApiResponseCode(t);if(b.OneNoteApiUtils.requiresSignout(n))return;case R.SignInNeeded:return m.component(C.Footer,{clipperState:this.props.clipperState,onSignOutInvoked:this.props.onSignOutInvoked});case R.ClippingSuccess:default:return}},t.prototype.render=function(){var e=this.getCurrentPanel(),t=this.getCloseButtonForType(),n=this.getCurrentFooter();return{tag:"div",attrs:Object.assign({id:a.Constants.Ids.mainController},this.onElementDraw(this.onMainControllerDraw),{role:"main","aria-label":s.Localization.getLocalizedString("WebClipper.Label.OneNoteWebClipper")}),children:[t,{tag:"div",attrs:{className:"panelContent"},children:[{tag:"div",attrs:Object.assign({className:a.Constants.Classes.heightAnimator},this.onElementDraw(this.onHeightAnimatorDraw)),children:[{tag:"div",attrs:Object.assign({className:a.Constants.Classes.panelAnimator},this.onElementDraw(this.onPanelAnimatorDraw)),children:[e,n]}]}]}]}},t}(v.ComponentBase);n.MainControllerClass=F;var k=F.componentize();n.MainController=k},{"../communicator/smartValue":73,"../constants":74,"../localization/localization":105,"../logging/log":108,"./animations/animationHelper":5,"./animations/animationState":6,"./animations/expandFromRightAnimationStrategy":8,"./animations/fadeInAnimationStrategy":9,"./animations/slidingHeightAnimationStrategy":11,"./clipMode":13,"./clipperStateUtilities":15,"./componentBase":16,"./components/closeButton":18,"./components/footer":19,"./frontEndGlobals":49,"./oneNoteApiUtils":51,"./panels/clippingPanel":52,"./panels/clippingPanelWithDelayedMessage":53,"./panels/clippingPanelWithProgressIndicator":54,"./panels/errorDialogPanel":56,"./panels/loadingPanel":57,"./panels/optionsPanel":58,"./panels/ratingsPanel":59,"./panels/regionSelectingPanel":60,"./panels/signInPanel":61,"./panels/successPanel":62,"./status":66}],51:[function(e,t,n){arguments[4][4][0].apply(n,arguments)},{"../constants":74,"../localization/localization":105,"../logging/log":108,"./frontEndGlobals":49,dup:4}],52:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../constants"),i=e("../../contentCapture/augmentationHelper"),a=e("../../extensions/extensionUtils"),s=e("../../localization/localization"),l=e("../../logging/log"),c=e("../clipMode"),u=e("../frontEndGlobals"),p=e("../componentBase"),d=e("../components/spriteAnimation"),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getProgressLabel=function(){switch(this.props.clipperState.currentMode.get()){case c.ClipMode.Pdf:return s.Localization.getLocalizedString("WebClipper.ClipType.Pdf.ProgressLabel");case c.ClipMode.Region:return s.Localization.getLocalizedString("WebClipper.ClipType.Region.ProgressLabel");case c.ClipMode.Augmentation:var e=void 0;try{var t=i.AugmentationModel[this.props.clipperState.augmentationResult.data.ContentModel];e=s.Localization.getLocalizedString("WebClipper.ClipType."+t+".ProgressLabel")}catch(t){u.Clipper.logger.logFailure(l.Failure.Label.GetLocalizedString,l.Failure.Type.Unexpected,{error:t.message},c.ClipMode[this.props.clipperState.currentMode.get()]),e=s.Localization.getLocalizedString("WebClipper.ClipType.ScreenShot.ProgressLabel")}return e;case c.ClipMode.Bookmark:return s.Localization.getLocalizedString("WebClipper.ClipType.Bookmark.ProgressLabel");case c.ClipMode.Selection:return s.Localization.getLocalizedString("WebClipper.ClipType.Selection.ProgressLabel");default:case c.ClipMode.FullPage:return s.Localization.getLocalizedString("WebClipper.ClipType.ScreenShot.ProgressLabel")}},t.prototype.render=function(){return{tag:"div",attrs:{id:r.Constants.Ids.clipperApiProgressContainer,className:"progressPadding"},children:[m.component(d.SpriteAnimation,{spriteUrl:a.ExtensionUtils.getImageResourceUrl("spinner_loop.png"),imageHeight:32,totalFrameCount:21,loop:!0}),{tag:"span",attrs:{className:"actionLabelFont messageLabel",role:"alert",style:s.Localization.getFontFamilyAsStyle(s.Localization.FontFamily.Regular)},children:[this.getProgressLabel()]}]}},t}(p.ComponentBase),f=g.componentize();n.ClippingPanel=f},{"../../constants":74,"../../contentCapture/augmentationHelper":75,"../../extensions/extensionUtils":93,"../../localization/localization":105,"../../logging/log":108,"../clipMode":13,"../componentBase":16,"../components/spriteAnimation":48,"../frontEndGlobals":49}],53:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../constants"),i=e("../../localization/localization"),a=e("../componentBase"),s=e("./clippingPanel"),l=function(e){function t(t){var n=e.call(this,t)||this;return setTimeout(function(){n.setState({showMessage:!0})},Math.max(n.props.delay,0)),n}return o(t,e),t.prototype.getInitialState=function(){return{showMessage:!1}},t.prototype.getMessageElement=function(){return{tag:"span",attrs:{className:"actionLabelFont messageLabel",id:r.Constants.Ids.clipProgressDelayedMessage,style:i.Localization.getFontFamilyAsStyle(i.Localization.FontFamily.Regular)},children:[this.props.message]}},t.prototype.render=function(){return{tag:"div",attrs:{},children:[m.component(s.ClippingPanel,{clipperState:this.props.clipperState}),this.state.showMessage?this.getMessageElement():void 0]}},t}(a.ComponentBase),c=l.componentize();n.ClippingPanelWithDelayedMessage=c},{"../../constants":74,"../../localization/localization":105,"../componentBase":16,"./clippingPanel":52}],54:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../constants"),i=e("../../objectUtils"),a=e("../../localization/localization"),s=e("../componentBase"),l=e("./clippingPanel"),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getMessageElement=function(){var e=this.props.clipperState.clipSaveStatus;if(!i.ObjectUtils.isNullOrUndefined(e.numItemsCompleted)&&!i.ObjectUtils.isNullOrUndefined(e.numItemsTotal)&&!(e.numItemsCompleted>e.numItemsTotal||e.numItemsCompleted<0||e.numItemsTotal<0)){var t=a.Localization.getLocalizedString("WebClipper.ClipType.Pdf.IncrementalProgressMessage").replace("{0}",(e.numItemsCompleted+1).toString());return t=t.replace("{1}",e.numItemsTotal.toString()),{tag:"span",attrs:{className:"actionLabelFont messageLabel",id:r.Constants.Ids.clipProgressIndicatorMessage,style:a.Localization.getFontFamilyAsStyle(a.Localization.FontFamily.Regular)},children:[t]}}},t.prototype.render=function(){return{tag:"div",attrs:{},children:[m.component(l.ClippingPanel,{clipperState:this.props.clipperState}),this.getMessageElement()]}},t}(s.ComponentBase),u=c.componentize();n.ClippingPanelWithProgressIndicator=u},{"../../constants":74,"../../localization/localization":105,"../../objectUtils":123,"../componentBase":16,"./clippingPanel":52}],55:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../componentBase"),i=e("../../constants"),a=e("../../objectUtils"),s=e("../../localization/localization"),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getExtraMessages=function(){},t.prototype.onPanelAnimatorDraw=function(e){this.props.panelAnimationStrategy&&this.props.panelAnimationStrategy.animate(e)},t.prototype.render=function(){var e=this,t=a.ObjectUtils.isNullOrUndefined(this.props.fontFamily)?s.Localization.FontFamily.Semibold:this.props.fontFamily,n=a.ObjectUtils.isNullOrUndefined(this.props.buttonFontFamily)?s.Localization.FontFamily.Semibold:this.props.buttonFontFamily,o=this.props.containerId?this.props.containerId:"";return{tag:"div",attrs:{id:o},children:[{tag:"div",attrs:Object.assign({className:i.Constants.Classes.panelAnimator},this.onElementDraw(this.onPanelAnimatorDraw)),children:[{tag:"div",attrs:{id:i.Constants.Ids.dialogMessageContainer,className:"resultPagePadding"},children:[{tag:"div",attrs:{className:"messageLabelContainer",style:s.Localization.getFontFamilyAsStyle(t)},children:[{tag:"div",attrs:{id:i.Constants.Ids.dialogMessage,className:"dialogMessageFont messageLabel",role:"alert"},children:[this.props.message]},this.getExtraMessages()]}]},{tag:"div",attrs:{id:i.Constants.Ids.dialogContentContainer,className:""},children:[this.props.content]},{tag:"div",attrs:{id:i.Constants.Ids.dialogButtonContainer},children:[this.props.buttons.map(function(t,o){return{tag:"div",attrs:{className:"wideButtonContainer dialogButton"},children:[{tag:"a",attrs:Object.assign({id:t.id},e.enableInvoke({callback:t.handler,tabIndex:70}),{className:"buttonTextInHighContrast wideButtonFont wideActionButton",role:"button",style:s.Localization.getFontFamilyAsStyle(n)}),children:[t.label]}]}})]}]}]}},t}(r.ComponentBase);n.DialogPanelClass=l;var c=l.componentize();n.DialogPanel=c},{"../../constants":74,"../../localization/localization":105,"../../objectUtils":123,"../componentBase":16}],56:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../constants"),i=e("../frontEndGlobals"),a=e("./dialogPanel"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getExtraMessages=function(){return{tag:"div",attrs:{id:r.Constants.Ids.dialogDebugMessageContainer},children:[this.getDebugSessionId()]}},t.prototype.getDebugSessionId=function(){return"Usid: "+i.Clipper.getUserSessionId()},t}(a.DialogPanelClass),l=s.componentize();n.ErrorDialogPanel=l},{"../../constants":74,"../frontEndGlobals":49,"./dialogPanel":55}],57:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../constants"),i=e("../../extensions/extensionUtils"),a=e("../componentBase"),s=e("../components/spriteAnimation"),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.render=function(){return{tag:"div",attrs:{id:r.Constants.Ids.clipperLoadingContainer,className:"progressPadding"},children:[m.component(s.SpriteAnimation,{spriteUrl:i.ExtensionUtils.getImageResourceUrl("spinner_loop.png"),imageHeight:32,totalFrameCount:21,loop:!0,shouldTakeFocus:!0})]}},t}(a.ComponentBase),c=l.componentize();n.LoadingPanel=c},{"../../constants":74,"../../extensions/extensionUtils":93,"../componentBase":16,"../components/spriteAnimation":48}],58:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../constants"),i=e("../../operationResult"),a=e("../../stringUtils"),s=e("../../localization/localization"),l=e("../components/modeButtonSelector"),c=e("../components/sectionPicker"),u=e("../clipMode"),p=e("../clipperStateUtilities"),d=e("../componentBase"),g=e("../status"),f=e("../components/pdfClipOptions"),h=e("lodash"),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getCurrentClippingOptions=function(){var e=this.props.clipperState.currentMode.get();switch(e){case u.ClipMode.Pdf:return m.component(f.PdfClipOptions,{clipperState:this.props.clipperState});default:return}},t.prototype.checkOptionsBeforeStartClip=function(){var e=this.props.clipperState,t=e.pdfPreviewInfo;if(e.currentMode.get()===u.ClipMode.Pdf&&!t.allPages&&e.pdfResult.status===g.Status.Succeeded){var n=a.StringUtils.parsePageRange(t.selectedPageRange,e.pdfResult.data.get().pdf.numPages());if(n.status!==i.OperationResult.Succeeded){var o=h.extend(h.cloneDeep(t),{shouldShowPopover:!0});return void e.setState({pdfPreviewInfo:o})}}this.props.onStartClip()},t.prototype.attachClipHotKeyListener=function(e,t,n){var o=this;if(!t){var i=document.onkeydown;document.onkeydown=function(e){if(e.altKey&&e.which===r.Constants.KeyCodes.c&&o.checkOptionsBeforeStartClip(),e.shiftKey&&e.keyCode===r.Constants.KeyCodes.tab){var t=e.target;if(t&&t.id){var n=["fullPageButton","bookmarkButton","regionButton","augmentationButton"];if(n.indexOf(t.id)!==-1)return document.getElementById("closeButton").focus(),e.preventDefault(),void e.stopImmediatePropagation()}}i&&i.call(document,e)},n.onunload=function(){document.onkeydown=i?i.bind(document):void 0}}},t.prototype.render=function(){var e=p.ClipperStateUtilities.clipButtonEnabled(this.props.clipperState),t=e?"wideButtonContainer":"wideButtonContainer disabled",n=this.getCurrentClippingOptions();return{tag:"div",attrs:{className:"optionsPanel",config:this.attachClipHotKeyListener.bind(this)},children:[m.component(l.ModeButtonSelector,{clipperState:this.props.clipperState}),n,m.component(c.SectionPicker,{onPopupToggle:this.props.onPopupToggle.bind(this),clipperState:this.props.clipperState}),{tag:"div",attrs:{id:r.Constants.Ids.clipButtonContainer,className:t},children:[e?{tag:"a",attrs:Object.assign({id:r.Constants.Ids.clipButton,className:"wideActionButton"},this.enableInvoke({callback:this.checkOptionsBeforeStartClip.bind(this),tabIndex:71}),{role:"button"}),children:[{tag:"span",attrs:{className:"wideButtonFont buttonTextInHighContrast",style:s.Localization.getFontFamilyAsStyle(s.Localization.FontFamily.Semibold)},children:[s.Localization.getLocalizedString("WebClipper.Action.Clip")]}]}:{tag:"a",attrs:{id:r.Constants.Ids.clipButton,className:"wideActionButton",role:"button"},children:[{tag:"span",attrs:{className:"wideButtonFont buttonTextInHighContrast",style:s.Localization.getFontFamilyAsStyle(s.Localization.FontFamily.Semibold)},children:[s.Localization.getLocalizedString("WebClipper.Action.Clip")]}]}]}]}},t}(d.ComponentBase),y=v.componentize();n.OptionsPanel=y},{"../../constants":74,"../../localization/localization":105,"../../operationResult":124,"../../stringUtils":141,"../clipMode":13,"../clipperStateUtilities":15,"../componentBase":16,"../components/modeButtonSelector":21,"../components/pdfClipOptions":22,"../components/sectionPicker":47,"../status":66,lodash:150}],59:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../constants"),i=e("../../objectUtils"),a=e("../../localization/localization"),s=e("../../storage/clipperStorageKeys"),l=e("../componentBase"),c=e("../frontEndGlobals"),u=e("../ratingsHelper"),p=e("../animations/slideContentInFromTopAnimationStrategy"),d=e("./dialogPanel"),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getInitialState=function(){return{currentRatingsPromptStage:u.RatingsPromptStage.Init}},t.prototype.getPanelAnimationStrategy=function(e){if(this.props.animationState)return new p.SlideContentInFromTopAnimationStrategy({currentAnimationState:this.props.animationState,contentToAnimate:this.getContentToAnimate(),extShouldAnimateIn:function(){return i.ObjectUtils.isNullOrUndefined(e.state.userSelectedRatingsPromptStage)||e.state.userSelectedRatingsPromptStage===e.state.currentRatingsPromptStage},extShouldAnimateOut:function(){return e.state.userSelectedRatingsPromptStage>e.state.currentRatingsPromptStage},onAfterAnimateOut:function(){e.setState({currentRatingsPromptStage:e.state.userSelectedRatingsPromptStage})}})},t.prototype.getContentToAnimate=function(){return[{cssSelector:".messageLabel",animateInOptions:{slideDownDeltas:[50],delaysInMs:[33]}},{cssSelector:".dialogButton.wideButtonContainer",animateInOptions:{slideDownDeltas:[48,48],delaysInMs:[50,0]}}]},t.prototype.getMessage=function(e){switch(e){case u.RatingsPromptStage.Init:return a.Localization.getLocalizedString("WebClipper.Label.Ratings.Message.Init");case u.RatingsPromptStage.Rate:return a.Localization.getLocalizedString("WebClipper.Label.Ratings.Message.Rate");case u.RatingsPromptStage.Feedback:return a.Localization.getLocalizedString("WebClipper.Label.Ratings.Message.Feedback");case u.RatingsPromptStage.End:return a.Localization.getLocalizedString("WebClipper.Label.Ratings.Message.End");default:case u.RatingsPromptStage.None:return}},t.prototype.getDialogButtons=function(e){var t=this,n=e.state.currentRatingsPromptStage,o=e.props.clipperState,i=o.clientInfo.clipperType,l=[];switch(n){case u.RatingsPromptStage.Init:l.push({id:r.Constants.Ids.ratingsButtonInitYes,label:a.Localization.getLocalizedString("WebClipper.Label.Ratings.Button.Init.Positive"),handler:function(){u.RatingsHelper.setDoNotPromptStatus();var n=u.RatingsHelper.getRateUrlIfExists(i);n?e.setState({userSelectedRatingsPromptStage:u.RatingsPromptStage.Rate}):e.setState({userSelectedRatingsPromptStage:u.RatingsPromptStage.End}),t.forceTransitionIfAnimationsAreOff(e)}},{id:r.Constants.Ids.ratingsButtonInitNo,label:a.Localization.getLocalizedString("WebClipper.Label.Ratings.Button.Init.Negative"),handler:function(){u.RatingsHelper.badRatingAlreadyOccurred()&&u.RatingsHelper.setDoNotPromptStatus();var n=c.Clipper.getCachedValue(s.ClipperStorageKeys.lastSeenVersion);c.Clipper.storeValue(s.ClipperStorageKeys.lastBadRatingDate,Date.now().toString()),c.Clipper.storeValue(s.ClipperStorageKeys.lastBadRatingVersion,n);var r=u.RatingsHelper.getFeedbackUrlIfExists(o);r?e.setState({userSelectedRatingsPromptStage:u.RatingsPromptStage.Feedback}):e.setState({userSelectedRatingsPromptStage:u.RatingsPromptStage.End}),t.forceTransitionIfAnimationsAreOff(e)}});break;case u.RatingsPromptStage.Rate:var p=u.RatingsHelper.getRateUrlIfExists(i);p?l.push({id:r.Constants.Ids.ratingsButtonRateYes,label:a.Localization.getLocalizedString("WebClipper.Label.Ratings.Button.Rate"),handler:function(){window.open(p,"_blank"),e.setState({userSelectedRatingsPromptStage:u.RatingsPromptStage.End}),t.forceTransitionIfAnimationsAreOff(e)}},{id:r.Constants.Ids.ratingsButtonRateNo,label:a.Localization.getLocalizedString("WebClipper.Label.Ratings.Button.NoThanks"),handler:function(){e.setState({userSelectedRatingsPromptStage:u.RatingsPromptStage.None}),t.forceTransitionIfAnimationsAreOff(e)}}):e.setState({userSelectedRatingsPromptStage:u.RatingsPromptStage.None});break;case u.RatingsPromptStage.Feedback:var d=u.RatingsHelper.getFeedbackUrlIfExists(o);d?l.push({id:r.Constants.Ids.ratingsButtonFeedbackYes,label:a.Localization.getLocalizedString("WebClipper.Label.Ratings.Button.Feedback"),handler:function(){window.open(d,"_blank"),e.setState({userSelectedRatingsPromptStage:u.RatingsPromptStage.End}),t.forceTransitionIfAnimationsAreOff(e)}},{id:r.Constants.Ids.ratingsButtonFeedbackNo,label:a.Localization.getLocalizedString("WebClipper.Label.Ratings.Button.NoThanks"),handler:function(){e.setState({userSelectedRatingsPromptStage:u.RatingsPromptStage.None}),t.forceTransitionIfAnimationsAreOff(e)}}):e.setState({userSelectedRatingsPromptStage:u.RatingsPromptStage.None});break;default:case u.RatingsPromptStage.End:case u.RatingsPromptStage.None:}return l},t.prototype.forceTransitionIfAnimationsAreOff=function(e){e.props.animationState||e.setState({currentRatingsPromptStage:e.state.userSelectedRatingsPromptStage})},t.prototype.render=function(){if(!this.props.clipperState.showRatingsPrompt)return{tag:"div",attrs:{}};var e=this.getMessage(this.state.currentRatingsPromptStage);if(!i.ObjectUtils.isNullOrUndefined(e)){var t=this.getDialogButtons(this),n=this.getPanelAnimationStrategy(this);return m.component(d.DialogPanel,{message:e,buttons:t,buttonFontFamily:a.Localization.FontFamily.Regular,containerId:r.Constants.Ids.ratingsPromptContainer,panelAnimationStrategy:n})}return{tag:"div",attrs:{}}},t}(l.ComponentBase),f=g.componentize();n.RatingsPanel=f},{"../../constants":74,"../../localization/localization":105,"../../objectUtils":123,"../../storage/clipperStorageKeys":138,"../animations/slideContentInFromTopAnimationStrategy":10,"../componentBase":16,"../frontEndGlobals":49,"../ratingsHelper":64,"./dialogPanel":55}],60:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){
function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../constants"),i=e("../../localization/localization"),a=e("../componentBase"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.handleCancelButton=function(){this.props.clipperState.reset()},t.prototype.render=function(){return{tag:"div",attrs:{id:r.Constants.Ids.regionInstructionsContainer},children:[{tag:"div",attrs:{className:"regionClipPadding"},children:[{tag:"div",attrs:{className:"messageLabelContainer regionSelectionContainer"},children:[{tag:"div",attrs:{className:r.Constants.Classes.srOnly,role:"alert"},children:[i.Localization.getLocalizedString("WebClipper.Label.RegionSelectionMouseInstruction"),i.Localization.getLocalizedString("WebClipper.Label.RegionSelectionKeyboardInstruction")]},{tag:"span",attrs:{className:"informationLabelFont messageLabel",style:i.Localization.getFontFamilyAsStyle(i.Localization.FontFamily.Light)},children:[i.Localization.getLocalizedString("WebClipper.Label.RegionSelectionMouseInstruction"),{tag:"br",attrs:{}},i.Localization.getLocalizedString("WebClipper.Label.RegionSelectionKeyboardInstruction")]}]},{tag:"div",attrs:{className:"wideButtonContainer"},children:[{tag:"a",attrs:Object.assign({id:r.Constants.Ids.regionClipCancelButton,role:"button"},this.enableInvoke({callback:this.handleCancelButton,tabIndex:0})),children:[{tag:"span",attrs:{className:"wideButtonFont wideActionButton buttonTextInHighContrast",style:i.Localization.getFontFamilyAsStyle(i.Localization.FontFamily.Semibold)},children:[i.Localization.getLocalizedString("WebClipper.Action.BackToHome")]}]}]}]}]}},t}(a.ComponentBase),l=s.componentize();n.RegionSelectingPanel=l},{"../../constants":74,"../../localization/localization":105,"../componentBase":16}],61:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../clientType"),i=e("../../constants"),a=e("../../userInfo"),s=e("../../extensions/extensionUtils"),l=e("../../localization/localization"),c=e("../frontEndGlobals"),u=e("../componentBase"),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.initiallySetFocus=function(e){e.focus()},t.prototype.getInitialState=function(){return{debugInformationShowing:!1}},t.prototype.onSignInMsa=function(){this.props.onSignInInvoked(a.AuthType.Msa)},t.prototype.onSignInOrgId=function(){this.props.onSignInInvoked(a.AuthType.OrgId)},t.prototype.getSignInDescription=function(){if(!this.props.clipperState.userResult||!this.props.clipperState.userResult.data)return l.Localization.getLocalizedString("WebClipper.Label.SignInDescription");switch(this.props.clipperState.userResult.data.updateReason){case a.UpdateReason.SignInAttempt:return l.Localization.getLocalizedString("WebClipper.Error.SignInUnsuccessful");case a.UpdateReason.TokenRefreshForPendingClip:return l.Localization.getLocalizedString("WebClipper.Error.GenericExpiredTokenRefreshError");default:case a.UpdateReason.SignInCancel:case a.UpdateReason.SignOutAction:case a.UpdateReason.InitialRetrieval:return l.Localization.getLocalizedString("WebClipper.Label.SignInDescription")}},t.prototype.signInAttempted=function(){return!!this.props.clipperState.userResult&&!!this.props.clipperState.userResult.data&&this.props.clipperState.userResult.data.updateReason===a.UpdateReason.SignInAttempt},t.prototype.signInFailureContainsErrorDescription=function(){return this.signInAttempted()&&this.props.clipperState.userResult.data.errorDescription&&0===this.props.clipperState.userResult.data.errorDescription.indexOf("OrgId")},t.prototype.signInFailureThirdPartyCookiesBlocked=function(){return this.signInAttempted()&&!this.props.clipperState.userResult.data.user&&!this.props.clipperState.userResult.data.writeableCookies},t.prototype.debugInformationControlHandler=function(){this.setState({debugInformationShowing:!this.state.debugInformationShowing})},t.prototype.signInErrorDetected=function(){return this.signInFailureContainsErrorDescription()||this.signInFailureThirdPartyCookiesBlocked()},t.prototype.errorMoreInformationTogggle=function(){if(this.signInErrorDetected())return{tag:"div",attrs:{id:"signInErrorToggleInformation"},children:[{tag:"a",attrs:Object.assign({id:i.Constants.Ids.signInErrorMoreInformation},this.enableInvoke({callback:this.debugInformationControlHandler,tabIndex:10})),children:[{tag:"img",attrs:{id:i.Constants.Ids.signInToggleErrorDropdownArrow,src:s.ExtensionUtils.getImageResourceUrl("dropdown_arrow.svg")}},{tag:"span",attrs:{id:i.Constants.Ids.signInToggleErrorInformationText,style:l.Localization.getFontFamilyAsStyle(l.Localization.FontFamily.Light)},children:[this.state.debugInformationShowing?l.Localization.getLocalizedString("WebClipper.Label.SignInUnsuccessfulLessInformation"):l.Localization.getLocalizedString("WebClipper.Label.SignInUnsuccessfulMoreInformation")]}]},this.debugInformation()]}},t.prototype.debugInformation=function(){if(this.signInErrorDetected()&&this.state.debugInformationShowing)return{tag:"div",attrs:{id:i.Constants.Ids.signInErrorDebugInformation},children:[{tag:"div",attrs:{id:i.Constants.Ids.signInErrorDebugInformationContainer,style:l.Localization.getFontFamilyAsStyle(l.Localization.FontFamily.Light)},children:[{tag:"ul",attrs:{id:i.Constants.Ids.signInErrorDebugInformationList},children:[{tag:"li",attrs:{},children:[r.ClientType[this.props.clipperState.clientInfo.clipperType],": ",this.props.clipperState.clientInfo.clipperVersion]},{tag:"li",attrs:{},children:["ID: ",this.props.clipperState.clientInfo.clipperId]},{tag:"li",attrs:{},children:["USID: ",c.Clipper.getUserSessionId()]}]}]}]}},t.prototype.getErrorDescription=function(){if(this.signInFailureContainsErrorDescription())return this.props.clipperState.userResult.data.errorDescription;if(this.signInFailureThirdPartyCookiesBlocked()){var e="";switch(this.props.clipperState.clientInfo.clipperType){case r.ClientType.ChromeExtension:e=l.Localization.getLocalizedString("WebClipper.Error.CookiesDisabled.Chrome");break;case r.ClientType.EdgeExtension:e=l.Localization.getLocalizedString("WebClipper.Error.CookiesDisabled.Edge");break;case r.ClientType.FirefoxExtension:e=l.Localization.getLocalizedString("WebClipper.Error.CookiesDisabled.Firefox");break;default:e=l.Localization.getLocalizedString("WebClipper.Error.CookiesDisabled.Line2")}return{tag:"div",attrs:{},children:[{tag:"div",attrs:{class:i.Constants.Ids.signInErrorCookieInformation},children:[l.Localization.getLocalizedString("WebClipper.Error.CookiesDisabled.Line1")]},{tag:"div",attrs:{class:i.Constants.Ids.signInErrorCookieInformation},children:[e]}]}}},t.prototype.errorInformationDescription=function(){if(this.signInErrorDetected())return{tag:"div",attrs:{id:i.Constants.Ids.signInErrorDescription},children:[{tag:"span",attrs:{id:i.Constants.Ids.signInErrorDescriptionContainer,style:l.Localization.getFontFamilyAsStyle(l.Localization.FontFamily.Light)},children:[this.getErrorDescription()]},this.errorMoreInformationTogggle()]}},t.prototype.render=function(){return{tag:"div",attrs:{id:i.Constants.Ids.signInContainer},children:[{tag:"div",attrs:{className:"signInPadding"},children:[{tag:"img",attrs:{id:i.Constants.Ids.signInLogo,src:s.ExtensionUtils.getImageResourceUrl("onenote_logo_clipper.png"),"aria-hidden":"true"}},{tag:"div",attrs:{id:i.Constants.Ids.signInMessageLabelContainer,className:"messageLabelContainer"},children:[{tag:"span",attrs:{className:"messageLabel",style:l.Localization.getFontFamilyAsStyle(l.Localization.FontFamily.Regular)},children:[l.Localization.getLocalizedString("WebClipper.Label.OneNoteClipper")]}]},{tag:"div",attrs:{className:"signInDescription"},children:[{tag:"span",attrs:{id:i.Constants.Ids.signInText,style:l.Localization.getFontFamilyAsStyle(l.Localization.FontFamily.Light)},children:[this.getSignInDescription()]}]},this.errorInformationDescription(),{tag:"div",attrs:{className:"wideButtonContainer"},children:[{tag:"a",attrs:Object.assign({id:i.Constants.Ids.signInButtonMsa,className:"wideButtonFont wideActionButton buttonTextInHighContrast",role:"button"},this.onElementFirstDraw(this.initiallySetFocus),this.enableInvoke({callback:this.onSignInMsa,tabIndex:11,args:a.AuthType.Msa}),{style:l.Localization.getFontFamilyAsStyle(l.Localization.FontFamily.Regular)}),children:[l.Localization.getLocalizedString("WebClipper.Action.SigninMsa")]}]},{tag:"div",attrs:{className:"wideButtonContainer"},children:[{tag:"a",attrs:Object.assign({id:i.Constants.Ids.signInButtonOrgId,className:"wideButtonFont wideActionButton buttonTextInHighContrast",role:"button"},this.enableInvoke({callback:this.onSignInOrgId,tabIndex:12,args:a.AuthType.OrgId}),{style:l.Localization.getFontFamilyAsStyle(l.Localization.FontFamily.Regular)}),children:[l.Localization.getLocalizedString("WebClipper.Action.SigninOrgId")]}]}]}]}},t}(u.ComponentBase),d=p.componentize();n.SignInPanel=d},{"../../clientType":3,"../../constants":74,"../../extensions/extensionUtils":93,"../../localization/localization":105,"../../userInfo":143,"../componentBase":16,"../frontEndGlobals":49}],62:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../constants"),i=e("../../urlUtils"),a=e("../../extensions/extensionUtils"),s=e("../../localization/localization"),l=e("../../logging/log"),c=e("../componentBase"),u=e("../frontEndGlobals"),p=e("../components/spriteAnimation"),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.onLaunchOneNoteButton=function(){u.Clipper.logger.logUserFunnel(l.Funnel.Label.ViewInWac);var e=this.props.clipperState.oneNoteApiResult.data;if(e&&e.links&&e.links.oneNoteWebUrl&&e.links.oneNoteWebUrl.href){var t=i.UrlUtils.addUrlQueryValue(e.links.oneNoteWebUrl.href,r.Constants.Urls.QueryParams.wdFromClipper,"1");window.open(t,"_blank")}else u.Clipper.logger.logFailure(l.Failure.Label.OnLaunchOneNoteButton,l.Failure.Type.Unexpected,{error:"Page created and returned by API is either missing entirely, or missing its links, oneNoteWebUrl, or oneNoteWebUrl.href. Page: "+e})},t.prototype.render=function(){return{tag:"div",attrs:{id:r.Constants.Ids.clipperSuccessContainer},children:[{tag:"div",attrs:{className:"messageLabelContainer successPagePadding"},children:[m.component(p.SpriteAnimation,{spriteUrl:a.ExtensionUtils.getImageResourceUrl("checkmark.png"),imageHeight:28,totalFrameCount:30,loop:!1}),{tag:"span",attrs:{className:"actionLabelFont messageLabel",role:"alert",style:s.Localization.getFontFamilyAsStyle(s.Localization.FontFamily.Light)},children:[s.Localization.getLocalizedString("WebClipper.Label.ClipSuccessful")]}]},{tag:"div",attrs:{className:"wideButtonContainer"},children:[{tag:"a",attrs:Object.assign({id:r.Constants.Ids.launchOneNoteButton,className:"wideButtonFont wideActionButton buttonTextInHighContrast",role:"button"},this.enableInvoke({callback:this.onLaunchOneNoteButton,tabIndex:70}),{style:s.Localization.getFontFamilyAsStyle(s.Localization.FontFamily.Regular)}),children:[s.Localization.getLocalizedString("WebClipper.Action.ViewInOneNote")]}]}]}},t}(c.ComponentBase),g=d.componentize();n.SuccessPanel=g},{"../../constants":74,"../../extensions/extensionUtils":93,"../../localization/localization":105,"../../logging/log":108,"../../urlUtils":142,"../componentBase":16,"../components/spriteAnimation":48,"../frontEndGlobals":49}],63:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../clientType"),i=e("../localization/localization"),a=e("./clipMode"),s=e("./componentBase"),l=e("./components/previewViewer/augmentationPreview"),c=e("./components/previewViewer/bookmarkPreview"),u=e("./components/previewViewer/fullPagePreview"),p=e("./components/previewViewer/pdfPreview"),d=e("./components/previewViewer/regionPreview"),g=e("./components/previewViewer/selectionPreview"),f=e("./components/previewViewer/localFilesNotAllowedPanel"),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.render=function(){var e=this.props.clipperState;switch(e.currentMode.get()){case a.ClipMode.Pdf:return e.pdfPreviewInfo.isLocalFileAndNotAllowed?m.component(p.PdfPreview,{clipperState:e}):e.clientInfo.clipperType===r.ClientType.ChromeExtension?m.component(f.LocalFilesNotAllowedPanel,{title:i.Localization.getLocalizedString("WebClipper.ClipType.Pdf.AskPermissionToClipLocalFile"),subtitle:i.Localization.getLocalizedString("WebClipper.ClipType.Pdf.InstructionsForClippingLocalFiles"),header:i.Localization.getLocalizedString("WebClipper.ClipType.Pdf.Button")}):m.component(f.LocalFilesNotAllowedPanel,{title:i.Localization.getLocalizedString("WebClipper.Preview.UnableToClipLocalFile"),subtitle:"",header:i.Localization.getLocalizedString("WebClipper.ClipType.Pdf.Button")});case a.ClipMode.FullPage:return m.component(u.FullPagePreview,{clipperState:e});case a.ClipMode.Region:return m.component(d.RegionPreview,{clipperState:e});case a.ClipMode.Augmentation:return m.component(l.AugmentationPreview,{clipperState:e});case a.ClipMode.Bookmark:return m.component(c.BookmarkPreview,{clipperState:e});case a.ClipMode.Selection:return m.component(g.SelectionPreview,{clipperState:e});default:return{tag:"div",attrs:{}}}},t}(s.ComponentBase),v=h.componentize();n.PreviewViewer=v},{"../clientType":3,"../localization/localization":105,"./clipMode":13,"./componentBase":16,"./components/previewViewer/augmentationPreview":26,"./components/previewViewer/bookmarkPreview":27,"./components/previewViewer/fullPagePreview":29,"./components/previewViewer/localFilesNotAllowedPanel":30,"./components/previewViewer/pdfPreview":31,"./components/previewViewer/regionPreview":43,"./components/previewViewer/selectionPreview":44}],64:[function(e,t,n){"use strict";var o,r=e("../clientType"),i=e("../clipperUrls"),a=e("../constants"),s=e("../objectUtils"),l=e("../settings"),c=e("../logging/log"),u=e("../storage/clipperStorageKeys"),p=e("../versioning/version"),d=e("./frontEndGlobals");!function(e){e[e.Init=0]="Init",e[e.Rate=1]="Rate",e[e.Feedback=2]="Feedback",e[e.End=3]="End",e[e.None=4]="None"}(o=n.RatingsPromptStage||(n.RatingsPromptStage={}));var g=function(){function e(){}return e.badRatingAlreadyOccurred=function(){var t=d.Clipper.getCachedValue(u.ClipperStorageKeys.lastBadRatingDate),n=parseInt(t,10);return!(isNaN(n)||!e.isValidDate(n))},e.getFeedbackUrlIfExists=function(e){var t=l.Settings.getSetting("LogCategory_RatingsPrompt");if(!s.ObjectUtils.isNullOrUndefined(t)&&t.length>0)return i.ClipperUrls.generateFeedbackUrl(e,d.Clipper.getUserSessionId(),t)},e.getRateUrlIfExists=function(t){var n=e.getRateUrlSettingNameForClient(t);return l.Settings.getSetting(n)},e.preCacheNeededValues=function(){var e=[u.ClipperStorageKeys.doNotPromptRatings,u.ClipperStorageKeys.lastBadRatingDate,u.ClipperStorageKeys.lastBadRatingVersion,u.ClipperStorageKeys.lastSeenVersion,u.ClipperStorageKeys.numSuccessfulClips,u.ClipperStorageKeys.numSuccessfulClipsRatingsEnablement];d.Clipper.preCacheStoredValues(e)},e.setDoNotPromptStatus=function(){d.Clipper.storeValue(u.ClipperStorageKeys.doNotPromptRatings,"true"),d.Clipper.logger.logEvent(new c.Event.BaseEvent(c.Event.Label.SetDoNotPromptRatings))},e.shouldShowRatingsPrompt=function(t){var n=new c.Event.PromiseEvent(c.Event.Label.ShouldShowRatingsPrompt),o={},r=e.shouldShowRatingsPromptInternal(t,n,o);return n.setCustomProperty(c.PropertyName.Custom.ShouldShowRatingsPrompt,r),n.setCustomProperty(c.PropertyName.Custom.RatingsInfo,JSON.stringify(o)),d.Clipper.logger.logEvent(n),r},e.ratingsPromptEnabledForClient=function(t){var n=e.getRatingsPromptEnabledSettingNameForClient(t),o=l.Settings.getSetting(n);return!s.ObjectUtils.isNullOrUndefined(o)&&"true"===o.toLowerCase()},e.badRatingTimingDelayIsOver=function(t,n){return!!isNaN(t)||!(!e.isValidDate(t)||!e.isValidDate(n))&&n-t>=a.Constants.Settings.minTimeBetweenBadRatings},e.badRatingVersionDelayIsOver=function(e,t){if(s.ObjectUtils.isNullOrUndefined(e))return!0;var n,o;try{n=new p.Version(e),o=new p.Version(t)}catch(e){return!1}return o.isGreaterThan(n,!0)},e.clipSuccessDelayIsOver=function(e,t){if(isNaN(e))return!1;isNaN(t)&&(t=0);var n=e-t;return n>=a.Constants.Settings.minClipSuccessForRatingsPrompt&&n<=a.Constants.Settings.maxClipSuccessForRatingsPrompt},e.setNumSuccessfulClipsRatingsEnablement=function(){var t=d.Clipper.getCachedValue(u.ClipperStorageKeys.doNotPromptRatings);if(!e.doNotPromptRatingsIsSet(t)){var n=d.Clipper.getCachedValue(u.ClipperStorageKeys.numSuccessfulClipsRatingsEnablement);if(!(parseInt(n,10)>=0)){var o=parseInt(d.Clipper.getCachedValue(u.ClipperStorageKeys.numSuccessfulClips),10);d.Clipper.storeValue(u.ClipperStorageKeys.numSuccessfulClipsRatingsEnablement,(o-1).toString())}}},e.shouldShowRatingsPromptInternal=function(t,n,o){if(s.ObjectUtils.isNullOrUndefined(t))return n.setStatus(c.Status.Failed),n.setFailureInfo({error:"Clipper state is null or undefined"}),!1;if(!s.ObjectUtils.isNullOrUndefined(t.showRatingsPrompt))return o.usedCachedValue=!0,t.showRatingsPrompt;var r=e.ratingsPromptEnabledForClient(t.clientInfo.clipperType);if(o.ratingsPromptEnabledForClient=r,!r)return!1;e.setNumSuccessfulClipsRatingsEnablement();var i=d.Clipper.getCachedValue(u.ClipperStorageKeys.doNotPromptRatings),a=d.Clipper.getCachedValue(u.ClipperStorageKeys.lastBadRatingDate),l=d.Clipper.getCachedValue(u.ClipperStorageKeys.lastBadRatingVersion),p=d.Clipper.getCachedValue(u.ClipperStorageKeys.lastSeenVersion),g=d.Clipper.getCachedValue(u.ClipperStorageKeys.numSuccessfulClips),f=d.Clipper.getCachedValue(u.ClipperStorageKeys.numSuccessfulClipsRatingsEnablement);if(e.doNotPromptRatingsIsSet(i))return o.doNotPromptRatings=!0,!1;var h=parseInt(a,10),m=parseInt(g,10),v=parseInt(f,10);o.lastBadRatingDate=h?new Date(h).toString():null,o.lastBadRatingVersion=l,o.lastSeenVersion=p,o.numSuccessfulClips=m,o.numSuccessfulClipsAnchor=v;var y=e.badRatingTimingDelayIsOver(h,Date.now()),C=e.badRatingVersionDelayIsOver(l,p),S=e.clipSuccessDelayIsOver(m,v);return o.badRatingTimingDelayIsOver=y,o.badRatingVersionDelayIsOver=C,o.clipSuccessDelayIsOver=S,!!(y&&C&&S)},e.combineClientTypeAndSuffix=function(e,t){return r.ClientType[e]+t},e.getRateUrlSettingNameForClient=function(t){return e.combineClientTypeAndSuffix(t,e.rateUrlSettingNameSuffix)},e.getRatingsPromptEnabledSettingNameForClient=function(t){return e.combineClientTypeAndSuffix(t,e.ratingsPromptEnabledSettingNameSuffix)},e.isValidDate=function(e){var t=a.Constants.Settings.maximumJSTimeValue*-1;return e>=t&&e<=a.Constants.Settings.maximumJSTimeValue},e.doNotPromptRatingsIsSet=function(e){return!s.ObjectUtils.isNullOrUndefined(e)&&"true"===e.toLowerCase()},e}();g.rateUrlSettingNameSuffix="_RatingUrl",g.ratingsPromptEnabledSettingNameSuffix="_RatingsEnabled",n.RatingsHelper=g},{"../clientType":3,"../clipperUrls":68,"../constants":74,"../logging/log":108,"../objectUtils":123,"../settings":135,"../storage/clipperStorageKeys":138,"../versioning/version":146,"./frontEndGlobals":49}],65:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../domParsers/domUtils"),i=e("../logging/log"),a=e("../constants"),s=e("../clientType"),l=e("./status"),c=e("./componentBase"),u=e("./frontEndGlobals"),p=e("../extensions/extensionUtils"),d=e("../localization/localization"),g=function(e){function t(t){var n=e.call(this,t)||this;return n.devicePixelRatio=1,n.cursorSpeed=1,n.resizeHandler=n.handleResize.bind(n),n.mouseMovementHandler=n.globalMouseMoveHandler.bind(n),n.mouseOverHandler=n.globalMouseOverHandler.bind(n),n.keyDownDict={},n.resetState(),window.addEventListener("resize",n.resizeHandler),window.addEventListener("mousemove",n.mouseMovementHandler),window.addEventListener("mouseover",n.mouseOverHandler),n}return o(t,e),t.prototype.getInitialState=function(){return{selectionInProgress:!1,keyboardSelectionInProgress:!1,winHeight:window.innerHeight,winWidth:window.innerWidth,mousePosition:{x:window.innerWidth/2,y:window.innerHeight/2}}},t.prototype.onunload=function(){window.removeEventListener("resize",this.resizeHandler),window.removeEventListener("mousemove",this.mouseMovementHandler),window.removeEventListener("mouseover",this.mouseOverHandler)},t.prototype.resetState=function(){this.setState({firstPoint:void 0,secondPoint:void 0,selectionInProgress:!1,keyboardSelectionInProgress:!1}),this.props.clipperState.setState({regionResult:{status:l.Status.NotStarted,data:this.props.clipperState.regionResult.data}})},t.prototype.startSelection=function(e,t){void 0===t&&(t=!1),this.props.clipperState.regionResult.status!==l.Status.InProgress&&(this.setState({firstPoint:e,secondPoint:void 0,selectionInProgress:!0,keyboardSelectionInProgress:t}),this.props.clipperState.setState({regionResult:{status:l.Status.InProgress,data:this.props.clipperState.regionResult.data}}))},t.prototype.completeSelection=function(e){var t=this.props.clipperState.regionResult.data;t||(t=[]),t.push(e),this.props.clipperState.setState({regionResult:{status:l.Status.Succeeded,data:t}})},t.prototype.moveSelection=function(e){this.setState({secondPoint:e})},t.prototype.setMousePosition=function(e){this.setState({mousePosition:e})},t.prototype.stopSelection=function(e){this.state.selectionInProgress&&(this.state.firstPoint&&this.state.secondPoint&&this.state.firstPoint.x!==this.state.secondPoint.x&&this.state.firstPoint.y!==this.state.secondPoint.y?(this.setState({secondPoint:e,selectionInProgress:!1,keyboardSelectionInProgress:!1}),this.startRegionClip()):this.resetState())},t.prototype.mouseDownHandler=function(e){e.preventDefault(),this.startSelection({x:e.pageX,y:e.pageY})},t.prototype.keyDownHandler=function(e){if(this.keyDownDict[e.which]=!0,e.which===a.Constants.KeyCodes.enter)this.state.selectionInProgress?this.stopSelection({x:this.state.mousePosition.x,y:this.state.mousePosition.y}):this.startSelection({x:this.state.mousePosition.x,y:this.state.mousePosition.y},!0),e.preventDefault();else if(e.which===a.Constants.KeyCodes.up||e.which===a.Constants.KeyCodes.down||e.which===a.Constants.KeyCodes.left||e.which===a.Constants.KeyCodes.right){var t={x:0,y:0};this.keyDownDict[a.Constants.KeyCodes.up]&&(t.y-=this.cursorSpeed),this.keyDownDict[a.Constants.KeyCodes.down]&&(t.y+=this.cursorSpeed),this.keyDownDict[a.Constants.KeyCodes.left]&&(t.x-=this.cursorSpeed),this.keyDownDict[a.Constants.KeyCodes.right]&&(t.x+=this.cursorSpeed);var n={x:Math.max(Math.min(this.state.mousePosition.x+t.x,this.state.winWidth),0),y:Math.max(Math.min(this.state.mousePosition.y+t.y,this.state.winHeight),0)};this.setMousePosition(n),this.state.selectionInProgress&&this.moveSelection(n),this.cursorSpeed<5&&this.cursorSpeed++,e.preventDefault()}},t.prototype.keyUpHandler=function(e){this.keyDownDict[e.which]=!1,e.which!==a.Constants.KeyCodes.up&&e.which!==a.Constants.KeyCodes.down&&e.which!==a.Constants.KeyCodes.left&&e.which!==a.Constants.KeyCodes.right||(this.cursorSpeed=1)},t.prototype.globalMouseMoveHandler=function(e){this.setMousePosition({x:e.pageX,y:e.pageY})},t.prototype.globalMouseOverHandler=function(e){window.removeEventListener("mouseover",this.mouseOverHandler),this.setMousePosition({x:e.pageX,y:e.pageY})},t.prototype.mouseMoveHandler=function(e){if(this.state.selectionInProgress){if(0===e.buttons&&!this.state.keyboardSelectionInProgress)return void this.stopSelection(this.state.secondPoint);this.moveSelection({x:e.pageX,y:e.pageY})}},t.prototype.mouseUpHandler=function(e){this.stopSelection({x:e.pageX,y:e.pageY})},t.prototype.touchStartHandler=function(e){var t=e.changedTouches[0];this.startSelection({x:t.clientX,y:t.clientY})},t.prototype.touchMoveHandler=function(e){if(this.state.selectionInProgress){var t=e.changedTouches[0];this.moveSelection({x:t.clientX,y:t.clientY}),e.preventDefault()}},t.prototype.touchEndHandler=function(e){var t=e.changedTouches[0];this.stopSelection({x:t.clientX,y:t.clientY})},t.prototype.handleResize=function(){this.setState({winHeight:window.innerHeight,winWidth:window.innerWidth})},t.prototype.updateVisualElements=function(e,t){var n=this.refs.outerFrame;if(n){var o=this.refs.cursor;o&&(o.style.left=this.state.mousePosition.x+"px",o.style.top=this.state.mousePosition.y+"px");var r,i,a,s;if(this.state.firstPoint&&this.state.secondPoint){r=Math.min(this.state.firstPoint.x,this.state.secondPoint.x),i=Math.min(this.state.firstPoint.y,this.state.secondPoint.y),a=Math.max(this.state.firstPoint.x,this.state.secondPoint.x),s=Math.max(this.state.firstPoint.y,this.state.secondPoint.y);var l=this.refs.innerFrame;if(l){var c=1;l.style.top=i-c+"px",l.style.left=r-c+"px",l.style.height=s-i+"px",l.style.width=a-r+"px"}}else r=0,i=0,a=0,s=0;var u=this.state.winWidth,p=this.state.winHeight,d=n.getContext("2d");d.canvas.width=u,d.canvas.height=p,d.beginPath(),d.fillStyle="black",d.fillRect(0,0,r,p),d.fillRect(r,0,a-r,i),d.fillRect(a,0,u-a,p),d.fillRect(r,s,a-r,p-s),t||e.focus()}},t.prototype.startRegionClip=function(){var e=this,t="(-webkit-min-device-pixel-ratio: 2), (min-device-pixel-ratio: 2), (min-resolution: 192dpi)",n=matchMedia(t).matches,o=this.props.clipperState.clientInfo.clipperType===s.ClientType.FirefoxExtension&&n;this.devicePixelRatio=o?window.devicePixelRatio/2:window.devicePixelRatio;var r=new i.Event.BaseEvent(i.Event.Label.RegionSelectionProcessing),l=new i.Event.BaseEvent(i.Event.Label.RegionSelectionCapturing);l.setCustomProperty(i.PropertyName.Custom.Width,Math.abs(this.state.firstPoint.x-this.state.secondPoint.x)),l.setCustomProperty(i.PropertyName.Custom.Height,Math.abs(this.state.firstPoint.y-this.state.secondPoint.y)),u.Clipper.getExtensionCommunicator().callRemoteFunction(a.Constants.FunctionKeys.takeTabScreenshot,{callback:function(t){u.Clipper.logger.logEvent(l),e.saveCompressedSelectionToState(t).then(function(e){r.setCustomProperty(i.PropertyName.Custom.Width,e.width),r.setCustomProperty(i.PropertyName.Custom.Height,e.height),r.setCustomProperty(i.PropertyName.Custom.IsHighDpiScreen,n),u.Clipper.logger.logEvent(r)})}})},t.prototype.saveCompressedSelectionToState=function(e){var t=this;return this.createSelectionAsCanvas(e).then(function(e){var n=t.getCompressedDataUrl(e);return t.completeSelection(n),Promise.resolve(e)}).catch(function(e){return u.Clipper.logger.logFailure(i.Failure.Label.RegionSelectionProcessing,i.Failure.Type.Unexpected,{error:e.message}),t.resetState(),Promise.reject(e)})},t.prototype.createSelectionAsCanvas=function(e){var t=this;if(!e)return Promise.reject(new Error("baseDataUrl should be a non-empty string, but was: "+e));if(!this.state.firstPoint||!this.state.secondPoint)return Promise.reject(new Error("Expected the two points to be set, but they were not"));var n=this.devicePixelRatio;return new Promise(function(o){var r=new i.Event.BaseEvent(i.Event.Label.RegionSelectionLoading),a=new Image;a.onload=function(){u.Clipper.logger.logEvent(r);var e=Math.min(t.state.firstPoint.x,t.state.secondPoint.x),i=Math.min(t.state.firstPoint.y,t.state.secondPoint.y),s=Math.min(a.width,Math.max(t.state.firstPoint.x,t.state.secondPoint.x)),l=Math.min(a.height,Math.max(t.state.firstPoint.y,t.state.secondPoint.y)),c=0,p=0,d=s-e,g=l-i,f=e*n,h=i*n,m=(s-e)*n,v=(l-i)*n,y=document.createElement("canvas");y.width=d,y.height=g;var C=y.getContext("2d");C.drawImage(a,f,h,m,v,c,p,d,g),o(y)},a.src=e})},t.prototype.getCompressedDataUrl=function(e){var t=new i.Event.BaseEvent(i.Event.Label.CompressRegionSelection),n=e,o=n.toDataURL("image/png");return t.setCustomProperty(i.PropertyName.Custom.InitialDataUrlLength,o.length),o=r.DomUtils.adjustImageQualityIfNecessary(n,o),t.setCustomProperty(i.PropertyName.Custom.FinalDataUrlLength,o.length),u.Clipper.logger.logEvent(t),o},t.prototype.getInnerFrame=function(){if(this.state.secondPoint)return{tag:"div",attrs:Object.assign({id:a.Constants.Ids.innerFrame},this.ref(a.Constants.Ids.innerFrame))}},t.prototype.render=function(){var e=this.getInnerFrame();return{tag:"div",attrs:{tabindex:"1",config:this.updateVisualElements.bind(this),id:a.Constants.Ids.regionSelectorContainer,"aria-label":d.Localization.getLocalizedString("WebClipper.Accessibility.ScreenReader.RegionSelectionCanvas"),role:"application",onmousedown:this.mouseDownHandler.bind(this),onmousemove:this.mouseMoveHandler.bind(this),onmouseup:this.mouseUpHandler.bind(this),ontouchstart:this.touchStartHandler.bind(this),ontouchmove:this.touchMoveHandler.bind(this),ontouchend:this.touchEndHandler.bind(this),onkeydown:this.keyDownHandler.bind(this),onkeyup:this.keyUpHandler.bind(this)},children:[{tag:"img",attrs:Object.assign({id:"cursor"},this.ref("cursor"),{src:p.ExtensionUtils.getImageResourceUrl("crosshair_cursor.svg"),width:a.Constants.Styles.customCursorSize+"px",height:a.Constants.Styles.customCursorSize+"px"})},{tag:"canvas",attrs:Object.assign({id:a.Constants.Ids.outerFrame},this.ref(a.Constants.Ids.outerFrame))},e]}},t}(c.ComponentBase),f=g.componentize();n.RegionSelector=f},{"../clientType":3,"../constants":74,"../domParsers/domUtils":83,"../extensions/extensionUtils":93,"../localization/localization":105,"../logging/log":108,"./componentBase":16,"./frontEndGlobals":49,"./status":66}],66:[function(e,t,n){"use strict";var o;!function(e){e[e.NotStarted=0]="NotStarted",e[e.InProgress=1]="InProgress",e[e.Succeeded=2]="Succeeded",e[e.Failed=3]="Failed"}(o=n.Status||(n.Status={}))},{}],67:[function(e,t,n){"use strict";var o,r=e("../extensions/invokeSource");!function(e){e[e.ChangeLog=0]="ChangeLog",e[e.Pdf=1]="Pdf",e[e.Product=2]="Product",e[e.Recipe=3]="Recipe",e[e.Video=4]="Video",e[e.WhatsNew=5]="WhatsNew"}(o=n.TooltipType||(n.TooltipType={}));var i;!function(e){function t(e){switch(e){case o.Pdf:return r.InvokeSource.PdfTooltip;case o.Product:return r.InvokeSource.ProductTooltip;case o.Recipe:return r.InvokeSource.RecipeTooltip;case o.Video:return r.InvokeSource.VideoTooltip;case o.WhatsNew:return r.InvokeSource.WhatsNewTooltip;default:throw Error("Invalid TooltipType passed in TooltipType.toInvokeSource")}}e.toInvokeSource=t}(i=n.TooltipTypeUtils||(n.TooltipTypeUtils={}))},{"../extensions/invokeSource":96}],68:[function(e,t,n){"use strict";var o,r=e("./clientType"),i=e("./constants"),a=e("./urlUtils");!function(e){function t(e,t,n){var o=a.UrlUtils.addUrlQueryValue(i.Constants.Urls.clipperFeedbackUrl,"LogCategory",n);return o=a.UrlUtils.addUrlQueryValue(o,"originalUrl",e.pageInfo.rawUrl),o=a.UrlUtils.addUrlQueryValue(o,"clipperId",e.clientInfo.clipperId),o=a.UrlUtils.addUrlQueryValue(o,"usid",t),o=a.UrlUtils.addUrlQueryValue(o,"type",r.ClientType[e.clientInfo.clipperType]),o=a.UrlUtils.addUrlQueryValue(o,"version",e.clientInfo.clipperVersion)}function n(e,t,n){return s(i.Constants.Urls.Authentication.signInUrl,e,t,n)}function o(e,t,n){return s(i.Constants.Urls.Authentication.signOutUrl,e,t,n)}function s(e,t,n,o){var r=a.UrlUtils.addUrlQueryValue(e,i.Constants.Urls.QueryParams.authType,o);return r=a.UrlUtils.addUrlQueryValue(r,i.Constants.Urls.QueryParams.clipperId,t),r=a.UrlUtils.addUrlQueryValue(r,i.Constants.Urls.QueryParams.userSessionId,n)}e.generateFeedbackUrl=t,e.generateSignInUrl=n,e.generateSignOutUrl=o}(o=n.ClipperUrls||(n.ClipperUrls={}))},{"./clientType":3,"./constants":74,"./urlUtils":142}],69:[function(e,t,n){"use strict";var o=function(){function e(e,t){this.otherSideKeys={},this.queuedCalls={},this.callbackIdPostfix=0,this.functionMap={},
this.svFunctions={},this.trackedSmartValues={},this.channel=t,this.messageHandler=e,this.messageHandler.onMessageReceived=this.parseMessage.bind(this),this.sendInitializationMessage()}return e.prototype.getMessageHandler=function(){return this.messageHandler},e.prototype.onInitialized=function(){},e.prototype.tearDown=function(){for(var e in this.trackedSmartValues)if(this.trackedSmartValues.hasOwnProperty(e)&&this.svFunctions[e])for(var t=0;t<this.svFunctions[e].length;t++)this.trackedSmartValues[e].unsubscribe(this.svFunctions[e][t]);this.messageHandler.tearDown()},e.prototype.setErrorHandler=function(e){this.communicatorErrorHandler=e},e.prototype.parseMessage=function(e){var t;try{t=JSON.parse(e)}catch(e){return}if(t&&(!this.channel||t.channel&&t.channel===this.channel)&&(this.channel||!t.channel))try{this.handleDataPackage(t)}catch(e){if(!this.communicatorErrorHandler)throw e;this.communicatorErrorHandler(e)}},e.prototype.handleDataPackage=function(t){var n=this;if(t.functionKey===e.initializationKey){this.sendAcknowledgementMessage();for(var o in this.functionMap)this.functionMap.hasOwnProperty(o)&&this.postMessage({data:o,functionKey:e.registrationKey});this.onInitialized()}else if(t.functionKey===e.acknowledgeKey)this.onInitialized();else if(t.functionKey===e.registrationKey){var r=t.data.toString();if(this.otherSideKeys[r]||(this.otherSideKeys[r]=!0),this.isSmartValueSubscription(r)){var i=r.substr(e.setValuePrefix.length),a=this.trackedSmartValues[i];a&&this.updateRemoteSmartValue(i,a.get())}else if(this.queuedCalls[r]){for(var s=this.queuedCalls[r],l=0;l<s.length;l++)this.postMessage(s[l]);delete this.queuedCalls[r]}}else{var c=this.functionMap[t.functionKey];if(c){var u=c(t.data);u&&u.then&&t.callbackKey&&u.then(function(e){n.callRemoteFunction(t.callbackKey,{param:e})},function(e){n.callRemoteFunction(t.callbackKey,{param:e})})}}},e.prototype.registerFunction=function(t,n){if(!t)throw new Error("param 'name' is invalid");this.functionMap[t]=n,this.postMessage({data:t,functionKey:e.registrationKey})},e.prototype.callRemoteFunction=function(t,n){if(!t)throw new Error("param 'name' is invalid");var o=n?n.param:void 0,r=void 0;n&&n.callback&&(r=t+e.callbackPostfix+"-"+this.callbackIdPostfix++,this.registerFunction(r,n.callback));var i={data:o,functionKey:t};r&&(i.callbackKey=r),this.otherSideKeys[t]?this.postMessage(i):this.isSmartValueSubscription(t)||(this.queuedCalls[t]=this.queuedCalls[t]||[],this.queuedCalls[t].push(i))},e.prototype.subscribeAcrossCommunicator=function(t,n,o){o&&t.subscribe(o,{callOnSubscribe:!1}),this.registerFunction(e.setValuePrefix+n,function(e){t.set(e)})},e.prototype.broadcastAcrossCommunicator=function(e,t){var n=this,o=function(e){n.updateRemoteSmartValue(t,e)};this.svFunctions[t]||(this.svFunctions[t]=[]),this.svFunctions[t].push(o),this.trackedSmartValues[t]=e,e.subscribe(o)},e.prototype.updateRemoteSmartValue=function(t,n){this.callRemoteFunction(e.setValuePrefix+t,{param:n})},e.prototype.sendInitializationMessage=function(){this.postMessage({functionKey:e.initializationKey})},e.prototype.sendAcknowledgementMessage=function(){this.postMessage({functionKey:e.acknowledgeKey})},e.prototype.isSmartValueSubscription=function(t){return t.substr(0,e.setValuePrefix.length)===e.setValuePrefix},e.prototype.postMessage=function(e){this.channel&&(e.channel=this.channel);try{this.messageHandler.sendMessage(JSON.stringify(e))}catch(e){if(!this.communicatorErrorHandler)throw e;this.communicatorErrorHandler(e)}},e}();o.initializationKey="INITIALIZATION-K3Y",o.acknowledgeKey="ACKNOWLEDGE-K3Y",o.registrationKey="REGISTER-FUNCTION-K3Y",o.setValuePrefix="SETVALUE-",o.callbackPostfix="-CALLBACK",n.Communicator=o},{}],70:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("./messageHandler"),i=function(e){function t(t){var n=e.call(this)||this;return n.getOtherWindow=t,n.initMessageHandler(),window.addEventListener("message",n.messageHandler),n}return o(t,e),t.prototype.initMessageHandler=function(){var e=this;this.messageHandler=function(t){e.onMessageReceived(t.data),t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}},t.prototype.sendMessage=function(e){var t=this.getOtherWindow();t.postMessage(e,"*")},t.prototype.tearDown=function(){window.removeEventListener("message",this.messageHandler)},t}(r.MessageHandler);n.IFrameMessageHandler=i},{"./messageHandler":72}],71:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("./messageHandler"),i=function(e){function t(t){var n=e.call(this)||this;return n.setOtherSide(t),n}return o(t,e),t.prototype.initMessageHandler=function(){},t.prototype.inlineMessage=function(e){this.onMessageReceived(e)},t.prototype.setOtherSide=function(e){this.otherSide=e},t.prototype.sendMessage=function(e){this.otherSide&&this.otherSide.inlineMessage(e)},t.prototype.tearDown=function(){},t}(r.MessageHandler);n.InlineMessageHandler=i},{"./messageHandler":72}],72:[function(e,t,n){"use strict";var o=function(){function e(){}return e.prototype.onMessageReceived=function(e){},e}();n.MessageHandler=o},{}],73:[function(e,t,n){"use strict";var o=function(){function e(e){this.subscriptions=[],this.t=e}return e.prototype.subscribe=function(e,t){void 0===t&&(t={}),void 0===t.times&&(t.times=1/0),void 0===t.callOnSubscribe&&(t.callOnSubscribe=!0),t.callOnSubscribe&&e(this.t),t.times>0&&this.subscriptions.push({func:e,times:t.times})},e.prototype.unsubscribe=function(e){for(var t=0;t<this.subscriptions.length;t++)if(e===this.subscriptions[t].func)return void this.subscriptions.splice(t,1)},e.prototype.set=function(e){return this.t!==e&&(this.t=e,this.notifySubscribers()),this},e.prototype.get=function(){return this.t},e.prototype.forceUpdate=function(){this.notifySubscribers()},e.prototype.equals=function(e){return this.t===e},e.prototype.toString=function(){return this.t?this.t.toString():"undefined"},e.prototype.notifySubscribers=function(){for(var e=this.subscriptions.length,t=0;t<e;t++){this.subscriptions[t].times--,this.subscriptions[t].func(this.t);var n=this.subscriptions[t]&&0===this.subscriptions[t].times;n&&this.subscriptions.splice(t,1),this.subscriptions[t]&&!n||(e--,t--)}},e.subscribe=function(e,t){for(var n=0;n<e.length;n++)e[n].subscribe(function(){for(var n=[],o=0;o<e.length;o++)n.push(e[o].get());t.apply(this,n)})},e}();n.SmartValue=o},{}],74:[function(e,t,n){"use strict";var o;!function(e){var t;!function(e){e.heightAnimator="height-animator",e.panelAnimator="panel-animator",e.clearfix="clearfix",e.change="change",e.changes="changes",e.changeBody="change-body",e.changeDescription="change-description",e.changeImage="change-image",e.changeTitle="change-title",e.checkboxCheck="checkboxCheck",e.textAreaInput="textAreaInput",e.textAreaInputMirror="textAreaInputMirror",e.popover="popover",e.popoverArrow="popover-arrow",e.deleteHighlightButton="delete-highlight",e.highlightable="highlightable",e.highlighted="highlighted",e.regionSelection="region-selection",e.regionSelectionImage="region-selection-image",e.regionSelectionRemoveButton="region-selection-remove-button",e.attachmentOverlay="attachment-overlay",e.centeredInCanvas="centered-in-canvas",e.overlay="overlay",e.overlayHidden="overlay-hidden",e.overlayNumber="overlay-number",e.pdfPreviewImage="pdf-preview-image",e.pdfPreviewImageCanvas="pdf-preview-image-canvas",e.unselected="unselected",e.localPdfPanelTitle="local-pdf-panel-title",e.localPdfPanelSubtitle="local-pdf-panel-subtitle",e.radioIndicatorFill="radio-indicator-fill",e.spinner="spinner",e.srOnly="sr-only",e.tooltip="tooltip",e.centeredInPreview="centered-in-preview"}(t=e.Classes||(e.Classes={}));var n;!function(e){e.clipperInfo="ClipperInfo"}(n=e.Cookies||(e.Cookies={}));var o;!function(e){var t;!function(e){e.conflictingExtension="conflictingExtension"}(t=e.NotificationIds||(e.NotificationIds={}))}(o=e.Extension||(e.Extension={}));var r;!function(e){e.annotationContainer="annotationContainer",e.annotationField="annotationField",e.annotationFieldMirror="annotationFieldMirror",e.annotationPlaceholder="annotationPlaceholder",e.bookmarkThumbnail="bookmarkThumbnail",e.bookmarkPreviewContentContainer="bookmarkPreviewContentContainer",e.bookmarkPreviewInnerContainer="bookmarkPreviewInnerContainer",e.clipperApiProgressContainer="clipperApiProgressContainer",e.clipProgressDelayedMessage="clipProgressDelayedMessage",e.clipProgressIndicatorMessage="clipProgressIndicatorMessage",e.dialogBackButton="dialogBackButton",e.dialogButtonContainer="dialogButtonContainer",e.dialogDebugMessageContainer="dialogDebugMessageContainer",e.dialogMessageContainer="dialogMessageContainer",e.dialogContentContainer="dialogContentContainer",e.dialogMessage="dialogMessage",e.dialogSignOutButton="dialogSignoutButton",e.dialogTryAgainButton="dialogTryAgainButton",e.highlightablePreviewBody="highlightablePreviewBody",e.apiErrorMessage="apiErrorMessage",e.backToHomeButton="backToHomeButton",e.clipperFailureContainer="clipperFailureContainer",e.refreshPageButton="refreshPageButton",e.tryAgainButton="tryAgainButton",e.clipperFooterContainer="clipperFooterContainer",e.currentUserControl="currentUserControl",e.currentUserDetails="currentUserDetails",e.currentUserEmail="currentUserEmail",e.currentUserId="currentUserId",e.currentUserName="currentUserName",e.feedbackButton="feedbackButton",e.feedbackImage="feedbackImage",e.signOutButton="signOutButton",e.userDropdownArrow="userDropdownArrow",e.userSettingsContainer="userSettingsContainer",e.feedbackLabel="feedbackLabel",e.footerButtonsContainer="footerButtonsContainer",e.clipperLoadingContainer="clipperLoadingContainer",e.closeButton="closeButton",e.closeButtonContainer="closeButtonContainer",e.mainController="mainController",e.saveToLocationContainer="saveToLocationContainer",e.clipButton="clipButton",e.clipButtonContainer="clipButtonContainer",e.optionLabel="optionLabel",e.radioAllPagesLabel="radioAllPagesLabel",e.radioPageRangeLabel="radioPageRangeLabel",e.rangeInput="rangeInput",e.previewBody="previewBody",e.previewContentContainer="previewContentContainer",e.previewHeader="previewHeader",e.previewHeaderContainer="previewHeaderContainer",e.previewHeaderInput="previewHeaderInput",e.previewHeaderInputMirror="previewHeaderInputMirror",e.previewTitleContainer="previewTitleContainer",e.previewSubtitleContainer="previewSubtitleContainer",e.previewInnerContainer="previewInnerContainer",e.previewAriaLiveDiv="previewAriaLiveDiv",e.previewOptionsContainer="previewOptionsContainer",e.previewInnerWrapper="previewInnerWrapper",e.previewOuterContainer="previewOuterContainer",e.previewUrlContainer="previewUrlContainer",e.previewNotesContainer="previewNotesContainer",e.fullPageControl="fullPageControl",e.fullPageHeaderTitle="fullPageHeaderTitle",e.localPdfFileTitle="localPdfFileTitle",e.pdfControl="pdfControl",e.pdfHeaderTitle="pdfHeaderTitle",e.pageRangeControl="pageRangeControl",e.checkboxToDistributePages="checkboxToDistributePages",e.pdfIsTooLargeToAttachIndicator="pdfIsTooLargeToAttachIndicator",e.checkboxToAttachPdf="checkboxToAttachPdf",e.moreClipOptions="moreClipOptions",e.addAnotherRegionButton="addAnotherRegionButton",e.addRegionControl="addRegionControl",e.regionControl="regionControl",e.regionHeaderTitle="regionHeaderTitle",e.decrementFontSize="decrementFontSize",e.fontSizeControl="fontSizeControl",e.highlightButton="highlightButton",e.highlightControl="highlightControl",e.incrementFontSize="incrementFontSize",e.serifControl="serifControl",e.sansSerif="sansSerif",e.serif="serif",e.bookmarkControl="bookmarkControl",e.bookmarkHeaderTitle="bookmarkHeaderTitle",e.ratingsButtonFeedbackNo="ratingsButtonFeedbackNo",e.ratingsButtonFeedbackYes="ratingsButtonFeedbackYes",e.ratingsButtonInitNo="ratingsButtonInitNo",e.ratingsButtonInitYes="ratingsButtonInitYes",e.ratingsButtonRateNo="ratingsButtonRateNo",e.ratingsButtonRateYes="ratingsButtonRateYes",e.ratingsPromptContainer="ratingsPromptContainer",e.regionInstructionsContainer="regionInstructionsContainer",e.regionClipCancelButton="regionClipCancelButton",e.innerFrame="innerFrame",e.outerFrame="outerFrame",e.regionSelectorContainer="regionSelectorContainer",e.spinnerText="spinnerText",e.locationPickerContainer="locationPickerContainer",e.sectionLocationContainer="sectionLocationContainer",e.signInButtonMsa="signInButtonMsa",e.signInButtonOrgId="signInButtonOrgId",e.signInContainer="signInContainer",e.signInErrorCookieInformation="signInErrorCookieInformation",e.signInErrorDebugInformation="signInErrorDebugInformation",e.signInErrorDebugInformationDescription="signInErrorDebugInformationDescription",e.signInErrorDebugInformationContainer="signInErrorDebugInformationContainer",e.signInErrorDebugInformationList="signInErrorDebugInformationList",e.signInErrorDescription="signInErrorDescription",e.signInErrorDescriptionContainer="signInErrorDescriptionContainer",e.signInErrorMoreInformation="signInErrorMoreInformation",e.signInLogo="signInLogo",e.signInMessageLabelContainer="signInMessageLabelContainer",e.signInText="signInText",e.signInToggleErrorDropdownArrow="signInToggleErrorDropdownArrow",e.signInToggleErrorInformationText="signInToggleErrorInformationText",e.clipperSuccessContainer="clipperSuccessContainer",e.launchOneNoteButton="launchOneNoteButton",e.pageNavAnimatedTooltip="pageNavAnimatedTooltip",e.unsupportedBrowserContainer="unsupportedBrowserContainer",e.unsupportedBrowserPanel="unsupportedBrowserPanel",e.changeLogSubPanel="changeLogSubPanel",e.checkOutWhatsNewButton="checkOutWhatsNewButton",e.proceedToWebClipperButton="proceedToWebClipperButton",e.whatsNewTitleSubPanel="whatsNewTitleSubPanel",e.clipperRootScript="oneNoteCaptureRootScript",e.clipperUiFrame="oneNoteWebClipper",e.clipperPageNavFrame="oneNoteWebClipperPageNav",e.clipperExtFrame="oneNoteWebClipperExtension",e.brandingContainer="brandingContainer"}(r=e.Ids||(e.Ids={}));var i;!function(e){e.accept="Accept",e.appIdKey="MS-Int-AppId",e.correlationId="X-CorrelationId",e.noAuthKey="X-NoAuth",e.userSessionIdKey="X-UserSessionId"}(i=e.HeaderValues||(e.HeaderValues={}));var a;!function(e){e.debugLoggingInjectedAndExtension="DEBUGLOGGINGINJECTED_AND_EXTENSION",e.extensionAndUi="EXTENSION_AND_UI",e.injectedAndUi="INJECTED_AND_UI",e.injectedAndExtension="INJECTED_AND_EXTENSION",e.extensionAndPageNavUi="EXTENSION_AND_PAGENAVUI",e.pageNavInjectedAndPageNavUi="PAGENAVINJECTED_AND_PAGENAVUI",e.pageNavInjectedAndExtension="PAGENAVINJECTED_AND_EXTENSION"}(a=e.CommunicationChannels||(e.CommunicationChannels={}));var s;!function(e){e.clipperStrings="CLIPPER_STRINGS",e.clipperStringsFrontLoaded="CLIPPER_STRINGS_FRONT_LOADED",e.closePageNavTooltip="CLOSE_PAGE_NAV_TOOLTIP",e.createHiddenIFrame="CREATE_HIDDEN_IFRAME",e.ensureFreshUserBeforeClip="ENSURE_FRESH_USER_BEFORE_CLIP",e.escHandler="ESC_HANDLER",e.getInitialUser="GET_INITIAL_USER",e.getPageNavTooltipProps="GET_PAGE_NAV_TOOLTIP_PROPS",e.getStorageValue="GET_STORAGE_VALUE",e.getMultipleStorageValues="GET_MULTIPLE_STORAGE_VALUES",e.getTooltipToRenderInPageNav="GET_TOOLTIP_TO_RENDER_IN_PAGE_NAV",e.hideUi="HIDE_UI",e.invokeClipper="INVOKE_CLIPPER",e.invokeClipperFromPageNav="INVOKE_CLIPPER_FROM_PAGE_NAV",e.invokeDebugLogging="INVOKE_DEBUG_LOGGING",e.invokePageNav="INVOKE_PAGE_NAV",e.extensionNotAllowedToAccessLocalFiles="EXTENSION_NOT_ALLOWED_TO_ACCESS_LOCAL_FILES",e.noOpTracker="NO_OP_TRACKER",e.onSpaNavigate="ON_SPA_NAVIGATE",e.refreshPage="REFRESH_PAGE",e.showRefreshClipperMessage="SHOW_REFRESH_CLIPPER_MESSAGE",e.setInjectOptions="SET_INJECT_OPTIONS",e.setInvokeOptions="SET_INVOKE_OPTIONS",e.setStorageValue="SET_STORAGE_VALUE",e.signInUser="SIGN_IN_USER",e.signOutUser="SIGN_OUT_USER",e.tabToLowestIndexedElement="TAB_TO_LOWEST_INDEXED_ELEMENT",e.takeTabScreenshot="TAKE_TAB_SCREENSHOT",e.telemetry="TELEMETRY",e.toggleClipper="TOGGLE_CLIPPER",e.unloadHandler="UNLOAD_HANDLER",e.updateFrameHeight="UPDATE_FRAME_HEIGHT",e.updatePageInfoIfUrlChanged="UPDATE_PAGE_INFO_IF_URL_CHANGED"}(s=e.FunctionKeys||(e.FunctionKeys={}));var l;!function(e){e.tab=9,e.enter=13,e.esc=27,e.c=67,e.down=40,e.up=38,e.left=37,e.right=39,e.space=32,e.home=36,e.end=35}(l=e.KeyCodes||(e.KeyCodes={}));var c;!function(e){e.c="KeyC"}(c=e.StringKeyCodes||(e.StringKeyCodes={}));var u;!function(e){e.clientInfo="CLIENT_INFO",e.isFullScreen="IS_FULL_SCREEN",e.pageInfo="PAGE_INFO",e.sessionId="SESSION_ID",e.user="USER"}(u=e.SmartValueKeys||(e.SmartValueKeys={}));var p;!function(e){e.sectionPickerContainerHeight=280,e.clipperUiWidth=322,e.customCursorSize=20,e.clipperUiTopRightOffset=20,e.clipperUiDropShadowBuffer=7,e.clipperUiInnerPadding=30;var t;!function(e){e.oneNoteHighlightColor="#fefe56"}(t=e.Colors||(e.Colors={}))}(p=e.Styles||(e.Styles={}));var d;!function(e){e.serviceDomain="https://www.onenote.com",e.augmentationApiUrl=e.serviceDomain+"/onaugmentation/clipperextract/v1.0/",e.changelogUrl=e.serviceDomain+"/whatsnext/webclipper",e.clipperFeedbackUrl=e.serviceDomain+"/feedback",e.clipperInstallPageUrl=e.serviceDomain+"/clipper/installed",e.fullPageScreenshotUrl=e.serviceDomain+"/onaugmentation/clipperDomEnhancer/v1.0/",e.localizedStringsUrlBase=e.serviceDomain+"/strings?ids=WebClipper.",e.msaDomain="https://login.live.com",e.orgIdDomain="https://login.microsoftonline.com";var t;!function(t){t.authRedirectUrl=e.serviceDomain+"/webclipper/auth",t.signInUrl=e.serviceDomain+"/webclipper/signin",t.signOutUrl=e.serviceDomain+"/webclipper/signout",t.userInformationUrl=e.serviceDomain+"/webclipper/userinfo"}(t=e.Authentication||(e.Authentication={}));var n;!function(e){e.authType="authType",e.category="category",e.changelogLocale="omkt",e.channel="channel",e.clientType="clientType",e.clipperId="clipperId",e.clipperVersion="clipperVersion",e.correlationId="correlationId",e.error="error",e.errorDescription="error_?description",e.event="event",e.eventName="eventName",e.failureId="failureId",e.failureInfo="failureInfo",e.failureType="failureType",e.inlineInstall="inlineInstall",e.label="label",e.noOpType="noOpType",e.stackTrace="stackTrace",e.timeoutInMs="timeoutInMs",e.url="url",e.userSessionId="userSessionId",e.wdFromClipper="wdfromclipper"}(n=e.QueryParams||(e.QueryParams={}))}(d=e.Urls||(e.Urls={}));var g;!function(e){e.oneNoteClipperUsage="OneNoteClipperUsage"}(g=e.LogCategories||(e.LogCategories={}));var f;!function(e){e.fontSizeStep=2,e.maxClipSuccessForRatingsPrompt=12,e.maximumJSTimeValue=864e13,e.maximumFontSize=72,e.maximumNumberOfTimesToShowTooltips=3,e.maximumMimeSizeLimit=249e5,e.minClipSuccessForRatingsPrompt=4,e.minimumFontSize=8,e.minTimeBetweenBadRatings=6048e6,e.noOpTrackerTimeoutDuration=2e4,e.numRetriesPerPatchRequest=3,e.pdfCheckCreatePageInterval=2e3,e.pdfClippingMessageDelay=5e3,e.pdfExtraPageLoadEachSide=1,e.pdfInitialPageLoadCount=3,e.timeBetweenDifferentTooltips=6048e5,e.timeBetweenSameTooltip=18144e5,e.timeBetweenTooltips=18144e5,e.timeUntilPdfPageNumbersFadeOutAfterScroll=1e3}(f=e.Settings||(e.Settings={}));var h;!function(e){e.setNameForArrowKeyNav="setnameforarrowkeynav"}(h=e.CustomHtmlAttributes||(e.CustomHtmlAttributes={}));var m;!function(e){e.modeButtonSet="ariaModeButtonSet",e.pdfPageSelection="pdfPageSelection",e.serifGroupSet="serifGroupSet"}(m=e.AriaSet||(e.AriaSet={}))}(o=n.Constants||(n.Constants={}))},{}],75:[function(e,t,n){"use strict";var o,r=e("../constants"),i=e("../settings"),a=e("../stringUtils"),s=e("../objectUtils"),l=e("../clipperUI/frontEndGlobals"),c=e("../clipperUI/oneNoteApiUtils"),u=e("../domParsers/domUtils"),p=e("../http/HttpWithRetries"),d=e("../logging/log");!function(e){e[e.None=0]="None",e[e.Article=1]="Article",e[e.BizCard=2]="BizCard",e[e.EntityKnowledge=3]="EntityKnowledge",e[e.Recipe=4]="Recipe",e[e.Product=5]="Product",e[e.Screenshot=6]="Screenshot",e[e.Wrapstar=7]="Wrapstar"}(o=n.AugmentationModel||(n.AugmentationModel={}));var g=function(){function e(){}return e.augmentPage=function(t,n,i){return new Promise(function(s,p){var g=new d.Event.PromiseEvent(d.Event.Label.AugmentationApiCall),f=a.StringUtils.generateGuid();g.setCustomProperty(d.PropertyName.Custom.CorrelationId,f),e.makeAugmentationRequest(t,n,i,f).then(function(n){var a=n.parsedResponse,l={ContentModel:o.None,ContentObjects:[]};if(g.setCustomProperty(d.PropertyName.Custom.CorrelationId,n.request.getResponseHeader(r.Constants.HeaderValues.correlationId)),a&&a.length>0&&a[0].ContentInHtml){l=a[0],g.setCustomProperty(d.PropertyName.Custom.AugmentationModel,o[l.ContentModel]);var c=(new DOMParser).parseFromString(l.ContentInHtml,"text/html"),p=e.getArticlePreviewElement(c);u.DomUtils.toOnml(c).then(function(){u.DomUtils.addPreviewContainerStyling(p),e.addSupportedVideosToElement(p,i,t),l.ContentInHtml=c.body.innerHTML,s(l)})}else s(l);g.setCustomProperty(d.PropertyName.Custom.AugmentationModel,o[l.ContentModel])}).catch(function(e){c.OneNoteApiUtils.logOneNoteApiRequestError(g,e),p()}).then(function(){l.Clipper.logger.logEvent(g)})})},e.getAugmentationType=function(t){var n=o[o.Article].toString();if(!t||!t.augmentationResult||!t.augmentationResult.data)return n;var r=t.augmentationResult.data.ContentModel;return e.isSupportedAugmentationType(r)&&(n=o[r].toString()),n},e.makeAugmentationRequest=function(e,t,n,o){return l.Clipper.getUserSessionIdWhenDefined().then(function(a){var s=r.Constants.Urls.augmentationApiUrl+"?renderMethod=extractAggressive&url="+e+"&lang="+t,c={};return c[r.Constants.HeaderValues.appIdKey]=i.Settings.getSetting("App_Id"),c[r.Constants.HeaderValues.noAuthKey]="true",c[r.Constants.HeaderValues.correlationId]=o,c[r.Constants.HeaderValues.userSessionIdKey]=a,p.HttpWithRetries.post(s,n,c).then(function(e){var t;try{t=JSON.parse(e.response)}catch(t){return l.Clipper.logger.logJsonParseUnexpected(e.response),Promise.reject(OneNoteApi.ErrorUtils.createRequestErrorObject(e,OneNoteApi.RequestErrorType.UNABLE_TO_PARSE_RESPONSE))}var n={parsedResponse:t,request:e};return Promise.resolve(n)})})},e.getArticlePreviewElement=function(e){var t=e.getElementsByClassName("MainArticleContainer");return s.ObjectUtils.isNullOrUndefined(t)||s.ObjectUtils.isNullOrUndefined(t[0])?e.body:t[0]},e.isSupportedAugmentationType=function(e){return e===o.Article||e===o.Recipe||e===o.Product},e.addSupportedVideosToElement=function(e,t,n){var o=new d.Event.PromiseEvent(d.Event.Label.AddEmbeddedVideo);u.DomUtils.addEmbeddedVideosWhereSupported(e,t,n).then(function(e){s.ObjectUtils.isNullOrUndefined(e)||l.Clipper.logger.logEvent(o)},function(e){o.setStatus(d.Status.Failed),o.setFailureInfo(e),l.Clipper.logger.logEvent(o)})},e}();n.AugmentationHelper=g},{"../clipperUI/frontEndGlobals":49,"../clipperUI/oneNoteApiUtils":51,"../constants":74,"../domParsers/domUtils":83,"../http/HttpWithRetries":100,"../logging/log":108,"../objectUtils":123,"../settings":135,"../stringUtils":141}],76:[function(e,t,n){"use strict";var o=e("../objectUtils"),r=e("../clipperUI/frontEndGlobals"),i=e("../domParsers/domUtils"),a=e("../logging/log"),s=function(){function e(){}return e.bookmarkPage=function(t,n,s,l,c,u){void 0===l&&(l=!1);var p=new a.Event.PromiseEvent(a.Event.Label.BookmarkPage);if(o.ObjectUtils.isNullOrUndefined(t)||""===t){var d={error:"Page url is null, undefined, or empty"};return p.setStatus(a.Status.Failed),p.setFailureInfo(d),r.Clipper.logger.logEvent(p),Promise.reject(d)}var g={url:t,title:n},f={metadataElementsExist:!0,pageTitleExists:!0,descriptionMetadataUsed:"",thumbnailSrcMetadataUsed:"",thumbnailSrcToDataUrlFailure:void 0};if((o.ObjectUtils.isNullOrUndefined(n)||0===n.length)&&(f.pageTitleExists=!1),o.ObjectUtils.isNullOrUndefined(s)||0===s.length)return f.metadataElementsExist=!1,r.Clipper.logger.logEvent(p),Promise.resolve(g);var h=this.getPrimaryDescription(s);l&&o.ObjectUtils.isNullOrUndefined(h)&&(h=e.getFallbackDescription(s),o.ObjectUtils.isNullOrUndefined(h)&&(h=e.getTextOnPage(u)));var m=this.getPrimaryThumbnailSrc(s);return l&&o.ObjectUtils.isNullOrUndefined(m)&&(m=e.getFallbackThumbnailSrc(s),o.ObjectUtils.isNullOrUndefined(m)&&(m=e.getFirstImageOnPage(c))),o.ObjectUtils.isNullOrUndefined(h)||(h.description=e.truncateString(h.description),g.description=h.description,f.descriptionMetadataUsed=h.metadataUsed.value),o.ObjectUtils.isNullOrUndefined(m)?(r.Clipper.logger.logEvent(p),Promise.resolve(g)):(f.thumbnailSrcMetadataUsed=m.metadataUsed.value,m.thumbnailSrc=i.DomUtils.toAbsoluteUrl(m.thumbnailSrc,t),i.DomUtils.getImageDataUrl(m.thumbnailSrc).then(function(e){o.ObjectUtils.isNullOrUndefined(e)?(g.thumbnailSrc=m.thumbnailSrc,f.thumbnailSrcToDataUrlFailure="thumbnail conversion to data url returned undefined. falling back to non-data url as source: "+m.thumbnailSrc):g.thumbnailSrc=e}).catch(function(e){f.thumbnailSrcToDataUrlFailure=e.error}).then(function(){return r.Clipper.logger.logEvent(p),Promise.resolve(g)}))},e.getElementsByTagName=function(e,t){if(!o.ObjectUtils.isNullOrUndefined(e)&&!o.ObjectUtils.isNullOrUndefined(t)){for(var n=new Array,r=0,i=t;r<i.length;r++){var a=i[r];n=n.concat(n,Array.prototype.slice.call(e.getElementsByTagName(a)))}return n}},e.getNonWhiteSpaceTextElements=function(e,t){return void 0===t&&(t=!1),t&&i.DomUtils.removeElementsNotSupportedInOnml(e),i.DomUtils.textNodesNoWhitespaceUnder(e)},e.getPrimaryDescription=function(t){var n=e.primaryDescriptionKeyValuePair,r=e.getMetaContent(t,n);if(!o.ObjectUtils.isNullOrUndefined(r))return{metadataUsed:n,description:r}},e.getFallbackDescription=function(t){for(var n=0,r=e.fallbackDescriptionKeyValuePairs;n<r.length;n++){var i=r[n],a=e.getMetaContent(t,i);if(!o.ObjectUtils.isNullOrUndefined(a))return{metadataUsed:i,description:a}}},e.getTextOnPage=function(t,n){if(void 0===n&&(n=50),!o.ObjectUtils.isNullOrUndefined(t)&&t.length>0){var r=e.textOnPageKeyValuePair,i=t.map(function(e){return e.wholeText.trim()}).join(" ");if(!o.ObjectUtils.isNullOrUndefined(i)&&i.length>0)return{metadataUsed:r,description:i}}},e.truncateString=function(t,n){if(void 0===n&&(n=e.maxNumCharsInDescription),!o.ObjectUtils.isNullOrUndefined(t)){if(0===t.length)return"";if(t.length<=n)return t;var r="...",i=new RegExp("^(.{"+n+"}[^\\s]*)"),a=t.replace(/\s+/g," ").match(i);if(!o.ObjectUtils.isNullOrUndefined(a))return a[1]+r}},e.getPrimaryThumbnailSrc=function(t){var n=e.primaryThumbnailKeyValuePair,r=e.getMetaContent(t,n);if(!o.ObjectUtils.isNullOrUndefined(r))return{metadataUsed:n,thumbnailSrc:r}},e.getFallbackThumbnailSrc=function(t){for(var n=0,r=e.fallbackThumbnailKeyValuePairs;n<r.length;n++){var i=r[n],a=e.getMetaContent(t,i);if(!o.ObjectUtils.isNullOrUndefined(a))return{metadataUsed:i,thumbnailSrc:a}}},e.getFirstImageOnPage=function(t){if(!o.ObjectUtils.isNullOrUndefined(t)&&t.length>0){var n=t[0].getAttribute(e.srcAttrName),r=e.firstImageOnPageKeyValuePair;if(!o.ObjectUtils.isNullOrUndefined(n)&&""!==n)return{metadataUsed:r,thumbnailSrc:n}}},e.getMetaContent=function(e,t){if(!(o.ObjectUtils.isNullOrUndefined(e)||o.ObjectUtils.isNullOrUndefined(t)||o.ObjectUtils.isNullOrUndefined(t.key)||o.ObjectUtils.isNullOrUndefined(t.value)))for(var n=0,r=e;n<r.length;n++){var i=r[n],a=i.getAttribute(t.key);if(a&&a.toLowerCase().split(/\s/).indexOf(t.value.toLowerCase())>-1){var s=void 0;"LINK"===i.nodeName&&(s="href"),"META"===i.nodeName&&(s="content");var l=i.getAttribute(s);if(o.ObjectUtils.isNullOrUndefined(l)||0===l.length)return;return l}}},e}();s.maxNumCharsInDescription=140,s.metadataTagNames=[i.DomUtils.tags.meta,i.DomUtils.tags.link],s.nameAttrName="name",s.propertyAttrName="property",s.relAttrName="rel",s.srcAttrName="src",s.primaryDescriptionKeyValuePair={key:s.propertyAttrName,value:"og:description"},s.primaryThumbnailKeyValuePair={key:s.propertyAttrName,value:"og:image"},s.firstImageOnPageKeyValuePair={key:"",value:"firstImageOnPage"},s.textOnPageKeyValuePair={key:"",value:"textOnPage"},s.fallbackDescriptionKeyValuePairs=[{key:s.nameAttrName,value:"description"},{key:s.nameAttrName,value:"twitter:description"},{key:s.nameAttrName,value:"keywords"},{key:s.propertyAttrName,value:"article:tag"}],s.fallbackThumbnailKeyValuePairs=[{key:s.nameAttrName,value:"twitter:image:src"},{key:s.nameAttrName,value:"twitter:image"},{key:s.relAttrName,value:"image_src"},{key:s.relAttrName,value:"icon"}],n.BookmarkHelper=s},{"../clipperUI/frontEndGlobals":49,"../domParsers/domUtils":83,"../logging/log":108,"../objectUtils":123}],77:[function(e,t,n){"use strict";var o=e("../clipperUI/frontEndGlobals"),r=e("../clipperUI/oneNoteApiUtils"),i=e("../http/httpWithRetries"),a=e("../logging/log"),s=e("../constants"),l=e("../settings"),c=e("../stringUtils"),u=function(){function e(){}return e.getFullPageScreenshot=function(t){return new Promise(function(n,u){o.Clipper.getUserSessionIdWhenDefined().then(function(p){var d=new a.Event.PromiseEvent(a.Event.Label.FullPageScreenshotCall),g=c.StringUtils.generateGuid();d.setCustomProperty(a.PropertyName.Custom.CorrelationId,g);var f={};f[s.Constants.HeaderValues.accept]="application/json",f[s.Constants.HeaderValues.appIdKey]=l.Settings.getSetting("App_Id"),f[s.Constants.HeaderValues.noAuthKey]="true",f[s.Constants.HeaderValues.correlationId]=g,f[s.Constants.HeaderValues.userSessionIdKey]=p;var h=function(e){d.setCustomProperty(a.PropertyName.Custom.CorrelationId,e.responseHeaders[s.Constants.HeaderValues.correlationId]),r.OneNoteApiUtils.logOneNoteApiRequestError(d,e)};i.HttpWithRetries.post(s.Constants.Urls.fullPageScreenshotUrl,t,f,[200,204],e.timeout).then(function(e){if(200===e.status)try{n(JSON.parse(e.response)),d.setCustomProperty(a.PropertyName.Custom.FullPageScreenshotContentFound,!0)}catch(t){h(OneNoteApi.ErrorUtils.createRequestErrorObject(e,OneNoteApi.RequestErrorType.UNABLE_TO_PARSE_RESPONSE)),u()}else d.setCustomProperty(a.PropertyName.Custom.FullPageScreenshotContentFound,!1),u()},function(e){h(e),u()}).then(function(){o.Clipper.logger.logEvent(d)})})})},e}();u.timeout=5e4,n.FullPageScreenshotHelper=u},{"../clipperUI/frontEndGlobals":49,"../clipperUI/oneNoteApiUtils":51,"../constants":74,"../http/httpWithRetries":104,"../logging/log":108,"../settings":135,"../stringUtils":141}],78:[function(e,t,n){"use strict";var o=e("../arrayUtils"),r=e("lodash"),i=function(){function e(e){this.pdf=e}return e.prototype.numPages=function(){return this.pdf.numPages},e.prototype.getByteLength=function(){return this.getData().then(function(e){return Promise.resolve(e.length)})},e.prototype.getData=function(){var e=this;return new Promise(function(t){e.pdf.getData().then(function(e){t(e)})})},e.prototype.getPageListAsDataUrls=function(e){var t=this,n=new Array(e.length);return new Promise(function(r){for(var i=function(i){t.getPageAsDataUrl(e[i]).then(function(e){n[i]=e,o.ArrayUtils.isArrayComplete(n)&&r(n)})},a=0;a<e.length;a++)i(a)})},e.prototype.getPageAsDataUrl=function(e){var t=this;return new Promise(function(n){t.pdf.getPage(e+1).then(function(e){var t=e.getViewport(2),o=document.createElement("canvas"),r=o.getContext("2d");o.height=t.height,o.width=t.width;var i={canvasContext:r,viewport:t};e.render(i).then(function(){n(o.toDataURL())})})})},e.prototype.getAllPageViewportDimensions=function(){var e=r.range(this.numPages());return this.getPageListViewportDimensions(e)},e.prototype.getPageListViewportDimensions=function(e){var t=this,n=new Array(e.length);return new Promise(function(r){for(var i=function(i){t.getPageViewportDimensions(e[i]).then(function(e){n[i]=e,o.ArrayUtils.isArrayComplete(n)&&r(n)})},a=0;a<e.length;a++)i(a)})},e.prototype.getPageViewportDimensions=function(e){var t=this;return new Promise(function(n){t.pdf.getPage(e+1).then(function(e){var t=e.getViewport(1);n({height:t.height,width:t.width})})})},e}();n.PdfJsDocument=i},{"../arrayUtils":1,lodash:150}],79:[function(e,t,n){"use strict";var o=e("../clipperUI/frontEndGlobals"),r=e("../logging/log"),i=e("./pdfJsDocument"),a=function(){
function e(){}return e.getLocalPdfData=function(t){return e.getPdfScreenshotResult(t)},e.getPdfData=function(t){return new Promise(function(n,i){var a=new r.Event.PromiseEvent(r.Event.Label.GetBinaryRequest),s=new XMLHttpRequest;s.open("GET",t,!0),s.responseType="arraybuffer";var l=function(e){a.setStatus(r.Status.Failed),e.response=e.responseHeaders=void 0,a.setFailureInfo(e),o.Clipper.logger.logEvent(a),i()};s.onload=function(){if(200===s.status&&s.response){var t=s.response;a.setCustomProperty(r.PropertyName.Custom.ByteLength,t.byteLength),o.Clipper.logger.logEvent(a),e.getPdfScreenshotResult(t).then(function(e){e.byteLength=t.byteLength,n(e)})}else l(OneNoteApi.ErrorUtils.createRequestErrorObject(s,OneNoteApi.RequestErrorType.UNEXPECTED_RESPONSE_STATUS))},s.ontimeout=function(){l(OneNoteApi.ErrorUtils.createRequestErrorObject(s,OneNoteApi.RequestErrorType.REQUEST_TIMED_OUT))},s.onerror=function(){l(OneNoteApi.ErrorUtils.createRequestErrorObject(s,OneNoteApi.RequestErrorType.NETWORK_ERROR))},s.send()})},e.getPdfScreenshotResult=function(e){return new Promise(function(t,n){PDFJS.getDocument(e).then(function(e){var n=new i.PdfJsDocument(e);n.getAllPageViewportDimensions().then(function(e){n.getByteLength().then(function(o){t({pdf:n,viewportDimensions:e,byteLength:o})})})})})},e}();n.PdfScreenshotHelper=a},{"../clipperUI/frontEndGlobals":49,"../logging/log":108,"./pdfJsDocument":78}],80:[function(e,t,n){"use strict";var o=e("./objectUtils"),r=function(){function e(){}return e.readCookie=function(e,t){o.ObjectUtils.isNullOrUndefined(t)&&(t=document);for(var n=document.cookie.split(";").map(function(e){return e.split("=")}),r=0,i=n;r<i.length;r++){var a=i[r];if(a[0].trim()===e)return a[1].trim()}},e}();n.CookieUtils=r},{"./objectUtils":123}],81:[function(e,t,n){"use strict";var o,r=e("./khanAcademyVideoExtractor"),i=e("./videoUtils"),a=e("./vimeoVideoExtractor"),s=e("./YoutubeVideoExtractor");!function(e){function t(e){var t=i.SupportedVideoDomains;switch(e){case t.KhanAcademy:return new r.KhanAcademyVideoExtractor;case t.Vimeo:return new a.VimeoVideoExtractor;case t.YouTube:return new s.YoutubeVideoExtractor;default:return}}e.createVideoExtractor=t}(o=n.VideoExtractorFactory||(n.VideoExtractorFactory={}))},{"./YoutubeVideoExtractor":82,"./khanAcademyVideoExtractor":84,"./videoUtils":86,"./vimeoVideoExtractor":87}],82:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("./domUtils"),i=e("./videoExtractor"),a=e("../urlUtils"),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.youTubeWatchVideoBaseUrl="https://www.youtube.com/watch",t.youTubeVideoIdQueryKey="v",t.dataOriginalSrcAttribute="data-original-src",t}return o(t,e),t.prototype.createEmbeddedVideosFromHtml=function(e){if(!e)return[];var t=document.createElement("div");t.innerHTML=e;for(var n=t.getElementsByTagName("iframe"),o=[],r=0;r<n.length;r++)if(this.isYoutubeUrl(n[r].src)){var i=this.createEmbeddedVideoFromUrl(n[r].src);i&&o.push(i)}return o},t.prototype.isYoutubeUrl=function(e){return/[^\w]youtube\.com\/watch(\?v=(\w+)|.*\&v=(\w+))/.test(e)||/[^\w]youtube\.com\/embed\/(\w+)/.test(e)},t.prototype.createEmbeddedVideoFromUrl=function(e){if(e){if(0===a.UrlUtils.getPathname(e).indexOf("/watch"))return this.createEmbeddedVideoFromId(a.UrlUtils.getQueryValue(e,this.youTubeVideoIdQueryKey));if(0===a.UrlUtils.getPathname(e).indexOf("/embed")){var t=e.match(/youtube\.com\/embed\/([^?|\/?]+)/);return this.createEmbeddedVideoFromId(t[1])}}},t.prototype.createEmbeddedVideoFromId=function(e){if(e){var t=r.DomUtils.createEmbedVideoIframe(),n="https://www.youtube.com/embed/"+e;t.src=n;var o=a.UrlUtils.addUrlQueryValue(this.youTubeWatchVideoBaseUrl,this.youTubeVideoIdQueryKey,e);return t.setAttribute(this.dataOriginalSrcAttribute,o),t}},t}(i.VideoExtractor);n.YoutubeVideoExtractor=s},{"../urlUtils":142,"./domUtils":83,"./videoExtractor":85}],83:[function(e,t,n){"use strict";var o=e("../constants"),r=e("../objectUtils"),i=e("./videoUtils"),a=e("./VideoExtractorFactory"),s=function(){function e(){}return e.cleanHtml=function(t){var n=[];for(var o in e.attributesAllowedByOnml)e.attributesAllowedByOnml.hasOwnProperty(o)&&(n=n.concat(e.attributesAllowedByOnml[o]));var r=e.htmlTags.concat(e.markupTags).concat(e.tableTags),i=sanitizeHtml(t,{allowedTags:r,allowedAttributes:e.attributesAllowedByOnml,allowedSchemes:sanitizeHtml.defaults.allowedSchemes.concat(["data"]),allowedClasses:{"*":["MainArticleContainer"]}});return i},e.removeStylesWithBase64EncodedBinaries=function(t){e.domReplacer(t,"style",function(e){return e.innerHTML.indexOf("data:application")!==-1?void 0:e})},e.removeElementsNotSupportedInOnml=function(t){e.domReplacer(t,e.tagsNotSupportedInOnml.join());var n=[e.tags.main,e.tags.article,e.tags.figure,e.tags.header,e.tags.center];e.domReplacer(t,n.join(),function(t){var n=document.createElement("div");return n.innerHTML=e.cleanHtml(t.innerHTML),n})},e.domReplacer=function(e,t,n){void 0===n&&(n=function(){});for(var o=e.querySelectorAll(t),r=0;r<o.length;r++){var i=o[r];try{var a=n(i,r);a?i!==a&&i.parentNode.replaceChild(a,i):i.parentNode.removeChild(i)}catch(e){}}},e.domReplacerAsync=function(e,t,n){return void 0===n&&(n=function(){return Promise.resolve(void 0)}),new Promise(function(o){var r=e.querySelectorAll(t),i=0;0===r.length&&o();for(var a=function(e){var t=r[e];n(t,e).then(function(e){e?t!==e&&t.parentNode.replaceChild(e,t):t.parentNode.removeChild(t)},function(){}).then(function(){++i===r.length&&o()})},s=0;s<r.length;s++)a(s)})},e.getPageContentType=function(e){var t=e.createElement("a");if(t.href=e.URL,/\.pdf$/i.test(t.pathname))return OneNoteApi.ContentType.EnhancedUrl;var n=e.querySelector("embed");return n&&/application\/pdf/i.test(n.type)?OneNoteApi.ContentType.EnhancedUrl:window&&window.PDFJS?OneNoteApi.ContentType.EnhancedUrl:OneNoteApi.ContentType.Html},e.fetchCanonicalUrl=function(e){var t=e.querySelectorAll("link[rel=canonical]");if(0===t.length)return e.URL;for(var n=t[0].href,o=void 0,r=1;r<t.length;r++)o=t.item(r).href,o.length<n.length&&(n=o);return n},e.getCleanDomOfCurrentPage=function(t){var n=e.cloneDocument(t);e.convertCanvasElementsToImages(n,t),e.addBaseTagIfNecessary(n,t.location),e.addImageSizeInformationToDom(n),e.removeUnwantedItems(n);var o=e.getDomString(n);return o},e.removeUnwantedItems=function(t){e.removeStylesWithBase64EncodedBinaries(t),e.removeClipperElements(t),e.removeUnwantedElements(t),e.removeUnwantedAttributes(t),e.removeUnsupportedHrefs(t)},e.addPreviewContainerStyling=function(e){e.setAttribute("style","margin-bottom: 16px")},e.addEmbeddedVideosWhereSupported=function(t,n,o){var r=i.VideoUtils.videoDomainIfSupported(o);if(!r)return Promise.resolve();var s=[];try{var l=i.SupportedVideoDomains[r],c=a.VideoExtractorFactory.createVideoExtractor(l);c&&(s=s.concat(c.createEmbeddedVideosFromPage(o,n)))}catch(e){return Promise.reject({error:JSON.stringify({doc:t.outerHTML,pageContent:n,message:e.message})})}return Promise.resolve(e.addVideosToElement(t,s))},e.createEmbedVideoIframe=function(){var e=document.createElement("iframe");return e.width="600",e.height="338",e.frameBorder="0",e.allowFullscreen=!1,e},e.addVideosToElement=function(t,n){if(!r.ObjectUtils.isNullOrUndefined(t)&&!r.ObjectUtils.isNullOrUndefined(n)&&0!==n.length){for(var o,i=[],a=0,s=n;a<s.length;a++){var l=s[a];r.ObjectUtils.isNullOrUndefined(l.src)||r.ObjectUtils.isNullOrUndefined(l.getAttribute(e.dataOriginalSrcAttribute))?i.push({srcAttribute:"",dataOriginalSrcAttribute:""}):(o=e.insertIFrame(t,l,o),o=e.insertSpacer(t,o.nextSibling),i.push({srcAttribute:l.src,dataOriginalSrcAttribute:l.getAttribute(e.dataOriginalSrcAttribute)}))}return i}},e.insertIFrame=function(e,t,n){var o;return o=r.ObjectUtils.isNullOrUndefined(n)?e.children[0]:n.nextSibling,e.insertBefore(t,o)},e.insertSpacer=function(e,t){var n=document.createElement("br");return e.insertBefore(n,t)},e.cloneDocument=function(e){return e.cloneNode(!0)},e.addBaseTagIfNecessary=function(t,n){if(!t.head){var o=t.createElement(e.tags.head),r=t.getElementsByTagName(e.tags.html)[0];r.insertBefore(o,r.children[0])}n||(n=document.location);var i=t.head.getElementsByTagName(e.tags.base);if(0===i.length){var a=n.href.split("#")[0].split("?")[0];a=a.substr(0,a.lastIndexOf("/")+1);var s=t.createElement(e.tags.base);s.href=a,t.head.insertBefore(s,t.head.firstChild)}},e.removeBlankImages=function(t){return e.domReplacerAsync(t,e.tags.img,function(t){return new Promise(function(n){var o=t,r=new Image;r.crossOrigin="anonymous",r.onload=function(){n(e.imageIsBlank(r)?void 0:t)},r.onerror=function(){n(t)},r.src=o.src||o.getAttribute("src")})})},e.imageIsBlank=function(e){if(0===e.width||0===e.height)return!1;var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);try{for(var o=n.getImageData(0,0,t.width,t.height),r=o.data,i=0;i<r.length;i+=4)if(0!==r[i+3]&&(255!==r[i]||255!==r[i+1]||255!==r[i+2]))return!1;return!0}catch(e){return!1}},e.removeClipperElements=function(t){var n=this;e.domReplacer(t,["#"+o.Constants.Ids.clipperRootScript,"#"+o.Constants.Ids.clipperUiFrame,"#"+o.Constants.Ids.clipperExtFrame].join()),e.domReplacer(t,e.tags.iframe,function(e){var t=e,o=t.src;if(!n.isLocalReferenceUrl(o))return t})},e.removeUnsupportedHrefs=function(t){var n=this;e.domReplacer(t,e.tags.link,function(e){var t=e,o=t.href;if(!n.isLocalReferenceUrl(o))return t})},e.removeUnwantedElements=function(t){e.domReplacer(t,[e.tags.script,e.tags.noscript].join())},e.removeUnwantedAttributes=function(e){for(var t=e.getElementsByTagName("IMG"),n=0;n<t.length;n++){var o=t[n];o.srcset=void 0,o.removeAttribute("srcset")}},e.convertRelativeUrlsToAbsolute=function(t){e.domReplacer(t,e.tags.img,function(t,n){var o=t,r=o.attributes.src;if(r&&r.value)return o.src=e.toAbsoluteUrl(r.value,location.origin),o}),e.domReplacer(t,e.tags.a,function(t,n){var o=t,r=o.attributes.href;return r&&r.value?(o.href=e.toAbsoluteUrl(r.value,location.origin),o):t})},e.toAbsoluteUrl=function(e,t){if(!e||!t)throw new Error("parameters must be non-empty, but was: "+e+", "+t);/^\/\/[^\/]/.test(e)&&(e=location.protocol+e);var n=new URI(e);return n.is("relative")?n.absoluteTo(t).valueOf():e},e.convertCanvasElementsToImages=function(t,n){var o=n.querySelectorAll(e.tags.canvas);e.domReplacer(t,e.tags.canvas,function(n,r){var i=o[r];if(i){var a=t.createElement(e.tags.img);return a.src=i.toDataURL(),a.style.cssText=window.getComputedStyle(i).cssText,a}})},e.addImageSizeInformationToDom=function(e){for(var t=e.getElementsByTagName("img"),n=0;n<t.length;n++){var o=t[n];if(!o.hasAttribute("data-height")){var r=o.height;o.setAttribute("data-height",r.toString())}if(!o.hasAttribute("data-width")){var i=o.width;o.setAttribute("data-width",i.toString())}}},e.getImageDataUrl=function(t){return new Promise(function(n,o){(r.ObjectUtils.isNullOrUndefined(t)||""===t)&&o({error:"image source is undefined or empty"});var i=new Image;i.crossOrigin="anonymous",i.onload=function(){var o=document.createElement(e.tags.canvas);o.width=i.naturalWidth,o.height=i.naturalHeight,o.getContext("2d").drawImage(i,0,0);try{var r=o.toDataURL("image/png");r=e.adjustImageQualityIfNecessary(o,r),n(r)}catch(e){n(t)}},i.onerror=function(e){var t,n=e.currentTarget;r.ObjectUtils.isNullOrUndefined(n)||(t=n.src),o({error:"onerror occurred fetching "+t})},i.src=t,(i.complete||void 0===i.complete)&&(i.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",i.src=t)})},e.adjustImageQualityIfNecessary=function(t,n,o,r){void 0===o&&(o=1),void 0===r&&(r=.1);for(var i=0;o>0&&n.length>e.maxBytesForMediaTypes;)n=t.toDataURL("image/jpeg",o),o-=r,i++;return n},e.getDomString=function(t){return e.getDoctype(t)+t.documentElement.outerHTML},e.getDocumentFromDomString=function(e,t){var n=document.implementation.createHTMLDocument(t);return n.documentElement.innerHTML=e,n},e.getDoctype=function(e){var t=e.doctype;return t?"<!DOCTYPE "+t.name+(t.publicId?' PUBLIC "'+t.publicId+'"':"")+(!t.publicId&&t.systemId?" SYSTEM":"")+(t.systemId?' "'+t.systemId+'"':"")+">":""},e.getByteSize=function(t){return unescape?unescape(encodeURIComponent(t)).length:e.getByteArray(t).length},e.truncateStringToByteSize=function(t,n){var o=e.getByteArray(t);if(o.length<=n)return t;o=o.slice(0,n);for(var r=o.join("");r.length;)try{return r=r.slice(0,-1),decodeURIComponent(r)}catch(e){return""}},e.getByteArray=function(e){return encodeURIComponent(e).match(/%..|./g)||[]},e.getLocale=function(e){var t=e.getElementsByTagName("html")[0].getAttribute("lang");return t?t:window.navigator.language||window.navigator.userLanguage},e.getFileNameFromUrl=function(e){var t=e.createElement("a");if(t.href=e.URL,t.pathname.match(new RegExp(".pdf$","gi"))){var n=t.pathname.match(/[^/]+$/g);if(n)return decodeURIComponent(n.pop())}return e.title},e.textNodesNoWhitespaceUnder=function(e){for(var t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:function(e){if(!/^\s*$/.test(e.data))return NodeFilter.FILTER_ACCEPT}},!1),o=n.nextNode();o;)t.push(o),o=n.nextNode();return t},e.removeEventListenerAttributes=function(e){for(var t=["onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmousemove","onmouseout","ondragstart","ondrag","ondragenter","ondragleave","ondragover","ondrop","ondragend","onkeydown","onkeypress","onkeyup","onload","onunload","onabort","onerror","onresize","onscroll","onselect","onchange","onsubmit","onreset","onfocus","onblur"],n=0;n<t.length;n++)for(var o=e.querySelectorAll("["+t[n]+"]"),r=0;r<o.length;r++)o[r].removeAttribute(t[n])},e.toOnml=function(t){return e.removeElementsNotSupportedInOnml(t),e.removeDisallowedIframes(t),e.removeUnwantedItems(t),e.convertRelativeUrlsToAbsolute(t),e.removeAllStylesAndClasses(t),e.removeEventListenerAttributes(t),e.removeBlankImages(t)},e.removeDisallowedIframes=function(t){e.domReplacer(t,e.tags.iframe,function(e){var t=e.src,n=i.VideoUtils.videoDomainIfSupported(t);if(n){var o=i.SupportedVideoDomains[n],r=a.VideoExtractorFactory.createVideoExtractor(o);return r.createEmbeddedVideoFromUrl(t)}})},e.removeAllStylesAndClasses=function(t){e.domReplacer(t,"*",function(e,t){return e.removeAttribute("style"),e.removeAttribute("class"),e})},e.isScrolledIntoPartialView=function(e){var t=e.getBoundingClientRect().top,n=e.getBoundingClientRect().bottom,o=t<window.innerHeight&&n>=0;return o},e.getScrollPercent=function(e,t){if(void 0===t&&(t=!1),!e)return 0;var n=1*e.scrollTop/(e.scrollHeight-e.clientHeight);return t?n:100*n},e.isLocalReferenceUrl=function(e){return!(0===e.indexOf("https://")||0===e.indexOf("http://"))},e}();s.tags={a:"a",b:"b",applet:"applet",article:"article",audio:"audio",base:"base",body:"body",br:"br",button:"button",canvas:"canvas",center:"center",cite:"cite",code:"code",del:"del",div:"div",em:"em",embed:"embed",figure:"figure",font:"font",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",head:"head",header:"header",hr:"hr",html:"html",i:"i",iframe:"iframe",img:"img",input:"input",li:"li",link:"link",main:"main",map:"map",menu:"menu",menuitem:"menuitem",meta:"meta",meter:"meter",noscript:"noscript",object:"object",ol:"ol",p:"p",pre:"pre",progress:"progress",script:"script",span:"span",source:"source",strike:"strike",strong:"strong",style:"style",sub:"sub",sup:"sup",svg:"svg",table:"table",td:"td",title:"title",tr:"tr",u:"u",ul:"ul",video:"video"},s.attributesAllowedByOnml={a:["href","name","target"],img:["src"],"*":["src","background-color","color","font-family","font-size","data*","alt","height","width","style","id","type"]},s.tableTags=[s.tags.table,s.tags.td,s.tags.tr],s.markupTags=[s.tags.b,s.tags.em,s.tags.strong,s.tags.i,s.tags.u,s.tags.strike,s.tags.del,s.tags.sup,s.tags.sub,s.tags.cite,s.tags.font,s.tags.pre,s.tags.code],s.htmlTags=[s.tags.html,s.tags.head,s.tags.title,s.tags.meta,s.tags.body,s.tags.div,s.tags.span,s.tags.article,s.tags.figure,s.tags.header,s.tags.main,s.tags.center,s.tags.iframe,s.tags.a,s.tags.p,s.tags.br,s.tags.h1,s.tags.h2,s.tags.h3,s.tags.h4,s.tags.h5,s.tags.h6,s.tags.ul,s.tags.ol,s.tags.li,s.tags.img,s.tags.object,s.tags.video],s.tagsNotSupportedInOnml=[s.tags.applet,s.tags.audio,s.tags.button,s.tags.canvas,s.tags.embed,s.tags.hr,s.tags.input,s.tags.link,s.tags.map,s.tags.menu,s.tags.menuitem,s.tags.meter,s.tags.noscript,s.tags.progress,s.tags.script,s.tags.source,s.tags.style,s.tags.svg,s.tags.video],s.dataOriginalSrcAttribute="data-original-src",s.maxBytesForMediaTypes=2096652,n.DomUtils=s},{"../constants":74,"../objectUtils":123,"./VideoExtractorFactory":81,"./videoUtils":86}],84:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("./videoExtractor"),i=e("./videoUtils"),a=e("./youtubeVideoExtractor"),s=function(e){function t(){var t=e.call(this)||this;return t.youtubeExtractor=new a.YoutubeVideoExtractor,t}return o(t,e),t.prototype.createEmbeddedVideosFromHtml=function(e){var t=this;if(!e)return[];var n=/\sid\s*=\s*("\s*video_(\S+)\s*"|'\s*video_(\S+)\s*')/gi,o=/data-youtubeid\s*=\s*("\s*video_(\S+)\s*"|'\s*video_(\S+)\s*')/gi,r=i.VideoUtils.matchRegexFromPageContent(e,[n,o]);return r?r.map(function(e){return t.createEmbeddedVideoFromId(e)}):[]},t.prototype.createEmbeddedVideoFromUrl=function(e){},t.prototype.createEmbeddedVideoFromId=function(e){return this.youtubeExtractor.createEmbeddedVideoFromId(e)},t}(r.VideoExtractor);n.KhanAcademyVideoExtractor=s},{"./videoExtractor":85,"./videoUtils":86,"./youtubeVideoExtractor":88}],85:[function(e,t,n){"use strict";var o=e("lodash"),r=function(){function e(){}return e.prototype.createEmbeddedVideosFromPage=function(e,t){var n=[],r=this.createEmbeddedVideoFromUrl(e);return r&&n.push(r),n=n.concat(this.createEmbeddedVideosFromHtml(t)),o.uniqWith(n,function(e,t){return e.src===t.src})},e}();n.VideoExtractor=r},{lodash:150}],86:[function(e,t,n){"use strict";var o,r=e("../objectUtils"),i=e("../urlUtils");!function(e){e[e.YouTube=0]="YouTube",e[e.Vimeo=1]="Vimeo",e[e.KhanAcademy=2]="KhanAcademy"}(o=n.SupportedVideoDomains||(n.SupportedVideoDomains={}));var a=function(){function e(){this.youTubeWatchVideoBaseUrl="https://www.youtube.com/watch",this.youTubeVideoIdQueryKey="v"}return e.videoDomainIfSupported=function(e){if(e){var t=e.toLowerCase();if(i.UrlUtils.onWhitelistedDomain(t)){var n=i.UrlUtils.getHostname(t).toLowerCase();for(var r in o){var a=o[r];if("string"==typeof a&&n.indexOf(a.toLowerCase()+".")>-1)return a}}}},e.matchRegexFromPageContent=function(e,t){if(!r.ObjectUtils.isNullOrUndefined(e)){var n,o=[];if(t.forEach(function(t){for(;n=t.exec(e);)n[2]?o.push(n[2]):n[3]&&o.push(n[3])}),0!==o.length)return o}},e}();n.VideoUtils=a},{"../objectUtils":123,"../urlUtils":142}],87:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("./domUtils"),i=e("./videoExtractor"),a=e("./videoUtils"),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dataOriginalSrcAttribute="data-original-src",t}return o(t,e),t.prototype.createEmbeddedVideosFromHtml=function(e){var t=this;if(!e)return[];var n=/id\s*=\s*("\s*clip_(\d+)\s*"|'\s*clip_(\d+)\s*')/gi,o=/player\.vimeo\.com\/video\/((\d+))\d{0}/gi,r=a.VideoUtils.matchRegexFromPageContent(e,[n,o]);return r?r.map(function(e){return t.createEmbeddedVideoFromId(e)}):[]},t.prototype.createEmbeddedVideoFromUrl=function(e){if(e){var t=e.match(/^https?:\/\/vimeo\.com\/(\d+)\d{0}/);return t?this.createEmbeddedVideoFromId(t[1]):(t=e.match(/^https?:\/\/player.vimeo.com\/video\/(\d+)\d{0}/),t?this.createEmbeddedVideoFromId(t[1]):void 0)}},t.prototype.createEmbeddedVideoFromId=function(e){if(e){var t=r.DomUtils.createEmbedVideoIframe(),n="https://player.vimeo.com/video/"+e;return t.src=n,t.setAttribute(this.dataOriginalSrcAttribute,n),t}},t}(i.VideoExtractor);n.VimeoVideoExtractor=s},{"./domUtils":83,"./videoExtractor":85,"./videoUtils":86}],88:[function(e,t,n){arguments[4][82][0].apply(n,arguments)},{"../urlUtils":142,"./domUtils":83,"./videoExtractor":85,dup:82}],89:[function(e,t,n){"use strict";var o=e("../communicator/smartValue"),r=e("../logging/log"),i=e("../http/HttpWithRetries"),a=e("../storage/clipperStorageKeys"),s=e("../userInfo"),l=e("../constants"),c=e("../objectUtils"),u=e("../stringUtils"),p=e("../urlUtils"),d=function(){function e(e,t){this.user=new o.SmartValue,this.logger=t,this.clipperData=e}return e.prototype.updateUserInfoData=function(e,t){var n=this;return new Promise(function(o){var i=0,l=n.clipperData.getValue(a.ClipperStorageKeys.userInformation);if(l){var u=void 0;try{u=JSON.parse(l)}catch(e){n.logger.logJsonParseUnexpected(l)}u&&u.data&&c.ObjectUtils.isNumeric(u.data.accessTokenExpiration)&&(i=Math.max(1e3*u.data.accessTokenExpiration-18e4,0))}var p=function(){return n.retrieveUserInformation(e,void 0)},d=new r.Event.PromiseEvent(r.Event.Label.GetExistingUserInformation);d.setCustomProperty(r.PropertyName.Custom.UserInformationStored,!!l),n.clipperData.getFreshValue(a.ClipperStorageKeys.userInformation,p,i).then(function(e){var o=n.isValidUserInformation(e.data);d.setCustomProperty(r.PropertyName.Custom.FreshUserInfoAvailable,o);var i=n.isThirdPartyCookiesEnabled(e.data);d.setCustomProperty(r.PropertyName.Custom.WriteableCookies,i),d.setCustomProperty(r.PropertyName.Custom.UserUpdateReason,s.UpdateReason[t]),o?n.user.set({user:e.data,lastUpdated:e.lastUpdated,updateReason:t,writeableCookies:i}):n.user.set({updateReason:t,writeableCookies:i})},function(e){d.setStatus(r.Status.Failed),d.setFailureInfo(e),n.user.set({updateReason:t})}).then(function(){n.logger.logEvent(d),o(n.user.get())})})},e.prototype.retrieveUserInformation=function(e,t){var n=this;return void 0===t&&(t=void 0),new Promise(function(o,a){var s=p.UrlUtils.addUrlQueryValue(l.Constants.Urls.Authentication.userInformationUrl,l.Constants.Urls.QueryParams.clipperId,e),d=new r.Event.PromiseEvent(r.Event.Label.RetrieveUserInformation),g=u.StringUtils.generateGuid();d.setCustomProperty(r.PropertyName.Custom.CorrelationId,g);var f={};f["Content-type"]="application/x-www-form-urlencoded",f[l.Constants.HeaderValues.correlationId]=g;var h="";c.ObjectUtils.isNullOrUndefined(t)||(h=t.replace(/\+/g,"%2B")),i.HttpWithRetries.post(s,h,f).then(function(e){var t=e.response;o({parsedResponse:t,request:e})},function(e){d.setStatus(r.Status.Failed),d.setFailureInfo(e),a(e)}).then(function(){n.logger.logEvent(d)})})},e.prototype.isValidUserInformation=function(e){return!!(e&&e.accessToken&&e.accessTokenExpiration>0&&e.authType)},e.prototype.isThirdPartyCookiesEnabled=function(e){return void 0===e.cookieInRequest||e.cookieInRequest},e}();n.AuthenticationHelper=d},{"../communicator/smartValue":73,"../constants":74,"../http/HttpWithRetries":100,"../logging/log":108,"../objectUtils":123,"../storage/clipperStorageKeys":138,"../stringUtils":141,"../urlUtils":142,"../userInfo":143}],90:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../clientType"),i=e("../../storage/clipperData"),a=e("../../storage/localStorage"),s=e("../extensionBase"),l=e("./inlineWorker"),c=function(e){function t(){var t=e.call(this,r.ClientType.Bookmarklet,new i.ClipperData(new a.LocalStorage))||this;return t.worker=new l.InlineWorker(t.clientInfo,t.auth),t.addWorker(t.worker),t}return o(t,e),t.prototype.getIdFromTab=function(e){},t.prototype.getInlineMessageHandler=function(){return this.worker.getUiMessageHandler()},t.prototype.getUniqueId=function(){},t.prototype.addPageNavListener=function(e){},t.prototype.checkIfTabMatchesATooltipType=function(e,t){},t.prototype.checkIfTabIsAVideoDomain=function(e){return!1},t.prototype.checkIfTabIsOnWhitelistedUrl=function(e){return!1},t.prototype.createWorker=function(e){},t.prototype.onFirstRun=function(){},t}(s.ExtensionBase);n.InlineExtension=c},{"../../clientType":3,"../../storage/clipperData":136,"../../storage/localStorage":139,"../extensionBase":92,"./inlineWorker":91}],91:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../../communicator/iframeMessageHandler"),i=e("../../communicator/inlineMessageHandler"),a=e("../../logging/log"),s=e("../../storage/clipperData"),l=e("../../storage/localStorage"),c=e("../../clipperUrls"),u=e("../../userInfo"),p=e("../extensionWorkerBase"),d=e("../invokeOptions"),g=e("../invokeSource"),f=function(e){function t(t,n){var o=this,c=function(){return new i.InlineMessageHandler},u=function(){return new r.IFrameMessageHandler(function(){return parent})};o=e.call(this,t,n,new s.ClipperData(new l.LocalStorage),c,u)||this,o.logger.setContextProperty(a.Context.Custom.InPrivateBrowsing,a.unknownValue);var p={invokeMode:d.InvokeMode.Default};return o.sendInvokeOptionsToInject(p),o.logger.logUserFunnel(a.Funnel.Label.Invoke),o.logClipperInvoke({invokeSource:g.InvokeSource.Bookmarklet},p),o}return o(t,e),t.prototype.getUiMessageHandler=function(){return this.uiCommunicator.getMessageHandler()},t.prototype.getUrl=function(){return"inline - unknown"},t.prototype.invokeClipperBrowserSpecific=function(){return this.throwNotImplementedFailure()},t.prototype.invokeDebugLoggingBrowserSpecific=function(){return this.throwNotImplementedFailure()},t.prototype.invokeWhatsNewTooltipBrowserSpecific=function(e){return this.throwNotImplementedFailure()},t.prototype.invokeTooltipBrowserSpecific=function(){return this.throwNotImplementedFailure()},t.prototype.isAllowedFileSchemeAccessBrowserSpecific=function(e){e(!1)},t.prototype.takeTabScreenshot=function(){return this.throwNotImplementedFailure()},t.prototype.doSignInAction=function(e){var t=this.getUserSessionIdQueryParamValue(),n=c.ClipperUrls.generateSignInUrl(this.clientInfo.get().clipperId,t,u.AuthType[e]);return this.launchPopupAndWaitForClose(n)},t.prototype.doSignOutAction=function(e){var t=this.getUserSessionIdQueryParamValue(),n=c.ClipperUrls.generateSignOutUrl(this.clientInfo.get().clipperId,t,u.AuthType[e]),o=document.createElement("iframe");o.hidden=!0,o.style.display="none",o.src=n,document.body.appendChild(o)},t.prototype.throwNotImplementedFailure=function(){throw this.logger.logFailure(a.Failure.Label.NotImplemented,a.Failure.Type.Unexpected),new Error("not implemented")},t}(p.ExtensionWorkerBase);n.InlineWorker=f},{"../../clipperUrls":68,"../../communicator/iframeMessageHandler":70,"../../communicator/inlineMessageHandler":71,"../../logging/log":108,"../../storage/clipperData":136,"../../storage/localStorage":139,"../../userInfo":143,"../extensionWorkerBase":94,"../invokeOptions":95,"../invokeSource":96}],92:[function(e,t,n){"use strict";var o=e("../clientType"),r=e("../constants"),i=e("../stringUtils"),a=e("../urlUtils"),s=e("../clipperUI/tooltipType"),l=e("../communicator/smartValue"),c=e("../http/HttpWithRetries"),u=e("../localization/localization"),p=e("../localization/localizationHelper"),d=e("../logging/log"),g=e("../storage/clipperStorageKeys"),f=e("../versioning/changeLog"),h=e("../versioning/changeLogHelper"),m=e("../versioning/version"),v=e("./authenticationHelper"),y=e("./tooltipHelper"),C=e("./workerPassthroughLogger"),S=function(){function e(t,n){this.setUnhandledExceptionLogging(),this.workers=[],this.logger=new C.WorkerPassthroughLogger(this.workers),e.extensionId=i.StringUtils.generateGuid(),this.clipperData=n,this.clipperData.setLogger(this.logger),this.auth=new v.AuthenticationHelper(this.clipperData,this.logger),this.tooltip=new y.TooltipHelper(this.clipperData);var o=!1,r=this.clipperData.getValue(g.ClipperStorageKeys.clipperId);r||(o=!0,r=e.generateClipperId(),this.clipperData.setValue(g.ClipperStorageKeys.clipperId,r),this.updateLastSeenVersionInStorageToCurrent()),this.clientInfo=new l.SmartValue({clipperType:t,clipperVersion:e.getExtensionVersion(),clipperId:r}),o&&this.onFirstRun(),this.initializeUserFlighting(),this.listenForOpportunityToShowPageNavTooltip()}return e.getExtensionId=function(){return e.extensionId},e.getExtensionVersion=function(){return e.version},e.shouldCheckForMajorUpdates=function(e,t){return!!t&&(!e||e.isLesserThan(t))},e.prototype.addWorker=function(e){var t=this;e.setOnUnloading(function(){e.destroy(),t.removeWorker(e)}),this.workers.push(e)},e.prototype.getWorkers=function(){return this.workers},e.prototype.removeWorker=function(e){var t=this.workers.indexOf(e);t>-1&&this.workers.splice(t,1)},e.isOnOneNoteDomain=function(e){return e.indexOf("onenote.com")>=0||e.indexOf("onenote-int.com")>=0},e.prototype.fetchAndStoreLocStrings=function(){var e=this,t=navigator.language||navigator.userLanguage;return p.LocalizationHelper.makeLocStringsFetchRequest(t).then(function(n){try{var o=JSON.parse(n.parsedResponse);return o&&(e.clipperData.setValue(g.ClipperStorageKeys.locale,t),e.clipperData.setValue(g.ClipperStorageKeys.locStrings,n.parsedResponse),u.Localization.setLocalizedStrings(o)),Promise.resolve(o)}catch(e){return Promise.reject(void 0)}})},e.prototype.getClipperInstalledPageUrl=function(t,n,i){var s=r.Constants.Urls.clipperInstallPageUrl;return s=a.UrlUtils.addUrlQueryValue(s,r.Constants.Urls.QueryParams.clientType,o.ClientType[n]),s=a.UrlUtils.addUrlQueryValue(s,r.Constants.Urls.QueryParams.clipperId,t),s=a.UrlUtils.addUrlQueryValue(s,r.Constants.Urls.QueryParams.clipperVersion,e.getExtensionVersion()),s=a.UrlUtils.addUrlQueryValue(s,r.Constants.Urls.QueryParams.inlineInstall,i.toString()),this.logger.logTrace(d.Trace.Label.RequestForClipperInstalledPageUrl,d.Trace.Level.Information,s),s},e.prototype.getExistingWorkerForTab=function(e){for(var t=this.getWorkers(),n=0,o=t;n<o.length;n++){var r=o[n];if(r.getUniqueId()===e)return r}},e.prototype.getLastSeenVersion=function(){var e=this.clipperData.getValue(g.ClipperStorageKeys.lastSeenVersion);return e?new m.Version(e):void 0},e.prototype.getNewUpdates=function(e,t){var n=this;return new Promise(function(o,i){var s=n.clipperData.getValue(g.ClipperStorageKeys.displayLanguageOverride),l=s||navigator.language||navigator.userLanguage,u=a.UrlUtils.addUrlQueryValue(r.Constants.Urls.changelogUrl,r.Constants.Urls.QueryParams.changelogLocale,l);c.HttpWithRetries.get(u).then(function(n){try{for(var r=JSON.parse(n.responseText),a=void 0,s=0;s<r.length;s++)if(r[s].schemaVersion===f.ChangeLog.schemaVersionSupported){a=r[s].updates;break}if(!a)throw new Error("No matching schemas were found.");var l=h.ChangeLogHelper.getUpdatesBetweenVersions(a,e,t);o(l)}catch(e){i(e)}},function(e){i(e)})})},e.prototype.getOrCreateWorkerForTab=function(e,t){var n=t(e),o=this.getExistingWorkerForTab(n);return o||(o=this.createWorker(e),this.addWorker(o)),o},e.generateClipperId=function(){var e="ON";return e+"-"+i.StringUtils.generateGuid()},e.prototype.initializeUserFlighting=function(){this.updateClientInfoWithFlightInformation([])},e.prototype.shouldShowTooltip=function(e,t){var n=this.checkIfTabMatchesATooltipType(e,t);if(n&&this.tooltip.tooltipDelayIsOver(n,Date.now()))return n},e.prototype.shouldShowVideoTooltip=function(e){return!(!this.checkIfTabIsAVideoDomain(e)||!this.tooltip.tooltipDelayIsOver(s.TooltipType.Video,Date.now()))},e.prototype.showTooltip=function(e,t){var n=this,o=this.getOrCreateWorkerForTab(e,this.getIdFromTab),r=new d.Event.BaseEvent(d.Event.Label.TooltipImpression);r.setCustomProperty(d.PropertyName.Custom.TooltipType,s.TooltipType[t]),r.setCustomProperty(d.PropertyName.Custom.LastSeenTooltipTime,this.tooltip.getTooltipInformation(g.ClipperStorageKeys.lastSeenTooltipTimeBase,t)),
r.setCustomProperty(d.PropertyName.Custom.NumTimesTooltipHasBeenSeen,this.tooltip.getTooltipInformation(g.ClipperStorageKeys.numTimesTooltipHasBeenSeenBase,t)),o.invokeTooltip(t).then(function(e){if(e){n.tooltip.setTooltipInformation(g.ClipperStorageKeys.lastSeenTooltipTimeBase,t,Date.now().toString());var i=g.ClipperStorageKeys.numTimesTooltipHasBeenSeenBase,a=n.tooltip.getTooltipInformation(i,t)+1;n.tooltip.setTooltipInformation(g.ClipperStorageKeys.numTimesTooltipHasBeenSeenBase,t,a.toString())}r.setCustomProperty(d.PropertyName.Custom.FeatureEnabled,e),o.getLogger().logEvent(r)})},e.prototype.shouldShowWhatsNewTooltip=function(t,n,o){return this.checkIfTabIsOnWhitelistedUrl(t)&&e.shouldCheckForMajorUpdates(n,o)},e.prototype.showWhatsNewTooltip=function(e,t,n){var r=this;this.getNewUpdates(t,n).then(function(t){var n=h.ChangeLogHelper.filterUpdatesThatDontApplyToBrowser(t,o.ClientType[r.clientInfo.get().clipperType]);if(n&&n.length>0){var i=r.getOrCreateWorkerForTab(e,r.getIdFromTab);i.invokeWhatsNewTooltip(n).then(function(e){if(e){var t=new d.Event.BaseEvent(d.Event.Label.WhatsNewImpression);t.setCustomProperty(d.PropertyName.Custom.FeatureEnabled,e),i.getLogger().logEvent(t),r.updateLastSeenVersionInStorageToCurrent()}})}else r.updateLastSeenVersionInStorageToCurrent()},function(e){d.ErrorUtils.sendFailureLogRequest({label:d.Failure.Label.GetChangeLog,properties:{failureType:d.Failure.Type.Unexpected,failureInfo:{error:e},failureId:"GetChangeLog",stackTrace:e},clientInfo:r.clientInfo})})},e.prototype.listenForOpportunityToShowPageNavTooltip=function(){var t=this;this.addPageNavListener(function(n){var r;try{r=t.getLastSeenVersion()}catch(e){return void t.updateLastSeenVersionInStorageToCurrent()}var i=new m.Version(e.getExtensionVersion());if(t.clientInfo.get().clipperType!==o.ClientType.FirefoxExtension){var a=[s.TooltipType.Pdf,s.TooltipType.Product,s.TooltipType.Recipe],l=t.shouldShowTooltip(n,a);if(l)return void t.showTooltip(n,l);if(t.shouldShowVideoTooltip(n))return void t.showTooltip(n,s.TooltipType.Video)}if(t.shouldShowWhatsNewTooltip(n,r,i))return void t.showWhatsNewTooltip(n,r,i)})},e.prototype.setUnhandledExceptionLogging=function(){var e=this,t=window.onerror;window.onerror=function(n,o,r,i,a){var s=a?d.Failure.getStackTrace(a):"[unknown stacktrace]";d.ErrorUtils.sendFailureLogRequest({label:d.Failure.Label.UnhandledExceptionThrown,properties:{failureType:d.Failure.Type.Unexpected,failureInfo:{error:JSON.stringify({error:a.toString(),message:n,lineno:r,colno:i})},failureId:"ExtensionBase",stackTrace:s},clientInfo:e.clientInfo}),t&&t(n,o,r,i,a)}},e.prototype.updateClientInfoWithFlightInformation=function(e){this.clientInfo.set({clipperType:this.clientInfo.get().clipperType,clipperVersion:this.clientInfo.get().clipperVersion,clipperId:this.clientInfo.get().clipperId,flightingInfo:e})},e.prototype.updateLastSeenVersionInStorageToCurrent=function(){this.clipperData.setValue(g.ClipperStorageKeys.lastSeenVersion,e.getExtensionVersion())},e}();S.version="3.8.8",n.ExtensionBase=S},{"../clientType":3,"../clipperUI/tooltipType":67,"../communicator/smartValue":73,"../constants":74,"../http/HttpWithRetries":100,"../localization/localization":105,"../localization/localizationHelper":106,"../logging/log":108,"../storage/clipperStorageKeys":138,"../stringUtils":141,"../urlUtils":142,"../versioning/changeLog":144,"../versioning/changeLogHelper":145,"../versioning/version":146,"./authenticationHelper":89,"./tooltipHelper":97,"./workerPassthroughLogger":98}],93:[function(e,t,n){"use strict";var o;!function(e){function t(e){return("images/"+e).toLowerCase()}e.getImageResourceUrl=t}(o=n.ExtensionUtils||(n.ExtensionUtils={}))},{}],94:[function(e,t,n){"use strict";var o=e("../browserUtils"),r=e("../clientType"),i=e("../clipperUrls"),a=e("../cookieUtils"),s=e("../constants"),l=e("../polyfills"),c=e("../userInfo"),u=e("../settings"),p=e("../clipperUI/tooltipType"),d=e("../communicator/communicator"),g=e("../communicator/smartValue"),f=e("../http/clipperCachedHttp"),h=e("../localization/localizationHelper"),m=e("../logging/log"),v=e("../logging/logHelpers"),y=e("../storage/clipperStorageKeys"),C=e("./extensionBase"),S=e("./invokeSource"),b=e("./invokeOptions"),w=function(){function e(e,t,n,o,r){this.clipperFunnelAlreadyLogged=!1,l.Polyfills.init(),this.onUnloading=function(){},this.uiCommunicator=new d.Communicator(o(),s.Constants.CommunicationChannels.extensionAndUi),this.pageNavUiCommunicator=new d.Communicator(o(),s.Constants.CommunicationChannels.extensionAndPageNavUi),this.debugLoggingInjectCommunicator=new d.Communicator(r(),s.Constants.CommunicationChannels.debugLoggingInjectedAndExtension),this.injectCommunicator=new d.Communicator(r(),s.Constants.CommunicationChannels.injectedAndExtension),this.pageNavInjectCommunicator=new d.Communicator(r(),s.Constants.CommunicationChannels.pageNavInjectedAndExtension),this.sessionId=new g.SmartValue,this.logger=LogManager.createExtLogger(this.sessionId,v.LogHelpers.isConsoleOutputEnabled()?this.debugLoggingInjectCommunicator:void 0),this.logger.logSessionStart(),this.clipperData=n,this.clipperData.setLogger(this.logger),this.auth=t,this.clientInfo=e,this.logDeviceIdMapEvent(),this.initializeCommunicators(),this.initializeContextProperties()}return e.prototype.initializeContextProperties=function(){var e=this,t=this.clientInfo.get();if(this.logger.setContextProperty(m.Context.Custom.AppInfoId,u.Settings.getSetting("App_Id")),this.logger.setContextProperty(m.Context.Custom.ExtensionLifecycleId,C.ExtensionBase.getExtensionId()),this.logger.setContextProperty(m.Context.Custom.UserInfoId,void 0),this.logger.setContextProperty(m.Context.Custom.AuthType,"None"),this.logger.setContextProperty(m.Context.Custom.AppInfoVersion,t.clipperVersion),this.logger.setContextProperty(m.Context.Custom.DeviceInfoId,t.clipperId),this.logger.setContextProperty(m.Context.Custom.ClipperType,r.ClientType[t.clipperType]),t.flightingInfo)this.logger.setContextProperty(m.Context.Custom.FlightInfo,t.flightingInfo.join(","));else{var n=function(t){t.flightingInfo&&(e.clientInfo.unsubscribe(n),e.logger.setContextProperty(m.Context.Custom.FlightInfo,t.flightingInfo.join(",")))}.bind(this);this.clientInfo.subscribe(n,{callOnSubscribe:!1})}},e.prototype.getUniqueId=function(){return this.tabId},e.prototype.closeAllFramesAndInvokeClipper=function(e,t){this.pageNavInjectCommunicator.callRemoteFunction(s.Constants.FunctionKeys.closePageNavTooltip),this.invokeClipper(e,t)},e.prototype.getLogger=function(){return this.logger},e.prototype.invokeClipper=function(e,t){var n=this,o={invokeDataForMode:t?t.invokeDataForMode:void 0,invokeMode:t?t.invokeMode:b.InvokeMode.Default};this.sendInvokeOptionsToInject(o),this.isAllowedFileSchemeAccessBrowserSpecific(function(e){e||n.uiCommunicator.callRemoteFunction(s.Constants.FunctionKeys.extensionNotAllowedToAccessLocalFiles)}),this.invokeClipperBrowserSpecific().then(function(t){t&&!n.clipperFunnelAlreadyLogged&&(n.logger.logUserFunnel(m.Funnel.Label.Invoke),n.clipperFunnelAlreadyLogged=!0),n.logClipperInvoke(e,o)})},e.prototype.invokeWhatsNewTooltip=function(e){var t=this,n=new m.Event.PromiseEvent(m.Event.Label.InvokeWhatsNew);return this.registerLocalizedStringsForPageNav().then(function(o){return o?(t.registerWhatsNewCommunicatorFunctions(e),t.invokeWhatsNewTooltipBrowserSpecific(e).then(function(e){return e||(n.setStatus(m.Status.Failed),n.setFailureInfo({error:"invoking the What's New experience failed"})),t.logger.logEvent(n),Promise.resolve(e)})):(n.setStatus(m.Status.Failed),n.setFailureInfo({error:"getLocalizedStringsForBrowser returned undefined/null"}),t.logger.logEvent(n),Promise.resolve(!1))})},e.prototype.invokeTooltip=function(e){var t=this,n=new m.Event.PromiseEvent(m.Event.Label.InvokeTooltip);return n.setCustomProperty(m.PropertyName.Custom.TooltipType,p.TooltipType[e]),this.registerLocalizedStringsForPageNav().then(function(o){return o?(t.registerTooltipCommunicatorFunctions(e),t.invokeTooltipBrowserSpecific(e).then(function(e){return t.logger.logEvent(n),Promise.resolve(e)})):(n.setStatus(m.Status.Failed),n.setFailureInfo({error:"getLocalizedStringsForBrowser returned undefined/null"}),t.logger.logEvent(n),Promise.resolve(!1))})},e.prototype.setOnUnloading=function(e){this.onUnloading=e},e.prototype.destroy=function(){this.logger.logSessionEnd(m.Session.EndTrigger.Unload)},e.prototype.getLocalizedStrings=function(e,t){var n=this;this.logger.setContextProperty(m.Context.Custom.BrowserLanguage,e);var o=this.clipperData.getValue(y.ClipperStorageKeys.locale),r=!o||o!==e,i=new m.Event.BaseEvent(m.Event.Label.GetLocale);i.setCustomProperty(m.PropertyName.Custom.StoredLocaleDifferentThanRequested,r),this.logger.logEvent(i);var a=function(){return h.LocalizationHelper.makeLocStringsFetchRequest(e)},s=r?0:f.ClipperCachedHttp.getDefaultExpiry(),l=new m.Event.PromiseEvent(m.Event.Label.GetLocalizedStrings);l.setCustomProperty(m.PropertyName.Custom.ForceRetrieveFreshLocStrings,r),this.clipperData.getFreshValue(y.ClipperStorageKeys.locStrings,a,s).then(function(o){n.clipperData.setValue(y.ClipperStorageKeys.locale,e),t&&t(o?o.data:void 0)},function(e){l.setStatus(m.Status.Failed),l.setFailureInfo(e),t&&t(void 0)}).then(function(){n.logger.logEvent(l)})},e.prototype.getLocalizedStringsForBrowser=function(e){var t=this.clipperData.getValue(y.ClipperStorageKeys.displayLanguageOverride),n=t||navigator.language||navigator.userLanguage;this.getLocalizedStrings(n,e)},e.prototype.getUserSessionIdQueryParamValue=function(){var e=this.logger.getUserSessionId();return e?e:this.clientInfo.get().clipperId},e.prototype.invokeDebugLoggingIfEnabled=function(){return v.LogHelpers.isConsoleOutputEnabled()?this.invokeDebugLoggingBrowserSpecific():Promise.resolve(!1)},e.prototype.launchPopupAndWaitForClose=function(e){var t=this;return new Promise(function(n,r){var i,a=o.BrowserUtils.openPopupWindow(e),l=function(e){if(e.source===a){var n=void 0;try{n=JSON.parse(e.data)}catch(n){t.logger.logJsonParseUnexpected(e.data)}n&&(n[s.Constants.Urls.QueryParams.error]||n[s.Constants.Urls.QueryParams.errorDescription])&&(i={correlationId:n[s.Constants.Urls.QueryParams.correlationId],error:n[s.Constants.Urls.QueryParams.error],errorDescription:n[s.Constants.Urls.QueryParams.errorDescription]})}};window.addEventListener("message",l);var c=setInterval(function(){a&&!a.closed||(clearInterval(c),window.removeEventListener("message",l),i?r(i):n(!0))},100)})},e.prototype.logClipperInvoke=function(e,t){var n=new m.Event.BaseEvent(m.Event.Label.InvokeClipper);n.setCustomProperty(m.PropertyName.Custom.InvokeSource,S.InvokeSource[e.invokeSource]),n.setCustomProperty(m.PropertyName.Custom.InvokeMode,b.InvokeMode[t.invokeMode]),this.logger.logEvent(n)},e.prototype.registerTooltipToRenderInPageNav=function(e,t){this.pageNavUiCommunicator.registerFunction(s.Constants.FunctionKeys.getTooltipToRenderInPageNav,function(){return Promise.resolve(e)}),this.pageNavUiCommunicator.registerFunction(s.Constants.FunctionKeys.getPageNavTooltipProps,function(){return Promise.resolve(t)})},e.prototype.registerWhatsNewCommunicatorFunctions=function(e){this.registerTooltipToRenderInPageNav(p.TooltipType.WhatsNew,{updates:e})},e.prototype.registerTooltipCommunicatorFunctions=function(e){this.registerTooltipToRenderInPageNav(e)},e.prototype.sendInvokeOptionsToInject=function(e){this.injectCommunicator.callRemoteFunction(s.Constants.FunctionKeys.setInvokeOptions,{param:e})},e.prototype.setUpNoOpTrackers=function(e){var t=m.ErrorUtils.setNoOpTrackerRequestTimeout({label:m.NoOp.Label.InitializeCommunicator,channel:s.Constants.CommunicationChannels.injectedAndExtension,clientInfo:this.clientInfo,url:e},!0);this.injectCommunicator.callRemoteFunction(s.Constants.FunctionKeys.noOpTracker,{param:(new Date).getTime(),callback:function(){clearTimeout(t)}});var n=m.ErrorUtils.setNoOpTrackerRequestTimeout({label:m.NoOp.Label.InitializeCommunicator,channel:s.Constants.CommunicationChannels.extensionAndUi,clientInfo:this.clientInfo,url:e},!0);this.uiCommunicator.callRemoteFunction(s.Constants.FunctionKeys.noOpTracker,{param:(new Date).getTime(),callback:function(){clearTimeout(n)}})},e.prototype.doSignOutActionInFrontEnd=function(e){var t=this.getUserSessionIdQueryParamValue(),n=i.ClipperUrls.generateSignOutUrl(this.clientInfo.get().clipperId,t,c.AuthType[e]);this.uiCommunicator.callRemoteFunction(s.Constants.FunctionKeys.createHiddenIFrame,{param:n})},e.prototype.initializeCommunicators=function(){this.initializeDebugLoggingCommunicators(),this.initializeClipperCommunicators(),this.initializePageNavCommunicators()},e.prototype.initializeClipperCommunicators=function(){this.initializeClipperUiCommunicator(),this.initializeClipperInjectCommunicator()},e.prototype.initializeClipperUiCommunicator=function(){var e=this;this.uiCommunicator.broadcastAcrossCommunicator(this.auth.user,s.Constants.SmartValueKeys.user),this.uiCommunicator.broadcastAcrossCommunicator(this.clientInfo,s.Constants.SmartValueKeys.clientInfo),this.uiCommunicator.broadcastAcrossCommunicator(this.sessionId,s.Constants.SmartValueKeys.sessionId),this.uiCommunicator.registerFunction(s.Constants.FunctionKeys.clipperStrings,function(){return new Promise(function(t){e.getLocalizedStringsForBrowser(function(e){t(e)})})}),this.uiCommunicator.registerFunction(s.Constants.FunctionKeys.getStorageValue,function(t){return new Promise(function(n){var o=e.clipperData.getValue(t);n(o)})}),this.uiCommunicator.registerFunction(s.Constants.FunctionKeys.getMultipleStorageValues,function(t){return new Promise(function(n){for(var o={},r=0,i=t;r<i.length;r++){var a=i[r];o[a]=e.clipperData.getValue(a)}n(o)})}),this.uiCommunicator.registerFunction(s.Constants.FunctionKeys.setStorageValue,function(t){e.clipperData.setValue(t.key,t.value)}),this.uiCommunicator.registerFunction(s.Constants.FunctionKeys.getInitialUser,function(){return e.auth.updateUserInfoData(e.clientInfo.get().clipperId,c.UpdateReason.InitialRetrieval)}),this.uiCommunicator.registerFunction(s.Constants.FunctionKeys.signInUser,function(t){return e.doSignInAction(t).then(function(t){return e.auth.updateUserInfoData(e.clientInfo.get().clipperId,c.UpdateReason.SignInAttempt).then(function(n){if(!(n&&n.user||t)){var o={updateReason:c.UpdateReason.SignInCancel};return e.auth.user.set(o),Promise.resolve(o)}return Promise.resolve(n)})}).catch(function(t){return e.auth.user.set({updateReason:c.UpdateReason.SignInAttempt}),t.updateReason=c.UpdateReason.SignInAttempt,Promise.reject(t)})}),this.uiCommunicator.registerFunction(s.Constants.FunctionKeys.signOutUser,function(t){e.clientInfo.get().clipperType===r.ClientType.EdgeExtension?e.doSignOutActionInFrontEnd(t):e.doSignOutAction(t),e.auth.user.set({updateReason:c.UpdateReason.SignOutAction}),e.clipperData.setValue(y.ClipperStorageKeys.userInformation,void 0),e.clipperData.setValue(y.ClipperStorageKeys.currentSelectedSection,void 0),e.clipperData.setValue(y.ClipperStorageKeys.cachedNotebooks,void 0)}),this.uiCommunicator.registerFunction(s.Constants.FunctionKeys.telemetry,function(t){m.parseAndLogDataPackage(t,e.logger)}),this.uiCommunicator.registerFunction(s.Constants.FunctionKeys.ensureFreshUserBeforeClip,function(){return e.auth.updateUserInfoData(e.clientInfo.get().clipperId,c.UpdateReason.TokenRefreshForPendingClip)}),this.uiCommunicator.registerFunction(s.Constants.FunctionKeys.takeTabScreenshot,function(){return e.takeTabScreenshot()}),this.uiCommunicator.setErrorHandler(function(t){m.ErrorUtils.handleCommunicatorError(s.Constants.CommunicationChannels.extensionAndUi,t,e.clientInfo)})},e.prototype.initializeClipperInjectCommunicator=function(){var e=this;this.injectCommunicator.broadcastAcrossCommunicator(this.clientInfo,s.Constants.SmartValueKeys.clientInfo),this.injectCommunicator.registerFunction(s.Constants.FunctionKeys.unloadHandler,function(){e.tearDownCommunicators(),e.onUnloading()}),this.injectCommunicator.registerFunction(s.Constants.FunctionKeys.setStorageValue,function(t){e.clipperData.setValue(t.key,t.value)}),this.injectCommunicator.setErrorHandler(function(t){m.ErrorUtils.handleCommunicatorError(s.Constants.CommunicationChannels.injectedAndExtension,t,e.clientInfo)})},e.prototype.initializeDebugLoggingCommunicators=function(){var e=this;this.debugLoggingInjectCommunicator.registerFunction(s.Constants.FunctionKeys.unloadHandler,function(){e.tearDownCommunicators(),e.onUnloading()})},e.prototype.initializePageNavCommunicators=function(){this.initializePageNavUiCommunicator(),this.initializePageNavInjectCommunicator()},e.prototype.initializePageNavUiCommunicator=function(){var e=this;this.pageNavUiCommunicator.registerFunction(s.Constants.FunctionKeys.telemetry,function(t){m.parseAndLogDataPackage(t,e.logger)}),this.pageNavUiCommunicator.registerFunction(s.Constants.FunctionKeys.invokeClipperFromPageNav,function(t){e.closeAllFramesAndInvokeClipper({invokeSource:t},{invokeMode:b.InvokeMode.Default})})},e.prototype.initializePageNavInjectCommunicator=function(){var e=this;this.pageNavInjectCommunicator.registerFunction(s.Constants.FunctionKeys.telemetry,function(t){m.parseAndLogDataPackage(t,e.logger)}),this.pageNavInjectCommunicator.registerFunction(s.Constants.FunctionKeys.unloadHandler,function(){e.tearDownCommunicators(),e.onUnloading()})},e.prototype.registerLocalizedStringsForPageNav=function(){var e=this;return new Promise(function(t){e.getLocalizedStringsForBrowser(function(n){n&&e.pageNavUiCommunicator.registerFunction(s.Constants.FunctionKeys.clipperStringsFrontLoaded,function(){return Promise.resolve(n)}),t(!!n)})})},e.prototype.tearDownCommunicators=function(){this.uiCommunicator.tearDown(),this.pageNavUiCommunicator.tearDown(),this.injectCommunicator.tearDown(),this.pageNavInjectCommunicator.tearDown()},e.prototype.logDeviceIdMapEvent=function(){var e=this.clientInfo.get().clipperId,t=a.CookieUtils.readCookie("MicrosoftApplicationsTelemetryDeviceId");if(t!==e){var n=new m.Event.BaseEvent(m.Event.Label.DeviceIdMap);n.setCustomProperty(m.PropertyName.Custom.DeviceIdInStorage,e),n.setCustomProperty(m.PropertyName.Custom.DeviceIdInCookie,t),this.logger.logEvent(n)}},e}();n.ExtensionWorkerBase=w},{"../browserUtils":2,"../clientType":3,"../clipperUI/tooltipType":67,"../clipperUrls":68,"../communicator/communicator":69,"../communicator/smartValue":73,"../constants":74,"../cookieUtils":80,"../http/clipperCachedHttp":102,"../localization/localizationHelper":106,"../logging/log":108,"../logging/logHelpers":109,"../polyfills":125,"../settings":135,"../storage/clipperStorageKeys":138,"../userInfo":143,"./extensionBase":92,"./invokeOptions":95,"./invokeSource":96}],95:[function(e,t,n){"use strict";var o;!function(e){e[e.ContextImage=0]="ContextImage",e[e.ContextTextSelection=1]="ContextTextSelection",e[e.Default=2]="Default"}(o=n.InvokeMode||(n.InvokeMode={}))},{}],96:[function(e,t,n){"use strict";var o;!function(e){e[e.Bookmarklet=0]="Bookmarklet",e[e.ContextMenu=1]="ContextMenu",e[e.ExtensionButton=2]="ExtensionButton",e[e.WhatsNewTooltip=3]="WhatsNewTooltip",e[e.PdfTooltip=4]="PdfTooltip",e[e.ProductTooltip=5]="ProductTooltip",e[e.RecipeTooltip=6]="RecipeTooltip",e[e.VideoTooltip=7]="VideoTooltip"}(o=n.InvokeSource||(n.InvokeSource={}))},{}],97:[function(e,t,n){"use strict";var o=e("../constants"),r=e("../objectUtils"),i=e("../clipperUI/tooltipType"),a=e("../storage/clipperStorageKeys"),s=function(){function e(e){this.storage=e,this.validTypes=[i.TooltipType.Pdf,i.TooltipType.Product,i.TooltipType.Recipe,i.TooltipType.Video]}return e.prototype.getTooltipInformation=function(t,n){if(r.ObjectUtils.isNullOrUndefined(t)||r.ObjectUtils.isNullOrUndefined(n))throw new Error("Invalid argument passed to getTooltipInformation");var o=e.getStorageKeyForTooltip(t,n),i=this.storage.getValue(o),a=parseInt(i,10);return isNaN(a)?0:a},e.prototype.setTooltipInformation=function(t,n,o){if(r.ObjectUtils.isNullOrUndefined(t)||r.ObjectUtils.isNullOrUndefined(n))throw new Error("Invalid argument passed to setTooltipInformation");var i=e.getStorageKeyForTooltip(t,n);this.storage.setValue(i,o)},e.prototype.tooltipDelayIsOver=function(e,t){if(r.ObjectUtils.isNullOrUndefined(e)||r.ObjectUtils.isNullOrUndefined(t))throw new Error("Invalid argument passed to tooltipDelayIsOver");var n=this.getTooltipInformation(a.ClipperStorageKeys.lastClippedTooltipTimeBase,e);if(0!==n)return!1;var i=this.getTooltipInformation(a.ClipperStorageKeys.numTimesTooltipHasBeenSeenBase,e);if(i>=o.Constants.Settings.maximumNumberOfTimesToShowTooltips)return!1;this.getTooltipInformation(a.ClipperStorageKeys.lastSeenTooltipTimeBase,e);if(this.tooltipHasBeenSeenInLastTimePeriod(e,t,o.Constants.Settings.timeBetweenSameTooltip))return!1;var s=this.validTypes.indexOf(e),l=this.validTypes.slice();return l.splice(s,1),!this.hasAnyTooltipBeenSeenInLastTimePeriod(t,l,o.Constants.Settings.timeBetweenDifferentTooltips)},e.getStorageKeyForTooltip=function(e,t){if(r.ObjectUtils.isNullOrUndefined(e)||r.ObjectUtils.isNullOrUndefined(t))throw new Error("Invalid argument passed to getStorageKeyForTooltip");return e+i.TooltipType[t]},e.prototype.tooltipHasBeenSeenInLastTimePeriod=function(e,t,n){var o=this.getTooltipInformation(a.ClipperStorageKeys.lastSeenTooltipTimeBase,e);return 0!==o&&t-o<n},e.prototype.hasAnyTooltipBeenSeenInLastTimePeriod=function(e,t,n){var o=this;return t.some(function(t){var r=o.tooltipHasBeenSeenInLastTimePeriod(t,e,n);return r})},e}();n.TooltipHelper=s},{"../clipperUI/tooltipType":67,"../constants":74,"../objectUtils":123,"../storage/clipperStorageKeys":138}],98:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../logging/logger"),i=function(e){function t(t){var n=e.call(this)||this;return n.workers=t,n}return o(t,e),t.prototype.logEvent=function(e){for(var t=0,n=this.workers;t<n.length;t++){var o=n[t];o.getLogger().logEvent(e)}},t.prototype.pushToStream=function(e,t){for(var n=0,o=this.workers;n<o.length;n++){var r=o[n];r.getLogger().pushToStream(e,t)}},t.prototype.logFailure=function(e,t,n,o){for(var r=0,i=this.workers;r<i.length;r++){var a=i[r];a.getLogger().logFailure(e,t,n,o)}},t.prototype.logUserFunnel=function(e){for(var t=0,n=this.workers;t<n.length;t++){var o=n[t];o.getLogger().logUserFunnel(e)}},t.prototype.logSessionStart=function(){for(var e=0,t=this.workers;e<t.length;e++){var n=t[e];n.getLogger().logSessionStart()}},t.prototype.logSessionEnd=function(e){for(var t=0,n=this.workers;t<n.length;t++){var o=n[t];o.getLogger().logSessionEnd(e)}},t.prototype.logTrace=function(e,t,n){for(var o=0,r=this.workers;o<r.length;o++){var i=r[o];i.getLogger().logTrace(e,t,n)}},t.prototype.logClickEvent=function(e){for(var t=0,n=this.workers;t<n.length;t++){var o=n[t];o.getLogger().logClickEvent(e)}},t.prototype.setContextProperty=function(e,t){for(var n=0,o=this.workers;n<o.length;n++){var r=o[n];r.getLogger().setContextProperty(e,t)}},t}(r.Logger);n.WorkerPassthroughLogger=i},{"../logging/logger":110}],99:[function(e,t,n){"use strict";var o=function(){function e(){}return e.reconstructInstance=function(t,n){return e.tearDownCurrentInstance(),e.instance=new TextHighlighter(t,n),e.instance},e.tearDownCurrentInstance=function(){e.instance&&e.instance.disable()},e}();n.Highlighter=o},{}],100:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("./http"),i=e("../objectUtils"),a=e("../promiseUtils"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.get=function(t,n,o,i,s){var l=this;void 0===o&&(o=r.Http.defaultTimeout),void 0===i&&(i=[200]);var c=function(){return e.createAndSendRequest.call(l,"GET",t,n,i,o)};return a.PromiseUtils.execWithRetry(c,s)},t.post=function(t,n,o,s,l,c){var u=this;if(void 0===s&&(s=[200]),void 0===l&&(l=r.Http.defaultTimeout),i.ObjectUtils.isNullOrUndefined(n))throw new Error("data must be a non-undefined object, but was: "+n);var p=function(){return e.createAndSendRequest.call(u,"POST",t,o,s,l,n)};return a.PromiseUtils.execWithRetry(p,c)},t}(r.Http);n.HttpWithRetries=s},{"../objectUtils":123,"../promiseUtils":126,"./http":103}],101:[function(e,t,n){"use strict";var o=function(){function e(e){this.cache=e}return e.prototype.getFreshValue=function(t,n,o){if(!t)throw new Error("key must be a non-empty string, but was: "+t);if(!n)throw new Error("getRemoteValue must be non-undefined");o<0&&(o=0);var r=this.cache.getValue(t),i=!!r;if(i){var a=void 0;try{a=JSON.parse(r)}catch(e){return Promise.reject({error:e})}var s=e.valueHasExpired(a,o);if(!s)return Promise.resolve(a)}return this.getAndCacheRemoteValue(t,n)},e.prototype.getAndCacheRemoteValue=function(e,t){var n=this;if(!e)throw new Error("key must be a non-empty string, but was: "+e);if(!t)throw new Error("getRemoteValue must be non-undefined");return t().then(function(t){var o=n.setTimeStampedValue(e,t.parsedResponse);return o||n.cache.removeKey(e),Promise.resolve(o)}).catch(function(t){return n.cache.removeKey(e),Promise.reject(t)})},e.valueHasExpired=function(e,t){var n=e&&e.lastUpdated?e.lastUpdated:0;return Date.now()-n>=t},e.prototype.setTimeStampedValue=function(e,t){if(!e)throw new Error("key must be a non-empty string, but was: "+e);if(t){var n;try{n=JSON.parse(t)}catch(e){return}var o={data:n,lastUpdated:Date.now()};return this.cache.setValue(e,JSON.stringify(o)),o}},e}();n.CachedHttp=o},{}],102:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../constants"),i=e("../logging/log"),a=e("./cachedHttp"),s=function(e){function t(t,n){var o=e.call(this,t)||this;return o.logger=n,o}return o(t,e),t.prototype.setLogger=function(e){this.logger=e},t.getDefaultExpiry=function(){return t.defaultExpiry},t.prototype.getFreshValue=function(n,o,r){if(void 0===r&&(r=t.defaultExpiry),!n)return this.logger.logFailure(i.Failure.Label.InvalidArgument,i.Failure.Type.Unexpected,{error:"getFreshValue key parameter should be passed a non-empty string"},""+n),Promise.resolve(void 0);if(!o)return this.logger.logFailure(i.Failure.Label.InvalidArgument,i.Failure.Type.Unexpected,{error:"getFreshValue getRemoteValue parameter should be passed a non-undefined function"},""+o),Promise.resolve(void 0);r<0&&(this.logger.logFailure(i.Failure.Label.InvalidArgument,i.Failure.Type.Unexpected,{error:"getFreshValue updateInterval parameter should be passed a number >= 0"},""+r),r=0);var a=this.addLoggingToGetResponseAsync(n,o,r);return e.prototype.getFreshValue.call(this,n,a,r)},t.prototype.addLoggingToGetResponseAsync=function(e,n,o){var r=this;return function(){var a=new i.Event.PromiseEvent(i.Event.Label.FetchNonLocalData);return a.setCustomProperty(i.PropertyName.Custom.Key,e),a.setCustomProperty(i.PropertyName.Custom.UpdateInterval,o),new Promise(function(e,o){n().then(function(n){n.request&&t.addCorrelationIdToLogEvent(a,n.request),e(n)},function(e){a.setStatus(i.Status.Failed),a.setFailureInfo(e),o(e)}).then(function(){r.logger.logEvent(a)})})}},t.addCorrelationIdToLogEvent=function(e,t){var n=t.getResponseHeader(r.Constants.HeaderValues.correlationId);n&&e.setCustomProperty(i.PropertyName.Custom.CorrelationId,n)},t}(a.CachedHttp);s.defaultExpiry=432e5,n.ClipperCachedHttp=s},{"../constants":74,"../logging/log":108,"./cachedHttp":101}],103:[function(e,t,n){"use strict";var o=e("../objectUtils"),r=function(){function e(){}return e.get=function(t,n,o,r){return void 0===o&&(o=e.defaultTimeout),void 0===r&&(r=[200]),e.createAndSendRequest("GET",t,n,r,o)},e.post=function(t,n,r,i,a){if(void 0===i&&(i=[200]),void 0===a&&(a=e.defaultTimeout),o.ObjectUtils.isNullOrUndefined(n))throw new Error("data must be a non-undefined object, but was: "+n);return e.createAndSendRequest("POST",t,r,i,a,n)},e.createAndSendRequest=function(t,n,o,r,i,a){if(void 0===r&&(r=[200]),void 0===i&&(i=e.defaultTimeout),!n)throw new Error("url must be a non-empty string, but was: "+n);return new Promise(function(s,l){var c=new XMLHttpRequest;c.open(t,n),c.onload=function(){r.indexOf(c.status)>-1?s(c):l(OneNoteApi.ErrorUtils.createRequestErrorObject(c,OneNoteApi.RequestErrorType.UNEXPECTED_RESPONSE_STATUS))},c.onerror=function(){l(OneNoteApi.ErrorUtils.createRequestErrorObject(c,OneNoteApi.RequestErrorType.NETWORK_ERROR))},c.ontimeout=function(){l(OneNoteApi.ErrorUtils.createRequestErrorObject(c,OneNoteApi.RequestErrorType.REQUEST_TIMED_OUT))},e.setHeaders(c,o),c.timeout=i,c.send(a)})},e.setHeaders=function(e,t){if(t)for(var n in t)e.setRequestHeader(n,t[n])},e}();r.defaultTimeout=3e4,n.Http=r},{"../objectUtils":123}],104:[function(e,t,n){arguments[4][100][0].apply(n,arguments)},{"../objectUtils":123,"../promiseUtils":126,"./http":103,dup:100}],105:[function(e,t,n){"use strict";var o;!function(t){function n(e){if(!e)throw new Error("stringId must be a non-empty string, but was: "+e);if(l){var t=l[e];if(t)return t}var n=u[e];if(n)return n;throw new Error("getLocalizedString could not find a localized or fallback string: "+e)}function o(e){l=e}function r(e){return"font-family: "+i(e)+";"}function i(e){if(c[e])return c[e];var t="WebClipper.FontFamily."+s[e].toString(),o=n(t);return c[e]=a(o),c[e]}function a(e){if(!e)return"";for(var t=e.split(","),n=0;n<t.length;n++)t[n]=t[n].trim(),t[n].length>0&&t[n].indexOf(" ")>=0&&"'"!==t[n][0]&&"'"!==t[n][t.length-1]&&(t[n]="'"+t[n]+"'");return t.join(",")}var s;!function(e){e[e.Regular=0]="Regular",e[e.Bold=1]="Bold",e[e.Light=2]="Light",e[e.Semibold=3]="Semibold",e[e.Semilight=4]="Semilight"}(s=t.FontFamily||(t.FontFamily={}));var l,c={},u=e("../../strings.json");t.getLocalizedString=n,t.setLocalizedStrings=o,t.getFontFamilyAsStyle=r,t.getFontFamily=i,t.formatFontFamily=a}(o=n.Localization||(n.Localization={}))},{"../../strings.json":148}],106:[function(e,t,n){"use strict";var o=e("../constants"),r=e("../urlUtils"),i=e("../http/HttpWithRetries"),a=function(){function e(){}return e.makeLocStringsFetchRequest=function(e){var t=r.UrlUtils.addUrlQueryValue(o.Constants.Urls.localizedStringsUrlBase,"locale",e);return i.HttpWithRetries.get(t).then(function(e){return Promise.resolve({request:e,parsedResponse:e.responseText})})},e}();n.LocalizationHelper=a},{"../constants":74,"../http/HttpWithRetries":100,"../urlUtils":142}],107:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../constants"),i=e("./log"),a=e("./logger"),s=function(e){function t(t){var n=e.call(this)||this;return n.communicator=t,n}return o(t,e),t.prototype.logEvent=function(e){e.timerWasStopped()||e.stopTimer(),this.sendDataPackage(i.LogMethods.LogEvent,[e.getEventCategory(),e.getEventData()])},t.prototype.logFailure=function(e,t,n,o){this.sendDataPackage(i.LogMethods.LogFailure,arguments)},t.prototype.logUserFunnel=function(e){this.sendDataPackage(i.LogMethods.LogFunnel,arguments)},t.prototype.logSessionStart=function(){this.sendDataPackage(i.LogMethods.LogSessionStart,arguments)},t.prototype.logSessionEnd=function(e){this.sendDataPackage(i.LogMethods.LogSessionEnd,arguments)},t.prototype.logTrace=function(e,t,n){n?this.sendDataPackage(i.LogMethods.LogTrace,[e,t,n]):this.sendDataPackage(i.LogMethods.LogTrace,[e,t])},t.prototype.pushToStream=function(e,t){this.sendDataPackage(i.LogMethods.PushToStream,arguments)},t.prototype.logClickEvent=function(e){this.sendDataPackage(i.LogMethods.LogClickEvent,arguments)},t.prototype.setContextProperty=function(e,t){this.sendDataPackage(i.LogMethods.SetContextProperty,arguments)},t.prototype.sendDataPackage=function(e,t){
var n={methodName:e,methodArgs:Object.keys(t).map(function(e){return t[e]})};this.communicator.callRemoteFunction(r.Constants.FunctionKeys.telemetry,{param:n})},t}(a.Logger);n.CommunicatorLoggerPure=s},{"../constants":74,"./log":108,"./logger":110}],108:[function(e,t,n){"use strict";function o(e,t){switch(e.methodName){case i.LogMethods.LogEvent:var n=e.methodArgs[0],o=e.methodArgs[1];t.logEvent.apply(t,[r.Event.createEvent(n,o)]);break;case i.LogMethods.LogFailure:t.logFailure.apply(t,e.methodArgs);break;case i.LogMethods.PushToStream:t.pushToStream.apply(t,e.methodArgs);break;case i.LogMethods.LogFunnel:t.logUserFunnel.apply(t,e.methodArgs);break;case i.LogMethods.LogSessionStart:t.logSessionStart.apply(t,e.methodArgs);break;case i.LogMethods.LogSessionEnd:t.logSessionEnd.apply(t,e.methodArgs);break;case i.LogMethods.LogClickEvent:t.logClickEvent.apply(t,e.methodArgs);break;case i.LogMethods.SetContextProperty:t.setContextProperty.apply(t,e.methodArgs);break;case i.LogMethods.LogTrace:default:t.logTrace.apply(t,e.methodArgs)}}var r=e("./submodules/event"),i=e("./submodules/logMethods");n.contextPropertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_]){0,98}[a-zA-Z0-9])?$/,n.enableConsoleLogging="enable_console_logging",n.reportData="ReportData",n.unknownValue="unknown",n.parseAndLogDataPackage=o;var a=e("./submodules/click");n.Click=a.Click;var s=e("./submodules/context");n.Context=s.Context;var l=e("./submodules/errorUtils");n.ErrorUtils=l.ErrorUtils;var c=e("./submodules/event");n.Event=c.Event;var u=e("./submodules/failure");n.Failure=u.Failure;var p=e("./submodules/funnel");n.Funnel=p.Funnel;var d=e("./submodules/logMethods");n.LogMethods=d.LogMethods;var g=e("./submodules/noop");n.NoOp=g.NoOp;var f=e("./submodules/propertyName");n.PropertyName=f.PropertyName;var h=e("./submodules/session");n.Session=h.Session;var m=e("./submodules/status");n.Status=m.Status;var v=e("./submodules/trace");n.Trace=v.Trace},{"./submodules/click":111,"./submodules/context":112,"./submodules/errorUtils":113,"./submodules/event":114,"./submodules/failure":115,"./submodules/funnel":116,"./submodules/logMethods":117,"./submodules/noop":118,"./submodules/propertyName":119,"./submodules/session":120,"./submodules/status":121,"./submodules/trace":122}],109:[function(e,t,n){"use strict";var o,r=e("./log");!function(e){function t(e,t){var n={};n[r.PropertyName.Reserved.EventType]=r.reportData,n[r.PropertyName.Reserved.Label]=t;var o=r.PropertyName.Reserved.WebClipper+"."+e;return n[r.PropertyName.Reserved.Category]=o,n[r.PropertyName.Reserved.EventName]=o+"."+t,n}function n(t){if(!t)throw new Error("Button clicked without an ID! Logged with ID "+JSON.stringify(t));var n=e.createBaseEventAsJson(r.Click.category,t);return n}function o(t){t.timerWasStopped()||t.stopTimer();var n=t.getEventCategory(),o=e.createBaseEventAsJson(r.Event.Category[n],t.getLabel());switch(o[r.PropertyName.Reserved.Duration]=t.getDuration(),g(o,t.getCustomProperties()),n){case r.Event.Category.BaseEvent:break;case r.Event.Category.PromiseEvent:i(o,t);break;case r.Event.Category.StreamEvent:a(o,t);break;default:throw new Error("createLogEvent does not specify a case for event category: "+r.Event.Category[n])}return o}function i(e,t){var n=t.getStatus();e[r.PropertyName.Reserved.Status]=n,n===r.Status[r.Status.Failed]&&(e[r.PropertyName.Reserved.FailureInfo]=t.getFailureInfo(),e[r.PropertyName.Reserved.FailureType]=t.getFailureType())}function a(e,t){e[r.PropertyName.Reserved.Stream]=JSON.stringify(t.getEventData().Stream)}function s(t,n){var o=new r.Event.BaseEvent(r.Event.Label.SetContextProperty),i=e.createBaseEventAsJson(r.Event.Category[o.getEventCategory()],o.getLabel()),a=r.Context.toString(t);return i[r.PropertyName.Custom[r.PropertyName.Custom.Key]]=a,i[r.PropertyName.Custom[r.PropertyName.Custom.Value]]=n,i}function l(t,n,o,i){var a=e.createBaseEventAsJson(r.Failure.category,r.Failure.Label[t]);return a[r.PropertyName.Reserved.FailureType]=r.Failure.Type[n],o&&(a[r.PropertyName.Reserved.FailureInfo]=r.ErrorUtils.toString(o)),i&&(a[r.PropertyName.Reserved.Id]=i),a[r.PropertyName.Reserved.StackTrace]=r.Failure.getStackTrace(),a}function c(t){var n=e.createBaseEventAsJson(r.Funnel.category,r.Funnel.Label[t]);return n}function u(){var t=e.createBaseEventAsJson(r.Session.category,r.Session.State[r.Session.State.Started]);return t}function p(t){var n=e.createBaseEventAsJson(r.Session.category,r.Session.State[r.Session.State.Ended]);return n[r.PropertyName.Reserved.Trigger]=r.Session.EndTrigger[t],n}function d(t,n,o){var i=e.createBaseEventAsJson(r.Trace.category,r.Trace.Label[t]);switch(o&&(i[r.PropertyName.Reserved.Message]=o),i[r.PropertyName.Reserved.Level]=r.Trace.Level[n],n){case r.Trace.Level.Warning:i[r.PropertyName.Reserved.StackTrace]=r.Failure.getStackTrace()}return i}function g(e,t){if(e[r.PropertyName.Reserved.Status]===r.Status[r.Status.Failed]&&(e[r.PropertyName.Reserved.StackTrace]=r.Failure.getStackTrace()),t)for(var n in t)if(t.hasOwnProperty(n)){var o=void 0;o="object"==typeof t[n]?JSON.stringify(t[n]):t[n],e[n]=o}}function f(){try{if(localStorage.getItem(r.enableConsoleLogging))return!0}catch(e){}return!1}e.createBaseEventAsJson=t,e.createClickEventAsJson=n,e.createLogEventAsJson=o,e.createSetContextEventAsJson=s,e.createFailureEventAsJson=l,e.createFunnelEventAsJson=c,e.createSessionStartEventAsJson=u,e.createSessionEndEventAsJson=p,e.createTraceEventAsJson=d,e.addToLogEvent=g,e.isConsoleOutputEnabled=f}(o=n.LogHelpers||(n.LogHelpers={}))},{"./log":108}],110:[function(e,t,n){"use strict";var o=e("./log"),r=function(){function e(){}return e.prototype.logJsonParseUnexpected=function(e){this.logFailure(o.Failure.Label.JsonParse,o.Failure.Type.Unexpected,void 0,e)},e}();n.Logger=r},{"./log":108}],111:[function(e,t,n){"use strict";var o;!function(e){e.category="Click";var t;!function(e){e.regionSelectionRemoveButton="RegionSelectionRemoveButton",e.sectionComponent="SectionComponent",e.sectionPickerLocationContainer="SectionPickerLocationContainer"}(t=e.Label||(e.Label={}))}(o=n.Click||(n.Click={}))},{}],112:[function(e,t,n){"use strict";var o;!function(e){function t(e){return o[n[e]]}var n,o={AppInfoId:"AppInfo.Id",AppInfoVersion:"AppInfo.Version",DeviceInfoId:"DeviceInfo.Id",ExtensionLifecycleId:"ExtensionLifecycle.Id",SessionId:"Session.Id",UserInfoId:"UserInfo.Id",UserInfoLanguage:"UserInfo.Language",AuthType:"AuthType",BrowserLanguage:"BrowserLanguage",ClipperType:"ClipperType",ContentType:"ContentType",FlightInfo:"FlightInfo",InPrivateBrowsing:"InPrivateBrowsing",PageLanguage:"PageLanguage"};!function(e){e[e.AppInfoId=0]="AppInfoId",e[e.AppInfoVersion=1]="AppInfoVersion",e[e.ExtensionLifecycleId=2]="ExtensionLifecycleId",e[e.DeviceInfoId=3]="DeviceInfoId",e[e.SessionId=4]="SessionId",e[e.UserInfoId=5]="UserInfoId",e[e.UserInfoLanguage=6]="UserInfoLanguage",e[e.AuthType=7]="AuthType",e[e.BrowserLanguage=8]="BrowserLanguage",e[e.ClipperType=9]="ClipperType",e[e.ContentType=10]="ContentType",e[e.FlightInfo=11]="FlightInfo",e[e.InPrivateBrowsing=12]="InPrivateBrowsing",e[e.PageLanguage=13]="PageLanguage"}(n=e.Custom||(e.Custom={})),e.toString=t}(o=n.Context||(n.Context={}))},{}],113:[function(e,t,n){"use strict";var o,r=e("../../clientType"),i=e("../../constants"),a=e("../../objectUtils"),s=e("../../localization/localization"),l=e("../log");!function(e){function t(e){if(e){var t={};t[g[g.Error].toLowerCase()]=e.error;var n=e;return n&&void 0!==n.statusCode&&(t[g[g.StatusCode].toLowerCase()]=n.statusCode,t[g[g.Response].toLowerCase()]=n.response,t[g[g.ResponseHeaders].toLowerCase()]=n.responseHeaders,void 0!==n.timeout&&(t[g[g.Timeout].toLowerCase()]=n.timeout)),JSON.stringify(t)}}function n(e){if(e){var t=e;return t&&void 0!==t.statusCode?void 0!==t.timeout?{error:t.error,statusCode:t.statusCode,response:t.response,responseHeaders:t.responseHeaders,timeout:t.timeout}:{error:t.error,statusCode:t.statusCode,response:t.response,responseHeaders:t.responseHeaders}:{error:e.error}}}function o(t){var n={};n[i.Constants.Urls.QueryParams.failureType]=l.Failure.Type[t.properties.failureType],n[i.Constants.Urls.QueryParams.failureInfo]=e.toString(t.properties.failureInfo),n[i.Constants.Urls.QueryParams.stackTrace]=t.properties.stackTrace,a.ObjectUtils.isNullOrUndefined(t.properties.failureId)||(n[i.Constants.Urls.QueryParams.failureId]=t.properties.failureId);var o=t.clientInfo;d(n,o),LogManager.sendMiscLogRequest({label:l.Failure.Label[t.label],category:l.Failure.category,properties:n},!0)}function c(t,n,o,r){var i;throw i=r?JSON.stringify({message:r,error:n.toString()}):n.toString(),e.sendFailureLogRequest({label:l.Failure.Label.UnhandledExceptionThrown,properties:{failureType:l.Failure.Type.Unexpected,failureInfo:{error:i},failureId:"Channel "+t,stackTrace:l.Failure.getStackTrace(n)},clientInfo:o}),n}function u(e,t){void 0===t&&(t=!1);var n={};n[i.Constants.Urls.QueryParams.channel]=e.channel,n[i.Constants.Urls.QueryParams.timeoutInMs]=i.Constants.Settings.noOpTrackerTimeoutDuration.toString();var o=e.clientInfo;d(n,o),LogManager.sendMiscLogRequest({label:l.NoOp.Label[e.label],category:l.NoOp.category,properties:n},!0),t&&window&&window.alert(s.Localization.getLocalizedString("WebClipper.Error.NoOpError"))}function p(e,t){return void 0===t&&(t=!1),setTimeout(function(){u(e,t)},i.Constants.Settings.noOpTrackerTimeoutDuration)}function d(e,t){t&&(e[i.Constants.Urls.QueryParams.clientType]=a.ObjectUtils.isNullOrUndefined(t.get())?l.unknownValue:r.ClientType[t.get().clipperType],e[i.Constants.Urls.QueryParams.clipperVersion]=a.ObjectUtils.isNullOrUndefined(t.get())?l.unknownValue:t.get().clipperVersion,e[i.Constants.Urls.QueryParams.clipperId]=a.ObjectUtils.isNullOrUndefined(t.get())?l.unknownValue:t.get().clipperId)}var g;!function(e){e[e.Error=0]="Error",e[e.StatusCode=1]="StatusCode",e[e.Response=2]="Response",e[e.ResponseHeaders=3]="ResponseHeaders",e[e.Timeout=4]="Timeout"}(g||(g={})),e.toString=t,e.clone=n,e.sendFailureLogRequest=o,e.handleCommunicatorError=c,e.sendNoOpTrackerRequest=u,e.setNoOpTrackerRequestTimeout=p}(o=n.ErrorUtils||(n.ErrorUtils={}))},{"../../clientType":3,"../../constants":74,"../../localization/localization":105,"../../objectUtils":123,"../log":108}],114:[function(e,t,n){"use strict";var o,r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("../log"),a=e("../../objectUtils");!function(e){function t(t,n){switch(t){default:case e.Category.BaseEvent:return new e.BaseEvent(n);case e.Category.PromiseEvent:return new e.PromiseEvent(n);case e.Category.StreamEvent:return new e.StreamEvent(n)}}var n;!function(e){e[e.BaseEvent=0]="BaseEvent",e[e.PromiseEvent=1]="PromiseEvent",e[e.StreamEvent=2]="StreamEvent"}(n=e.Category||(e.Category={}));var o;!function(e){e[e.AddEmbeddedVideo=0]="AddEmbeddedVideo",e[e.AugmentationApiCall=1]="AugmentationApiCall",e[e.BookmarkPage=2]="BookmarkPage",e[e.CompressRegionSelection=3]="CompressRegionSelection",e[e.ClearNoOpTracker=4]="ClearNoOpTracker",e[e.Click=5]="Click",e[e.ClipAugmentationOptions=6]="ClipAugmentationOptions",e[e.ClipCommonOptions=7]="ClipCommonOptions",e[e.ClipPdfOptions=8]="ClipPdfOptions",e[e.ClipRegionOptions=9]="ClipRegionOptions",e[e.ClipSelectionOptions=10]="ClipSelectionOptions",e[e.ClipToOneNoteAction=11]="ClipToOneNoteAction",e[e.CloseClipper=12]="CloseClipper",e[e.ClosePageNavTooltip=13]="ClosePageNavTooltip",e[e.CreateNotebook=14]="CreateNotebook",e[e.CreatePage=15]="CreatePage",e[e.CreateSection=16]="CreateSection",e[e.DebugFeedback=17]="DebugFeedback",e[e.DeviceIdMap=18]="DeviceIdMap",e[e.FetchNonLocalData=19]="FetchNonLocalData",e[e.FullPageScreenshotCall=20]="FullPageScreenshotCall",e[e.GetBinaryRequest=21]="GetBinaryRequest",e[e.GetCleanDom=22]="GetCleanDom",e[e.GetExistingUserInformation=23]="GetExistingUserInformation",e[e.GetFlightingAssignments=24]="GetFlightingAssignments",e[e.GetLocale=25]="GetLocale",e[e.GetLocalizedStrings=26]="GetLocalizedStrings",e[e.GetNotebookByName=27]="GetNotebookByName",e[e.GetNotebooks=28]="GetNotebooks",e[e.GetPage=29]="GetPage",e[e.GetPageContent=30]="GetPageContent",e[e.GetPages=31]="GetPages",e[e.HandleSignInEvent=32]="HandleSignInEvent",e[e.HideClipperDueToSpaNavigate=33]="HideClipperDueToSpaNavigate",e[e.InvokeClipper=34]="InvokeClipper",e[e.InvokeTooltip=35]="InvokeTooltip",e[e.InvokeWhatsNew=36]="InvokeWhatsNew",e[e.LocalFilesNotAllowedPanelShown=37]="LocalFilesNotAllowedPanelShown",e[e.PagesSearch=38]="PagesSearch",e[e.PdfByteMetadata=39]="PdfByteMetadata",e[e.PdfDataUrlMetadata=40]="PdfDataUrlMetadata",e[e.ProcessPdfIntoDataUrls=41]="ProcessPdfIntoDataUrls",e[e.RegionSelectionCapturing=42]="RegionSelectionCapturing",e[e.RegionSelectionLoading=43]="RegionSelectionLoading",e[e.RegionSelectionProcessing=44]="RegionSelectionProcessing",e[e.RetrieveUserInformation=45]="RetrieveUserInformation",e[e.SendBatchRequest=46]="SendBatchRequest",e[e.SetContextProperty=47]="SetContextProperty",e[e.SetDoNotPromptRatings=48]="SetDoNotPromptRatings",e[e.ShouldShowRatingsPrompt=49]="ShouldShowRatingsPrompt",e[e.TooltipImpression=50]="TooltipImpression",e[e.UpdatePage=51]="UpdatePage",e[e.UserInfoUpdated=52]="UserInfoUpdated",e[e.WhatsNewImpression=53]="WhatsNewImpression"}(o=e.Label||(e.Label={}));var s=function(){function t(e){if(this._timerWasStopped=!1,this.isEventData(e)){var t=e;this._label=t.Label,this._duration=t.Duration,this._properties=t.Properties?JSON.parse(JSON.stringify(t.Properties)):void 0}else{var n=e;this._label=n,this.startTimer()}}return t.prototype.getDuration=function(){return this._duration},t.prototype.getEventCategory=function(){return e.Category.BaseEvent},t.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties()}},t.prototype.getLabel=function(){return e.Label[this._label]},t.prototype.getCustomProperties=function(){return this._properties?JSON.parse(JSON.stringify(this._properties)):void 0},t.prototype.setCustomProperty=function(e,t){if(this.isReservedPropertyName(e))throw new Error("Tried to overwrite key '"+i.PropertyName.Custom[e]+"' with value of "+JSON.stringify(t));this._properties||(this._properties={}),this._properties[i.PropertyName.Custom[e]]=t},t.prototype.startTimer=function(){this._startTime=(new Date).getTime()},t.prototype.stopTimer=function(){return!!this._startTime&&(this._duration=(new Date).getTime()-this._startTime,this._timerWasStopped=!0,!0)},t.prototype.timerWasStopped=function(){return this._timerWasStopped},t.prototype.isEventData=function(e){var t=e;return!(!t||a.ObjectUtils.isNullOrUndefined(t.Label))},t.prototype.isReservedPropertyName=function(e){for(var t in i.PropertyName.Reserved)if(i.PropertyName.Custom[e].toLowerCase()===t.toLowerCase())return!0;return!1},t}();e.BaseEvent=s;var l=function(t){function n(e){var n=t.call(this,e)||this;if(n._logStatus=i.Status.Succeeded,n._failureType=i.Failure.Type.Unexpected,n.isEventData(e)){var o=e;n._logStatus=o.LogStatus,n._failureType=o.FailureType,n._failureInfo=i.ErrorUtils.clone(o.FailureInfo)}return n}return r(n,t),n.prototype.getEventCategory=function(){return e.Category.PromiseEvent},n.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties(),LogStatus:this._logStatus,FailureType:this._failureType,FailureInfo:i.ErrorUtils.clone(this._failureInfo)}},n.prototype.getStatus=function(){return i.Status[this._logStatus]},n.prototype.setStatus=function(e){this._logStatus=e,this._timerWasStopped||this.stopTimer()},n.prototype.getFailureInfo=function(){return i.ErrorUtils.toString(this._failureInfo)},n.prototype.setFailureInfo=function(e){this._failureInfo=i.ErrorUtils.clone(e)},n.prototype.getFailureType=function(){return i.Failure.Type[this._failureType]},n.prototype.setFailureType=function(e){this._failureType=e},n}(s);e.PromiseEvent=l;var c=function(t){function n(e){var n=t.call(this,e)||this;if(n._stream=[],n.isEventData(e)){var o=e;n._stream=o.Stream}return n}return r(n,t),n.prototype.getEventCategory=function(){return e.Category.StreamEvent},n.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties(),Stream:this._stream}},n.prototype.append=function(e){this._stream.push(e)},n}(s);e.StreamEvent=c,e.createEvent=t}(o=n.Event||(n.Event={}))},{"../../objectUtils":123,"../log":108}],115:[function(e,t,n){"use strict";var o;!function(e){function t(e){return e||(e=new Error),e.stack}e.category="Failure";var n;!function(e){e[e.Unexpected=0]="Unexpected",e[e.Expected=1]="Expected"}(n=e.Type||(e.Type={})),e.getStackTrace=t;var o;!function(e){e[e.ClickedButtonWithNoId=0]="ClickedButtonWithNoId",e[e.EndSessionWithoutTrigger=1]="EndSessionWithoutTrigger",e[e.GetChangeLog=2]="GetChangeLog",e[e.GetComputedStyle=3]="GetComputedStyle",e[e.GetLocalizedString=4]="GetLocalizedString",e[e.GetSetting=5]="GetSetting",e[e.IFrameMessageHandlerHasNoOtherWindow=6]="IFrameMessageHandlerHasNoOtherWindow",e[e.InvalidArgument=7]="InvalidArgument",e[e.IsFeatureEnabled=8]="IsFeatureEnabled",e[e.JsonParse=9]="JsonParse",e[e.NotImplemented=10]="NotImplemented",e[e.OnLaunchOneNoteButton=11]="OnLaunchOneNoteButton",e[e.OrphanedWebClippersDueToExtensionRefresh=12]="OrphanedWebClippersDueToExtensionRefresh",e[e.RegionSelectionProcessing=13]="RegionSelectionProcessing",e[e.RenderFailurePanel=14]="RenderFailurePanel",e[e.ReservedPropertyOverwriteAttempted=15]="ReservedPropertyOverwriteAttempted",e[e.SessionAlreadySet=16]="SessionAlreadySet",e[e.SetLoggerNoop=17]="SetLoggerNoop",e[e.SetUndefinedLocalizedStrings=18]="SetUndefinedLocalizedStrings",e[e.TraceLevelErrorWarningMessage=19]="TraceLevelErrorWarningMessage",e[e.UnhandledApiCode=20]="UnhandledApiCode",e[e.UnhandledExceptionThrown=21]="UnhandledExceptionThrown",e[e.UserSetWithInvalidExpiredData=22]="UserSetWithInvalidExpiredData",e[e.WebExtensionWindowCreate=23]="WebExtensionWindowCreate",e[e.UnclippablePage=24]="UnclippablePage",e[e.UnsupportedBrowser=25]="UnsupportedBrowser"}(o=e.Label||(e.Label={}))}(o=n.Failure||(n.Failure={}))},{}],116:[function(e,t,n){"use strict";var o;!function(e){e.category="Funnel";var t;!function(e){e[e.Invoke=0]="Invoke",e[e.AuthAlreadySignedIn=1]="AuthAlreadySignedIn",e[e.AuthAttempted=2]="AuthAttempted",e[e.AuthSignInCompleted=3]="AuthSignInCompleted",e[e.AuthSignInFailed=4]="AuthSignInFailed",e[e.ClipAttempted=5]="ClipAttempted",e[e.Interact=6]="Interact",e[e.ViewInWac=7]="ViewInWac",e[e.SignOut=8]="SignOut"}(t=e.Label||(e.Label={}))}(o=n.Funnel||(n.Funnel={}))},{}],117:[function(e,t,n){"use strict";var o;!function(e){e[e.LogEvent=0]="LogEvent",e[e.LogFailure=1]="LogFailure",e[e.PushToStream=2]="PushToStream",e[e.LogFunnel=3]="LogFunnel",e[e.LogSession=4]="LogSession",e[e.LogSessionStart=5]="LogSessionStart",e[e.LogSessionEnd=6]="LogSessionEnd",e[e.LogTrace=7]="LogTrace",e[e.LogClickEvent=8]="LogClickEvent",e[e.SetContextProperty=9]="SetContextProperty"}(o=n.LogMethods||(n.LogMethods={}))},{}],118:[function(e,t,n){"use strict";var o;!function(e){e.category="NoOp";var t;!function(e){e[e.InitializeCommunicator=0]="InitializeCommunicator",e[e.WebClipperUiFrameDidNotExist=1]="WebClipperUiFrameDidNotExist",e[e.WebClipperUiFrameIsNotVisible=2]="WebClipperUiFrameIsNotVisible"}(t=e.Label||(e.Label={}))}(o=n.NoOp||(n.NoOp={}))},{}],119:[function(e,t,n){"use strict";var o;!function(e){var t;!function(e){e[e.AnnotationAdded=0]="AnnotationAdded",e[e.AugmentationModel=1]="AugmentationModel",e[e.AverageProcessingDurationPerPage=2]="AverageProcessingDurationPerPage",e[e.ByteLength=3]="ByteLength",e[e.BytesPerPdfPage=4]="BytesPerPdfPage",e[e.BytesTrimmed=5]="BytesTrimmed",e[e.Channel=6]="Channel",e[e.ClipMode=7]="ClipMode",e[e.CloseReason=8]="CloseReason",e[e.ContainsAtLeastOneHighlight=9]="ContainsAtLeastOneHighlight",e[e.ContentType=10]="ContentType",e[e.CorrelationId=11]="CorrelationId",e[e.CurrentPanel=12]="CurrentPanel",e[e.CurrentSectionStillExists=13]="CurrentSectionStillExists",e[e.DeviceIdInStorage=14]="DeviceIdInStorage",e[e.DeviceIdInCookie=15]="DeviceIdInCookie",e[e.DomSizeInBytes=16]="DomSizeInBytes",e[e.FeatureEnabled=17]="FeatureEnabled",e[e.FinalDataUrlLength=18]="FinalDataUrlLength",e[e.FontSize=19]="FontSize",e[e.ForceRetrieveFreshLocStrings=20]="ForceRetrieveFreshLocStrings",e[e.FreshUserInfoAvailable=21]="FreshUserInfoAvailable",e[e.FullPageScreenshotContentFound=22]="FullPageScreenshotContentFound",e[e.Height=23]="Height",e[e.InitialDataUrlLength=24]="InitialDataUrlLength",e[e.InvokeMode=25]="InvokeMode",e[e.InvokeSource=26]="InvokeSource",e[e.IsHighDpiScreen=27]="IsHighDpiScreen",e[e.IsRetryable=28]="IsRetryable",e[e.IsSerif=29]="IsSerif",e[e.Key=30]="Key",e[e.LastSeenTooltipTime=31]="LastSeenTooltipTime",e[e.LastUpdated=32]="LastUpdated",e[e.MaxDepth=33]="MaxDepth",e[e.NumPages=34]="NumPages",e[e.NumRegions=35]="NumRegions",e[e.NumTimesTooltipHasBeenSeen=36]="NumTimesTooltipHasBeenSeen",e[e.PageNavTooltipType=37]="PageNavTooltipType",e[e.PageTitleModified=38]="PageTitleModified",e[e.PdfAllPagesClipped=39]="PdfAllPagesClipped",e[e.PdfAttachmentClipped=40]="PdfAttachmentClipped",e[e.PdfFileSelectedPageCount=41]="PdfFileSelectedPageCount",e[e.PdfFileTotalPageCount=42]="PdfFileTotalPageCount",e[e.PdfIsBatched=43]="PdfIsBatched",e[e.PdfIsLocalFile=44]="PdfIsLocalFile",e[e.RatingsInfo=45]="RatingsInfo",e[e.ShouldShowRatingsPrompt=46]="ShouldShowRatingsPrompt",e[e.SignInCancelled=47]="SignInCancelled",e[e.StoredLocaleDifferentThanRequested=48]="StoredLocaleDifferentThanRequested",e[e.TimeToClearNoOpTracker=49]="TimeToClearNoOpTracker",e[e.TooltipType=50]="TooltipType",e[e.UpdateInterval=51]="UpdateInterval",e[e.UserInformationReturned=52]="UserInformationReturned",e[e.UserInformationStored=53]="UserInformationStored",e[e.UserUpdateReason=54]="UserUpdateReason",e[e.Value=55]="Value",e[e.Width=56]="Width",e[e.WriteableCookies=57]="WriteableCookies"}(t=e.Custom||(e.Custom={}));var n;!function(e){e.Category="Category",e.Duration="Duration",e.EventName="EventName",e.EventType="EventType",e.FailureInfo="FailureInfo",e.FailureType="FailureType",e.Id="Id",e.Label="Label",e.Level="Level",e.Message="Message",e.Properties="Properties",e.StackTrace="StackTrace",e.Status="Status",e.Stream="Stream",e.Trigger="Trigger",e.WebClipper="WebClipper"}(n=e.Reserved||(e.Reserved={}))}(o=n.PropertyName||(n.PropertyName={}))},{}],120:[function(e,t,n){"use strict";var o;!function(e){e.category="Session";var t;!function(e){e[e.SignOut=0]="SignOut",e[e.Unload=1]="Unload"}(t=e.EndTrigger||(e.EndTrigger={}));var n;!function(e){e[e.Started=0]="Started",e[e.Ended=1]="Ended"}(n=e.State||(e.State={}))}(o=n.Session||(n.Session={}))},{}],121:[function(e,t,n){"use strict";var o;!function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed"}(o=n.Status||(n.Status={}))},{}],122:[function(e,t,n){"use strict";var o;!function(e){e.category="Trace";var t;!function(e){e[e.DefaultingToConsoleLogger=0]="DefaultingToConsoleLogger",e[e.DebugMode=1]="DebugMode",e[e.RequestForClipperInstalledPageUrl=2]="RequestForClipperInstalledPageUrl",e[e.General=3]="General"}(t=e.Label||(e.Label={}));var n;!function(e){e[e.None=0]="None",e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Verbose=4]="Verbose"}(n=e.Level||(e.Level={}))}(o=n.Trace||(n.Trace={}))},{}],123:[function(e,t,n){"use strict";var o;!function(e){function t(e){return"number"==typeof e&&!isNaN(e)}function n(e){return null===e||void 0===e}e.isNumeric=t,e.isNullOrUndefined=n}(o=n.ObjectUtils||(n.ObjectUtils={}))},{}],124:[function(e,t,n){"use strict";var o;!function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed"}(o=n.OperationResult||(n.OperationResult={}))},{}],125:[function(e,t,n){"use strict";var o,r=e("es6-promise");!function(e){function t(){n(),o(),i(),a()}function n(){String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>n.length)&&(t=n.length),t-=e.length;var o=n.lastIndexOf(e,t);return o!==-1&&o===t})}function o(){"function"!=typeof Object.assign&&(Object.assign=function(e){if(!e)throw new TypeError("Cannot convert undefined to object");for(var t=Object(e),n=1;n<arguments.length;n++){var o=arguments[n];if(o)for(var r in o)o.hasOwnProperty(r)&&(t[r]=o[r])}return t})}function i(){"undefined"==typeof Promise&&r.polyfill()}function a(){window.requestAnimationFrame||(window.requestAnimationFrame=window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||function(e){setTimeout(function(){e(Date.now())},16)})}e.init=t}(o=n.Polyfills||(n.Polyfills={}))},{"es6-promise":149}],126:[function(e,t,n){"use strict";var o;!function(e){function t(e){return new Promise(function(t){setTimeout(function(){t()},e)})}function n(e,t){return void 0===t&&(t={retryCount:3,retryWaitTimeInMs:3e3}),e().catch(function(o){return t.retryCount>0?new Promise(function(o,r){setTimeout(function(){t.retryCount--,n(e,t).then(function(e){o(e)}).catch(function(e){r(e)})},t.retryWaitTimeInMs)}):Promise.reject(o)})}e.wait=t,e.execWithRetry=n}(o=n.PromiseUtils||(n.PromiseUtils={}))},{}],127:[function(e,t,n){"use strict";var o=e("../constants"),r=e("../clipperUI/frontEndGlobals"),i=e("../clipperUI/OneNoteApiUtils"),a=e("../logging/log"),s=function(){function e(e){this.api=e}return e.prototype.createNotebook=function(e){var t=this;return this.executeWithLogging(function(){return t.api.createNotebook(e)},a.Event.Label.CreateNotebook)},e.prototype.createPage=function(e,t){var n=this;return this.executeWithLogging(function(){return n.api.createPage(e,t)},a.Event.Label.CreatePage)},e.prototype.sendBatchRequest=function(e){var t=this;return this.executeWithLogging(function(){return t.api.sendBatchRequest(e)},a.Event.Label.SendBatchRequest)},e.prototype.getPage=function(e){var t=this;return this.executeWithLogging(function(){return t.api.getPage(e)},a.Event.Label.GetPage)},e.prototype.getPageContent=function(e){var t=this;return this.executeWithLogging(function(){return t.api.getPageContent(e)},a.Event.Label.GetPageContent)},e.prototype.getPages=function(e){var t=this;return this.executeWithLogging(function(){return t.api.getPages(e)},a.Event.Label.GetPages)},e.prototype.updatePage=function(e,t){var n=this;return this.executeWithLogging(function(){return n.api.updatePage(e,t)},a.Event.Label.UpdatePage)},e.prototype.createSection=function(e,t){var n=this;return this.executeWithLogging(function(){return n.api.createSection(e,t)},a.Event.Label.CreateSection)},e.prototype.getNotebooks=function(e){var t=this;return this.executeWithLogging(function(){return t.api.getNotebooks(e)},a.Event.Label.GetNotebooks)},e.prototype.getNotebooksWithExpandedSections=function(e,t){var n=this;return this.executeWithLogging(function(){return n.api.getNotebooksWithExpandedSections(e,t)},a.Event.Label.GetNotebooks)},e.prototype.getNotebookByName=function(e){var t=this;return this.executeWithLogging(function(){return t.api.getNotebookByName(e)},a.Event.Label.GetNotebookByName)},e.prototype.pagesSearch=function(e){var t=this;return this.executeWithLogging(function(){return t.api.pagesSearch(e)},a.Event.Label.PagesSearch)},e.prototype.executeWithLogging=function(e,t){return new Promise(function(n,s){var l=new a.Event.PromiseEvent(t);return e().then(function(e){l.setCustomProperty(a.PropertyName.Custom.CorrelationId,e.request.getResponseHeader(o.Constants.HeaderValues.correlationId)),n(e)},function(e){i.OneNoteApiUtils.logOneNoteApiRequestError(l,e),s(e)}).then(function(){r.Clipper.logger.logEvent(l)})})},e}();n.OneNoteApiWithLogging=s},{"../clipperUI/OneNoteApiUtils":4,"../clipperUI/frontEndGlobals":49,"../constants":74,"../logging/log":108}],128:[function(e,t,n){"use strict";var o=e("../promiseUtils"),r=function(){function e(e,t){void 0===t&&(t=3),this.api=e,this.maxRetries=t}return e.prototype.createNotebook=function(e){var t=this;return o.PromiseUtils.execWithRetry(function(){return t.api.createNotebook(e)})},e.prototype.createPage=function(e,t){var n=this;return o.PromiseUtils.execWithRetry(function(){return n.api.createPage(e,t)})},e.prototype.sendBatchRequest=function(e){var t=this;return o.PromiseUtils.execWithRetry(function(){return t.api.sendBatchRequest(e)})},e.prototype.getPage=function(e){var t=this;return o.PromiseUtils.execWithRetry(function(){return t.api.getPage(e)})},e.prototype.getPageContent=function(e){var t=this;return o.PromiseUtils.execWithRetry(function(){return t.api.getPageContent(e)})},e.prototype.getPages=function(e){var t=this;return o.PromiseUtils.execWithRetry(function(){return t.api.getPages(e)})},e.prototype.updatePage=function(e,t){var n=this;return o.PromiseUtils.execWithRetry(function(){return n.api.updatePage(e,t)})},e.prototype.createSection=function(e,t){var n=this;return o.PromiseUtils.execWithRetry(function(){return n.api.createSection(e,t)})},e.prototype.getNotebooks=function(e){var t=this;return o.PromiseUtils.execWithRetry(function(){return t.api.getNotebooks(e)})},e.prototype.getNotebooksWithExpandedSections=function(e,t){var n=this;return o.PromiseUtils.execWithRetry(function(){return n.api.getNotebooksWithExpandedSections(e,t)})},e.prototype.getNotebookByName=function(e){var t=this;return o.PromiseUtils.execWithRetry(function(){return t.api.getNotebookByName(e)})},e.prototype.pagesSearch=function(e){var t=this;return o.PromiseUtils.execWithRetry(function(){return t.api.pagesSearch(e)})},e}();n.OneNoteApiWithRetries=r},{"../promiseUtils":126}],129:[function(e,t,n){"use strict";var o=e("../constants"),r=e("../operationResult"),i=e("../stringUtils"),a=e("../urlUtils"),s=e("../clipperUI/clipMode"),l=e("../domParsers/domUtils"),c=e("../localization/localization"),u=e("./oneNoteSaveablePage"),p=e("./oneNoteSaveablePdf"),d=e("./oneNoteSaveablePdfSynchronousBatched"),g=e("lodash"),f=function(){function e(e){this.clipperState=e}return e.prototype.getSaveable=function(){var e=this,t=this.getInitialPage();return this.addAnnotation(t),this.addClippedFromUrlToPage(t),this.addPrimaryContent(t).then(function(){return e.pageToSaveable(t)})},e.prototype.getInitialPage=function(){var e=this.clipperState.previewGlobalInfo.previewTitleText;if(this.clipperState.currentMode.get()===s.ClipMode.Pdf&&this.clipperState.pdfPreviewInfo.shouldDistributePages){var t=this.getPageIndicesToSendInPdfMode()[0];e=i.StringUtils.getBatchedPageTitle(e,t)}return new OneNoteApi.OneNotePage(e,"",this.clipperState.pageInfo.contentLocale,this.getMetaData())},e.prototype.getMetaData=function(){if(this.clipperState.currentMode.get()===s.ClipMode.Augmentation&&this.clipperState.augmentationResult.data&&this.clipperState.augmentationResult.data.PageMetadata)return this.clipperState.augmentationResult.data.PageMetadata},e.prototype.addAnnotation=function(e){var t=this.clipperState.previewGlobalInfo.annotation;if(t&&t.length>0){var n='"'+t+'"',o=e.escapeHtmlEntities(n),r=this.createPostProcessessedHtml("<div>"+o+"</div>");e.addOnml(r.outerHTML)}},e.prototype.createPostProcessessedHtml=function(e){var t=document.createElement("div");t.innerHTML=l.DomUtils.cleanHtml(e);var n=this.clipperState.previewGlobalInfo.fontSize.toString()+"px",o=this.clipperState.previewGlobalInfo.serif?"WebClipper.FontFamily.Preview.SerifDefault":"WebClipper.FontFamily.Preview.SansSerifDefault",r=c.Localization.getLocalizedString(o),i="font-size: "+n+"; font-family: "+r+";";t.setAttribute("style",i);for(var a=t.getElementsByTagName("table"),s=0;s<a.length;s++){var u=a[s];u.setAttribute("style",i)}return this.stripUnwantedUIElements(t),t},e.prototype.stripUnwantedUIElements=function(e){for(;;){var t=e.querySelector("."+o.Constants.Classes.deleteHighlightButton);if(!t)break;t.parentNode.removeChild(t)}},e.prototype.addClippedFromUrlToPage=function(e){if(this.clipperState.currentMode.get()!==s.ClipMode.Bookmark){var t=c.Localization.getLocalizedString("WebClipper.FromCitation").replace("{0}",'<a href="'+this.clipperState.pageInfo.rawUrl+'">'+this.clipperState.pageInfo.rawUrl+"</a>"),n=this.createPostProcessessedHtml(t);
e.addOnml(n.outerHTML)}},e.prototype.addPrimaryContent=function(e){switch(this.clipperState.currentMode.get()){default:case s.ClipMode.Pdf:if(this.clipperState.pdfPreviewInfo.shouldAttachPdf&&this.clipperState.pdfResult.data.get().byteLength<o.Constants.Settings.maximumMimeSizeLimit)return this.addPdfAttachment(e);break;case s.ClipMode.FullPage:e.addHtml(this.clipperState.pageInfo.contentData);break;case s.ClipMode.Region:for(var t=0,n=this.clipperState.regionResult.data;t<n.length;t++){var r=n[t];e.addOnml('<p><img src="'+r+'" /></p>&nbsp;')}break;case s.ClipMode.Augmentation:var i=this.createPostProcessessedHtml(this.clipperState.augmentationPreviewInfo.previewBodyHtml);e.addOnml(i.outerHTML);break;case s.ClipMode.Bookmark:var a=this.createPostProcessessedHtml(this.clipperState.bookmarkPreviewInfo.previewBodyHtml);e.addOnml(a.outerHTML);break;case s.ClipMode.Selection:var l=this.createPostProcessessedHtml(this.clipperState.selectionPreviewInfo.previewBodyHtml);e.addOnml(l.outerHTML)}return Promise.resolve()},e.prototype.addPdfAttachment=function(e){var t=this,n=this.clipperState.pdfResult.data.get().pdf;return n.getData().then(function(n){if(n){var o=a.UrlUtils.getFileNameFromUrl(t.clipperState.pageInfo.rawUrl,"Original.pdf");e.addAttachment(n,o)}return Promise.resolve()})},e.prototype.pageToSaveable=function(e){var t=this;if(this.clipperState.currentMode.get()===s.ClipMode.Pdf){var n=this.clipperState.pdfResult.data.get().pdf,o=this.getPageIndicesToSendInPdfMode();return this.clipperState.pdfPreviewInfo.shouldDistributePages?n.getPageAsDataUrl(o[0]).then(function(r){return e.addOnml('<p><img src="'+r+'" /></p>&nbsp;'),new d.OneNoteSaveablePdfSynchronousBatched(e,n,o.slice(1),t.clipperState.pageInfo.contentLocale,t.clipperState.previewGlobalInfo.previewTitleText)}):Promise.resolve(new p.OneNoteSaveablePdf(e,n,o))}return Promise.resolve(new u.OneNoteSaveablePage(e))},e.prototype.getPageIndicesToSendInPdfMode=function(){var e=this.clipperState.pdfResult.data.get().pdf;if(this.clipperState.pdfPreviewInfo.allPages)return g.range(e.numPages());var t=i.StringUtils.parsePageRange(this.clipperState.pdfPreviewInfo.selectedPageRange,e.numPages());if(t.status!==r.OperationResult.Succeeded)throw new Error("User is clipping an invalid page range");var n=t.result;return n.map(function(e){return e-1})},e}();f.maxImagesPerPatchRequest=15,n.OneNoteSaveableFactory=f},{"../clipperUI/clipMode":13,"../constants":74,"../domParsers/domUtils":83,"../localization/localization":105,"../operationResult":124,"../stringUtils":141,"../urlUtils":142,"./oneNoteSaveablePage":130,"./oneNoteSaveablePdf":131,"./oneNoteSaveablePdfSynchronousBatched":132,lodash:150}],130:[function(e,t,n){"use strict";var o=function(){function e(e){this.page=e}return e.prototype.getPage=function(){return Promise.resolve(this.page)},e.prototype.getNumPages=function(){return 1},e.prototype.getPatch=function(e){return Promise.resolve(void 0)},e.prototype.getNumPatches=function(){return 0},e.prototype.getBatch=function(e){return Promise.resolve(void 0)},e.prototype.getNumBatches=function(){return 0},e}();n.OneNoteSaveablePage=o},{}],131:[function(e,t,n){"use strict";var o=e("../arrayUtils"),r=function(){function e(t,n,r,i){this.page=t,this.pdf=n,this.buckets=o.ArrayUtils.partition(r,e.maxImagesPerPatchRequest),this.pageData=i}return e.prototype.getPage=function(){return Promise.resolve(this.page)},e.prototype.getNumPages=function(){return 1},e.prototype.getPatch=function(e){return this.pdf.getPageListAsDataUrls(this.buckets[e]).then(this.createPatchRequestBody)},e.prototype.createPatchRequestBody=function(e){var t=[];return e.forEach(function(e){var n='<p><img src="'+e+'" /></p>&nbsp;';t.push({target:"body",action:"append",content:n})}),t},e.prototype.getNumPatches=function(){return this.buckets.length},e.prototype.getNumBatches=function(){return 0},e.prototype.getBatch=function(e){return Promise.resolve(void 0)},e}();r.maxImagesPerPatchRequest=15,n.OneNoteSaveablePdf=r},{"../arrayUtils":1}],132:[function(e,t,n){"use strict";var o=e("../stringUtils"),r=e("../objectUtils"),i=function(){function e(e,t,n,o,r){this.page=e,this.pdf=t,this.pageIndexes=n,this.contentLocale=o,this.titleText=r}return e.prototype.getPage=function(e){var t=this;if(r.ObjectUtils.isNullOrUndefined(e)||0===e)return Promise.resolve(this.page);var n=this.pageIndexes[e-1];return this.pdf.getPageAsDataUrl(n).then(function(e){return t.createPage(e,n)})},e.prototype.createPage=function(e,t){var n=o.StringUtils.getBatchedPageTitle(this.titleText,t),r=new OneNoteApi.OneNotePage(n,"",this.contentLocale);return r.addOnml('<p><img src="'+e+'" /></p>&nbsp;'),r},e.prototype.getNumPages=function(){return this.pageIndexes.length+1},e.prototype.getNumPatches=function(){return 0},e.prototype.getPatch=function(e){return Promise.resolve(void 0)},e.prototype.getNumBatches=function(){return 0},e.prototype.getBatch=function(e){return Promise.resolve(void 0)},e}();n.OneNoteSaveablePdfSynchronousBatched=i},{"../objectUtils":123,"../stringUtils":141}],133:[function(e,t,n){"use strict";var o=e("../constants"),r=e("../promiseUtils"),i=e("../settings"),a=e("../clipperUI/frontEndGlobals"),s=e("../storage/clipperStorageKeys"),l=e("../logging/log"),c=e("./oneNoteApiWithLogging"),u=e("./oneNoteApiWithRetries"),p=e("lodash"),d=function(){function e(e){this.accessToken=e}return e.prototype.save=function(e){var t=this;return e.page.getNumPages()>1?this.saveMultiplePagesSynchronously(e):e.page.getNumPatches()>0?this.rejectIfNoPatchPermissions(e.saveLocation).then(function(){return t.saveWithoutCheckingPatchPermissions(e)}):this.saveWithoutCheckingPatchPermissions(e)},e.prototype.saveMultiplePagesSynchronously=function(e){var t=this,n=e.progressCallback?e.progressCallback:function(){};return n(0,e.page.getNumPages()),e.page.getPage().then(function(o){return t.getApi().createPage(o,e.saveLocation).then(function(o){return t.synchronouslyCreateMultiplePages(e,n).then(function(){return Promise.resolve(o)})})})},e.prototype.synchronouslyCreateMultiplePages=function(t,n){var o=this;void 0===n&&(n=function(){});var i=t.page,a=i.getNumPages();return p.range(1,a).reduce(function(s,l){return s=s.then(function(){return new Promise(function(s,c){var u=o.getPageWithLogging(i,l),p=r.PromiseUtils.wait(e.timeBetweenPostRequests);Promise.all([u,p]).then(function(e){var r=e[0];o.getApi().createPage(r,t.saveLocation).then(function(){n(l,a),s()}).catch(function(e){c(e)})})})})},Promise.resolve())},e.prototype.rejectIfNoPatchPermissions=function(e){var t=this;return new Promise(function(n,o){a.Clipper.getStoredValue(s.ClipperStorageKeys.hasPatchPermissions,function(r){r?n():t.getApi().getPages({top:1,sectionId:e}).then(function(){a.Clipper.storeValue(s.ClipperStorageKeys.hasPatchPermissions,"true"),n()}).catch(function(e){o(e)})})})},e.prototype.saveWithoutCheckingPatchPermissions=function(e){var t=this;return e.page.getPage().then(function(n){return t.getApi().createPage(n,e.saveLocation).then(function(n){if(e.page.getNumPatches()>0){var o=n.parsedResponse.id;return t.patch(o,e.page).then(function(){return Promise.resolve(n)})}return e.page.getNumBatches()>0?t.batch(e.page).then(function(){return Promise.resolve(n)}):Promise.resolve(n)})})},e.prototype.batch=function(t){var n=this,o=e.timeBeforeFirstBatch;return p.range(t.getNumBatches()).reduce(function(e,i){return e=e.then(function(){return new Promise(function(e,a){var s=n.getBatchWithLogging(t,i),l=r.PromiseUtils.wait(o);Promise.all([s,l]).then(function(t){var o=t[0];n.getApi().sendBatchRequest(o).then(function(){e()}).catch(function(e){a(e)})})})})},Promise.resolve())},e.prototype.patch=function(t,n){var i=this,s=e.timeBeforeFirstPatch;return Promise.all([p.range(n.getNumPatches()).reduce(function(l,c){return l=l.then(function(){return new Promise(function(l,u){var p=i.getPatchWithLogging(n,c),d=r.PromiseUtils.wait(s);Promise.all([p,d]).then(function(n){var r=n[0],c=function(){s=e.timeBetweenPatchRequests,l()},p=function(e){401===e.statusCode?a.Clipper.getExtensionCommunicator().callRemoteFunction(o.Constants.FunctionKeys.ensureFreshUserBeforeClip,{callback:function(n){n.user.accessToken?(i.accessToken=n.user.accessToken,i.updatePage(t,r,c,p)):u(e)}}):u(e)};i.updatePage(t,r,c,p)})})})},this.getApi().getPageContent(t))])},e.prototype.updatePage=function(e,t,n,o){this.getApi().updatePage(e,t).then(n).catch(o)},e.prototype.getPatchWithLogging=function(e,t){var n=new l.Event.PromiseEvent(l.Event.Label.ProcessPdfIntoDataUrls);return e.getPatch(t).then(function(e){n.stopTimer();var t=e.length;if(n.setCustomProperty(l.PropertyName.Custom.NumPages,t),e.length>0){var o=p.sumBy(e,function(e){return e.content.length});n.setCustomProperty(l.PropertyName.Custom.ByteLength,o),n.setCustomProperty(l.PropertyName.Custom.BytesPerPdfPage,o/t),n.setCustomProperty(l.PropertyName.Custom.AverageProcessingDurationPerPage,n.getDuration()/t)}return a.Clipper.logger.logEvent(n),Promise.resolve(e)})},e.prototype.getPageWithLogging=function(e,t){var n=new l.Event.PromiseEvent(l.Event.Label.ProcessPdfIntoDataUrls);return e.getPage(t).then(function(e){n.stopTimer();var t=1;n.setCustomProperty(l.PropertyName.Custom.NumPages,t);var o=e.getEntireOnml().length;return n.setCustomProperty(l.PropertyName.Custom.ByteLength,o),n.setCustomProperty(l.PropertyName.Custom.BytesPerPdfPage,o/t),n.setCustomProperty(l.PropertyName.Custom.AverageProcessingDurationPerPage,n.getDuration()/t),a.Clipper.logger.logEvent(n),Promise.resolve(e)})},e.prototype.getBatchWithLogging=function(e,t){var n=new l.Event.PromiseEvent(l.Event.Label.ProcessPdfIntoDataUrls);return e.getBatch(t).then(function(e){n.stopTimer();var t=e.getNumOperations();if(n.setCustomProperty(l.PropertyName.Custom.NumPages,t),t>0){var o=p.range(t).map(function(t){return e.getOperation(t)}),r=p.sumBy(o,function(e){return e.content.length});n.setCustomProperty(l.PropertyName.Custom.ByteLength,r),n.setCustomProperty(l.PropertyName.Custom.BytesPerPdfPage,r/t),n.setCustomProperty(l.PropertyName.Custom.AverageProcessingDurationPerPage,n.getDuration()/t)}return a.Clipper.logger.logEvent(n),Promise.resolve(e)})},e.prototype.getApi=function(){var e={};e[o.Constants.HeaderValues.appIdKey]=i.Settings.getSetting("App_Id"),e[o.Constants.HeaderValues.userSessionIdKey]=a.Clipper.getUserSessionId();var t=new OneNoteApi.OneNoteApi(this.accessToken,void 0,e),n=new u.OneNoteApiWithRetries(t);return new c.OneNoteApiWithLogging(n)},e}();d.timeBeforeFirstPatch=1e3,d.timeBetweenPatchRequests=7e3,d.timeBeforeFirstBatch=1e3,d.timeBetweenBatchRequests=7e3,d.timeBeforeFirstPost=1e3,d.timeBetweenPostRequests=0,n.SaveToOneNote=d},{"../clipperUI/frontEndGlobals":49,"../constants":74,"../logging/log":108,"../promiseUtils":126,"../settings":135,"../storage/clipperStorageKeys":138,"./oneNoteApiWithLogging":127,"./oneNoteApiWithRetries":128,lodash:150}],134:[function(e,t,n){"use strict";var o=e("../logging/log"),r=e("../constants"),i=e("../stringUtils"),a=e("../clipperUI/clipMode"),s=e("../clipperUI/frontEndGlobals"),l=e("../contentCapture/augmentationHelper"),c=e("../domParsers/domUtils"),u=function(){function e(){}return e.logClip=function(t){e.logCommonClipModifications(t),e.logClipModeSpecific(t)},e.logCommonClipModifications=function(e){var t=new o.Event.BaseEvent(o.Event.Label.ClipCommonOptions);t.setCustomProperty(o.PropertyName.Custom.ClipMode,a.ClipMode[e.currentMode.get()]),t.setCustomProperty(o.PropertyName.Custom.PageTitleModified,e.pageInfo.contentTitle!==e.previewGlobalInfo.previewTitleText),t.setCustomProperty(o.PropertyName.Custom.AnnotationAdded,!!e.previewGlobalInfo.annotation),s.Clipper.logger.logEvent(t)},e.logClipModeSpecific=function(t){switch(t.currentMode.get()){default:case a.ClipMode.Pdf:e.logPdfClip(t);break;case a.ClipMode.FullPage:break;case a.ClipMode.Region:e.logRegionClip(t);break;case a.ClipMode.Augmentation:e.logAugmentationClip(t);break;case a.ClipMode.Bookmark:break;case a.ClipMode.Selection:e.logSelectionClip(t)}},e.logPdfClip=function(t){e.logPdfClipOptions(t),e.logPdfByteMetadata(t)},e.logPdfClipOptions=function(e){var t=new o.Event.BaseEvent(o.Event.Label.ClipPdfOptions),n=e.pdfPreviewInfo;t.setCustomProperty(o.PropertyName.Custom.PdfAllPagesClipped,n.allPages),t.setCustomProperty(o.PropertyName.Custom.PdfAttachmentClipped,n.shouldAttachPdf),t.setCustomProperty(o.PropertyName.Custom.PdfIsLocalFile,0===e.pageInfo.rawUrl.indexOf("file:///")),t.setCustomProperty(o.PropertyName.Custom.PdfIsBatched,n.shouldDistributePages);var r=e.pdfResult.data.get().viewportDimensions.length,a=n.allPages?r:Math.min(r,i.StringUtils.countPageRange(n.selectedPageRange));t.setCustomProperty(o.PropertyName.Custom.PdfFileSelectedPageCount,a),t.setCustomProperty(o.PropertyName.Custom.PdfFileTotalPageCount,r),s.Clipper.logger.logEvent(t)},e.logPdfByteMetadata=function(e){var t=new o.Event.BaseEvent(o.Event.Label.PdfByteMetadata),n=e.pdfResult.data.get().byteLength;t.setCustomProperty(o.PropertyName.Custom.ByteLength,n),t.setCustomProperty(o.PropertyName.Custom.BytesPerPdfPage,n/e.pdfResult.data.get().pdf.numPages()),s.Clipper.logger.logEvent(t)},e.logRegionClip=function(e){var t=new o.Event.BaseEvent(o.Event.Label.ClipRegionOptions);t.setCustomProperty(o.PropertyName.Custom.NumRegions,e.regionResult.data.length),s.Clipper.logger.logEvent(t)},e.logAugmentationClip=function(t){var n=new o.Event.BaseEvent(o.Event.Label.ClipAugmentationOptions);e.setEditOptions(n,t.previewGlobalInfo,t.augmentationPreviewInfo),n.setCustomProperty(o.PropertyName.Custom.AugmentationModel,l.AugmentationModel[t.augmentationResult.data.ContentModel]),s.Clipper.logger.logEvent(n)},e.logSelectionClip=function(t){var n=new o.Event.BaseEvent(o.Event.Label.ClipSelectionOptions);e.setEditOptions(n,t.previewGlobalInfo,t.selectionPreviewInfo),s.Clipper.logger.logEvent(n)},e.setEditOptions=function(e,t,n){e.setCustomProperty(o.PropertyName.Custom.FontSize,t.fontSize),e.setCustomProperty(o.PropertyName.Custom.IsSerif,t.serif);var i=document.createElement("div");i.innerHTML=c.DomUtils.cleanHtml(n.previewBodyHtml);var a=i.getElementsByClassName(r.Constants.Classes.highlighted);e.setCustomProperty(o.PropertyName.Custom.ContainsAtLeastOneHighlight,a&&a.length>0)},e}();n.SaveToOneNoteLogger=u},{"../clipperUI/clipMode":13,"../clipperUI/frontEndGlobals":49,"../constants":74,"../contentCapture/augmentationHelper":75,"../domParsers/domUtils":83,"../logging/log":108,"../stringUtils":141}],135:[function(e,t,n){"use strict";var o,r=e("../settings.json");!function(t){function n(e){var t=r[e];if(t&&t.Value)return t.Value}function o(t){r=t?t:e("../settings.json")}t.getSetting=n,t.setSettingsJsonForTesting=o}(o=n.Settings||(n.Settings={}))},{"../settings.json":147}],136:[function(e,t,n){"use strict";var o=e("../http/clipperCachedHttp"),r=e("./clipperStorageGateStrategy"),i=function(){function e(e,t){this.storage=e,this.storageGateStrategy=new r.ClipperStorageGateStrategy(e),this.cachedHttp=new o.ClipperCachedHttp(this,t)}return e.prototype.setLogger=function(e){this.cachedHttp.setLogger(e)},e.prototype.getFreshValue=function(e,t,n){return this.cachedHttp.getFreshValue(e,t,n)},e.prototype.getValue=function(e){return this.storage.getValue(e)},e.prototype.getValues=function(e){return this.storage.getValues(e)},e.prototype.setValue=function(e,t){this.storageGateStrategy.shouldSet(e,t)&&this.storage.setValue(e,t)},e.prototype.removeKey=function(e){return this.storage.removeKey(e)},e}();n.ClipperData=i},{"../http/clipperCachedHttp":102,"./clipperStorageGateStrategy":137}],137:[function(e,t,n){"use strict";var o=e("./clipperStorageKeys"),r=function(){function e(e){this.keysThatRequireUserInfo=[o.ClipperStorageKeys.cachedNotebooks,o.ClipperStorageKeys.currentSelectedSection],this.storage=e}return e.prototype.shouldSet=function(e,t){if(t&&this.keysThatRequireUserInfo.indexOf(e)>-1){var n=this.storage.getValue(o.ClipperStorageKeys.userInformation);return!!n}return!0},e}();n.ClipperStorageGateStrategy=r},{"./clipperStorageKeys":138}],138:[function(e,t,n){"use strict";var o;!function(e){e.clipperId="clipperId",e.cachedNotebooks="notebooks",e.currentSelectedSection="curSection",e.displayLanguageOverride="displayLocaleOverride",e.doNotPromptRatings="doNotPromptRatings",e.flightingInfo="flightingInfo",e.hasPatchPermissions="hasPatchPermissions",e.lastBadRatingDate="lastBadRatingDate",e.lastBadRatingVersion="lastBadRatingVersion",e.lastClippedDate="lastClippedDate",e.lastSeenVersion="lastSeenVersion",e.lastInvokedDate="lastInvokedDate",e.lastSeenTooltipTimeBase="lastSeenTooltipTime",e.lastClippedTooltipTimeBase="lastClippedTooltipTime",e.locale="locale",e.locStrings="locStrings",e.numSuccessfulClips="numSuccessfulClips",e.numSuccessfulClipsRatingsEnablement="numSuccessfulClipsRatingsEnablement",e.numTimesTooltipHasBeenSeenBase="numTimesTooltipHasBeenSeen",e.userInformation="userInformation"}(o=n.ClipperStorageKeys||(n.ClipperStorageKeys={}))},{}],139:[function(e,t,n){"use strict";var o=function(){function e(){}return e.prototype.getValue=function(e){var t;return window.localStorage&&(t=window.localStorage.getItem(e),t||this.removeKey(e)),t},e.prototype.getValues=function(e){var t={};if(window.localStorage&&e)for(var n=0;n<e.length;n++){var o=window.localStorage.getItem(e[n]);o?t[e[n]]=o:this.removeKey(e[n])}return t},e.prototype.setValue=function(e,t){window.localStorage&&(t?window.localStorage.setItem(e,t):window.localStorage.removeItem(e))},e.prototype.removeKey=function(e){return window.localStorage&&window.localStorage.removeItem(e),!0},e}();n.LocalStorage=o},{}],140:[function(e,t,n){"use strict";var o=e("../constants"),r=function(){function e(e){this.storageCache={},this.extensionCommunicator=e}return e.prototype.getCachedValue=function(e){return this.storageCache[e]},e.prototype.getValue=function(e,t,n){var r=this;this.extensionCommunicator.callRemoteFunction(o.Constants.FunctionKeys.getStorageValue,{param:e,callback:function(o){n&&(r.storageCache[e]=o),t(o)}})},e.prototype.getValues=function(e,t,n){var r=this;this.extensionCommunicator.callRemoteFunction(o.Constants.FunctionKeys.getMultipleStorageValues,{param:e,callback:function(e){if(n)for(var o in e)e.hasOwnProperty(o)&&(r.storageCache[o]=e[o]);t(e)}})},e.prototype.setValue=function(e,t,n){e in this.storageCache&&(this.storageCache[e]=t),this.extensionCommunicator.callRemoteFunction(o.Constants.FunctionKeys.setStorageValue,{param:{key:e,value:t},callback:function(e){n&&n(e)}})},e}();n.RemoteStorage=r},{"../constants":74}],141:[function(e,t,n){"use strict";var o,r=e("./objectUtils"),i=e("./operationResult"),a=e("./localization/localization"),s=e("lodash");!function(e){function t(e,t){if(r.ObjectUtils.isNullOrUndefined(e))return o("");if(e=e.trim(),""===e)return o("");for(var i=e.split(","),a=[],l=0;l<i.length;++l){var c=[],u=void 0,p=i[l].trim();if(""!==p){if(/^\d+$/.test(p)){var d=parseInt(p,10);if(0===d||!r.ObjectUtils.isNullOrUndefined(t)&&d>t)return o(p);c=[d]}else{if(!(u=/^(\d+)\s*-\s*(\d+)$/.exec(p)))return o(p);var g=parseInt(u[1],10),f=parseInt(u[2],10),h=4294967295;if(g>=f||0===g||0===f||g>=h||f>=h||f-g+1>h||!r.ObjectUtils.isNullOrUndefined(t)&&f>t)return o(p);c=s.range(g,f+1)}a=a.concat(c)}}var m=s(a).sortBy().sortedUniq().value();if(0===m.length)return o(e);var v=s.last(m);return!r.ObjectUtils.isNullOrUndefined(t)&&v>t?o(v.toString()):n(m)}function n(e){return{status:i.OperationResult.Succeeded,result:e}}function o(e){return{status:i.OperationResult.Failed,result:e}}function l(e){var n=t(e);if(n.status!==i.OperationResult.Succeeded)return 0;var o=n.result;return o?o.length:0}function c(e,t){var n=(t+1).toString();return e+": "+a.Localization.getLocalizedString("WebClipper.Label.Page")+" "+n}function u(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"===e?t:3&t|8;return n.toString(16)})}e.parsePageRange=t,e.countPageRange=l,e.getBatchedPageTitle=c,e.generateGuid=u}(o=n.StringUtils||(n.StringUtils={}))},{"./localization/localization":105,"./objectUtils":123,"./operationResult":124,lodash:150}],142:[function(e,t,n){"use strict";var o,r=e("./objectUtils"),i=e("./settings"),a=e("./clipperUI/tooltipType");!function(e){function t(e,t){for(var n=0;n<t.length;++n){var o=t[n],r=a.TooltipType[o],s=i.Settings.getSetting(r+"Domains"),l=new RegExp(s.join("|"),"i");if(l.test(e))return o}}function n(e,t){if(!e)return t;var n=/\/(?=[^\/]+\.\w{3,4}$).+/g.exec(e);return n&&n[0]?n[0].slice(1):t}function o(e){var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.host+"/"}function s(e){var t=document.createElement("a");t.href=e;var n=t.pathname;return l(n)}function l(e){return e=r.ObjectUtils.isNullOrUndefined(e)?"/":e,e.length>0&&"/"===e.charAt(0)?e:"/"+e}function c(e,t){if(e&&t){var n=t.replace(/[\[\]]/g,"\\$&"),o=new RegExp("[?&]"+n+"(=([^&#]*)|&|#|$)","i"),r=o.exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""}}function u(e,t,n,o){if(void 0===o&&(o=!1),!e||!t||!n)return e;o&&(t=t.charAt(0).toUpperCase()+t.slice(1));var r=e.match(/^([^#]*)(#.*)?$/),i=r[1],a=r[2]?r[2]:"",s=i.indexOf("?");if(s===-1)return i+"?"+t+"="+n+a;if(s===i.length-1)return i+t+"="+n+a;for(var l=i.substring(s+1).split("&"),c=0;c<l.length;c++){var u=l[c].split("=");if(u[0]===t)return l[c]=u[0]+"="+n,i.substring(0,s+1)+l.join("&")+a}return i+"&"+t+"="+n+a}function p(e){return g(e,["PageNav_BlacklistedDomains"])}function d(e){return g(e,["AugmentationDefault_WhitelistedDomains","ProductDomains","RecipeDomains"])}function g(e,t){if(!e)return!1;var n=[];t.forEach(function(e){n=n.concat(i.Settings.getSetting(e))});for(var o=0,r=n;o<r.length;o++){var a=r[o];if(new RegExp(a).test(e))return!0}return!1}e.checkIfUrlMatchesAContentType=t,e.getFileNameFromUrl=n,e.getHostname=o,e.getPathname=s,e.getQueryValue=c,e.addUrlQueryValue=u,e.onBlacklistedDomain=p,e.onWhitelistedDomain=d}(o=n.UrlUtils||(n.UrlUtils={}))},{"./clipperUI/tooltipType":67,"./objectUtils":123,"./settings":135}],143:[function(e,t,n){"use strict";var o;!function(e){e[e.Msa=0]="Msa",e[e.OrgId=1]="OrgId"}(o=n.AuthType||(n.AuthType={}));var r;!function(e){e[e.InitialRetrieval=0]="InitialRetrieval",e[e.SignInAttempt=1]="SignInAttempt",e[e.SignInCancel=2]="SignInCancel",e[e.SignOutAction=3]="SignOutAction",e[e.TokenRefreshForPendingClip=4]="TokenRefreshForPendingClip"}(r=n.UpdateReason||(n.UpdateReason={}))},{}],144:[function(e,t,n){"use strict";var o;!function(e){e.schemaVersionSupported="1"}(o=n.ChangeLog||(n.ChangeLog={}))},{}],145:[function(e,t,n){"use strict";var o,r=e("./version");!function(e){function t(e,t){if(!e||0===e.length)return[];if(!t)return e;for(var n=0;n<e.length;n++){var o=new r.Version(e[n].version);if(t.isGreaterThanOrEqualTo(o))return e.slice(0,n)}return e}function n(e,t,n){if(!e||0===e.length)return[];for(var o=[],i=0;i<e.length;i++){var a=new r.Version(e[i].version);if(t&&a.isLesserThanOrEqualTo(t))break;a.isLesserThanOrEqualTo(n)&&o.push(e[i])}return o}function o(e,t){if(!e||!t)return[];for(var n=[],o=0;o<e.length;o++){var r=e[o],i=r.changes.filter(function(e){return e.supportedBrowsers.indexOf(t)!==-1});i.length>0&&n.push({version:r.version,date:r.date,changes:i})}return n}e.getUpdatesSinceVersion=t,e.getUpdatesBetweenVersions=n,e.filterUpdatesThatDontApplyToBrowser=o}(o=n.ChangeLogHelper||(n.ChangeLogHelper={}))},{"./version":146}],146:[function(e,t,n){"use strict";var o=function(){function e(e){if(!e||!/^\d+\.\d+\.\d+$/.test(e))throw new Error("version must match 'int.int.int' pattern, but was: "+e);var t=e.split(".");this.major=parseInt(t[0],10),this.minor=parseInt(t[1],10),this.patch=parseInt(t[2],10),this.stringRepresentation=this.major+"."+this.minor+"."+this.patch}return e.prototype.isEqualTo=function(e,t){return this.major===e.major&&this.minor===e.minor&&(t||this.patch===e.patch)},e.prototype.isGreaterThan=function(e,t){return this.major!==e.major?this.major>e.major:this.minor!==e.minor?this.minor>e.minor:!t&&this.patch>e.patch},e.prototype.isGreaterThanOrEqualTo=function(e,t){return this.isEqualTo(e,t)||this.isGreaterThan(e,t)},e.prototype.isLesserThan=function(e,t){return this.major!==e.major?this.major<e.major:this.minor!==e.minor?this.minor<e.minor:!t&&this.patch<e.patch},e.prototype.isLesserThanOrEqualTo=function(e,t){return this.isEqualTo(e,t)||this.isLesserThan(e,t)},e.prototype.toString=function(){return this.stringRepresentation},e}();n.Version=o},{}],147:[function(e,t,n){t.exports={DummyObjectForTestingPurposes:{Description:"Do not remove under any circumstances!",Value:"Testing."},AugmentationDefault_WhitelistedDomains:{Description:"The set of domains on which we are changing the default clip mode to Augmentation.",Value:["^https?:\\/\\/www\\.onenote\\.com","[^\\w]wikipedia","[^\\w]nytimes","[^\\w]lifehacker","[^\\w]msn","[^\\w]theguardian","[^\\w]forbes","[^\\w]bbc","[^\\w]huffingtonpost","[^\\w]businessinsider","[^\\w]washingtonpost","[^\\w]medium","[^\\w]buzzfeed","[^\\w]bbc","[^\\w]theverge","[^\\w]techcrunch","[^\\w]amazon","[^\\w]allrecipes","[^\\w]foodnetwork","[^\\w]seriouseats","[^\\w]epicurious","[^\\w]support.office.com","[^\\w]blogs.office.com","[^\\w]blogs.technet.com","[^\\w]youtube\\.com\\/watch(\\?v=(\\w+)|.*\\&v=(\\w+))","[^\\w]youtube\\.com\\/embed\\/(\\w+)","[^\\w]vimeo\\.com.*?\\/(\\d+)($|\\?|\\#|\\/$)","[^\\w]vimeo\\.com.*?\\/(\\d+)\\/\\w+:\\w+(\\/|$)","[^\\w]vimeo\\.com.*?\\/ondemand\\/\\w+$","[^\\w]khanacademy\\.org(.*)/v/(.*)","\\/(\\d{2}|\\d{4})\\/\\d{1,2}\\/","\\/(\\d{2}|\\d{4})-\\d{1,2}-\\d{1,2}\\/"]},PageNav_BlacklistedDomains:{Description:"The set of domains where we do not want to show any PageNav tooltip experience",Value:["^(http(s)?)://(login\\.live\\.com)","^(http(s)?)://(login\\.microsoftonline\\.com)"]},PdfDomains:{Description:"PDF regexes",Value:["^.*(\\.pdf)$"]},RecipeDomains:{Description:"The set of domains where we want to show a Recipe tooltip",Value:["^(http(s)?)://(12tomatoes\\.com/)()([^/]*-[^/]*)/$","^(http(s)?)://(abc\\.go\\.com/shows/the-chew/recipes/)([^/]*-[^/]*)$","^(http(s)?)://(([^ ]{1,18})?)(allrecipes\\.com)()/(recipe/.*)$","^(http(s)?)://((\\.{1,18}\\.)?)(allrecipes\\.)(com)/(recipe/[^/]+(/)?(/detail\\.aspx\\??)?)$","^(http(s)?)://()(allrecipes\\.com)()/([r|R]ecipe/[^/]+/Detail\\.aspx)$","^(http(s)?)://()(allrecipes\\.com)()/(recipe/.*)$","^(http(s)?)://(cookieandkate\\.com)()/(\\d{4})/(.+)$","^(http(s)?)://(cooking\\.)(nytimes\\.com)()/(recipes/(.*))$","^(http(s)?)://()(cookpad\\.com)()/(recipe/[0-9]+$)$","^(http(s)?)://()(damndelicious\\.net)()/\\d+/\\d+/\\d+/.+/$","^(http(s)?)://(food52\\.com)()/recipes/[0-9]+-.+$","^(http(s)?)://(minimalistbaker.com)/([^/]*-[^/]*)/$","^(http(s)?)://(paleoleap.com)/([^/]*-[^/]*)/$","^(http(s)?)://(pinchofyum.com)/([^/]*-[^/]*)$","^(http(s)?)://(recipe\\.rakuten\\.co\\.jp)()/recipe/[0-9]+/$","^(http(s)?)://()(thepioneerwoman\\.com)()/(cooking/.+/)$","^(http(s)?)://((www\\.)?)(allrecipes\\.com)()/([r|R]ecipe/[^/]+/(Detail\\.aspx)?)$","^(http(s)?)://((www\\.)?)(allrecipes\\.com)()/([R|r]ecipe/.*)$","^(http(s)?)://(www\\.)(bbc\\.co\\.uk/food/recipes/[^/]*_\\d+)$","^(http(s)?)://(www\\.)(bbcgoodfood\\.com)()/(recipes/[0-9]+/(.*))$","^(http(s)?)://(www\\.)(bbcgoodfood\\.com)/recipes/([^/]*-[^/]*)$","^(http(s)?)://(www\\.)(bettycrocker\\.com)()/(recipes/[^\\/]+/[0-9a-f-]{36}/?)$","^(http(s)?)://(www\\.)(bonappetit\\.com)()/(recipe/(.*))$","^(http(s)?)://(www\\.budgetbytes\\.com)/\\d{4}/\\d{2}/(.*)/","^(http(s)?)://((www\\.)?)(chowhound\\.com)()/(recipes/.*)$","^(http(s)?)://(www\\.cookingclassy\\.com)/\\d{4}/\\d{2}/(.*)/","^(http(s)?)://(www\\.delish\\.com)/cooking/recipe-ideas/recipes/a\\d+/[^/]*-[^/]*/","^(http(s)?)://(www\\.)(eatingwell\\.com)()/(recipe/\\d+/.+/)$","^(http(s)?)://(www\\.)(epicurious\\.com)()/(recipes/food/views/.*)$","^(http(s)?)://(www\\.)(food\\.com)()/(recipe/.*)$","^(http(s)?)://(www\\.)(foodandwine\\.com)()/(recipes\\/.+)$","^(http(s)?)://(www\\.)(foodnetwork)(\\.ca)/(recipe/(.*))$","^(http(s)?)://(www\\.)(foodnetwork\\.com)()/(recipe-collections/.*)$","^(http(s)?)://(www\\.)(foodnetwork\\.com)()/(recipes.*)$","^(http(s)?)://(www\\.)(foodnetwork\\.com)()/(recipes/.*)$","^(http(s)?)://(www\\.)(marthastewart\\.com)()/(([0-9]+|recipe)/.*)$","^(http(s)?)://(www\\.)(marthastewart\\.com)()/([0-9]+/[^/]+)$","^(http(s)?)://(www\\.)(myrecipes\\.com)()/(recipe/.*)$","^(http(s)?)://(www\\.)(myrecipes\\.com)()/(recipe/.*-[0-9]*/)$","^(http(s)?)://(www\\.)(myrecipes\\.com)()/(recipe/.*)$","^(http(s)?)://(www\\.)(myrecipes\\.com)()/(recipe/[^/]+.*)$","^(http(s)?)://(www\\.)(realsimple\\.com)()/(food-recipes/browse-all-recipes/[^\\/]+/index\\.html)$","^(http(s)?)://((www)?\\.)(seriouseats\\.com)()/([Rr]ecipes\\/.*\\.(html|HTML)(.*)?)$","^(http(s)?)://(www\\.)(simplyrecipes\\.com)()/(recipes/[^/]*/)$","^(http(s)?)://((www\\.)?)(simplyrecipes\\.com)()/(recipes/[^/]*/)$","^(http(s)?)://((www\\.)?)(simplyrecipes\\.com)()/(recipes/.*)$","^(http(s)?)://(www\\.)(tasteofhome\\.com)()/([R|r]ecipes/[^/]+$)$","^(http(s)?)://(www\\.)(tasteofhome\\.com)()/(recipes/[^/]*/?)$","^(http(s)?)://(www\\.)(tasteofhome\\.com)()/(recipes/[^\\/]+/?)$","^(http(s)?)://(www\\.)(yummly\\.com)()/(recipe/[^/]+)$","^(http(s)?)://((www\\.)?)(yummly\\.com)()/(recipe/.*)$","^(http(s)?)://(.*)(yummly\\.com)()/(recipe/.+)$"]},ProductDomains:{Description:"The set of domains where we want to show a Product tooltip",Value:["^(http(s)?)://store\\.steampowered.com/app/\\d+/.*$","^(http(s)?)://(www\\.)(amazon\\.com)()/(gp/product/[^/]+/.*)$","^(http(s)?)://(www\\.)(amazon\\.com)()/(dp/[^/]+.*)$","^(http(s)?)://(www\\.)(amazon\\.com)()/([^/]+/dp/[^/]+)$","^(http(s)?)://(www\\.)(amazon\\.in)()/((.+/)?(dp|gp/product)\\/\\w{10,13}([^\\w].*)?)$","^(http(s)?)://(www\\.)(amazon\\.)([a-zA-Z\\.]+)/([^/]+/dp/.*)$","^(http(s)?)://(www\\.)(bedbathandbeyond\\.com)(/store/product/)([^/]*-[^/]*/)(\\d+.*)","^(http(s)?)://(www\\.)(ebay\\.com)()/(itm/[^/]+/.*)$","^(http(s)?)://(www\\.)(etsy\\.com)()/(listing)/(\\d+/.*)$","^(http(s)?)://(www\\.)(homedepot\\.com)()/(p/[^/]+/.*)$","^(http(s)?)://(www\\.)(newegg\\.com)()/(Product/Product\\.aspx\\?Item=.+)$","^(http(s)?)://(www\\.)(overstock\\.com)()/(.+/.+/[0-9]+/product\\.html.*)$","^(http(s)?)://(www\\.)(staples\\.com)()/(.*/product_[^/]+)$","^(http(s)?)://(www\\.)(target\\.com)()/(p/.+)$","^(http(s)?)://(www\\.)(walmart\\.com)()/(ip/.*)$"]},App_Id:{Description:"For identifying the Web Clipper during interaction with external services",Value:"OneNote Web Clipper"},Misc_Data_Endpoint_Id:{Description:"The id of the data endpoint used for miscellaneous logging",Value:"production"},Aria_Token:{Description:"For sending log events to the Aria production tenant 'OneNote Web Clipper (production)'",Value:"c7f3f24bc5f746d7b9d8f8e422fdd8a5-1cb58166-2598-485f-897c-1d3c8e62d30e-7560"},LogCategory_RatingsPrompt:{Description:"OFeedback log category for the ratings prompt feature",Value:"OneNoteClipperRatingsPrompt"},Bookmarklet_RatingsEnabled:{Description:"If true, ratings prompt will be enabled for the bookmarklet",Value:"false"},ChromeExtension_RatingsEnabled:{Description:"If true, ratings prompt will be enabled for the Chrome extension",Value:"true"},EdgeExtension_RatingsEnabled:{Description:"If true, ratings prompt will be enabled for the Edge extension",Value:"false"},FirefoxExtension_RatingsEnabled:{Description:"If true, ratings prompt will be enabled for the Firefox extension",Value:"true"},SafariExtension_RatingsEnabled:{Description:"If true, ratings prompt will be enabled for the Safari extension",Value:"false"},ChromeExtension_RatingUrl:{Description:"URL for the Web Clipper in the Chrome Web Store; used to direct users to leave ratings and reviews",Value:"https://chrome.google.com/webstore/detail/onenote-web-clipper/gojbdfnpnhogfdgjbigejoaolejmgdhk/reviews"},EdgeExtension_RatingUrl:{Description:"URL for the Web Clipper in the Windows Store; used to direct users to leave ratings and reviews",Value:"https://www.microsoft.com/en-us/store/p/onenote-web-clipper/9nblggh4r01n#ratings-reviews"},FirefoxExtension_RatingUrl:{Description:"URL for the Web Clipper in Firefox Add-ons; used to direct users to leave ratings and reviews",
Value:"https://addons.mozilla.org/en-US/firefox/addon/onenote-clipper/reviews/add"}}},{}],148:[function(e,t,n){t.exports={"WebClipper.Accessibility.ScreenReader.CurrentModeHasChanged":"The current clipping mode is now '{0}'","WebClipper.Accessibility.ScreenReader.ClippingPageToOneNote":"Clipping the current page to OneNote","WebClipper.Accessibility.ScreenReader.ChangeFontToSansSerif":"Change font to Sans-Serif","WebClipper.Accessibility.ScreenReader.ChangeFontToSerif":"Change font to Serif","WebClipper.Accessibility.ScreenReader.DecreaseFontSize":"Decrease font size","WebClipper.Accessibility.ScreenReader.IncreaseFontSize":"Increase font size","WebClipper.Accessibility.ScreenReader.ToggleHighlighterModeForArticle":"Toggle Highlighter Mode For Article. To highlight using keyboard, enter Caret Mode using F7","WebClipper.Accessibility.ScreenReader.InputBoxToChangeTitleOfOneNotePage":"Text input to edit the title of the page you want to save","WebClipper.Accessibility.ScreenReader.InputBoxToChangeNotesToAddToPage":"Text input to edit the notes to save along with this page","WebClipper.Accessibility.ScreenReader.PagePreview":"Page Preview","WebClipper.Accessibility.ScreenReader.Footer":"User details","WebClipper.Accessibility.ScreenReader.Loading":"Loading...","WebClipper.Accessibility.ScreenReader.RegionSelectionCanvas":"Selection canvas","WebClipper.Action.BackToHome":"Back","WebClipper.Action.Cancel":"Cancel","WebClipper.Action.Clip":"Clip","WebClipper.Action.CloseTheClipper":"Close the Clipper","WebClipper.Action.Feedback":"Feedback?","WebClipper.Action.RefreshPage":"Refresh Page","WebClipper.Action.Signin":"Sign In","WebClipper.Action.SigninMsa":"Sign in with a Microsoft account","WebClipper.Action.SigninOrgId":"Sign in with a work or school account","WebClipper.Action.SignOut":"Sign Out","WebClipper.Action.TryAgain":"Try Again","WebClipper.Action.ViewInOneNote":"View in OneNote","WebClipper.Action.Less":"Less","WebClipper.Action.More":"More","WebClipper.BetaTag":"beta","WebClipper.ClipType.Article.Button":"Article","WebClipper.ClipType.Article.ProgressLabel":"Clipping Article","WebClipper.ClipType.Bookmark.Button":"Bookmark","WebClipper.ClipType.Bookmark.Button.Tooltip":"Clip just the title, thumbnail, synopsis, and link.","WebClipper.ClipType.Bookmark.ProgressLabel":"Clipping Bookmark","WebClipper.ClipType.Button.Tooltip":"Clip just the {0} in an easy-to-read format.","WebClipper.ClipType.Image.Button":"Image","WebClipper.ClipType.ImageSnippet.Button":"Image Snippet","WebClipper.ClipType.MultipleRegions.Button.Tooltip":"Take screenshots of parts of the page you'll select.","WebClipper.ClipType.Pdf.Button":"PDF Document","WebClipper.ClipType.Pdf.AskPermissionToClipLocalFile":"We need your permission to clip PDF files stored on your computer","WebClipper.ClipType.Pdf.InstructionsForClippingLocalFiles":"In Chrome, right-click the OneNote icon in the toolbar and choose \"Manage Extension'. Then, for OneNote Web Clipper, check 'Allow access to file URLs.'","WebClipper.ClipType.Pdf.ProgressLabel":"Clipping PDF File","WebClipper.ClipType.Pdf.ProgressLabelDelay":"PDFs can take a little while to upload. Still clipping.","WebClipper.ClipType.Pdf.IncrementalProgressMessage":"Clipping page {0} of {1}...","WebClipper.ClipType.Pdf.Button.Tooltip":"Take a screenshot of the whole PDF file and save a copy of the attachment.","WebClipper.ClipType.Product.Button":"Product","WebClipper.ClipType.Product.ProgressLabel":"Clipping Product","WebClipper.ClipType.Recipe.Button":"Recipe","WebClipper.ClipType.Recipe.ProgressLabel":"Clipping Recipe","WebClipper.ClipType.Region.Button":"Region","WebClipper.ClipType.Region.Button.Tooltip":"Take a screenshot of the part of the page you'll select.","WebClipper.ClipType.Region.ProgressLabel":"Clipping Region","WebClipper.ClipType.ScreenShot.Button":"Full Page","WebClipper.ClipType.ScreenShot.Button.Tooltip":"Take a screenshot of the whole page, just like you see it.","WebClipper.ClipType.ScreenShot.ProgressLabel":"Clipping Page","WebClipper.ClipType.Selection.Button":"Selection","WebClipper.ClipType.Selection.Button.Tooltip":"Clip the selection you made on the web page.","WebClipper.ClipType.Selection.ProgressLabel":"Clipping Selection","WebClipper.Error.ConflictingExtension":"Your PDF viewer or another extension might be blocking the OneNote Web Clipper. You could temporarily disable the following extension and try clipping again.","WebClipper.Error.CannotClipPage":"Sorry, this type of page can't be clipped.","WebClipper.Error.CookiesDisabled.Line1":"Cookies must be enabled in order for OneNote Web Clipper to work correctly.","WebClipper.Error.CookiesDisabled.Line2":"Please allow third-party cookies in your browser or add the onenote.com and live.com domains as an exception.","WebClipper.Error.CookiesDisabled.Chrome":"Please allow third-party cookies in your browser or add the [*.]onenote.com and [*.]live.com domains as an exception.","WebClipper.Error.CookiesDisabled.Edge":"Please allow third-party cookies in your browser.","WebClipper.Error.CookiesDisabled.Firefox":"Please allow third-party cookies in your browser or add the https://onenote.com and https://live.com domains as an exception.","WebClipper.Error.CorruptedSection":"Your clip can't be saved here because the section is corrupt.","WebClipper.Error.GenericError":"Something went wrong. Please try clipping the page again.","WebClipper.Error.GenericExpiredTokenRefreshError":"Your login session has ended and we were unable to clip the page. Please sign in again.","WebClipper.Error.NoOpError":"Sorry, we can't clip this page right now","WebClipper.Error.NotProvisioned":"Your clip can't be saved because your OneDrive for Business account isn't set up.","WebClipper.Error.OrphanedWebClipperDetected":"Something went wrong. Please refresh this page, and try to clip again.","WebClipper.Error.PasswordProtected":"Your clip can't be saved here because the section is password protected.","WebClipper.Error.QuotaExceeded":"Your clip can't be saved because your OneDrive account has reached its size limit.","WebClipper.Error.ResourceDoesNotExist":"Your clip can't be saved here because the location no longer exists. Please try clipping to another location.","WebClipper.Error.SectionTooLarge":"Your clip can't be saved here because the section has reached its size limit.","WebClipper.Error.SignInUnsuccessful":"We couldn't sign you in. Please try again.","WebClipper.Error.ThirdPartyCookiesDisabled":"For OneNote Web Clipper to work correctly, please allow third-party cookies in your browser, or add the onenote.com domain as an exception.","WebClipper.Error.UserAccountSuspended":"Your clip can't be saved because your Microsoft account has been suspended.","WebClipper.Error.UserAccountSuspendedResetText":"Reset Your Account","WebClipper.Error.UserDoesNotHaveUpdatePermission":"We've added features to the Web Clipper that require new permissions. To accept them, please sign out and sign back in.","WebClipper.Extension.RefreshTab":"Please refresh this page, and try to clip again.","WebClipper.FromCitation":"Clipped from: {0}","WebClipper.Label.Annotation":"Note","WebClipper.Label.AnnotationPlaceholder":"Add a note...","WebClipper.Label.PageTitlePlaceholder":"Add a page title...","WebClipper.Label.AttachPdfFile":"Attach PDF file","WebClipper.Label.AttachPdfFileSubText":"(all pages)","WebClipper.Label.ClipImageToOneNote":"Clip Image to OneNote","WebClipper.Label.ClipLocation":"Location","WebClipper.Label.ClipSelectionToOneNote":"Clip Selection to OneNote","WebClipper.Label.ClipSuccessful":"Clip Successful!","WebClipper.Label.DragAndRelease":"Drag and release to capture a screenshot","WebClipper.Label.RegionSelectionMouseInstruction":"Drag a selection with the mouse, and then release to capture.","WebClipper.Label.RegionSelectionKeyboardInstruction":"To select with the keyboard, press the arrow keys, and then press Enter.","WebClipper.Label.OneNoteClipper":"OneNote Clipper","WebClipper.Label.OneNoteWebClipper":"OneNote Web Clipper","WebClipper.Label.OpenChangeLogFromTooltip":"Check out what's new","WebClipper.Label.Page":"Page","WebClipper.Label.PdfAllPagesRadioButton":"All pages","WebClipper.Label.PdfDistributePagesCheckbox":"New note for each PDF page","WebClipper.Label.PdfOptions":"PDF Options","WebClipper.Label.PdfTooLargeToAttach":"PDF too large to attach","WebClipper.Label.PdfTooltip":"Clip this PDF to OneNote, and read it later","WebClipper.Label.ProceedToWebClipper":"Proceed to the Web Clipper","WebClipper.Label.ProceedToWebClipperFun":"Try it out!","WebClipper.Label.ProductTooltip":"Clip and save product details like this to OneNote","WebClipper.Label.Ratings.Message.End":"Thanks for your feedback!","WebClipper.Label.Ratings.Message.Feedback":"Help us improve","WebClipper.Label.Ratings.Message.Init":"Enjoying the Web Clipper?","WebClipper.Label.Ratings.Message.Rate":"Glad you like it!","WebClipper.Label.Ratings.Button.Feedback":"Provide feedback","WebClipper.Label.Ratings.Button.Init.Positive":"Yes, it's great!","WebClipper.Label.Ratings.Button.Init.Negative":"Not really...","WebClipper.Label.Ratings.Button.NoThanks":"No thanks","WebClipper.Label.Ratings.Button.Rate":"Rate us 5 stars","WebClipper.Label.RecipeTooltip":"Save clutter-free recipes right to OneNote","WebClipper.Label.SignedIn":"Signed in","WebClipper.Label.SignInDescription":"Save anything on the web to OneNote in one click","WebClipper.Label.SignInUnsuccessfulMoreInformation":"More information","WebClipper.Label.SignInUnsuccessfulLessInformation":"Less information","WebClipper.Label.UnsupportedBrowser":"Sorry, your browser version is unsupported.","WebClipper.Label.WebClipper":"Web Clipper","WebClipper.Label.WebClipperWasUpdated":"OneNote Web Clipper has been updated","WebClipper.Label.WebClipperWasUpdatedFun":"OneNote Web Clipper is now better than ever!","WebClipper.Label.WhatsNew":"What's New","WebClipper.Label.VideoTooltip":"Clip this video and watch it anytime in OneNote","WebClipper.Popover.PdfInvalidPageRange":"We couldn't find page '{0}'","WebClipper.Preview.AugmentationModeGenericError":"Something went wrong creating the preview. Try again, or choose a different clipping mode.","WebClipper.Preview.BookmarkModeGenericError":"Something went wrong creating the bookmark. Try again, or choose a different clipping mode.","WebClipper.Preview.FullPageModeGenericError":"A preview isn't available, but you can still clip your page.","WebClipper.Preview.FullPageModeScreenshotDescription":"A full page screenshot of '{0}'","WebClipper.Preview.LoadingMessage":"Loading preview...","WebClipper.Preview.NoFullPageScreenshotFound":"No content found. Try another clipping mode.","WebClipper.Preview.NoContentFound":"No article found. Try another clipping mode.","WebClipper.Preview.UnableToClipLocalFile":"Local files can only be clipped using Region mode.","WebClipper.Preview.RemoveSelectedRegion":"Remove selected region","WebClipper.Preview.SelectedRegion":"Selected region","WebClipper.Preview.Header.AddAnotherRegionButtonLabel":"Add another region","WebClipper.Preview.Header.SansSerifButtonLabel":"Sans-serif","WebClipper.Preview.Header.SerifButtonLabel":"Serif","WebClipper.Preview.Spinner.ClipAnyTimeInFullPage":"In a hurry? You can clip any time in Full Page mode!","WebClipper.SectionPicker.DefaultLocation":"Default location","WebClipper.SectionPicker.LoadingNotebooks":"Loading notebooks...","WebClipper.SectionPicker.NoNotebooksFound":"You don't have any notebooks yet, so we'll create your default notebook when you clip this page.","WebClipper.SectionPicker.NotebookLoadFailureMessage":"OneNote couldn't load your notebooks. Please try again later.","WebClipper.SectionPicker.NotebookLoadUnretryableFailureMessage":"OneNote couldn't load your notebooks.","WebClipper.SectionPicker.NotebookLoadUnretryableFailureMessageWithExplanation":"We couldn't load your notebooks because a list limit was exceeded in OneDrive.","WebClipper.SectionPicker.NotebookLoadUnretryableFailureLinkMessage":"Learn more","WebClipper.FontFamily.Regular":"Segoe UI Regular,Segoe UI,Segoe,Segoe WP,Helvetica Neue,Roboto,Helvetica,Arial,Tahoma,Verdana,sans-serif","WebClipper.FontFamily.Bold":"Segoe UI Bold,Segoe UI,Segoe,Segoe WP,Helvetica Neue,Roboto,Helvetica,Arial,Tahoma,Verdana,sans-serif","WebClipper.FontFamily.Light":"Segoe UI Light,Segoe WP Light,Segoe UI,Segoe,Segoe WP,Helvetica Neue,Roboto,Helvetica,Arial,Tahoma,Verdana,sans-serif","WebClipper.FontFamily.Preview.SerifDefault":"Georgia","WebClipper.FontFamily.Preview.SansSerifDefault":"Verdana","WebClipper.FontFamily.Semibold":"Segoe UI Semibold,Segoe UI,Segoe,Segoe WP,Helvetica Neue,Roboto,Helvetica,Arial,Tahoma,Verdana,sans-serif","WebClipper.FontFamily.Semilight":"Segoe UI Semilight,Segoe UI Light,Segoe WP Light,Segoe UI,Segoe,Segoe WP,Helvetica Neue,Roboto,Helvetica,Arial,Tahoma,Verdana,sans-serif","WebClipper.FontSize.Preview.SerifDefault":"16px","WebClipper.FontSize.Preview.SansSerifDefault":"16px"}},{}],149:[function(e,t,n){(function(o,r){(function(){!function(e,o){"object"==typeof n&&"undefined"!=typeof t?t.exports=o():"function"==typeof define&&define.amd?define(o):e.ES6Promise=o()}(this,function(){"use strict";function t(e){return"function"==typeof e||"object"==typeof e&&null!==e}function n(e){return"function"==typeof e}function i(e){J=e}function a(e){Q=e}function s(){return function(){return o.nextTick(d)}}function l(){return"undefined"!=typeof $?function(){$(d)}:p()}function c(){var e=0,t=new Z(d),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function u(){var e=new MessageChannel;return e.port1.onmessage=d,function(){return e.port2.postMessage(0)}}function p(){var e=setTimeout;return function(){return e(d,1)}}function d(){for(var e=0;e<q;e+=2){var t=ne[e],n=ne[e+1];t(n),ne[e]=void 0,ne[e+1]=void 0}q=0}function g(){try{var t=e,n=t("vertx");return $=n.runOnLoop||n.runOnContext,l()}catch(e){return p()}}function f(e,t){var n=arguments,o=this,r=new this.constructor(m);void 0===r[re]&&k(r);var i=o._state;return i?!function(){var e=n[i-1];Q(function(){return O(i,r,e,o._result)})}():A(o,r,e,t),r}function h(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(m);return I(n,e),n}function m(){}function v(){return new TypeError("You cannot resolve a promise with itself")}function y(){return new TypeError("A promises callback cannot return that same promise.")}function C(e){try{return e.then}catch(e){return le.error=e,le}}function S(e,t,n,o){try{e.call(t,n,o)}catch(e){return e}}function b(e,t,n){Q(function(e){var o=!1,r=S(n,t,function(n){o||(o=!0,t!==n?I(e,n):E(e,n))},function(t){o||(o=!0,L(e,t))},"Settle: "+(e._label||" unknown promise"));!o&&r&&(o=!0,L(e,r))},e)}function w(e,t){t._state===ae?E(e,t._result):t._state===se?L(e,t._result):A(t,void 0,function(t){return I(e,t)},function(t){return L(e,t)})}function P(e,t,o){t.constructor===e.constructor&&o===f&&t.constructor.resolve===h?w(e,t):o===le?L(e,le.error):void 0===o?E(e,t):n(o)?b(e,t,o):E(e,t)}function I(e,n){e===n?L(e,v()):t(n)?P(e,n,C(n)):E(e,n)}function T(e){e._onerror&&e._onerror(e._result),U(e)}function E(e,t){e._state===ie&&(e._result=t,e._state=ae,0!==e._subscribers.length&&Q(U,e))}function L(e,t){e._state===ie&&(e._state=se,e._result=t,Q(T,e))}function A(e,t,n,o){var r=e._subscribers,i=r.length;e._onerror=null,r[i]=t,r[i+ae]=n,r[i+se]=o,0===i&&e._state&&Q(U,e)}function U(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var o=void 0,r=void 0,i=e._result,a=0;a<t.length;a+=3)o=t[a],r=t[a+n],o?O(n,o,r,i):r(i);e._subscribers.length=0}}function x(){this.error=null}function N(e,t){try{return e(t)}catch(e){return ce.error=e,ce}}function O(e,t,o,r){var i=n(o),a=void 0,s=void 0,l=void 0,c=void 0;if(i){if(a=N(o,r),a===ce?(c=!0,s=a.error,a=null):l=!0,t===a)return void L(t,y())}else a=r,l=!0;t._state!==ie||(i&&l?I(t,a):c?L(t,s):e===ae?E(t,a):e===se&&L(t,a))}function R(e,t){try{t(function(t){I(e,t)},function(t){L(e,t)})}catch(t){L(e,t)}}function F(){return ue++}function k(e){e[re]=ue++,e._state=void 0,e._result=void 0,e._subscribers=[]}function _(e,t){this._instanceConstructor=e,this.promise=new e(m),this.promise[re]||k(this.promise),G(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?E(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&E(this.promise,this._result))):L(this.promise,B())}function B(){return new Error("Array Methods must be provided an Array")}function z(e){return new _(this,e).promise}function D(e){var t=this;return new t(G(e)?function(n,o){for(var r=e.length,i=0;i<r;i++)t.resolve(e[i]).then(n,o)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function W(e){var t=this,n=new t(m);return L(n,e),n}function M(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function H(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function V(e){this[re]=F(),this._result=this._state=void 0,this._subscribers=[],m!==e&&("function"!=typeof e&&M(),this instanceof V?R(this,e):H())}function j(){var e=void 0;if("undefined"!=typeof r)e=r;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=V}var K=void 0;K=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var G=K,q=0,$=void 0,J=void 0,Q=function(e,t){ne[q]=e,ne[q+1]=t,q+=2,2===q&&(J?J(d):oe())},Y="undefined"!=typeof window?window:void 0,X=Y||{},Z=X.MutationObserver||X.WebKitMutationObserver,ee="undefined"==typeof self&&"undefined"!=typeof o&&"[object process]"==={}.toString.call(o),te="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ne=new Array(1e3),oe=void 0;oe=ee?s():Z?c():te?u():void 0===Y&&"function"==typeof e?g():p();var re=Math.random().toString(36).substring(16),ie=void 0,ae=1,se=2,le=new x,ce=new x,ue=0;return _.prototype._enumerate=function(){for(var e=this.length,t=this._input,n=0;this._state===ie&&n<e;n++)this._eachEntry(t[n],n)},_.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,o=n.resolve;if(o===h){var r=C(e);if(r===f&&e._state!==ie)this._settledAt(e._state,t,e._result);else if("function"!=typeof r)this._remaining--,this._result[t]=e;else if(n===V){var i=new n(m);P(i,e,r),this._willSettleAt(i,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(o(e),t)},_.prototype._settledAt=function(e,t,n){var o=this.promise;o._state===ie&&(this._remaining--,e===se?L(o,n):this._result[t]=n),0===this._remaining&&E(o,this._result)},_.prototype._willSettleAt=function(e,t){var n=this;A(e,void 0,function(e){return n._settledAt(ae,t,e)},function(e){return n._settledAt(se,t,e)})},V.all=z,V.race=D,V.resolve=h,V.reject=W,V._setScheduler=i,V._setAsap=a,V._asap=Q,V.prototype={constructor:V,then:f,catch:function(e){return this.then(null,e)}},V.polyfill=j,V.Promise=V,V})}).call(this)}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:152}],150:[function(e,t,n){(function(e){(function(){(function(){function o(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function r(e,t,n,o){for(var r=-1,i=null==e?0:e.length;++r<i;){var a=e[r];t(o,a,n(a),e)}return o}function i(e,t){for(var n=-1,o=null==e?0:e.length;++n<o&&t(e[n],n,e)!==!1;);return e}function a(e,t){for(var n=null==e?0:e.length;n--&&t(e[n],n,e)!==!1;);return e}function s(e,t){for(var n=-1,o=null==e?0:e.length;++n<o;)if(!t(e[n],n,e))return!1;return!0}function l(e,t){for(var n=-1,o=null==e?0:e.length,r=0,i=[];++n<o;){var a=e[n];t(a,n,e)&&(i[r++]=a)}return i}function c(e,t){var n=null==e?0:e.length;return!!n&&S(e,t,0)>-1}function u(e,t,n){for(var o=-1,r=null==e?0:e.length;++o<r;)if(n(t,e[o]))return!0;return!1}function p(e,t){for(var n=-1,o=null==e?0:e.length,r=Array(o);++n<o;)r[n]=t(e[n],n,e);return r}function d(e,t){for(var n=-1,o=t.length,r=e.length;++n<o;)e[r+n]=t[n];return e}function g(e,t,n,o){var r=-1,i=null==e?0:e.length;for(o&&i&&(n=e[++r]);++r<i;)n=t(n,e[r],r,e);return n}function f(e,t,n,o){var r=null==e?0:e.length;for(o&&r&&(n=e[--r]);r--;)n=t(n,e[r],r,e);return n}function h(e,t){for(var n=-1,o=null==e?0:e.length;++n<o;)if(t(e[n],n,e))return!0;return!1}function m(e){return e.split("")}function v(e){return e.match(Wt)||[]}function y(e,t,n){var o;return n(e,function(e,n,r){if(t(e,n,r))return o=n,!1}),o}function C(e,t,n,o){for(var r=e.length,i=n+(o?1:-1);o?i--:++i<r;)if(t(e[i],i,e))return i;return-1}function S(e,t,n){return t===t?$(e,t,n):C(e,w,n)}function b(e,t,n,o){for(var r=n-1,i=e.length;++r<i;)if(o(e[r],t))return r;return-1}function w(e){return e!==e}function P(e,t){var n=null==e?0:e.length;return n?A(e,t)/n:_e}function I(e){return function(t){return null==t?ne:t[e]}}function T(e){return function(t){return null==e?ne:e[t]}}function E(e,t,n,o,r){return r(e,function(e,r,i){n=o?(o=!1,e):t(n,e,r,i)}),n}function L(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}function A(e,t){for(var n,o=-1,r=e.length;++o<r;){var i=t(e[o]);i!==ne&&(n=n===ne?i:n+i)}return n}function U(e,t){for(var n=-1,o=Array(e);++n<e;)o[n]=t(n);return o}function x(e,t){return p(t,function(t){return[t,e[t]]})}function N(e){return e?e.slice(0,X(e)+1).replace(kt,""):e}function O(e){return function(t){return e(t)}}function R(e,t){return p(t,function(t){return e[t]})}function F(e,t){return e.has(t)}function k(e,t){for(var n=-1,o=e.length;++n<o&&S(t,e[n],0)>-1;);return n}function _(e,t){for(var n=e.length;n--&&S(t,e[n],0)>-1;);return n}function B(e,t){for(var n=e.length,o=0;n--;)e[n]===t&&++o;return o}function z(e){return"\\"+eo[e]}function D(e,t){return null==e?ne:e[t]}function W(e){return Kn.test(e)}function M(e){return Gn.test(e)}function H(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}function V(e){var t=-1,n=Array(e.size);return e.forEach(function(e,o){n[++t]=[o,e]}),n}function j(e,t){return function(n){return e(t(n))}}function K(e,t){for(var n=-1,o=e.length,r=0,i=[];++n<o;){var a=e[n];a!==t&&a!==ue||(e[n]=ue,i[r++]=n)}return i}function G(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function q(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=[e,e]}),n}function $(e,t,n){for(var o=n-1,r=e.length;++o<r;)if(e[o]===t)return o;return-1}function J(e,t,n){for(var o=n+1;o--;)if(e[o]===t)return o;return o}function Q(e){return W(e)?Z(e):yo(e)}function Y(e){return W(e)?ee(e):m(e)}function X(e){for(var t=e.length;t--&&_t.test(e.charAt(t)););return t}function Z(e){for(var t=Vn.lastIndex=0;Vn.test(e);)++t;return t}function ee(e){return e.match(Vn)||[]}function te(e){return e.match(jn)||[]}var ne,oe="4.17.21",re=200,ie="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",ae="Expected a function",se="Invalid `variable` option passed into `_.template`",le="__lodash_hash_undefined__",ce=500,ue="__lodash_placeholder__",pe=1,de=2,ge=4,fe=1,he=2,me=1,ve=2,ye=4,Ce=8,Se=16,be=32,we=64,Pe=128,Ie=256,Te=512,Ee=30,Le="...",Ae=800,Ue=16,xe=1,Ne=2,Oe=3,Re=1/0,Fe=9007199254740991,ke=1.7976931348623157e308,_e=NaN,Be=4294967295,ze=Be-1,De=Be>>>1,We=[["ary",Pe],["bind",me],["bindKey",ve],["curry",Ce],["curryRight",Se],["flip",Te],["partial",be],["partialRight",we],["rearg",Ie]],Me="[object Arguments]",He="[object Array]",Ve="[object AsyncFunction]",je="[object Boolean]",Ke="[object Date]",Ge="[object DOMException]",qe="[object Error]",$e="[object Function]",Je="[object GeneratorFunction]",Qe="[object Map]",Ye="[object Number]",Xe="[object Null]",Ze="[object Object]",et="[object Promise]",tt="[object Proxy]",nt="[object RegExp]",ot="[object Set]",rt="[object String]",it="[object Symbol]",at="[object Undefined]",st="[object WeakMap]",lt="[object WeakSet]",ct="[object ArrayBuffer]",ut="[object DataView]",pt="[object Float32Array]",dt="[object Float64Array]",gt="[object Int8Array]",ft="[object Int16Array]",ht="[object Int32Array]",mt="[object Uint8Array]",vt="[object Uint8ClampedArray]",yt="[object Uint16Array]",Ct="[object Uint32Array]",St=/\b__p \+= '';/g,bt=/\b(__p \+=) '' \+/g,wt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Pt=/&(?:amp|lt|gt|quot|#39);/g,It=/[&<>"']/g,Tt=RegExp(Pt.source),Et=RegExp(It.source),Lt=/<%-([\s\S]+?)%>/g,At=/<%([\s\S]+?)%>/g,Ut=/<%=([\s\S]+?)%>/g,xt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Nt=/^\w*$/,Ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Rt=/[\\^$.*+?()[\]{}|]/g,Ft=RegExp(Rt.source),kt=/^\s+/,_t=/\s/,Bt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,zt=/\{\n\/\* \[wrapped with (.+)\] \*/,Dt=/,? & /,Wt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Mt=/[()=,{}\[\]\/\s]/,Ht=/\\(\\)?/g,Vt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,jt=/\w*$/,Kt=/^[-+]0x[0-9a-f]+$/i,Gt=/^0b[01]+$/i,qt=/^\[object .+?Constructor\]$/,$t=/^0o[0-7]+$/i,Jt=/^(?:0|[1-9]\d*)$/,Qt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Yt=/($^)/,Xt=/['\n\r\u2028\u2029\\]/g,Zt="\\ud800-\\udfff",en="\\u0300-\\u036f",tn="\\ufe20-\\ufe2f",nn="\\u20d0-\\u20ff",on=en+tn+nn,rn="\\u2700-\\u27bf",an="a-z\\xdf-\\xf6\\xf8-\\xff",sn="\\xac\\xb1\\xd7\\xf7",ln="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",cn="\\u2000-\\u206f",un=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",pn="A-Z\\xc0-\\xd6\\xd8-\\xde",dn="\\ufe0e\\ufe0f",gn=sn+ln+cn+un,fn="[']",hn="["+Zt+"]",mn="["+gn+"]",vn="["+on+"]",yn="\\d+",Cn="["+rn+"]",Sn="["+an+"]",bn="[^"+Zt+gn+yn+rn+an+pn+"]",wn="\\ud83c[\\udffb-\\udfff]",Pn="(?:"+vn+"|"+wn+")",In="[^"+Zt+"]",Tn="(?:\\ud83c[\\udde6-\\uddff]){2}",En="[\\ud800-\\udbff][\\udc00-\\udfff]",Ln="["+pn+"]",An="\\u200d",Un="(?:"+Sn+"|"+bn+")",xn="(?:"+Ln+"|"+bn+")",Nn="(?:"+fn+"(?:d|ll|m|re|s|t|ve))?",On="(?:"+fn+"(?:D|LL|M|RE|S|T|VE))?",Rn=Pn+"?",Fn="["+dn+"]?",kn="(?:"+An+"(?:"+[In,Tn,En].join("|")+")"+Fn+Rn+")*",_n="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Bn="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",zn=Fn+Rn+kn,Dn="(?:"+[Cn,Tn,En].join("|")+")"+zn,Wn="(?:"+[In+vn+"?",vn,Tn,En,hn].join("|")+")",Mn=RegExp(fn,"g"),Hn=RegExp(vn,"g"),Vn=RegExp(wn+"(?="+wn+")|"+Wn+zn,"g"),jn=RegExp([Ln+"?"+Sn+"+"+Nn+"(?="+[mn,Ln,"$"].join("|")+")",xn+"+"+On+"(?="+[mn,Ln+Un,"$"].join("|")+")",Ln+"?"+Un+"+"+Nn,Ln+"+"+On,Bn,_n,yn,Dn].join("|"),"g"),Kn=RegExp("["+An+Zt+on+dn+"]"),Gn=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,qn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],$n=-1,Jn={};Jn[pt]=Jn[dt]=Jn[gt]=Jn[ft]=Jn[ht]=Jn[mt]=Jn[vt]=Jn[yt]=Jn[Ct]=!0,Jn[Me]=Jn[He]=Jn[ct]=Jn[je]=Jn[ut]=Jn[Ke]=Jn[qe]=Jn[$e]=Jn[Qe]=Jn[Ye]=Jn[Ze]=Jn[nt]=Jn[ot]=Jn[rt]=Jn[st]=!1;var Qn={};Qn[Me]=Qn[He]=Qn[ct]=Qn[ut]=Qn[je]=Qn[Ke]=Qn[pt]=Qn[dt]=Qn[gt]=Qn[ft]=Qn[ht]=Qn[Qe]=Qn[Ye]=Qn[Ze]=Qn[nt]=Qn[ot]=Qn[rt]=Qn[it]=Qn[mt]=Qn[vt]=Qn[yt]=Qn[Ct]=!0,Qn[qe]=Qn[$e]=Qn[st]=!1;var Yn={"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"},Xn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Zn={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},eo={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},to=parseFloat,no=parseInt,oo="object"==typeof e&&e&&e.Object===Object&&e,ro="object"==typeof self&&self&&self.Object===Object&&self,io=oo||ro||Function("return this")(),ao="object"==typeof n&&n&&!n.nodeType&&n,so=ao&&"object"==typeof t&&t&&!t.nodeType&&t,lo=so&&so.exports===ao,co=lo&&oo.process,uo=function(){try{var e=so&&so.require&&so.require("util").types;return e?e:co&&co.binding&&co.binding("util")}catch(e){}}(),po=uo&&uo.isArrayBuffer,go=uo&&uo.isDate,fo=uo&&uo.isMap,ho=uo&&uo.isRegExp,mo=uo&&uo.isSet,vo=uo&&uo.isTypedArray,yo=I("length"),Co=T(Yn),So=T(Xn),bo=T(Zn),wo=function e(t){function n(e){if(sl(e)&&!yd(e)&&!(e instanceof $)){if(e instanceof T)return e;if(yu.call(e,"__wrapped__"))return ra(e)}return new T(e)}function m(){}function T(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=ne}function $(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Be,this.__views__=[]}function Z(){var e=new $(this.__wrapped__);return e.__actions__=zr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=zr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=zr(this.__views__),e}function ee(){if(this.__filtered__){var e=new $(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function _t(){var e=this.__wrapped__.value(),t=this.__dir__,n=yd(e),o=t<0,r=n?e.length:0,i=Li(0,r,this.__views__),a=i.start,s=i.end,l=s-a,c=o?s:a-1,u=this.__iteratees__,p=u.length,d=0,g=$u(l,this.__takeCount__);if(!n||!o&&r==l&&g==l)return br(e,this.__actions__);var f=[];e:for(;l--&&d<g;){c+=t;for(var h=-1,m=e[c];++h<p;){var v=u[h],y=v.iteratee,C=v.type,S=y(m);if(C==Ne)m=S;else if(!S){if(C==xe)continue e;break e}}f[d++]=m}return f}function Wt(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function Zt(){this.__data__=rp?rp(null):{},this.size=0}function en(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function tn(e){var t=this.__data__;if(rp){var n=t[e];return n===le?ne:n}return yu.call(t,e)?t[e]:ne}function nn(e){var t=this.__data__;return rp?t[e]!==ne:yu.call(t,e)}function on(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=rp&&t===ne?le:t,this}function rn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function an(){this.__data__=[],this.size=0}function sn(e){var t=this.__data__,n=On(t,e);if(n<0)return!1;var o=t.length-1;return n==o?t.pop():Ou.call(t,n,1),--this.size,
!0}function ln(e){var t=this.__data__,n=On(t,e);return n<0?ne:t[n][1]}function cn(e){return On(this.__data__,e)>-1}function un(e,t){var n=this.__data__,o=On(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}function pn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function dn(){this.size=0,this.__data__={hash:new Wt,map:new(ep||rn),string:new Wt}}function gn(e){var t=Pi(this,e).delete(e);return this.size-=t?1:0,t}function fn(e){return Pi(this,e).get(e)}function hn(e){return Pi(this,e).has(e)}function mn(e,t){var n=Pi(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this}function vn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new pn;++t<n;)this.add(e[t])}function yn(e){return this.__data__.set(e,le),this}function Cn(e){return this.__data__.has(e)}function Sn(e){var t=this.__data__=new rn(e);this.size=t.size}function bn(){this.__data__=new rn,this.size=0}function wn(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function Pn(e){return this.__data__.get(e)}function In(e){return this.__data__.has(e)}function Tn(e,t){var n=this.__data__;if(n instanceof rn){var o=n.__data__;if(!ep||o.length<re-1)return o.push([e,t]),this.size=++n.size,this;n=this.__data__=new pn(o)}return n.set(e,t),this.size=n.size,this}function En(e,t){var n=yd(e),o=!n&&vd(e),r=!n&&!o&&Sd(e),i=!n&&!o&&!r&&Td(e),a=n||o||r||i,s=a?U(e.length,pu):[],l=s.length;for(var c in e)!t&&!yu.call(e,c)||a&&("length"==c||r&&("offset"==c||"parent"==c)||i&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||ki(c,l))||s.push(c);return s}function Ln(e){var t=e.length;return t?e[nr(0,t-1)]:ne}function An(e,t){return ea(zr(e),zn(t,0,e.length))}function Un(e){return ea(zr(e))}function xn(e,t,n){(n===ne||qs(e[t],n))&&(n!==ne||t in e)||_n(e,t,n)}function Nn(e,t,n){var o=e[t];yu.call(e,t)&&qs(o,n)&&(n!==ne||t in e)||_n(e,t,n)}function On(e,t){for(var n=e.length;n--;)if(qs(e[n][0],t))return n;return-1}function Rn(e,t,n,o){return mp(e,function(e,r,i){t(o,e,n(e),i)}),o}function Fn(e,t){return e&&Dr(t,Hl(t),e)}function kn(e,t){return e&&Dr(t,Vl(t),e)}function _n(e,t,n){"__proto__"==t&&_u?_u(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Bn(e,t){for(var n=-1,o=t.length,r=ru(o),i=null==e;++n<o;)r[n]=i?ne:Dl(e,t[n]);return r}function zn(e,t,n){return e===e&&(n!==ne&&(e=e<=n?e:n),t!==ne&&(e=e>=t?e:t)),e}function Dn(e,t,n,o,r,a){var s,l=t&pe,c=t&de,u=t&ge;if(n&&(s=r?n(e,o,r,a):n(e)),s!==ne)return s;if(!al(e))return e;var p=yd(e);if(p){if(s=xi(e),!l)return zr(e,s)}else{var d=Ap(e),g=d==$e||d==Je;if(Sd(e))return Ar(e,l);if(d==Ze||d==Me||g&&!r){if(s=c||g?{}:Ni(e),!l)return c?Mr(e,kn(s,e)):Wr(e,Fn(s,e))}else{if(!Qn[d])return r?e:{};s=Oi(e,d,l)}}a||(a=new Sn);var f=a.get(e);if(f)return f;a.set(e,s),Id(e)?e.forEach(function(o){s.add(Dn(o,t,n,o,e,a))}):wd(e)&&e.forEach(function(o,r){s.set(r,Dn(o,t,n,r,e,a))});var h=u?c?Ci:yi:c?Vl:Hl,m=p?ne:h(e);return i(m||e,function(o,r){m&&(r=o,o=e[r]),Nn(s,r,Dn(o,t,n,r,e,a))}),s}function Wn(e){var t=Hl(e);return function(n){return Vn(n,e,t)}}function Vn(e,t,n){var o=n.length;if(null==e)return!o;for(e=cu(e);o--;){var r=n[o],i=t[r],a=e[r];if(a===ne&&!(r in e)||!i(a))return!1}return!0}function jn(e,t,n){if("function"!=typeof e)throw new du(ae);return Np(function(){e.apply(ne,n)},t)}function Kn(e,t,n,o){var r=-1,i=c,a=!0,s=e.length,l=[],d=t.length;if(!s)return l;n&&(t=p(t,O(n))),o?(i=u,a=!1):t.length>=re&&(i=F,a=!1,t=new vn(t));e:for(;++r<s;){var g=e[r],f=null==n?g:n(g);if(g=o||0!==g?g:0,a&&f===f){for(var h=d;h--;)if(t[h]===f)continue e;l.push(g)}else i(t,f,o)||l.push(g)}return l}function Gn(e,t){var n=!0;return mp(e,function(e,o,r){return n=!!t(e,o,r)}),n}function Yn(e,t,n){for(var o=-1,r=e.length;++o<r;){var i=e[o],a=t(i);if(null!=a&&(s===ne?a===a&&!yl(a):n(a,s)))var s=a,l=i}return l}function Xn(e,t,n,o){var r=e.length;for(n=Il(n),n<0&&(n=-n>r?0:r+n),o=o===ne||o>r?r:Il(o),o<0&&(o+=r),o=n>o?0:Tl(o);n<o;)e[n++]=t;return e}function Zn(e,t){var n=[];return mp(e,function(e,o,r){t(e,o,r)&&n.push(e)}),n}function eo(e,t,n,o,r){var i=-1,a=e.length;for(n||(n=Fi),r||(r=[]);++i<a;){var s=e[i];t>0&&n(s)?t>1?eo(s,t-1,n,o,r):d(r,s):o||(r[r.length]=s)}return r}function oo(e,t){return e&&yp(e,t,Hl)}function ro(e,t){return e&&Cp(e,t,Hl)}function ao(e,t){return l(t,function(t){return ol(e[t])})}function so(e,t){t=Er(t,e);for(var n=0,o=t.length;null!=e&&n<o;)e=e[ta(t[n++])];return n&&n==o?e:ne}function co(e,t,n){var o=t(e);return yd(e)?o:d(o,n(e))}function uo(e){return null==e?e===ne?at:Xe:ku&&ku in cu(e)?Ei(e):qi(e)}function yo(e,t){return e>t}function wo(e,t){return null!=e&&yu.call(e,t)}function Io(e,t){return null!=e&&t in cu(e)}function To(e,t,n){return e>=$u(t,n)&&e<qu(t,n)}function Eo(e,t,n){for(var o=n?u:c,r=e[0].length,i=e.length,a=i,s=ru(i),l=1/0,d=[];a--;){var g=e[a];a&&t&&(g=p(g,O(t))),l=$u(g.length,l),s[a]=!n&&(t||r>=120&&g.length>=120)?new vn(a&&g):ne}g=e[0];var f=-1,h=s[0];e:for(;++f<r&&d.length<l;){var m=g[f],v=t?t(m):m;if(m=n||0!==m?m:0,!(h?F(h,v):o(d,v,n))){for(a=i;--a;){var y=s[a];if(!(y?F(y,v):o(e[a],v,n)))continue e}h&&h.push(v),d.push(m)}}return d}function Lo(e,t,n,o){return oo(e,function(e,r,i){t(o,n(e),r,i)}),o}function Ao(e,t,n){t=Er(t,e),e=Ji(e,t);var r=null==e?e:e[ta(Pa(t))];return null==r?ne:o(r,e,n)}function Uo(e){return sl(e)&&uo(e)==Me}function xo(e){return sl(e)&&uo(e)==ct}function No(e){return sl(e)&&uo(e)==Ke}function Oo(e,t,n,o,r){return e===t||(null==e||null==t||!sl(e)&&!sl(t)?e!==e&&t!==t:Ro(e,t,n,o,Oo,r))}function Ro(e,t,n,o,r,i){var a=yd(e),s=yd(t),l=a?He:Ap(e),c=s?He:Ap(t);l=l==Me?Ze:l,c=c==Me?Ze:c;var u=l==Ze,p=c==Ze,d=l==c;if(d&&Sd(e)){if(!Sd(t))return!1;a=!0,u=!1}if(d&&!u)return i||(i=new Sn),a||Td(e)?fi(e,t,n,o,r,i):hi(e,t,l,n,o,r,i);if(!(n&fe)){var g=u&&yu.call(e,"__wrapped__"),f=p&&yu.call(t,"__wrapped__");if(g||f){var h=g?e.value():e,m=f?t.value():t;return i||(i=new Sn),r(h,m,n,o,i)}}return!!d&&(i||(i=new Sn),mi(e,t,n,o,r,i))}function Fo(e){return sl(e)&&Ap(e)==Qe}function ko(e,t,n,o){var r=n.length,i=r,a=!o;if(null==e)return!i;for(e=cu(e);r--;){var s=n[r];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++r<i;){s=n[r];var l=s[0],c=e[l],u=s[1];if(a&&s[2]){if(c===ne&&!(l in e))return!1}else{var p=new Sn;if(o)var d=o(c,u,l,e,t,p);if(!(d===ne?Oo(u,c,fe|he,o,p):d))return!1}}return!0}function _o(e){if(!al(e)||Wi(e))return!1;var t=ol(e)?Iu:qt;return t.test(na(e))}function Bo(e){return sl(e)&&uo(e)==nt}function zo(e){return sl(e)&&Ap(e)==ot}function Do(e){return sl(e)&&il(e.length)&&!!Jn[uo(e)]}function Wo(e){return"function"==typeof e?e:null==e?Oc:"object"==typeof e?yd(e)?Go(e[0],e[1]):Ko(e):Wc(e)}function Mo(e){if(!Mi(e))return Gu(e);var t=[];for(var n in cu(e))yu.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Ho(e){if(!al(e))return Gi(e);var t=Mi(e),n=[];for(var o in e)("constructor"!=o||!t&&yu.call(e,o))&&n.push(o);return n}function Vo(e,t){return e<t}function jo(e,t){var n=-1,o=$s(e)?ru(e.length):[];return mp(e,function(e,r,i){o[++n]=t(e,r,i)}),o}function Ko(e){var t=Ii(e);return 1==t.length&&t[0][2]?Vi(t[0][0],t[0][1]):function(n){return n===e||ko(n,e,t)}}function Go(e,t){return Bi(e)&&Hi(t)?Vi(ta(e),t):function(n){var o=Dl(n,e);return o===ne&&o===t?Ml(n,e):Oo(t,o,fe|he)}}function qo(e,t,n,o,r){e!==t&&yp(t,function(i,a){if(r||(r=new Sn),al(i))$o(e,t,a,n,qo,o,r);else{var s=o?o(Yi(e,a),i,a+"",e,t,r):ne;s===ne&&(s=i),xn(e,a,s)}},Vl)}function $o(e,t,n,o,r,i,a){var s=Yi(e,n),l=Yi(t,n),c=a.get(l);if(c)return void xn(e,n,c);var u=i?i(s,l,n+"",e,t,a):ne,p=u===ne;if(p){var d=yd(l),g=!d&&Sd(l),f=!d&&!g&&Td(l);u=l,d||g||f?yd(s)?u=s:Js(s)?u=zr(s):g?(p=!1,u=Ar(l,!0)):f?(p=!1,u=Rr(l,!0)):u=[]:hl(l)||vd(l)?(u=s,vd(s)?u=Ll(s):al(s)&&!ol(s)||(u=Ni(l))):p=!1}p&&(a.set(l,u),r(u,l,o,i,a),a.delete(l)),xn(e,n,u)}function Jo(e,t){var n=e.length;if(n)return t+=t<0?n:0,ki(t,n)?e[t]:ne}function Qo(e,t,n){t=t.length?p(t,function(e){return yd(e)?function(t){return so(t,1===e.length?e[0]:e)}:e}):[Oc];var o=-1;t=p(t,O(wi()));var r=jo(e,function(e,n,r){var i=p(t,function(t){return t(e)});return{criteria:i,index:++o,value:e}});return L(r,function(e,t){return kr(e,t,n)})}function Yo(e,t){return Xo(e,t,function(t,n){return Ml(e,n)})}function Xo(e,t,n){for(var o=-1,r=t.length,i={};++o<r;){var a=t[o],s=so(e,a);n(s,a)&&lr(i,Er(a,e),s)}return i}function Zo(e){return function(t){return so(t,e)}}function er(e,t,n,o){var r=o?b:S,i=-1,a=t.length,s=e;for(e===t&&(t=zr(t)),n&&(s=p(e,O(n)));++i<a;)for(var l=0,c=t[i],u=n?n(c):c;(l=r(s,u,l,o))>-1;)s!==e&&Ou.call(s,l,1),Ou.call(e,l,1);return e}function tr(e,t){for(var n=e?t.length:0,o=n-1;n--;){var r=t[n];if(n==o||r!==i){var i=r;ki(r)?Ou.call(e,r,1):yr(e,r)}}return e}function nr(e,t){return e+Mu(Yu()*(t-e+1))}function or(e,t,n,o){for(var r=-1,i=qu(Wu((t-e)/(n||1)),0),a=ru(i);i--;)a[o?i:++r]=e,e+=n;return a}function rr(e,t){var n="";if(!e||t<1||t>Fe)return n;do t%2&&(n+=e),t=Mu(t/2),t&&(e+=e);while(t);return n}function ir(e,t){return Op($i(e,t,Oc),e+"")}function ar(e){return Ln(tc(e))}function sr(e,t){var n=tc(e);return ea(n,zn(t,0,n.length))}function lr(e,t,n,o){if(!al(e))return e;t=Er(t,e);for(var r=-1,i=t.length,a=i-1,s=e;null!=s&&++r<i;){var l=ta(t[r]),c=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(r!=a){var u=s[l];c=o?o(u,l,s):ne,c===ne&&(c=al(u)?u:ki(t[r+1])?[]:{})}Nn(s,l,c),s=s[l]}return e}function cr(e){return ea(tc(e))}function ur(e,t,n){var o=-1,r=e.length;t<0&&(t=-t>r?0:r+t),n=n>r?r:n,n<0&&(n+=r),r=t>n?0:n-t>>>0,t>>>=0;for(var i=ru(r);++o<r;)i[o]=e[o+t];return i}function pr(e,t){var n;return mp(e,function(e,o,r){return n=t(e,o,r),!n}),!!n}function dr(e,t,n){var o=0,r=null==e?o:e.length;if("number"==typeof t&&t===t&&r<=De){for(;o<r;){var i=o+r>>>1,a=e[i];null!==a&&!yl(a)&&(n?a<=t:a<t)?o=i+1:r=i}return r}return gr(e,t,Oc,n)}function gr(e,t,n,o){var r=0,i=null==e?0:e.length;if(0===i)return 0;t=n(t);for(var a=t!==t,s=null===t,l=yl(t),c=t===ne;r<i;){var u=Mu((r+i)/2),p=n(e[u]),d=p!==ne,g=null===p,f=p===p,h=yl(p);if(a)var m=o||f;else m=c?f&&(o||d):s?f&&d&&(o||!g):l?f&&d&&!g&&(o||!h):!g&&!h&&(o?p<=t:p<t);m?r=u+1:i=u}return $u(i,ze)}function fr(e,t){for(var n=-1,o=e.length,r=0,i=[];++n<o;){var a=e[n],s=t?t(a):a;if(!n||!qs(s,l)){var l=s;i[r++]=0===a?0:a}}return i}function hr(e){return"number"==typeof e?e:yl(e)?_e:+e}function mr(e){if("string"==typeof e)return e;if(yd(e))return p(e,mr)+"";if(yl(e))return fp?fp.call(e):"";var t=e+"";return"0"==t&&1/e==-Re?"-0":t}function vr(e,t,n){var o=-1,r=c,i=e.length,a=!0,s=[],l=s;if(n)a=!1,r=u;else if(i>=re){var p=t?null:Ip(e);if(p)return G(p);a=!1,r=F,l=new vn}else l=t?[]:s;e:for(;++o<i;){var d=e[o],g=t?t(d):d;if(d=n||0!==d?d:0,a&&g===g){for(var f=l.length;f--;)if(l[f]===g)continue e;t&&l.push(g),s.push(d)}else r(l,g,n)||(l!==s&&l.push(g),s.push(d))}return s}function yr(e,t){return t=Er(t,e),e=Ji(e,t),null==e||delete e[ta(Pa(t))]}function Cr(e,t,n,o){return lr(e,t,n(so(e,t)),o)}function Sr(e,t,n,o){for(var r=e.length,i=o?r:-1;(o?i--:++i<r)&&t(e[i],i,e););return n?ur(e,o?0:i,o?i+1:r):ur(e,o?i+1:0,o?r:i)}function br(e,t){var n=e;return n instanceof $&&(n=n.value()),g(t,function(e,t){return t.func.apply(t.thisArg,d([e],t.args))},n)}function wr(e,t,n){var o=e.length;if(o<2)return o?vr(e[0]):[];for(var r=-1,i=ru(o);++r<o;)for(var a=e[r],s=-1;++s<o;)s!=r&&(i[r]=Kn(i[r]||a,e[s],t,n));return vr(eo(i,1),t,n)}function Pr(e,t,n){for(var o=-1,r=e.length,i=t.length,a={};++o<r;){var s=o<i?t[o]:ne;n(a,e[o],s)}return a}function Ir(e){return Js(e)?e:[]}function Tr(e){return"function"==typeof e?e:Oc}function Er(e,t){return yd(e)?e:Bi(e,t)?[e]:Rp(Ul(e))}function Lr(e,t,n){var o=e.length;return n=n===ne?o:n,!t&&n>=o?e:ur(e,t,n)}function Ar(e,t){if(t)return e.slice();var n=e.length,o=Au?Au(n):new e.constructor(n);return e.copy(o),o}function Ur(e){var t=new e.constructor(e.byteLength);return new Lu(t).set(new Lu(e)),t}function xr(e,t){var n=t?Ur(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}function Nr(e){var t=new e.constructor(e.source,jt.exec(e));return t.lastIndex=e.lastIndex,t}function Or(e){return gp?cu(gp.call(e)):{}}function Rr(e,t){var n=t?Ur(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Fr(e,t){if(e!==t){var n=e!==ne,o=null===e,r=e===e,i=yl(e),a=t!==ne,s=null===t,l=t===t,c=yl(t);if(!s&&!c&&!i&&e>t||i&&a&&l&&!s&&!c||o&&a&&l||!n&&l||!r)return 1;if(!o&&!i&&!c&&e<t||c&&n&&r&&!o&&!i||s&&n&&r||!a&&r||!l)return-1}return 0}function kr(e,t,n){for(var o=-1,r=e.criteria,i=t.criteria,a=r.length,s=n.length;++o<a;){var l=Fr(r[o],i[o]);if(l){if(o>=s)return l;var c=n[o];return l*("desc"==c?-1:1)}}return e.index-t.index}function _r(e,t,n,o){for(var r=-1,i=e.length,a=n.length,s=-1,l=t.length,c=qu(i-a,0),u=ru(l+c),p=!o;++s<l;)u[s]=t[s];for(;++r<a;)(p||r<i)&&(u[n[r]]=e[r]);for(;c--;)u[s++]=e[r++];return u}function Br(e,t,n,o){for(var r=-1,i=e.length,a=-1,s=n.length,l=-1,c=t.length,u=qu(i-s,0),p=ru(u+c),d=!o;++r<u;)p[r]=e[r];for(var g=r;++l<c;)p[g+l]=t[l];for(;++a<s;)(d||r<i)&&(p[g+n[a]]=e[r++]);return p}function zr(e,t){var n=-1,o=e.length;for(t||(t=ru(o));++n<o;)t[n]=e[n];return t}function Dr(e,t,n,o){var r=!n;n||(n={});for(var i=-1,a=t.length;++i<a;){var s=t[i],l=o?o(n[s],e[s],s,n,e):ne;l===ne&&(l=e[s]),r?_n(n,s,l):Nn(n,s,l)}return n}function Wr(e,t){return Dr(e,Ep(e),t)}function Mr(e,t){return Dr(e,Lp(e),t)}function Hr(e,t){return function(n,o){var i=yd(n)?r:Rn,a=t?t():{};return i(n,e,wi(o,2),a)}}function Vr(e){return ir(function(t,n){var o=-1,r=n.length,i=r>1?n[r-1]:ne,a=r>2?n[2]:ne;for(i=e.length>3&&"function"==typeof i?(r--,i):ne,a&&_i(n[0],n[1],a)&&(i=r<3?ne:i,r=1),t=cu(t);++o<r;){var s=n[o];s&&e(t,s,o,i)}return t})}function jr(e,t){return function(n,o){if(null==n)return n;if(!$s(n))return e(n,o);for(var r=n.length,i=t?r:-1,a=cu(n);(t?i--:++i<r)&&o(a[i],i,a)!==!1;);return n}}function Kr(e){return function(t,n,o){for(var r=-1,i=cu(t),a=o(t),s=a.length;s--;){var l=a[e?s:++r];if(n(i[l],l,i)===!1)break}return t}}function Gr(e,t,n){function o(){var t=this&&this!==io&&this instanceof o?i:e;return t.apply(r?n:this,arguments)}var r=t&me,i=Jr(e);return o}function qr(e){return function(t){t=Ul(t);var n=W(t)?Y(t):ne,o=n?n[0]:t.charAt(0),r=n?Lr(n,1).join(""):t.slice(1);return o[e]()+r}}function $r(e){return function(t){return g(Lc(sc(t).replace(Mn,"")),e,"")}}function Jr(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=hp(e.prototype),o=e.apply(n,t);return al(o)?o:n}}function Qr(e,t,n){function r(){for(var a=arguments.length,s=ru(a),l=a,c=bi(r);l--;)s[l]=arguments[l];var u=a<3&&s[0]!==c&&s[a-1]!==c?[]:K(s,c);if(a-=u.length,a<n)return si(e,t,Zr,r.placeholder,ne,s,u,ne,ne,n-a);var p=this&&this!==io&&this instanceof r?i:e;return o(p,this,s)}var i=Jr(e);return r}function Yr(e){return function(t,n,o){var r=cu(t);if(!$s(t)){var i=wi(n,3);t=Hl(t),n=function(e){return i(r[e],e,r)}}var a=e(t,n,o);return a>-1?r[i?t[a]:a]:ne}}function Xr(e){return vi(function(t){var n=t.length,o=n,r=T.prototype.thru;for(e&&t.reverse();o--;){var i=t[o];if("function"!=typeof i)throw new du(ae);if(r&&!a&&"wrapper"==Si(i))var a=new T([],!0)}for(o=a?o:n;++o<n;){i=t[o];var s=Si(i),l="wrapper"==s?Tp(i):ne;a=l&&Di(l[0])&&l[1]==(Pe|Ce|be|Ie)&&!l[4].length&&1==l[9]?a[Si(l[0])].apply(a,l[3]):1==i.length&&Di(i)?a[s]():a.thru(i)}return function(){var e=arguments,o=e[0];if(a&&1==e.length&&yd(o))return a.plant(o).value();for(var r=0,i=n?t[r].apply(this,e):o;++r<n;)i=t[r].call(this,i);return i}})}function Zr(e,t,n,o,r,i,a,s,l,c){function u(){for(var v=arguments.length,y=ru(v),C=v;C--;)y[C]=arguments[C];if(f)var S=bi(u),b=B(y,S);if(o&&(y=_r(y,o,r,f)),i&&(y=Br(y,i,a,f)),v-=b,f&&v<c){var w=K(y,S);return si(e,t,Zr,u.placeholder,n,y,w,s,l,c-v)}var P=d?n:this,I=g?P[e]:e;return v=y.length,s?y=Qi(y,s):h&&v>1&&y.reverse(),p&&l<v&&(y.length=l),this&&this!==io&&this instanceof u&&(I=m||Jr(I)),I.apply(P,y)}var p=t&Pe,d=t&me,g=t&ve,f=t&(Ce|Se),h=t&Te,m=g?ne:Jr(e);return u}function ei(e,t){return function(n,o){return Lo(n,e,t(o),{})}}function ti(e,t){return function(n,o){var r;if(n===ne&&o===ne)return t;if(n!==ne&&(r=n),o!==ne){if(r===ne)return o;"string"==typeof n||"string"==typeof o?(n=mr(n),o=mr(o)):(n=hr(n),o=hr(o)),r=e(n,o)}return r}}function ni(e){return vi(function(t){return t=p(t,O(wi())),ir(function(n){var r=this;return e(t,function(e){return o(e,r,n)})})})}function oi(e,t){t=t===ne?" ":mr(t);var n=t.length;if(n<2)return n?rr(t,e):t;var o=rr(t,Wu(e/Q(t)));return W(t)?Lr(Y(o),0,e).join(""):o.slice(0,e)}function ri(e,t,n,r){function i(){for(var t=-1,l=arguments.length,c=-1,u=r.length,p=ru(u+l),d=this&&this!==io&&this instanceof i?s:e;++c<u;)p[c]=r[c];for(;l--;)p[c++]=arguments[++t];return o(d,a?n:this,p)}var a=t&me,s=Jr(e);return i}function ii(e){return function(t,n,o){return o&&"number"!=typeof o&&_i(t,n,o)&&(n=o=ne),t=Pl(t),n===ne?(n=t,t=0):n=Pl(n),o=o===ne?t<n?1:-1:Pl(o),or(t,n,o,e)}}function ai(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=El(t),n=El(n)),e(t,n)}}function si(e,t,n,o,r,i,a,s,l,c){var u=t&Ce,p=u?a:ne,d=u?ne:a,g=u?i:ne,f=u?ne:i;t|=u?be:we,t&=~(u?we:be),t&ye||(t&=~(me|ve));var h=[e,t,r,g,p,f,d,s,l,c],m=n.apply(ne,h);return Di(e)&&xp(m,h),m.placeholder=o,Xi(m,e,t)}function li(e){var t=lu[e];return function(e,n){if(e=El(e),n=null==n?0:$u(Il(n),292),n&&ju(e)){var o=(Ul(e)+"e").split("e"),r=t(o[0]+"e"+(+o[1]+n));return o=(Ul(r)+"e").split("e"),+(o[0]+"e"+(+o[1]-n))}return t(e)}}function ci(e){return function(t){var n=Ap(t);return n==Qe?V(t):n==ot?q(t):x(t,e(t))}}function ui(e,t,n,o,r,i,a,s){var l=t&ve;if(!l&&"function"!=typeof e)throw new du(ae);var c=o?o.length:0;if(c||(t&=~(be|we),o=r=ne),a=a===ne?a:qu(Il(a),0),s=s===ne?s:Il(s),c-=r?r.length:0,t&we){var u=o,p=r;o=r=ne}var d=l?ne:Tp(e),g=[e,t,n,o,r,u,p,i,a,s];if(d&&Ki(g,d),e=g[0],t=g[1],n=g[2],o=g[3],r=g[4],s=g[9]=g[9]===ne?l?0:e.length:qu(g[9]-c,0),!s&&t&(Ce|Se)&&(t&=~(Ce|Se)),t&&t!=me)f=t==Ce||t==Se?Qr(e,t,s):t!=be&&t!=(me|be)||r.length?Zr.apply(ne,g):ri(e,t,n,o);else var f=Gr(e,t,n);var h=d?Sp:xp;return Xi(h(f,g),e,t)}function pi(e,t,n,o){return e===ne||qs(e,hu[n])&&!yu.call(o,n)?t:e}function di(e,t,n,o,r,i){return al(e)&&al(t)&&(i.set(t,e),qo(e,t,ne,di,i),i.delete(t)),e}function gi(e){return hl(e)?ne:e}function fi(e,t,n,o,r,i){var a=n&fe,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var c=i.get(e),u=i.get(t);if(c&&u)return c==t&&u==e;var p=-1,d=!0,g=n&he?new vn:ne;for(i.set(e,t),i.set(t,e);++p<s;){var f=e[p],m=t[p];if(o)var v=a?o(m,f,p,t,e,i):o(f,m,p,e,t,i);if(v!==ne){if(v)continue;d=!1;break}if(g){if(!h(t,function(e,t){if(!F(g,t)&&(f===e||r(f,e,n,o,i)))return g.push(t)})){d=!1;break}}else if(f!==m&&!r(f,m,n,o,i)){d=!1;break}}return i.delete(e),i.delete(t),d}function hi(e,t,n,o,r,i,a){switch(n){case ut:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case ct:return!(e.byteLength!=t.byteLength||!i(new Lu(e),new Lu(t)));case je:case Ke:case Ye:return qs(+e,+t);case qe:return e.name==t.name&&e.message==t.message;case nt:case rt:return e==t+"";case Qe:var s=V;case ot:var l=o&fe;if(s||(s=G),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;o|=he,a.set(e,t);var u=fi(s(e),s(t),o,r,i,a);return a.delete(e),u;case it:if(gp)return gp.call(e)==gp.call(t)}return!1}function mi(e,t,n,o,r,i){var a=n&fe,s=yi(e),l=s.length,c=yi(t),u=c.length;if(l!=u&&!a)return!1;for(var p=l;p--;){var d=s[p];if(!(a?d in t:yu.call(t,d)))return!1}var g=i.get(e),f=i.get(t);if(g&&f)return g==t&&f==e;var h=!0;i.set(e,t),i.set(t,e);for(var m=a;++p<l;){d=s[p];var v=e[d],y=t[d];if(o)var C=a?o(y,v,d,t,e,i):o(v,y,d,e,t,i);if(!(C===ne?v===y||r(v,y,n,o,i):C)){h=!1;break}m||(m="constructor"==d)}if(h&&!m){var S=e.constructor,b=t.constructor;S!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof S&&S instanceof S&&"function"==typeof b&&b instanceof b)&&(h=!1)}return i.delete(e),i.delete(t),h}function vi(e){return Op($i(e,ne,ha),e+"")}function yi(e){return co(e,Hl,Ep)}function Ci(e){return co(e,Vl,Lp)}function Si(e){for(var t=e.name+"",n=ap[t],o=yu.call(ap,t)?n.length:0;o--;){var r=n[o],i=r.func;if(null==i||i==e)return r.name}return t}function bi(e){var t=yu.call(n,"placeholder")?n:e;return t.placeholder}function wi(){var e=n.iteratee||Rc;return e=e===Rc?Wo:e,arguments.length?e(arguments[0],arguments[1]):e}function Pi(e,t){var n=e.__data__;return zi(t)?n["string"==typeof t?"string":"hash"]:n.map}function Ii(e){for(var t=Hl(e),n=t.length;n--;){var o=t[n],r=e[o];t[n]=[o,r,Hi(r)]}return t}function Ti(e,t){var n=D(e,t);return _o(n)?n:ne}function Ei(e){var t=yu.call(e,ku),n=e[ku];try{e[ku]=ne;var o=!0}catch(e){}var r=bu.call(e);return o&&(t?e[ku]=n:delete e[ku]),r}function Li(e,t,n){for(var o=-1,r=n.length;++o<r;){var i=n[o],a=i.size;switch(i.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=$u(t,e+a);break;case"takeRight":e=qu(e,t-a)}}return{start:e,end:t}}function Ai(e){var t=e.match(zt);return t?t[1].split(Dt):[]}function Ui(e,t,n){t=Er(t,e);for(var o=-1,r=t.length,i=!1;++o<r;){var a=ta(t[o]);if(!(i=null!=e&&n(e,a)))break;e=e[a]}return i||++o!=r?i:(r=null==e?0:e.length,!!r&&il(r)&&ki(a,r)&&(yd(e)||vd(e)))}function xi(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&yu.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function Ni(e){return"function"!=typeof e.constructor||Mi(e)?{}:hp(Uu(e))}function Oi(e,t,n){var o=e.constructor;switch(t){case ct:return Ur(e);case je:case Ke:return new o(+e);case ut:return xr(e,n);case pt:case dt:case gt:case ft:case ht:case mt:case vt:case yt:case Ct:return Rr(e,n);case Qe:return new o;case Ye:case rt:return new o(e);case nt:return Nr(e);case ot:return new o;case it:return Or(e)}}function Ri(e,t){var n=t.length;if(!n)return e;var o=n-1;return t[o]=(n>1?"& ":"")+t[o],t=t.join(n>2?", ":" "),e.replace(Bt,"{\n/* [wrapped with "+t+"] */\n")}function Fi(e){return yd(e)||vd(e)||!!(Ru&&e&&e[Ru])}function ki(e,t){var n=typeof e;return t=null==t?Fe:t,!!t&&("number"==n||"symbol"!=n&&Jt.test(e))&&e>-1&&e%1==0&&e<t}function _i(e,t,n){if(!al(n))return!1;var o=typeof t;return!!("number"==o?$s(n)&&ki(t,n.length):"string"==o&&t in n)&&qs(n[t],e)}function Bi(e,t){if(yd(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!yl(e))||(Nt.test(e)||!xt.test(e)||null!=t&&e in cu(t))}function zi(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function Di(e){var t=Si(e),o=n[t];if("function"!=typeof o||!(t in $.prototype))return!1;if(e===o)return!0;var r=Tp(o);return!!r&&e===r[0]}function Wi(e){return!!Su&&Su in e}function Mi(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||hu;return e===n}function Hi(e){return e===e&&!al(e)}function Vi(e,t){return function(n){return null!=n&&(n[e]===t&&(t!==ne||e in cu(n)))}}function ji(e){var t=Rs(e,function(e){return n.size===ce&&n.clear(),e}),n=t.cache;return t}function Ki(e,t){var n=e[1],o=t[1],r=n|o,i=r<(me|ve|Pe),a=o==Pe&&n==Ce||o==Pe&&n==Ie&&e[7].length<=t[8]||o==(Pe|Ie)&&t[7].length<=t[8]&&n==Ce;if(!i&&!a)return e;o&me&&(e[2]=t[2],r|=n&me?0:ye);var s=t[3];if(s){var l=e[3];e[3]=l?_r(l,s,t[4]):s,e[4]=l?K(e[3],ue):t[4]}return s=t[5],s&&(l=e[5],e[5]=l?Br(l,s,t[6]):s,e[6]=l?K(e[5],ue):t[6]),s=t[7],s&&(e[7]=s),o&Pe&&(e[8]=null==e[8]?t[8]:$u(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=r,e}function Gi(e){var t=[];if(null!=e)for(var n in cu(e))t.push(n);return t}function qi(e){return bu.call(e)}function $i(e,t,n){return t=qu(t===ne?e.length-1:t,0),function(){for(var r=arguments,i=-1,a=qu(r.length-t,0),s=ru(a);++i<a;)s[i]=r[t+i];i=-1;for(var l=ru(t+1);++i<t;)l[i]=r[i];return l[t]=n(s),o(e,this,l)}}function Ji(e,t){return t.length<2?e:so(e,ur(t,0,-1))}function Qi(e,t){for(var n=e.length,o=$u(t.length,n),r=zr(e);o--;){var i=t[o];e[o]=ki(i,n)?r[i]:ne}return e}function Yi(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function Xi(e,t,n){var o=t+"";return Op(e,Ri(o,oa(Ai(o),n)))}function Zi(e){var t=0,n=0;return function(){var o=Ju(),r=Ue-(o-n);if(n=o,r>0){if(++t>=Ae)return arguments[0]}else t=0;return e.apply(ne,arguments)}}function ea(e,t){var n=-1,o=e.length,r=o-1;for(t=t===ne?o:t;++n<t;){var i=nr(n,r),a=e[i];e[i]=e[n],e[n]=a}return e.length=t,e}function ta(e){if("string"==typeof e||yl(e))return e;var t=e+"";return"0"==t&&1/e==-Re?"-0":t}function na(e){if(null!=e){try{return vu.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function oa(e,t){return i(We,function(n){var o="_."+n[0];t&n[1]&&!c(e,o)&&e.push(o)}),e.sort()}function ra(e){if(e instanceof $)return e.clone();var t=new T(e.__wrapped__,e.__chain__);return t.__actions__=zr(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function ia(e,t,n){t=(n?_i(e,t,n):t===ne)?1:qu(Il(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];for(var r=0,i=0,a=ru(Wu(o/t));r<o;)a[i++]=ur(e,r,r+=t);return a}function aa(e){for(var t=-1,n=null==e?0:e.length,o=0,r=[];++t<n;){var i=e[t];i&&(r[o++]=i)}return r}function sa(){var e=arguments.length;if(!e)return[];for(var t=ru(e-1),n=arguments[0],o=e;o--;)t[o-1]=arguments[o];return d(yd(n)?zr(n):[n],eo(t,1))}function la(e,t,n){var o=null==e?0:e.length;return o?(t=n||t===ne?1:Il(t),ur(e,t<0?0:t,o)):[]}function ca(e,t,n){var o=null==e?0:e.length;return o?(t=n||t===ne?1:Il(t),t=o-t,ur(e,0,t<0?0:t)):[]}function ua(e,t){return e&&e.length?Sr(e,wi(t,3),!0,!0):[]}function pa(e,t){return e&&e.length?Sr(e,wi(t,3),!0):[]}function da(e,t,n,o){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&_i(e,t,n)&&(n=0,o=r),Xn(e,t,n,o)):[]}function ga(e,t,n){var o=null==e?0:e.length;if(!o)return-1;var r=null==n?0:Il(n);return r<0&&(r=qu(o+r,0)),C(e,wi(t,3),r)}function fa(e,t,n){var o=null==e?0:e.length;if(!o)return-1;var r=o-1;return n!==ne&&(r=Il(n),r=n<0?qu(o+r,0):$u(r,o-1)),C(e,wi(t,3),r,!0)}function ha(e){var t=null==e?0:e.length;return t?eo(e,1):[]}function ma(e){var t=null==e?0:e.length;return t?eo(e,Re):[]}function va(e,t){var n=null==e?0:e.length;return n?(t=t===ne?1:Il(t),eo(e,t)):[]}function ya(e){for(var t=-1,n=null==e?0:e.length,o={};++t<n;){var r=e[t];o[r[0]]=r[1]}return o}function Ca(e){return e&&e.length?e[0]:ne}function Sa(e,t,n){var o=null==e?0:e.length;if(!o)return-1;var r=null==n?0:Il(n);return r<0&&(r=qu(o+r,0)),S(e,t,r)}function ba(e){var t=null==e?0:e.length;return t?ur(e,0,-1):[]}function wa(e,t){return null==e?"":Ku.call(e,t)}function Pa(e){var t=null==e?0:e.length;return t?e[t-1]:ne}function Ia(e,t,n){var o=null==e?0:e.length;if(!o)return-1;var r=o;return n!==ne&&(r=Il(n),r=r<0?qu(o+r,0):$u(r,o-1)),t===t?J(e,t,r):C(e,w,r,!0)}function Ta(e,t){return e&&e.length?Jo(e,Il(t)):ne}function Ea(e,t){return e&&e.length&&t&&t.length?er(e,t):e}function La(e,t,n){return e&&e.length&&t&&t.length?er(e,t,wi(n,2)):e}function Aa(e,t,n){return e&&e.length&&t&&t.length?er(e,t,ne,n):e}function Ua(e,t){var n=[];if(!e||!e.length)return n;var o=-1,r=[],i=e.length;for(t=wi(t,3);++o<i;){var a=e[o];t(a,o,e)&&(n.push(a),r.push(o))}return tr(e,r),n}function xa(e){return null==e?e:Xu.call(e)}function Na(e,t,n){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&_i(e,t,n)?(t=0,n=o):(t=null==t?0:Il(t),n=n===ne?o:Il(n)),ur(e,t,n)):[]}function Oa(e,t){return dr(e,t)}function Ra(e,t,n){return gr(e,t,wi(n,2))}function Fa(e,t){var n=null==e?0:e.length;if(n){var o=dr(e,t);if(o<n&&qs(e[o],t))return o}return-1}function ka(e,t){return dr(e,t,!0)}function _a(e,t,n){return gr(e,t,wi(n,2),!0)}function Ba(e,t){var n=null==e?0:e.length;if(n){var o=dr(e,t,!0)-1;if(qs(e[o],t))return o}return-1}function za(e){return e&&e.length?fr(e):[]}function Da(e,t){return e&&e.length?fr(e,wi(t,2)):[]}function Wa(e){var t=null==e?0:e.length;return t?ur(e,1,t):[]}function Ma(e,t,n){return e&&e.length?(t=n||t===ne?1:Il(t),ur(e,0,t<0?0:t)):[]}function Ha(e,t,n){var o=null==e?0:e.length;return o?(t=n||t===ne?1:Il(t),t=o-t,ur(e,t<0?0:t,o)):[]}function Va(e,t){return e&&e.length?Sr(e,wi(t,3),!1,!0):[]}function ja(e,t){return e&&e.length?Sr(e,wi(t,3)):[]}function Ka(e){return e&&e.length?vr(e):[]}function Ga(e,t){return e&&e.length?vr(e,wi(t,2)):[]}function qa(e,t){return t="function"==typeof t?t:ne,e&&e.length?vr(e,ne,t):[]}function $a(e){if(!e||!e.length)return[];var t=0;return e=l(e,function(e){if(Js(e))return t=qu(e.length,t),!0}),U(t,function(t){return p(e,I(t))})}function Ja(e,t){if(!e||!e.length)return[];var n=$a(e);return null==t?n:p(n,function(e){return o(t,ne,e)})}function Qa(e,t){return Pr(e||[],t||[],Nn)}function Ya(e,t){return Pr(e||[],t||[],lr)}function Xa(e){var t=n(e);return t.__chain__=!0,t}function Za(e,t){return t(e),e}function es(e,t){return t(e)}function ts(){return Xa(this)}function ns(){return new T(this.value(),this.__chain__)}function os(){this.__values__===ne&&(this.__values__=wl(this.value()));var e=this.__index__>=this.__values__.length,t=e?ne:this.__values__[this.__index__++];return{done:e,value:t}}function rs(){return this}function is(e){for(var t,n=this;n instanceof m;){var o=ra(n);o.__index__=0,o.__values__=ne,t?r.__wrapped__=o:t=o;var r=o;n=n.__wrapped__}return r.__wrapped__=e,t}function as(){var e=this.__wrapped__;if(e instanceof $){var t=e;return this.__actions__.length&&(t=new $(this)),t=t.reverse(),t.__actions__.push({func:es,args:[xa],thisArg:ne}),new T(t,this.__chain__)}return this.thru(xa)}function ss(){return br(this.__wrapped__,this.__actions__)}function ls(e,t,n){var o=yd(e)?s:Gn;return n&&_i(e,t,n)&&(t=ne),o(e,wi(t,3))}function cs(e,t){var n=yd(e)?l:Zn;return n(e,wi(t,3))}function us(e,t){return eo(ms(e,t),1)}function ps(e,t){return eo(ms(e,t),Re)}function ds(e,t,n){return n=n===ne?1:Il(n),eo(ms(e,t),n)}function gs(e,t){var n=yd(e)?i:mp;return n(e,wi(t,3))}function fs(e,t){var n=yd(e)?a:vp;return n(e,wi(t,3))}function hs(e,t,n,o){e=$s(e)?e:tc(e),n=n&&!o?Il(n):0;var r=e.length;return n<0&&(n=qu(r+n,0)),vl(e)?n<=r&&e.indexOf(t,n)>-1:!!r&&S(e,t,n)>-1}function ms(e,t){var n=yd(e)?p:jo;return n(e,wi(t,3))}function vs(e,t,n,o){return null==e?[]:(yd(t)||(t=null==t?[]:[t]),n=o?ne:n,yd(n)||(n=null==n?[]:[n]),Qo(e,t,n))}function ys(e,t,n){var o=yd(e)?g:E,r=arguments.length<3;return o(e,wi(t,4),n,r,mp)}function Cs(e,t,n){var o=yd(e)?f:E,r=arguments.length<3;return o(e,wi(t,4),n,r,vp)}function Ss(e,t){var n=yd(e)?l:Zn;return n(e,Fs(wi(t,3)))}function bs(e){var t=yd(e)?Ln:ar;return t(e)}function ws(e,t,n){t=(n?_i(e,t,n):t===ne)?1:Il(t);var o=yd(e)?An:sr;return o(e,t)}function Ps(e){var t=yd(e)?Un:cr;return t(e)}function Is(e){if(null==e)return 0;if($s(e))return vl(e)?Q(e):e.length;var t=Ap(e);return t==Qe||t==ot?e.size:Mo(e).length}function Ts(e,t,n){var o=yd(e)?h:pr;return n&&_i(e,t,n)&&(t=ne),o(e,wi(t,3))}function Es(e,t){if("function"!=typeof t)throw new du(ae);return e=Il(e),function(){if(--e<1)return t.apply(this,arguments)}}function Ls(e,t,n){return t=n?ne:t,t=e&&null==t?e.length:t,ui(e,Pe,ne,ne,ne,ne,t)}function As(e,t){var n;if("function"!=typeof t)throw new du(ae);return e=Il(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=ne),n}}function Us(e,t,n){t=n?ne:t;var o=ui(e,Ce,ne,ne,ne,ne,ne,t);return o.placeholder=Us.placeholder,o}function xs(e,t,n){t=n?ne:t;var o=ui(e,Se,ne,ne,ne,ne,ne,t);return o.placeholder=xs.placeholder,o}function Ns(e,t,n){function o(t){var n=d,o=g;return d=g=ne,y=t,h=e.apply(o,n)}function r(e){return y=e,m=Np(s,t),C?o(e):h}function i(e){var n=e-v,o=e-y,r=t-n;return S?$u(r,f-o):r}function a(e){var n=e-v,o=e-y;return v===ne||n>=t||n<0||S&&o>=f}function s(){var e=ad();return a(e)?l(e):void(m=Np(s,i(e)))}function l(e){return m=ne,b&&d?o(e):(d=g=ne,h)}function c(){m!==ne&&Pp(m),y=0,d=v=g=m=ne}function u(){return m===ne?h:l(ad())}function p(){var e=ad(),n=a(e);if(d=arguments,g=this,v=e,n){if(m===ne)return r(v);if(S)return Pp(m),m=Np(s,t),o(v)}return m===ne&&(m=Np(s,t)),h}var d,g,f,h,m,v,y=0,C=!1,S=!1,b=!0;if("function"!=typeof e)throw new du(ae);return t=El(t)||0,al(n)&&(C=!!n.leading,S="maxWait"in n,
f=S?qu(El(n.maxWait)||0,t):f,b="trailing"in n?!!n.trailing:b),p.cancel=c,p.flush=u,p}function Os(e){return ui(e,Te)}function Rs(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new du(ae);var n=function(){var o=arguments,r=t?t.apply(this,o):o[0],i=n.cache;if(i.has(r))return i.get(r);var a=e.apply(this,o);return n.cache=i.set(r,a)||i,a};return n.cache=new(Rs.Cache||pn),n}function Fs(e){if("function"!=typeof e)throw new du(ae);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function ks(e){return As(2,e)}function _s(e,t){if("function"!=typeof e)throw new du(ae);return t=t===ne?t:Il(t),ir(e,t)}function Bs(e,t){if("function"!=typeof e)throw new du(ae);return t=null==t?0:qu(Il(t),0),ir(function(n){var r=n[t],i=Lr(n,0,t);return r&&d(i,r),o(e,this,i)})}function zs(e,t,n){var o=!0,r=!0;if("function"!=typeof e)throw new du(ae);return al(n)&&(o="leading"in n?!!n.leading:o,r="trailing"in n?!!n.trailing:r),Ns(e,t,{leading:o,maxWait:t,trailing:r})}function Ds(e){return Ls(e,1)}function Ws(e,t){return dd(Tr(t),e)}function Ms(){if(!arguments.length)return[];var e=arguments[0];return yd(e)?e:[e]}function Hs(e){return Dn(e,ge)}function Vs(e,t){return t="function"==typeof t?t:ne,Dn(e,ge,t)}function js(e){return Dn(e,pe|ge)}function Ks(e,t){return t="function"==typeof t?t:ne,Dn(e,pe|ge,t)}function Gs(e,t){return null==t||Vn(e,t,Hl(t))}function qs(e,t){return e===t||e!==e&&t!==t}function $s(e){return null!=e&&il(e.length)&&!ol(e)}function Js(e){return sl(e)&&$s(e)}function Qs(e){return e===!0||e===!1||sl(e)&&uo(e)==je}function Ys(e){return sl(e)&&1===e.nodeType&&!hl(e)}function Xs(e){if(null==e)return!0;if($s(e)&&(yd(e)||"string"==typeof e||"function"==typeof e.splice||Sd(e)||Td(e)||vd(e)))return!e.length;var t=Ap(e);if(t==Qe||t==ot)return!e.size;if(Mi(e))return!Mo(e).length;for(var n in e)if(yu.call(e,n))return!1;return!0}function Zs(e,t){return Oo(e,t)}function el(e,t,n){n="function"==typeof n?n:ne;var o=n?n(e,t):ne;return o===ne?Oo(e,t,ne,n):!!o}function tl(e){if(!sl(e))return!1;var t=uo(e);return t==qe||t==Ge||"string"==typeof e.message&&"string"==typeof e.name&&!hl(e)}function nl(e){return"number"==typeof e&&ju(e)}function ol(e){if(!al(e))return!1;var t=uo(e);return t==$e||t==Je||t==Ve||t==tt}function rl(e){return"number"==typeof e&&e==Il(e)}function il(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Fe}function al(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function sl(e){return null!=e&&"object"==typeof e}function ll(e,t){return e===t||ko(e,t,Ii(t))}function cl(e,t,n){return n="function"==typeof n?n:ne,ko(e,t,Ii(t),n)}function ul(e){return fl(e)&&e!=+e}function pl(e){if(Up(e))throw new au(ie);return _o(e)}function dl(e){return null===e}function gl(e){return null==e}function fl(e){return"number"==typeof e||sl(e)&&uo(e)==Ye}function hl(e){if(!sl(e)||uo(e)!=Ze)return!1;var t=Uu(e);if(null===t)return!0;var n=yu.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&vu.call(n)==wu}function ml(e){return rl(e)&&e>=-Fe&&e<=Fe}function vl(e){return"string"==typeof e||!yd(e)&&sl(e)&&uo(e)==rt}function yl(e){return"symbol"==typeof e||sl(e)&&uo(e)==it}function Cl(e){return e===ne}function Sl(e){return sl(e)&&Ap(e)==st}function bl(e){return sl(e)&&uo(e)==lt}function wl(e){if(!e)return[];if($s(e))return vl(e)?Y(e):zr(e);if(Fu&&e[Fu])return H(e[Fu]());var t=Ap(e),n=t==Qe?V:t==ot?G:tc;return n(e)}function Pl(e){if(!e)return 0===e?e:0;if(e=El(e),e===Re||e===-Re){var t=e<0?-1:1;return t*ke}return e===e?e:0}function Il(e){var t=Pl(e),n=t%1;return t===t?n?t-n:t:0}function Tl(e){return e?zn(Il(e),0,Be):0}function El(e){if("number"==typeof e)return e;if(yl(e))return _e;if(al(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=al(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=N(e);var n=Gt.test(e);return n||$t.test(e)?no(e.slice(2),n?2:8):Kt.test(e)?_e:+e}function Ll(e){return Dr(e,Vl(e))}function Al(e){return e?zn(Il(e),-Fe,Fe):0===e?e:0}function Ul(e){return null==e?"":mr(e)}function xl(e,t){var n=hp(e);return null==t?n:Fn(n,t)}function Nl(e,t){return y(e,wi(t,3),oo)}function Ol(e,t){return y(e,wi(t,3),ro)}function Rl(e,t){return null==e?e:yp(e,wi(t,3),Vl)}function Fl(e,t){return null==e?e:Cp(e,wi(t,3),Vl)}function kl(e,t){return e&&oo(e,wi(t,3))}function _l(e,t){return e&&ro(e,wi(t,3))}function Bl(e){return null==e?[]:ao(e,Hl(e))}function zl(e){return null==e?[]:ao(e,Vl(e))}function Dl(e,t,n){var o=null==e?ne:so(e,t);return o===ne?n:o}function Wl(e,t){return null!=e&&Ui(e,t,wo)}function Ml(e,t){return null!=e&&Ui(e,t,Io)}function Hl(e){return $s(e)?En(e):Mo(e)}function Vl(e){return $s(e)?En(e,!0):Ho(e)}function jl(e,t){var n={};return t=wi(t,3),oo(e,function(e,o,r){_n(n,t(e,o,r),e)}),n}function Kl(e,t){var n={};return t=wi(t,3),oo(e,function(e,o,r){_n(n,o,t(e,o,r))}),n}function Gl(e,t){return ql(e,Fs(wi(t)))}function ql(e,t){if(null==e)return{};var n=p(Ci(e),function(e){return[e]});return t=wi(t),Xo(e,n,function(e,n){return t(e,n[0])})}function $l(e,t,n){t=Er(t,e);var o=-1,r=t.length;for(r||(r=1,e=ne);++o<r;){var i=null==e?ne:e[ta(t[o])];i===ne&&(o=r,i=n),e=ol(i)?i.call(e):i}return e}function Jl(e,t,n){return null==e?e:lr(e,t,n)}function Ql(e,t,n,o){return o="function"==typeof o?o:ne,null==e?e:lr(e,t,n,o)}function Yl(e,t,n){var o=yd(e),r=o||Sd(e)||Td(e);if(t=wi(t,4),null==n){var a=e&&e.constructor;n=r?o?new a:[]:al(e)&&ol(a)?hp(Uu(e)):{}}return(r?i:oo)(e,function(e,o,r){return t(n,e,o,r)}),n}function Xl(e,t){return null==e||yr(e,t)}function Zl(e,t,n){return null==e?e:Cr(e,t,Tr(n))}function ec(e,t,n,o){return o="function"==typeof o?o:ne,null==e?e:Cr(e,t,Tr(n),o)}function tc(e){return null==e?[]:R(e,Hl(e))}function nc(e){return null==e?[]:R(e,Vl(e))}function oc(e,t,n){return n===ne&&(n=t,t=ne),n!==ne&&(n=El(n),n=n===n?n:0),t!==ne&&(t=El(t),t=t===t?t:0),zn(El(e),t,n)}function rc(e,t,n){return t=Pl(t),n===ne?(n=t,t=0):n=Pl(n),e=El(e),To(e,t,n)}function ic(e,t,n){if(n&&"boolean"!=typeof n&&_i(e,t,n)&&(t=n=ne),n===ne&&("boolean"==typeof t?(n=t,t=ne):"boolean"==typeof e&&(n=e,e=ne)),e===ne&&t===ne?(e=0,t=1):(e=Pl(e),t===ne?(t=e,e=0):t=Pl(t)),e>t){var o=e;e=t,t=o}if(n||e%1||t%1){var r=Yu();return $u(e+r*(t-e+to("1e-"+((r+"").length-1))),t)}return nr(e,t)}function ac(e){return Yd(Ul(e).toLowerCase())}function sc(e){return e=Ul(e),e&&e.replace(Qt,Co).replace(Hn,"")}function lc(e,t,n){e=Ul(e),t=mr(t);var o=e.length;n=n===ne?o:zn(Il(n),0,o);var r=n;return n-=t.length,n>=0&&e.slice(n,r)==t}function cc(e){return e=Ul(e),e&&Et.test(e)?e.replace(It,So):e}function uc(e){return e=Ul(e),e&&Ft.test(e)?e.replace(Rt,"\\$&"):e}function pc(e,t,n){e=Ul(e),t=Il(t);var o=t?Q(e):0;if(!t||o>=t)return e;var r=(t-o)/2;return oi(Mu(r),n)+e+oi(Wu(r),n)}function dc(e,t,n){e=Ul(e),t=Il(t);var o=t?Q(e):0;return t&&o<t?e+oi(t-o,n):e}function gc(e,t,n){e=Ul(e),t=Il(t);var o=t?Q(e):0;return t&&o<t?oi(t-o,n)+e:e}function fc(e,t,n){return n||null==t?t=0:t&&(t=+t),Qu(Ul(e).replace(kt,""),t||0)}function hc(e,t,n){return t=(n?_i(e,t,n):t===ne)?1:Il(t),rr(Ul(e),t)}function mc(){var e=arguments,t=Ul(e[0]);return e.length<3?t:t.replace(e[1],e[2])}function vc(e,t,n){return n&&"number"!=typeof n&&_i(e,t,n)&&(t=n=ne),(n=n===ne?Be:n>>>0)?(e=Ul(e),e&&("string"==typeof t||null!=t&&!Pd(t))&&(t=mr(t),!t&&W(e))?Lr(Y(e),0,n):e.split(t,n)):[]}function yc(e,t,n){return e=Ul(e),n=null==n?0:zn(Il(n),0,e.length),t=mr(t),e.slice(n,n+t.length)==t}function Cc(e,t,o){var r=n.templateSettings;o&&_i(e,t,o)&&(t=ne),e=Ul(e),t=xd({},t,r,pi);var i,a,s=xd({},t.imports,r.imports,pi),l=Hl(s),c=R(s,l),u=0,p=t.interpolate||Yt,d="__p += '",g=uu((t.escape||Yt).source+"|"+p.source+"|"+(p===Ut?Vt:Yt).source+"|"+(t.evaluate||Yt).source+"|$","g"),f="//# sourceURL="+(yu.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++$n+"]")+"\n";e.replace(g,function(t,n,o,r,s,l){return o||(o=r),d+=e.slice(u,l).replace(Xt,z),n&&(i=!0,d+="' +\n__e("+n+") +\n'"),s&&(a=!0,d+="';\n"+s+";\n__p += '"),o&&(d+="' +\n((__t = ("+o+")) == null ? '' : __t) +\n'"),u=l+t.length,t}),d+="';\n";var h=yu.call(t,"variable")&&t.variable;if(h){if(Mt.test(h))throw new au(se)}else d="with (obj) {\n"+d+"\n}\n";d=(a?d.replace(St,""):d).replace(bt,"$1").replace(wt,"$1;"),d="function("+(h||"obj")+") {\n"+(h?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var m=Xd(function(){return su(l,f+"return "+d).apply(ne,c)});if(m.source=d,tl(m))throw m;return m}function Sc(e){return Ul(e).toLowerCase()}function bc(e){return Ul(e).toUpperCase()}function wc(e,t,n){if(e=Ul(e),e&&(n||t===ne))return N(e);if(!e||!(t=mr(t)))return e;var o=Y(e),r=Y(t),i=k(o,r),a=_(o,r)+1;return Lr(o,i,a).join("")}function Pc(e,t,n){if(e=Ul(e),e&&(n||t===ne))return e.slice(0,X(e)+1);if(!e||!(t=mr(t)))return e;var o=Y(e),r=_(o,Y(t))+1;return Lr(o,0,r).join("")}function Ic(e,t,n){if(e=Ul(e),e&&(n||t===ne))return e.replace(kt,"");if(!e||!(t=mr(t)))return e;var o=Y(e),r=k(o,Y(t));return Lr(o,r).join("")}function Tc(e,t){var n=Ee,o=Le;if(al(t)){var r="separator"in t?t.separator:r;n="length"in t?Il(t.length):n,o="omission"in t?mr(t.omission):o}e=Ul(e);var i=e.length;if(W(e)){var a=Y(e);i=a.length}if(n>=i)return e;var s=n-Q(o);if(s<1)return o;var l=a?Lr(a,0,s).join(""):e.slice(0,s);if(r===ne)return l+o;if(a&&(s+=l.length-s),Pd(r)){if(e.slice(s).search(r)){var c,u=l;for(r.global||(r=uu(r.source,Ul(jt.exec(r))+"g")),r.lastIndex=0;c=r.exec(u);)var p=c.index;l=l.slice(0,p===ne?s:p)}}else if(e.indexOf(mr(r),s)!=s){var d=l.lastIndexOf(r);d>-1&&(l=l.slice(0,d))}return l+o}function Ec(e){return e=Ul(e),e&&Tt.test(e)?e.replace(Pt,bo):e}function Lc(e,t,n){return e=Ul(e),t=n?ne:t,t===ne?M(e)?te(e):v(e):e.match(t)||[]}function Ac(e){var t=null==e?0:e.length,n=wi();return e=t?p(e,function(e){if("function"!=typeof e[1])throw new du(ae);return[n(e[0]),e[1]]}):[],ir(function(n){for(var r=-1;++r<t;){var i=e[r];if(o(i[0],this,n))return o(i[1],this,n)}})}function Uc(e){return Wn(Dn(e,pe))}function xc(e){return function(){return e}}function Nc(e,t){return null==e||e!==e?t:e}function Oc(e){return e}function Rc(e){return Wo("function"==typeof e?e:Dn(e,pe))}function Fc(e){return Ko(Dn(e,pe))}function kc(e,t){return Go(e,Dn(t,pe))}function _c(e,t,n){var o=Hl(t),r=ao(t,o);null!=n||al(t)&&(r.length||!o.length)||(n=t,t=e,e=this,r=ao(t,Hl(t)));var a=!(al(n)&&"chain"in n&&!n.chain),s=ol(e);return i(r,function(n){var o=t[n];e[n]=o,s&&(e.prototype[n]=function(){var t=this.__chain__;if(a||t){var n=e(this.__wrapped__),r=n.__actions__=zr(this.__actions__);return r.push({func:o,args:arguments,thisArg:e}),n.__chain__=t,n}return o.apply(e,d([this.value()],arguments))})}),e}function Bc(){return io._===this&&(io._=Pu),this}function zc(){}function Dc(e){return e=Il(e),ir(function(t){return Jo(t,e)})}function Wc(e){return Bi(e)?I(ta(e)):Zo(e)}function Mc(e){return function(t){return null==e?ne:so(e,t)}}function Hc(){return[]}function Vc(){return!1}function jc(){return{}}function Kc(){return""}function Gc(){return!0}function qc(e,t){if(e=Il(e),e<1||e>Fe)return[];var n=Be,o=$u(e,Be);t=wi(t),e-=Be;for(var r=U(o,t);++n<e;)t(n);return r}function $c(e){return yd(e)?p(e,ta):yl(e)?[e]:zr(Rp(Ul(e)))}function Jc(e){var t=++Cu;return Ul(e)+t}function Qc(e){return e&&e.length?Yn(e,Oc,yo):ne}function Yc(e,t){return e&&e.length?Yn(e,wi(t,2),yo):ne}function Xc(e){return P(e,Oc)}function Zc(e,t){return P(e,wi(t,2))}function eu(e){return e&&e.length?Yn(e,Oc,Vo):ne}function tu(e,t){return e&&e.length?Yn(e,wi(t,2),Vo):ne}function nu(e){return e&&e.length?A(e,Oc):0}function ou(e,t){return e&&e.length?A(e,wi(t,2)):0}t=null==t?io:Po.defaults(io.Object(),t,Po.pick(io,qn));var ru=t.Array,iu=t.Date,au=t.Error,su=t.Function,lu=t.Math,cu=t.Object,uu=t.RegExp,pu=t.String,du=t.TypeError,gu=ru.prototype,fu=su.prototype,hu=cu.prototype,mu=t["__core-js_shared__"],vu=fu.toString,yu=hu.hasOwnProperty,Cu=0,Su=function(){var e=/[^.]+$/.exec(mu&&mu.keys&&mu.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),bu=hu.toString,wu=vu.call(cu),Pu=io._,Iu=uu("^"+vu.call(yu).replace(Rt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Tu=lo?t.Buffer:ne,Eu=t.Symbol,Lu=t.Uint8Array,Au=Tu?Tu.allocUnsafe:ne,Uu=j(cu.getPrototypeOf,cu),xu=cu.create,Nu=hu.propertyIsEnumerable,Ou=gu.splice,Ru=Eu?Eu.isConcatSpreadable:ne,Fu=Eu?Eu.iterator:ne,ku=Eu?Eu.toStringTag:ne,_u=function(){try{var e=Ti(cu,"defineProperty");return e({},"",{}),e}catch(e){}}(),Bu=t.clearTimeout!==io.clearTimeout&&t.clearTimeout,zu=iu&&iu.now!==io.Date.now&&iu.now,Du=t.setTimeout!==io.setTimeout&&t.setTimeout,Wu=lu.ceil,Mu=lu.floor,Hu=cu.getOwnPropertySymbols,Vu=Tu?Tu.isBuffer:ne,ju=t.isFinite,Ku=gu.join,Gu=j(cu.keys,cu),qu=lu.max,$u=lu.min,Ju=iu.now,Qu=t.parseInt,Yu=lu.random,Xu=gu.reverse,Zu=Ti(t,"DataView"),ep=Ti(t,"Map"),tp=Ti(t,"Promise"),np=Ti(t,"Set"),op=Ti(t,"WeakMap"),rp=Ti(cu,"create"),ip=op&&new op,ap={},sp=na(Zu),lp=na(ep),cp=na(tp),up=na(np),pp=na(op),dp=Eu?Eu.prototype:ne,gp=dp?dp.valueOf:ne,fp=dp?dp.toString:ne,hp=function(){function e(){}return function(t){if(!al(t))return{};if(xu)return xu(t);e.prototype=t;var n=new e;return e.prototype=ne,n}}();n.templateSettings={escape:Lt,evaluate:At,interpolate:Ut,variable:"",imports:{_:n}},n.prototype=m.prototype,n.prototype.constructor=n,T.prototype=hp(m.prototype),T.prototype.constructor=T,$.prototype=hp(m.prototype),$.prototype.constructor=$,Wt.prototype.clear=Zt,Wt.prototype.delete=en,Wt.prototype.get=tn,Wt.prototype.has=nn,Wt.prototype.set=on,rn.prototype.clear=an,rn.prototype.delete=sn,rn.prototype.get=ln,rn.prototype.has=cn,rn.prototype.set=un,pn.prototype.clear=dn,pn.prototype.delete=gn,pn.prototype.get=fn,pn.prototype.has=hn,pn.prototype.set=mn,vn.prototype.add=vn.prototype.push=yn,vn.prototype.has=Cn,Sn.prototype.clear=bn,Sn.prototype.delete=wn,Sn.prototype.get=Pn,Sn.prototype.has=In,Sn.prototype.set=Tn;var mp=jr(oo),vp=jr(ro,!0),yp=Kr(),Cp=Kr(!0),Sp=ip?function(e,t){return ip.set(e,t),e}:Oc,bp=_u?function(e,t){return _u(e,"toString",{configurable:!0,enumerable:!1,value:xc(t),writable:!0})}:Oc,wp=ir,Pp=Bu||function(e){return io.clearTimeout(e)},Ip=np&&1/G(new np([,-0]))[1]==Re?function(e){return new np(e)}:zc,Tp=ip?function(e){return ip.get(e)}:zc,Ep=Hu?function(e){return null==e?[]:(e=cu(e),l(Hu(e),function(t){return Nu.call(e,t)}))}:Hc,Lp=Hu?function(e){for(var t=[];e;)d(t,Ep(e)),e=Uu(e);return t}:Hc,Ap=uo;(Zu&&Ap(new Zu(new ArrayBuffer(1)))!=ut||ep&&Ap(new ep)!=Qe||tp&&Ap(tp.resolve())!=et||np&&Ap(new np)!=ot||op&&Ap(new op)!=st)&&(Ap=function(e){var t=uo(e),n=t==Ze?e.constructor:ne,o=n?na(n):"";if(o)switch(o){case sp:return ut;case lp:return Qe;case cp:return et;case up:return ot;case pp:return st}return t});var Up=mu?ol:Vc,xp=Zi(Sp),Np=Du||function(e,t){return io.setTimeout(e,t)},Op=Zi(bp),Rp=ji(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Ot,function(e,n,o,r){t.push(o?r.replace(Ht,"$1"):n||e)}),t}),Fp=ir(function(e,t){return Js(e)?Kn(e,eo(t,1,Js,!0)):[]}),kp=ir(function(e,t){var n=Pa(t);return Js(n)&&(n=ne),Js(e)?Kn(e,eo(t,1,Js,!0),wi(n,2)):[]}),_p=ir(function(e,t){var n=Pa(t);return Js(n)&&(n=ne),Js(e)?Kn(e,eo(t,1,Js,!0),ne,n):[]}),Bp=ir(function(e){var t=p(e,Ir);return t.length&&t[0]===e[0]?Eo(t):[]}),zp=ir(function(e){var t=Pa(e),n=p(e,Ir);return t===Pa(n)?t=ne:n.pop(),n.length&&n[0]===e[0]?Eo(n,wi(t,2)):[]}),Dp=ir(function(e){var t=Pa(e),n=p(e,Ir);return t="function"==typeof t?t:ne,t&&n.pop(),n.length&&n[0]===e[0]?Eo(n,ne,t):[]}),Wp=ir(Ea),Mp=vi(function(e,t){var n=null==e?0:e.length,o=Bn(e,t);return tr(e,p(t,function(e){return ki(e,n)?+e:e}).sort(Fr)),o}),Hp=ir(function(e){return vr(eo(e,1,Js,!0))}),Vp=ir(function(e){var t=Pa(e);return Js(t)&&(t=ne),vr(eo(e,1,Js,!0),wi(t,2))}),jp=ir(function(e){var t=Pa(e);return t="function"==typeof t?t:ne,vr(eo(e,1,Js,!0),ne,t)}),Kp=ir(function(e,t){return Js(e)?Kn(e,t):[]}),Gp=ir(function(e){return wr(l(e,Js))}),qp=ir(function(e){var t=Pa(e);return Js(t)&&(t=ne),wr(l(e,Js),wi(t,2))}),$p=ir(function(e){var t=Pa(e);return t="function"==typeof t?t:ne,wr(l(e,Js),ne,t)}),Jp=ir($a),Qp=ir(function(e){var t=e.length,n=t>1?e[t-1]:ne;return n="function"==typeof n?(e.pop(),n):ne,Ja(e,n)}),Yp=vi(function(e){var t=e.length,n=t?e[0]:0,o=this.__wrapped__,r=function(t){return Bn(t,e)};return!(t>1||this.__actions__.length)&&o instanceof $&&ki(n)?(o=o.slice(n,+n+(t?1:0)),o.__actions__.push({func:es,args:[r],thisArg:ne}),new T(o,this.__chain__).thru(function(e){return t&&!e.length&&e.push(ne),e})):this.thru(r)}),Xp=Hr(function(e,t,n){yu.call(e,n)?++e[n]:_n(e,n,1)}),Zp=Yr(ga),ed=Yr(fa),td=Hr(function(e,t,n){yu.call(e,n)?e[n].push(t):_n(e,n,[t])}),nd=ir(function(e,t,n){var r=-1,i="function"==typeof t,a=$s(e)?ru(e.length):[];return mp(e,function(e){a[++r]=i?o(t,e,n):Ao(e,t,n)}),a}),od=Hr(function(e,t,n){_n(e,n,t)}),rd=Hr(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]}),id=ir(function(e,t){if(null==e)return[];var n=t.length;return n>1&&_i(e,t[0],t[1])?t=[]:n>2&&_i(t[0],t[1],t[2])&&(t=[t[0]]),Qo(e,eo(t,1),[])}),ad=zu||function(){return io.Date.now()},sd=ir(function(e,t,n){var o=me;if(n.length){var r=K(n,bi(sd));o|=be}return ui(e,o,t,n,r)}),ld=ir(function(e,t,n){var o=me|ve;if(n.length){var r=K(n,bi(ld));o|=be}return ui(t,o,e,n,r)}),cd=ir(function(e,t){return jn(e,1,t)}),ud=ir(function(e,t,n){return jn(e,El(t)||0,n)});Rs.Cache=pn;var pd=wp(function(e,t){t=1==t.length&&yd(t[0])?p(t[0],O(wi())):p(eo(t,1),O(wi()));var n=t.length;return ir(function(r){for(var i=-1,a=$u(r.length,n);++i<a;)r[i]=t[i].call(this,r[i]);return o(e,this,r)})}),dd=ir(function(e,t){var n=K(t,bi(dd));return ui(e,be,ne,t,n)}),gd=ir(function(e,t){var n=K(t,bi(gd));return ui(e,we,ne,t,n)}),fd=vi(function(e,t){return ui(e,Ie,ne,ne,ne,t)}),hd=ai(yo),md=ai(function(e,t){return e>=t}),vd=Uo(function(){return arguments}())?Uo:function(e){return sl(e)&&yu.call(e,"callee")&&!Nu.call(e,"callee")},yd=ru.isArray,Cd=po?O(po):xo,Sd=Vu||Vc,bd=go?O(go):No,wd=fo?O(fo):Fo,Pd=ho?O(ho):Bo,Id=mo?O(mo):zo,Td=vo?O(vo):Do,Ed=ai(Vo),Ld=ai(function(e,t){return e<=t}),Ad=Vr(function(e,t){if(Mi(t)||$s(t))return void Dr(t,Hl(t),e);for(var n in t)yu.call(t,n)&&Nn(e,n,t[n])}),Ud=Vr(function(e,t){Dr(t,Vl(t),e)}),xd=Vr(function(e,t,n,o){Dr(t,Vl(t),e,o)}),Nd=Vr(function(e,t,n,o){Dr(t,Hl(t),e,o)}),Od=vi(Bn),Rd=ir(function(e,t){e=cu(e);var n=-1,o=t.length,r=o>2?t[2]:ne;for(r&&_i(t[0],t[1],r)&&(o=1);++n<o;)for(var i=t[n],a=Vl(i),s=-1,l=a.length;++s<l;){var c=a[s],u=e[c];(u===ne||qs(u,hu[c])&&!yu.call(e,c))&&(e[c]=i[c])}return e}),Fd=ir(function(e){return e.push(ne,di),o(Dd,ne,e)}),kd=ei(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=bu.call(t)),e[t]=n},xc(Oc)),_d=ei(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=bu.call(t)),yu.call(e,t)?e[t].push(n):e[t]=[n]},wi),Bd=ir(Ao),zd=Vr(function(e,t,n){qo(e,t,n)}),Dd=Vr(function(e,t,n,o){qo(e,t,n,o)}),Wd=vi(function(e,t){var n={};if(null==e)return n;var o=!1;t=p(t,function(t){return t=Er(t,e),o||(o=t.length>1),t}),Dr(e,Ci(e),n),o&&(n=Dn(n,pe|de|ge,gi));for(var r=t.length;r--;)yr(n,t[r]);return n}),Md=vi(function(e,t){return null==e?{}:Yo(e,t)}),Hd=ci(Hl),Vd=ci(Vl),jd=$r(function(e,t,n){return t=t.toLowerCase(),e+(n?ac(t):t)}),Kd=$r(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),Gd=$r(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),qd=qr("toLowerCase"),$d=$r(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}),Jd=$r(function(e,t,n){return e+(n?" ":"")+Yd(t)}),Qd=$r(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),Yd=qr("toUpperCase"),Xd=ir(function(e,t){try{return o(e,ne,t)}catch(e){return tl(e)?e:new au(e)}}),Zd=vi(function(e,t){return i(t,function(t){t=ta(t),_n(e,t,sd(e[t],e))}),e}),eg=Xr(),tg=Xr(!0),ng=ir(function(e,t){return function(n){return Ao(n,e,t)}}),og=ir(function(e,t){return function(n){return Ao(e,n,t)}}),rg=ni(p),ig=ni(s),ag=ni(h),sg=ii(),lg=ii(!0),cg=ti(function(e,t){return e+t},0),ug=li("ceil"),pg=ti(function(e,t){return e/t},1),dg=li("floor"),gg=ti(function(e,t){return e*t},1),fg=li("round"),hg=ti(function(e,t){return e-t},0);return n.after=Es,n.ary=Ls,n.assign=Ad,n.assignIn=Ud,n.assignInWith=xd,n.assignWith=Nd,n.at=Od,n.before=As,n.bind=sd,n.bindAll=Zd,n.bindKey=ld,n.castArray=Ms,n.chain=Xa,n.chunk=ia,n.compact=aa,n.concat=sa,n.cond=Ac,n.conforms=Uc,n.constant=xc,n.countBy=Xp,n.create=xl,n.curry=Us,n.curryRight=xs,n.debounce=Ns,n.defaults=Rd,n.defaultsDeep=Fd,n.defer=cd,n.delay=ud,n.difference=Fp,n.differenceBy=kp,n.differenceWith=_p,n.drop=la,n.dropRight=ca,n.dropRightWhile=ua,n.dropWhile=pa,n.fill=da,n.filter=cs,n.flatMap=us,n.flatMapDeep=ps,n.flatMapDepth=ds,n.flatten=ha,n.flattenDeep=ma,n.flattenDepth=va,n.flip=Os,n.flow=eg,n.flowRight=tg,n.fromPairs=ya,n.functions=Bl,n.functionsIn=zl,n.groupBy=td,n.initial=ba,n.intersection=Bp,n.intersectionBy=zp,n.intersectionWith=Dp,n.invert=kd,n.invertBy=_d,n.invokeMap=nd,n.iteratee=Rc,n.keyBy=od,n.keys=Hl,n.keysIn=Vl,n.map=ms,n.mapKeys=jl,n.mapValues=Kl,n.matches=Fc,n.matchesProperty=kc,n.memoize=Rs,n.merge=zd,n.mergeWith=Dd,n.method=ng,n.methodOf=og,n.mixin=_c,n.negate=Fs,n.nthArg=Dc,n.omit=Wd,n.omitBy=Gl,n.once=ks,n.orderBy=vs,n.over=rg,n.overArgs=pd,n.overEvery=ig,n.overSome=ag,n.partial=dd,n.partialRight=gd,n.partition=rd,n.pick=Md,n.pickBy=ql,n.property=Wc,n.propertyOf=Mc,n.pull=Wp,n.pullAll=Ea,n.pullAllBy=La,n.pullAllWith=Aa,n.pullAt=Mp,n.range=sg,n.rangeRight=lg,n.rearg=fd,n.reject=Ss,n.remove=Ua,n.rest=_s,n.reverse=xa,n.sampleSize=ws,n.set=Jl,n.setWith=Ql,n.shuffle=Ps,n.slice=Na,n.sortBy=id,n.sortedUniq=za,n.sortedUniqBy=Da,n.split=vc,n.spread=Bs,n.tail=Wa,n.take=Ma,n.takeRight=Ha,n.takeRightWhile=Va,n.takeWhile=ja,n.tap=Za,n.throttle=zs,n.thru=es,n.toArray=wl,n.toPairs=Hd,n.toPairsIn=Vd,n.toPath=$c,n.toPlainObject=Ll,n.transform=Yl,n.unary=Ds,n.union=Hp,n.unionBy=Vp,n.unionWith=jp,n.uniq=Ka,n.uniqBy=Ga,n.uniqWith=qa,n.unset=Xl,n.unzip=$a,n.unzipWith=Ja,n.update=Zl,n.updateWith=ec,n.values=tc,n.valuesIn=nc,n.without=Kp,n.words=Lc,n.wrap=Ws,n.xor=Gp,n.xorBy=qp,n.xorWith=$p,n.zip=Jp,n.zipObject=Qa,n.zipObjectDeep=Ya,n.zipWith=Qp,n.entries=Hd,n.entriesIn=Vd,n.extend=Ud,n.extendWith=xd,_c(n,n),n.add=cg,n.attempt=Xd,n.camelCase=jd,n.capitalize=ac,n.ceil=ug,n.clamp=oc,n.clone=Hs,n.cloneDeep=js,n.cloneDeepWith=Ks,n.cloneWith=Vs,n.conformsTo=Gs,n.deburr=sc,n.defaultTo=Nc,n.divide=pg,n.endsWith=lc,n.eq=qs,n.escape=cc,n.escapeRegExp=uc,n.every=ls,n.find=Zp,n.findIndex=ga,n.findKey=Nl,n.findLast=ed,n.findLastIndex=fa,n.findLastKey=Ol,n.floor=dg,n.forEach=gs,n.forEachRight=fs,n.forIn=Rl,n.forInRight=Fl,n.forOwn=kl,n.forOwnRight=_l,n.get=Dl,n.gt=hd,n.gte=md,n.has=Wl,n.hasIn=Ml,n.head=Ca,n.identity=Oc,n.includes=hs,n.indexOf=Sa,n.inRange=rc,n.invoke=Bd,n.isArguments=vd,n.isArray=yd,n.isArrayBuffer=Cd,n.isArrayLike=$s,n.isArrayLikeObject=Js,n.isBoolean=Qs,n.isBuffer=Sd,n.isDate=bd,n.isElement=Ys,n.isEmpty=Xs,n.isEqual=Zs,n.isEqualWith=el,n.isError=tl,n.isFinite=nl,n.isFunction=ol,n.isInteger=rl,n.isLength=il,n.isMap=wd,n.isMatch=ll,n.isMatchWith=cl,n.isNaN=ul,n.isNative=pl,n.isNil=gl,n.isNull=dl,n.isNumber=fl,n.isObject=al,n.isObjectLike=sl,n.isPlainObject=hl,n.isRegExp=Pd,n.isSafeInteger=ml,n.isSet=Id,n.isString=vl,n.isSymbol=yl,n.isTypedArray=Td,n.isUndefined=Cl,n.isWeakMap=Sl,n.isWeakSet=bl,n.join=wa,n.kebabCase=Kd,n.last=Pa,n.lastIndexOf=Ia,n.lowerCase=Gd,n.lowerFirst=qd,n.lt=Ed,n.lte=Ld,n.max=Qc,n.maxBy=Yc,n.mean=Xc,n.meanBy=Zc,n.min=eu,n.minBy=tu,n.stubArray=Hc,n.stubFalse=Vc,n.stubObject=jc,n.stubString=Kc,n.stubTrue=Gc,n.multiply=gg,n.nth=Ta,n.noConflict=Bc,n.noop=zc,n.now=ad,n.pad=pc,n.padEnd=dc,n.padStart=gc,n.parseInt=fc,n.random=ic,n.reduce=ys,n.reduceRight=Cs,n.repeat=hc,n.replace=mc,n.result=$l,n.round=fg,n.runInContext=e,n.sample=bs,n.size=Is,n.snakeCase=$d,n.some=Ts,n.sortedIndex=Oa,n.sortedIndexBy=Ra,n.sortedIndexOf=Fa,n.sortedLastIndex=ka,n.sortedLastIndexBy=_a,n.sortedLastIndexOf=Ba,n.startCase=Jd,n.startsWith=yc,n.subtract=hg,n.sum=nu,n.sumBy=ou,n.template=Cc,n.times=qc,n.toFinite=Pl,n.toInteger=Il,n.toLength=Tl,n.toLower=Sc,n.toNumber=El,n.toSafeInteger=Al,n.toString=Ul,n.toUpper=bc,n.trim=wc,n.trimEnd=Pc,n.trimStart=Ic,n.truncate=Tc,n.unescape=Ec,n.uniqueId=Jc,n.upperCase=Qd,n.upperFirst=Yd,n.each=gs,n.eachRight=fs,n.first=Ca,_c(n,function(){var e={};return oo(n,function(t,o){yu.call(n.prototype,o)||(e[o]=t)}),e}(),{chain:!1}),n.VERSION=oe,i(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){n[e].placeholder=n}),i(["drop","take"],function(e,t){$.prototype[e]=function(n){n=n===ne?1:qu(Il(n),0);var o=this.__filtered__&&!t?new $(this):this.clone();return o.__filtered__?o.__takeCount__=$u(n,o.__takeCount__):o.__views__.push({size:$u(n,Be),type:e+(o.__dir__<0?"Right":"")}),o},$.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),i(["filter","map","takeWhile"],function(e,t){var n=t+1,o=n==xe||n==Oe;$.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:wi(e,3),type:n}),t.__filtered__=t.__filtered__||o,t}}),i(["head","last"],function(e,t){var n="take"+(t?"Right":"");$.prototype[e]=function(){return this[n](1).value()[0]}}),i(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");$.prototype[e]=function(){return this.__filtered__?new $(this):this[n](1)}}),$.prototype.compact=function(){return this.filter(Oc)},$.prototype.find=function(e){return this.filter(e).head()},$.prototype.findLast=function(e){return this.reverse().find(e)},$.prototype.invokeMap=ir(function(e,t){return"function"==typeof e?new $(this):this.map(function(n){return Ao(n,e,t)})}),$.prototype.reject=function(e){return this.filter(Fs(wi(e)))},$.prototype.slice=function(e,t){e=Il(e);var n=this;return n.__filtered__&&(e>0||t<0)?new $(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==ne&&(t=Il(t),n=t<0?n.dropRight(-t):n.take(t-e)),n)},$.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},$.prototype.toArray=function(){return this.take(Be)},oo($.prototype,function(e,t){var o=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),i=n[r?"take"+("last"==t?"Right":""):t],a=r||/^find/.test(t);i&&(n.prototype[t]=function(){var t=this.__wrapped__,s=r?[1]:arguments,l=t instanceof $,c=s[0],u=l||yd(t),p=function(e){var t=i.apply(n,d([e],s));return r&&g?t[0]:t};u&&o&&"function"==typeof c&&1!=c.length&&(l=u=!1);var g=this.__chain__,f=!!this.__actions__.length,h=a&&!g,m=l&&!f;if(!a&&u){t=m?t:new $(this);var v=e.apply(t,s);return v.__actions__.push({func:es,args:[p],thisArg:ne}),new T(v,g)}return h&&m?e.apply(this,s):(v=this.thru(p),h?r?v.value()[0]:v.value():v)})}),i(["pop","push","shift","sort","splice","unshift"],function(e){var t=gu[e],o=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);n.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var n=this.value();return t.apply(yd(n)?n:[],e)}return this[o](function(n){return t.apply(yd(n)?n:[],e)})}}),oo($.prototype,function(e,t){var o=n[t];if(o){var r=o.name+"";yu.call(ap,r)||(ap[r]=[]),ap[r].push({name:t,func:o})}}),ap[Zr(ne,ve).name]=[{name:"wrapper",func:ne}],$.prototype.clone=Z,$.prototype.reverse=ee,$.prototype.value=_t,n.prototype.at=Yp,n.prototype.chain=ts,n.prototype.commit=ns,n.prototype.next=os,n.prototype.plant=is,n.prototype.reverse=as,n.prototype.toJSON=n.prototype.valueOf=n.prototype.value=ss,n.prototype.first=n.prototype.head,Fu&&(n.prototype[Fu]=rs),n},Po=wo();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(io._=Po,define(function(){return Po})):so?((so.exports=Po)._=Po,ao._=Po):io._=Po}).call(this)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],151:[function(e,t,n){!function(e,o){"object"==typeof n&&"undefined"!=typeof t?t.exports=o():"function"==typeof define&&define.amd?define(o):e.Popper=o()}(this,function(){"use strict";function e(e){var t=e.offsetParent,n=t&&t.nodeName;return n&&"BODY"!==n&&"HTML"!==n?t:window.document.documentElement}function t(e,t){if(1!==e.nodeType)return[];var n=window.getComputedStyle(e,null);return t?n[t]:n}function n(e){return"HTML"===e.nodeName?e:e.parentNode||e.host}function o(e){if(!e||["HTML","BODY","#document"].indexOf(e.nodeName)!==-1)return window.document.body;var r=t(e),i=r.overflow,a=r.overflowX,s=r.overflowY;return/(auto|scroll)/.test(i+s+a)?e:o(n(e))}function r(){var e=window.document.body,t=window.document.documentElement;return{height:Math.max(e.scrollHeight,e.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight),width:Math.max(e.scrollWidth,e.offsetWidth,t.clientWidth,t.scrollWidth,t.offsetWidth)}}function i(e){var t=void 0;if("HTML"===e.nodeName){var n=r(),o=n.width,i=n.height;t={width:o,height:i,left:0,top:0}}else t={width:e.offsetWidth,height:e.offsetHeight,left:e.offsetLeft,top:e.offsetTop};return t.right=t.left+t.width,t.bottom=t.top+t.height,t}function a(e){var o=e.nodeName;return"BODY"!==o&&"HTML"!==o&&("fixed"===t(e,"position")||a(n(e)))}function s(t){var n=e(t),o=a(n);return o?"fixed":"absolute"}function l(e,t){var n="x"===t?"Left":"Top",o="Left"===n?"Right":"Bottom";return Number(e["border"+n+"Width"].split("px")[0])+Number(e["border"+o+"Width"].split("px")[0])}function c(e){var n=navigator.appVersion.indexOf("MSIE 10")!==-1,o=void 0;if(n)try{o=e.getBoundingClientRect()}catch(e){o={}}else o=e.getBoundingClientRect();var r={left:o.left,top:o.top,right:o.right,bottom:o.bottom,width:o.right-o.left,height:o.bottom-o.top};if("HTML"===e.nodeName&&n){var i=window.document.documentElement,a=i.scrollTop,s=i.scrollLeft;r.top-=a,r.bottom-=a,r.left-=s,r.right-=s}var c=o.width-(e.clientWidth||o.right-o.left),u=o.height-(e.clientHeight||o.bottom-o.top);if(c||u){var p=t(e);c-=l(p,"x"),u-=l(p,"y")}return r.right-=c,r.width-=c,r.bottom-=u,r.height-=u,r}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",n="top"===t?"scrollTop":"scrollLeft",o=e.nodeName;if("BODY"===o||"HTML"===o){var r=window.document.documentElement,i=window.document.scrollingElement||r;return i[n]}return e[n]}function p(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=u(t,"top"),r=u(t,"left"),i=n?-1:1;return e.top+=o*i,e.bottom+=o*i,e.left+=r*i,e.right+=r*i,e}function d(n,r){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=o(r),l=c(n),u=c(r),d={top:l.top-u.top,left:l.left-u.left,bottom:l.top-u.top+l.height,right:l.left-u.left+l.width,width:l.width,height:l.height};i&&!a?d=p(d,s,!0):e(n).contains(s)&&"BODY"!==s.nodeName&&(d=p(d,r));var g=t(r),f=Number(g.borderTopWidth.split("px")[0]),h=Number(g.borderLeftWidth.split("px")[0]);return d.top-=f,d.bottom-=f,d.left-=h,d.right-=h,d}function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",r=o(e),i=u(r,t);return["BODY","HTML"].indexOf(r.nodeName)===-1?i+g(n(r),t):i}function f(t,l,c){var u={top:0,left:0},p=e(t);if("viewport"===c){var f=i(p),h=f.left,m=f.top,v=window.document.documentElement,y=v.clientWidth,C=v.clientHeight;if("fixed"===s(t))u.right=y,u.bottom=C;else{var S=g(t,"left"),b=g(t,"top");u={top:0-m,right:y-h+S,bottom:C-m+b,left:0-h}}}else{var w=void 0;if(w="scrollParent"===c?o(n(t)):"window"===c?window.document.body:c,"BODY"===w.nodeName){var P=r(),I=P.height,T=P.width;u.right=T,u.bottom=I}else u=d(w,p,a(t))}return u.left+=l,u.top+=l,u.right-=l,u.bottom-=l,u}function h(e,t,n){if(e.indexOf("auto")===-1)return e;var o=f(n,0,"scrollParent"),r={top:t.top-o.top,right:o.right-t.right,bottom:o.bottom-t.bottom,left:t.left-o.left},i=Object.keys(r).sort(function(e,t){return r[t]-r[e]})[0],a=e.split("-")[1];return i+(a?"-"+a:"")}function m(e){var t=!1,n=0,o=document.createElement("span"),r=new MutationObserver(function(){e(),t=!1});return r.observe(o,{attributes:!0}),function(){t||(t=!0,o.setAttribute("x-index",n),n+=1)}}function v(e){var t=!1;return function(){t||(t=!0,setTimeout(function(){
t=!1,e()},Y))}}function y(e,t){return Array.prototype.find?e.find(t):e.filter(t)[0]}function C(e,t,n){if(Array.prototype.findIndex)return e.findIndex(function(e){return e[t]===n});var o=y(e,function(e){return e[t]===n});return e.indexOf(o)}function S(e){return re({},e,{right:e.left+e.width,bottom:e.top+e.height})}function b(e){var t=window.getComputedStyle(e),n=parseFloat(t.marginTop)+parseFloat(t.marginBottom),o=parseFloat(t.marginLeft)+parseFloat(t.marginRight),r={width:e.offsetWidth+o,height:e.offsetHeight+n};return r}function w(e){var t={left:"right",right:"left",bottom:"top",top:"bottom"};return e.replace(/left|right|bottom|top/g,function(e){return t[e]})}function P(e,t,n,o){o=o.split("-")[0];var r=b(t),i={position:e,width:r.width,height:r.height},a=["right","left"].indexOf(o)!==-1,s=a?"top":"left",l=a?"left":"top",c=a?"height":"width",u=a?"width":"height";return i[s]=n[s]+n[c]/2-r[c]/2,o===l?i[l]=n[l]-r[u]:i[l]=n[w(l)],i}function I(t,n,o){var r="fixed"===t.position,i=t.isParentTransformed,a=e(r&&i?o:n);return d(o,a,r,i)}function T(e){for(var t=[!1,"ms","webkit","moz","o"],n=e.charAt(0).toUpperCase()+e.slice(1),o=0;o<t.length-1;o++){var r=t[o],i=r?""+r+n:e;if("undefined"!=typeof window.document.body.style[i])return i}return null}function E(e){var t={};return e&&"[object Function]"===t.toString.call(e)}function L(e,t){return e.some(function(e){var n=e.name,o=e.enabled;return o&&n===t})}function A(e,t,n){var o=y(e,function(e){var n=e.name;return n===t});return!!o&&e.some(function(e){return e.name===n&&e.enabled&&e.order<o.order})}function U(e){return""!==e&&!isNaN(parseFloat(e))&&isFinite(e)}function x(e){return"BODY"!==e.nodeName&&("none"!==t(e,"transform")||(n(e)?x(n(e)):e))}function N(e,t){return window.removeEventListener("resize",t.updateBound),t.scrollElement&&t.scrollElement.removeEventListener("scroll",t.updateBound),t.updateBound=null,t.scrollElement=null,t.eventsEnabled=!1,t}function O(e,t,n){var o=void 0===n?e:e.slice(0,C(e,"name",n));return o.forEach(function(e){e.enabled&&E(e.function)&&(t=e.function(t,e))}),t}function R(e,t){Object.keys(t).forEach(function(n){var o=t[n];o!==!1?e.setAttribute(n,t[n]):e.removeAttribute(n)})}function F(e,t){Object.keys(t).forEach(function(n){var o="";["width","height","top","right","bottom","left"].indexOf(n)!==-1&&U(t[n])&&(o="px"),e.style[n]=t[n]+o})}function k(e,t,n,r){n.updateBound=r,window.addEventListener("resize",n.updateBound,{passive:!0});var i=o(e);return"BODY"===i.nodeName&&(i=window),i.addEventListener("scroll",n.updateBound,{passive:!0}),n.scrollElement=i,n.eventsEnabled=!0,n}function _(e,t){var n={position:e.offsets.popper.position},o={"x-placement":e.placement},r=Math.round(e.offsets.popper.left),i=Math.round(e.offsets.popper.top),a=T("transform");return t.gpuAcceleration&&a?(n[a]="translate3d("+r+"px, "+i+"px, 0)",n.top=0,n.left=0,n.willChange="transform"):(n.left=r,n.top=i,n.willChange="top, left"),F(e.instance.popper,re({},n,e.styles)),R(e.instance.popper,re({},o,e.attributes)),e.offsets.arrow&&F(e.arrowElement,e.offsets.arrow),e}function B(e,t,n,o,r){var i=I(r,t,e);return n.placement=h(n.placement,i,t),t.setAttribute("x-placement",n.placement),n}function z(e,t){if(!A(e.instance.modifiers,"arrow","keepTogether"))return console.warn("WARNING: `keepTogether` modifier is required by arrow modifier in order to work, be sure to include it before `arrow`!"),e;var n=t.element;if("string"==typeof n){if(n=e.instance.popper.querySelector(n),!n)return e}else if(!e.instance.popper.contains(n))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),e;var o=e.placement.split("-")[0],r=S(e.offsets.popper),i=e.offsets.reference,a=["left","right"].indexOf(o)!==-1,s=a?"height":"width",l=a?"top":"left",c=a?"left":"top",u=a?"bottom":"right",p=b(n)[s];i[u]-p<r[l]&&(e.offsets.popper[l]-=r[l]-(i[u]-p)),i[l]+p>r[u]&&(e.offsets.popper[l]+=i[l]+p-r[u]);var d=i[l]+i[s]/2-p/2,g=d-S(e.offsets.popper)[l];return g=Math.max(Math.min(r[s]-p,g),0),e.arrowElement=n,e.offsets.arrow={},e.offsets.arrow[l]=g,e.offsets.arrow[c]="",e}function D(e){return"end"===e?"start":"start"===e?"end":e}function W(e,t){if(L(e.instance.modifiers,"inner"))return e;if(e.flipped&&e.placement===e.originalPlacement)return e;var n=f(e.instance.popper,t.padding,t.boundariesElement),o=e.placement.split("-")[0],r=w(o),i=e.placement.split("-")[1]||"",a=[];return a="flip"===t.behavior?[o,r]:t.behavior,a.forEach(function(s,l){if(o!==s||a.length===l+1)return e;o=e.placement.split("-")[0],r=w(o);var c=S(e.offsets.popper),u=e.offsets.reference,p=Math.floor,d="left"===o&&p(c.right)>p(u.left)||"right"===o&&p(c.left)<p(u.right)||"top"===o&&p(c.bottom)>p(u.top)||"bottom"===o&&p(c.top)<p(u.bottom),g=p(c.left)<p(n.left),f=p(c.right)>p(n.right),h=p(c.top)<p(n.top),m=p(c.bottom)>p(n.bottom),v="left"===o&&g||"right"===o&&f||"top"===o&&h||"bottom"===o&&m,y=["top","bottom"].indexOf(o)!==-1,C=!!t.flipVariations&&(y&&"start"===i&&g||y&&"end"===i&&f||!y&&"start"===i&&h||!y&&"end"===i&&m);(d||v||C)&&(e.flipped=!0,(d||v)&&(o=a[l+1]),C&&(i=D(i)),e.placement=o+(i?"-"+i:""),e.offsets.popper=P(e.instance.state.position,e.instance.popper,e.offsets.reference,e.placement),e=O(e.instance.modifiers,e,"flip"))}),e}function M(e){var t=S(e.offsets.popper),n=e.offsets.reference,o=e.placement.split("-")[0],r=Math.floor,i=["top","bottom"].indexOf(o)!==-1,a=i?"right":"bottom",s=i?"left":"top",l=i?"width":"height";return t[a]<r(n[s])&&(e.offsets.popper[s]=r(n[s])-t[l]),t[s]>r(n[a])&&(e.offsets.popper[s]=r(n[a])),e}function H(e,t){var n=e.placement,o=e.offsets.popper,r=void 0;return U(t.offset)?r=[t.offset,0]:(r=t.offset.split(" "),r=r.map(function(t,o){var r=t.match(/(\d*\.?\d*)(.*)/),i=+r[1],a=r[2],s=n.indexOf("right")!==-1||n.indexOf("left")!==-1;1===o&&(s=!s);var l=s?"height":"width";if(0===a.indexOf("%")){var c=void 0;switch(a){case"%p":c=e.offsets.popper;break;case"%":case"$r":default:c=e.offsets.reference}var u=S(c),p=u[l];return p/100*i}if("vh"===a||"vw"===a){var d=void 0;return d="vh"===a?Math.max(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0),d/100*i}return"px"===a?+i:+t})),e.placement.indexOf("left")!==-1?(o.top+=r[0],o.left-=r[1]||0):e.placement.indexOf("right")!==-1?(o.top+=r[0],o.left+=r[1]||0):e.placement.indexOf("top")!==-1?(o.left+=r[0],o.top-=r[1]||0):e.placement.indexOf("bottom")!==-1&&(o.left+=r[0],o.top+=r[1]||0),e}function V(t,n){var o=n.boundariesElement||e(t.instance.popper),r=f(t.instance.popper,n.padding,o);n.boundaries=r;var i=n.priority,a=S(t.offsets.popper),s={primary:function(e){var t=a[e];return a[e]<r[e]&&!n.escapeWithReference&&(t=Math.max(a[e],r[e])),oe({},e,t)},secondary:function(e){var t="right"===e?"left":"top",o=a[t];return a[e]>r[e]&&!n.escapeWithReference&&(o=Math.min(a[t],r[e]-("right"===e?a.width:a.height))),oe({},t,o)}};return i.forEach(function(e){var t=["left","top"].indexOf(e)!==-1?"primary":"secondary";a=re({},a,s[t](e))}),t.offsets.popper=a,t}function j(e){var t=e.placement,n=t.split("-")[0],o=t.split("-")[1];if(o){var r=e.offsets.reference,i=S(e.offsets.popper),a=["bottom","top"].indexOf(n)!==-1,s=a?"left":"top",l=a?"width":"height",c={start:oe({},s,r[s]),end:oe({},s,r[s]+r[l]-i[l])};e.offsets.popper=re({},i,c[o])}return e}function K(e){if(!A(e.instance.modifiers,"hide","preventOverflow"))return console.warn("WARNING: preventOverflow modifier is required by hide modifier in order to work, be sure to include it before hide!"),e;var t=e.offsets.reference,n=y(e.instance.modifiers,function(e){return"preventOverflow"===e.name}).boundaries;if(t.bottom<n.top||t.left>n.right||t.top>n.bottom||t.right<n.left){if(e.hide===!0)return e;e.hide=!0,e.attributes["x-out-of-boundaries"]=""}else{if(e.hide===!1)return e;e.hide=!1,e.attributes["x-out-of-boundaries"]=!1}return e}function G(e){var t=e.placement,n=t.split("-")[0],o=S(e.offsets.popper),r=S(e.offsets.reference),i=["left","right"].indexOf(n)!==-1,a=["top","left"].indexOf(n)===-1;return o[i?"left":"top"]=r[t]-(a?o[i?"width":"height"]:0),e.placement=w(t),e.offsets.popper=S(o),e}for(var q=["native code","[object MutationObserverConstructor]"],$=function(e){return q.some(function(t){return(e||"").toString().indexOf(t)>-1})},J="undefined"!=typeof window,Q=["Edge","Trident","Firefox"],Y=0,X=0;X<Q.length;X+=1)if(J&&navigator.userAgent.indexOf(Q[X])>=0){Y=1;break}var Z=J&&$(window.MutationObserver),ee=Z?m:v,te=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},ne=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),oe=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},re=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},ie={computeAutoPlacement:h,debounce:ee,findIndex:C,getBordersSize:l,getBoundaries:f,getBoundingClientRect:c,getClientRect:S,getOffsetParent:e,getOffsetRect:i,getOffsetRectRelativeToCustomParent:d,getOuterSizes:b,getParentNode:n,getPopperOffsets:P,getPosition:s,getReferenceOffsets:I,getScroll:u,getScrollParent:o,getStyleComputedProperty:t,getSupportedPropertyName:T,getTotalScroll:g,getWindowSizes:r,includeScroll:p,isFixed:a,isFunction:E,isModifierEnabled:L,isModifierRequired:A,isNative:$,isNumeric:U,isTransformed:x,removeEventListeners:N,runModifiers:O,setAttributes:R,setStyles:F,setupEventListeners:k},ae={shift:{order:100,enabled:!0,function:j},offset:{order:200,enabled:!0,function:H,offset:0},preventOverflow:{order:300,enabled:!0,function:V,priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,function:M},arrow:{order:500,enabled:!0,function:z,element:"[x-arrow]"},flip:{order:600,enabled:!0,function:W,behavior:"flip",padding:5,boundariesElement:"viewport"},inner:{order:700,enabled:!1,function:G},hide:{order:800,enabled:!0,function:K},applyStyle:{order:900,enabled:!0,gpuAcceleration:!0,function:_,onLoad:B}},se={placement:"bottom",eventsEnabled:!0,onCreate:function(){},onUpdate:function(){},modifiers:ae},le=function(){function e(t,n){var o=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};te(this,e),this.scheduleUpdate=function(){return requestAnimationFrame(o.update)},this.update=ee(this.update.bind(this)),this.options=re({},e.Defaults,r),this.state={isDestroyed:!1,isCreated:!1},this.reference=t.jquery?t[0]:t,this.popper=n.jquery?n[0]:n,this.modifiers=Object.keys(e.Defaults.modifiers).map(function(t){return re({name:t},e.Defaults.modifiers[t])}),this.modifiers=this.modifiers.map(function(e){var t=r.modifiers&&r.modifiers[e.name]||{};return re({},e,t)}),r.modifiers&&(this.options.modifiers=re({},e.Defaults.modifiers,r.modifiers),Object.keys(r.modifiers).forEach(function(t){if(void 0===e.Defaults.modifiers[t]){var n=r.modifiers[t];n.name=t,o.modifiers.push(n)}})),this.state.position=s(this.reference),this.modifiers=this.modifiers.sort(function(e,t){return e.order-t.order}),this.modifiers.forEach(function(e){e.enabled&&E(e.onLoad)&&e.onLoad(o.reference,o.popper,o.options,e,o.state)}),this.state.isParentTransformed=x(this.popper.parentNode),this.update();var i=this.options.eventsEnabled;i&&this.enableEventListeners(),this.state.eventsEnabled=i}return ne(e,[{key:"update",value:function(){if(!this.state.isDestroyed){var e={instance:this,styles:{},attributes:{},flipped:!1,offsets:{}};this.state.position=s(this.reference),F(this.popper,{position:this.state.position}),e.offsets.reference=I(this.state,this.popper,this.reference),e.placement=h(this.options.placement,e.offsets.reference,this.popper),e.originalPlacement=this.options.placement,e.offsets.popper=P(this.state,this.popper,e.offsets.reference,e.placement),e=O(this.modifiers,e),this.state.isCreated?this.options.onUpdate(e):(this.state.isCreated=!0,this.options.onCreate(e))}}},{key:"destroy",value:function(){return this.state.isDestroyed=!0,L(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.left="",this.popper.style.position="",this.popper.style.top="",this.popper.style[T("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}},{key:"enableEventListeners",value:function(){this.state.eventsEnabled||(this.state=k(this.reference,this.options,this.state,this.scheduleUpdate))}},{key:"disableEventListeners",value:function(){this.state.eventsEnabled&&(window.cancelAnimationFrame(this.scheduleUpdate),this.state=N(this.reference,this.state))}}]),e}();return le.Utils=ie,le.placements=["auto","auto-start","auto-end","top","top-start","top-end","right","right-start","right-end","bottom","bottom-start","bottom-end","left","left-start","left-end"],le.Defaults=se,le})},{}],152:[function(e,t,n){function o(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(e){if(p===setTimeout)return setTimeout(e,0);if((p===o||!p)&&setTimeout)return p=setTimeout,setTimeout(e,0);try{return p(e,0)}catch(t){try{return p.call(null,e,0)}catch(t){return p.call(this,e,0)}}}function a(e){if(d===clearTimeout)return clearTimeout(e);if((d===r||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(e);try{return d(e)}catch(t){try{return d.call(null,e)}catch(t){return d.call(this,e)}}}function s(){m&&f&&(m=!1,f.length?h=f.concat(h):v=-1,h.length&&l())}function l(){if(!m){var e=i(s);m=!0;for(var t=h.length;t;){for(f=h,h=[];++v<t;)f&&f[v].run();v=-1,t=h.length}f=null,m=!1,a(e)}}function c(e,t){this.fun=e,this.array=t}function u(){}var p,d,g=t.exports={};!function(){try{p="function"==typeof setTimeout?setTimeout:o}catch(e){p=o}try{d="function"==typeof clearTimeout?clearTimeout:r}catch(e){d=r}}();var f,h=[],m=!1,v=-1;g.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];h.push(new c(e,t)),1!==h.length||m||i(l)},c.prototype.run=function(){this.fun.apply(null,this.array)},g.title="browser",g.browser=!0,g.env={},g.argv=[],g.version="",g.versions={},g.on=u,g.addListener=u,g.once=u,g.off=u,g.removeListener=u,g.removeAllListeners=u,g.emit=u,g.prependListener=u,g.prependOnceListener=u,g.listeners=function(e){return[]},g.binding=function(e){throw new Error("process.binding is not supported")},g.cwd=function(){return"/"},g.chdir=function(e){throw new Error("process.chdir is not supported")},g.umask=function(){return 0}},{}]},{},[14]);